(function(e){function t(e,t,r){"string"==typeof e?e[t]=r:Object.defineProperty(e,t,{value:r,enumerable:!1,configurable:!0,writable:!0})}function r(e,t){if(e)return e.$$const[t]}function n(e,t){var r,n,a;if(0!==e.length)for(r=0,n=e.length;r<n;r++)if(null!=(a=e[r].$$const[t]))return a}function a(e,t){var r,n,a;if(null!=e)for(r=0,n=(a=C.ancestors(e)).length;r<n;r++)if(a[r].$$const&&q.call(a[r].$$const,t))return a[r].$$const[t]}function i(e,t){if(null==e||e.$$is_module)return a(T,t)}function $(e,t,r){if(!r)return(e||T).$const_missing(t)}function o(e,t){var n=r(e,t);if(n){if(!n.$$is_class)throw C.TypeError.$new(t+" is not a class");return n}}function s(e,t){if(e.$$super!==t)throw C.TypeError.$new("superclass mismatch for class "+e.$$name)}function l(e,t){var n=r(e,t);if(null==n&&e===T&&(n=a(T,t)),n&&!n.$$is_module&&n!==T)throw C.TypeError.$new(t+" is not a module");return n}function u(e){return e.hasOwnProperty("$$iclass")&&e.hasOwnProperty("$$root")}function c(e){for(var t,r=[],n=Object.getPrototypeOf(e.$$prototype);n&&!n.hasOwnProperty("$$class");)(t=y(n))&&r.push(t),n=Object.getPrototypeOf(n);return r}function p(e){var t,r=[],n=Object.getPrototypeOf(e.$$prototype);if(e.$$prototype.hasOwnProperty("$$dummy"))for(;n&&n!==e.$$prototype.$$define_methods_on;)(t=y(n))&&r.push(t),n=Object.getPrototypeOf(n);return r}function d(e){for(var t=e.$$prototype,r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++){var a=r[n];C.is_method(a)&&delete t[a]}}function _(e){var t=f(e);return e.$$is_module&&e.$$iclasses.push(t),t}function f(e){var r={},n=e.$$prototype;n.hasOwnProperty("$$dummy")&&(n=n.$$define_methods_on);var a,i=Object.getOwnPropertyNames(n),$=i.length;for(a=0;a<$;a++){var o=i[a];t(r,o,n[o])}return t(r,"$$iclass",!0),t(r,"$$module",e),r}function h(e){var r=e.length,n=e[0];if(t(n,"$$root",!0),1===r)return{first:n,last:n};for(var a=n,i=1;i<r;i++){var $=e[i];z(a,$),a=$}return{first:e[0],last:e[r-1]}}function y(e){if(!e.hasOwnProperty("$$dummy"))return e.hasOwnProperty("$$iclass")?e.$$module:e.hasOwnProperty("$$class")?e.$$class:void 0}function m(e){return e.$$own_prepended_modules.concat([e]).concat(e.$$own_included_modules)}function g(e){return"function"==typeof e&&!e.$$stub}function b(){}function v(){}function w(){}function k(){}function x(){}var E,O,A,T,S,I,R=this;if("undefined"!=typeof global&&(R=global),"undefined"!=typeof window&&(R=window),"log"in(E="object"==typeof R.console?R.console:null==R.console?R.console={}:{})||(E.log=function(){}),"warn"in E||(E.warn=E.log),"undefined"!=typeof this.Opal)return E.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),this.Opal;var C=this.Opal={};C.global=R,R.Opal=C,C.config={missing_require_severity:"error",unsupported_features_severity:"warning",enable_stack_trace:!0};var q=Object.hasOwnProperty,M=Function.prototype.bind,z=Object.setPrototypeOf,N=Array.prototype.slice,j=Array.prototype.splice,P=4,B=P;C.uid=function(){return B+=2},C.id=function(e){return e.$$is_number?2*e+1:null!=e.$$id?e.$$id:(t(e,"$$id",C.uid()),e.$$id)},C.gvars={},C.exit=function(e){C.gvars.DEBUG&&E.log("Exited with status "+e)},C.exceptions=[],C.pop_exception=function(){C.gvars["!"]=C.exceptions.pop()||O},C.inspect=function(t){return t===e?"undefined":null===t?"null":t.$$class?t.$inspect():t.toString()},C.defineProperty=t,C.slice=N,C.truthy=function(e){return e!==O&&null!=e&&(!e.$$is_boolean||1==e)},C.falsy=function(e){return e===O||null==e||e.$$is_boolean&&0==e},C.const_get_local=function(e,t,n){var a;if(null!=e){if("::"===e&&(e=T),!e.$$is_module&&!e.$$is_class)throw new C.TypeError(e.toString()+" is not a class/module");return null!=(a=r(e,t))?a:null!=(a=$(e,t,n))?a:void 0}},C.const_get_qualified=function(e,n,i){var o,s,l,u=C.const_cache_version;if(null!=e){if("::"===e&&(e=T),!e.$$is_module&&!e.$$is_class)throw new C.TypeError(e.toString()+" is not a class/module");return null==(s=e.$$const_cache)&&(t(e,"$$const_cache",Object.create(null)),s=e.$$const_cache),null==(l=s[n])||l[0]!==u?(null!=(o=r(e,n))||(o=a(e,n)),s[n]=[u,o]):o=l[1],null!=o?o:$(e,n,i)}},C.const_cache_version=1,C.const_get_relative=function(e,o,s){var l,u,c,p=e[0],d=C.const_cache_version;return null==(u=e.$$const_cache)&&(t(e,"$$const_cache",Object.create(null)),u=e.$$const_cache),null==(c=u[o])||c[0]!==d?(null!=(l=r(p,o))||null!=(l=n(e,o))||null!=(l=a(p,o))||(l=i(p,o)),u[o]=[d,l]):l=c[1],null!=l?l:$(p,o,s)},C.const_set=function(e,r,n){return null!=e&&"::"!==e||(e=T),n.$$is_a_module&&(null!=n.$$name&&n.$$name!==O||(n.$$name=r),null==n.$$base_module&&(n.$$base_module=e)),e.$$const=e.$$const||Object.create(null),e.$$const[r]=n,e.$$=e.$$const,C.const_cache_version++,e===T&&(C[r]=n),t(e,r,n),n},C.constants=function(e,t){null==t&&(t=!0);var r,n,a,i,$=[e],o={};for(t&&($=$.concat(C.ancestors(e))),t&&e.$$is_module&&($=$.concat([C.Object]).concat(C.ancestors(C.Object))),n=0,a=$.length;n<a&&(r=$[n],e===T||r!=T);n++)for(i in r.$$const)o[i]=!0;return Object.keys(o)},C.const_remove=function(e,t){if(C.const_cache_version++,null!=e.$$const[t]){var r=e.$$const[t];return delete e.$$const[t],r}if(null!=e.$$autoload&&null!=e.$$autoload[t])return delete e.$$autoload[t],O;throw C.NameError.$new("constant "+e+"::"+e.$name()+" not defined")},C.allocate_class=function(e,r){var n,a;return a=null!=r&&r.$$bridge?function(){var e=N.call(arguments),t=new(M.apply(r.$$constructor,[null].concat(e)));return z(t,n.$$prototype),t}:function(){},e&&t(a,"displayName","::"+e),t(n=a,"$$name",e),t(n,"$$constructor",a),t(n,"$$prototype",a.prototype),t(n,"$$const",{}),t(n,"$$is_class",!0),t(n,"$$is_a_module",!0),t(n,"$$super",r),t(n,"$$cvars",{}),t(n,"$$own_included_modules",[]),t(n,"$$own_prepended_modules",[]),t(n,"$$ancestors",[]),t(n,"$$ancestors_cache_version",null),t(n.$$prototype,"$$class",n),C.Class&&z(n,C.Class.prototype),null!=r&&(z(n.$$prototype,r.$$prototype),r.$$meta&&C.build_class_singleton_class(n)),n},C.klass=function(e,t,r){var n;null==e?e=T:e.$$is_class||e.$$is_module||(e=e.$$class),null==t||t.hasOwnProperty("$$is_class")||(n=t,t=T);var a=o(e,r);return a?(t&&s(a,t),a):(null==t&&(t=T),a=C.allocate_class(r,t),C.const_set(e,r,a),t.$inherited&&t.$inherited(a),n&&C.bridge(n,a),a)},C.allocate_module=function(e){var r=function(){};e&&t(r,"displayName",e+".$$constructor");var n=r;return e&&t(r,"displayName",e+".constructor"),t(n,"$$name",e),t(n,"$$prototype",r.prototype),t(n,"$$const",{}),t(n,"$$is_module",!0),t(n,"$$is_a_module",!0),t(n,"$$cvars",{}),t(n,"$$iclasses",[]),t(n,"$$own_included_modules",[]),t(n,"$$own_prepended_modules",[]),t(n,"$$ancestors",[n]),t(n,"$$ancestors_cache_version",null),z(n,C.Module.prototype),n},C.module=function(e,t){var r;return null==e?e=T:e.$$is_class||e.$$is_module||(e=e.$$class),(r=l(e,t))?r:(r=C.allocate_module(t),C.const_set(e,t,r),r)},C.get_singleton_class=function(e){return e.$$meta?e.$$meta:e.hasOwnProperty("$$is_class")?C.build_class_singleton_class(e):e.hasOwnProperty("$$is_module")?C.build_module_singletin_class(e):C.build_object_singleton_class(e)},C.build_class_singleton_class=function(e){var r,n;return e.$$meta?e.$$meta:(r=e===A?I:C.get_singleton_class(e.$$super),t(n=C.allocate_class(null,r,function(){}),"$$is_singleton",!0),t(n,"$$singleton_of",e),t(e,"$$meta",n),z(e,n.$$prototype),t(e,"$$class",C.Class),n)},C.build_module_singletin_class=function(e){if(e.$$meta)return e.$$meta;var r=C.allocate_class(null,C.Module,function(){});return t(r,"$$is_singleton",!0),t(r,"$$singleton_of",e),t(e,"$$meta",r),z(e,r.$$prototype),t(e,"$$class",C.Module),r},C.build_object_singleton_class=function(e){var r=e.$$class,n=C.allocate_class(O,r,function(){});return t(n,"$$is_singleton",!0),t(n,"$$singleton_of",e),delete n.$$prototype.$$class,t(e,"$$meta",n),z(e,e.$$meta.$$prototype),n},C.is_method=function(e){return"$"===e[0]&&"$"!==e[1]},C.instance_methods=function(e){for(var t=[],r=[],n=C.ancestors(e),a=0,i=n.length;a<i;a++){var $=n[a].$$prototype;$.hasOwnProperty("$$dummy")&&($=$.$$define_methods_on);for(var o=Object.getOwnPropertyNames($),s=0,l=o.length;s<l;s++){var u=o[s];if(C.is_method(u)){var c=u.slice(1),p=$[u];p.$$stub&&-1===t.indexOf(c)&&t.push(c),p.$$stub||-1!==r.indexOf(c)||-1!==t.indexOf(c)||r.push(c)}}}return r},C.own_instance_methods=function(e){var t=[],r=e.$$prototype;r.hasOwnProperty("$$dummy")&&(r=r.$$define_methods_on);for(var n=Object.getOwnPropertyNames(r),a=0,i=n.length;a<i;a++){var $=n[a];if(C.is_method($))if(!r[$].$$stub){var o=$.slice(1);t.push(o)}}return t},C.methods=function(e){return C.instance_methods(C.get_singleton_class(e))},C.own_methods=function(e){return C.own_instance_methods(C.get_singleton_class(e))},C.receiver_methods=function(e){var t=C.get_singleton_class(e),r=C.own_instance_methods(t),n=C.own_instance_methods(t.$$super);return r.concat(n)},C.class_variables=function(e){var t,r=C.ancestors(e),n={};for(t=r.length-1;t>=0;t--){var a=r[t];for(var i in a.$$cvars)n[i]=a.$$cvars[i]}return n},C.class_variable_set=function(e,t,r){var n,a=C.ancestors(e);for(n=a.length-2;n>=0;n--){var i=a[n];if(q.call(i.$$cvars,t))return i.$$cvars[t]=r,r}return e.$$cvars[t]=r,r},C.append_features=function(e,r){var n=C.ancestors(e),a=[];if(-1!==n.indexOf(r))throw C.ArgumentError.$new("cyclic include detected");for(var i=0,$=n.length;i<$;i++){var o=_(n[i]);t(o,"$$included",!0),a.push(o)}var s,l,p=C.ancestors(r),d=h(a);if(-1===p.indexOf(e))s=r.$$prototype,l=Object.getPrototypeOf(r.$$prototype);else{for(var f=r.$$prototype,y=Object.getPrototypeOf(f);null!=y&&(!u(y)||y.$$module!==e);)f=y,y=Object.getPrototypeOf(y);for(var m=Object.getPrototypeOf(y);m.hasOwnProperty("$$iclass")&&!u(m);)m=Object.getPrototypeOf(m);s=f,l=m}z(s,d.first),z(d.last,l),r.$$own_included_modules=c(r),C.const_cache_version++},C.prepend_features=function(e,r){var n=C.ancestors(e),a=[];if(-1!==n.indexOf(r))throw C.ArgumentError.$new("cyclic prepend detected");for(var i=0,$=n.length;i<$;i++){var o=_(n[i]);t(o,"$$prepended",!0),a.push(o)}var s,l,u,c=h(a),y=r.$$prototype,m=Object.getPrototypeOf(y);if(y.hasOwnProperty("$$dummy")?s=y.$$define_methods_on:(s=f(r),d(r),t(y,"$$dummy",!0),t(y,"$$define_methods_on",s),z(y,s),z(s,m)),-1!==C.ancestors(r).indexOf(e))throw C.RuntimeError.$new("Prepending a module multiple times is not supported");for(l=y,u=Object.getPrototypeOf(y);null!=u&&!u.hasOwnProperty("$$root")&&u!==s&&u.hasOwnProperty("$$iclass");)u=Object.getPrototypeOf(u);z(l,c.first),z(c.last,u),r.$$own_prepended_modules=p(r),C.const_cache_version++},C.bridge=function(e,r){if(e.hasOwnProperty("$$bridge"))throw C.ArgumentError.$new("already bridged");r.$$super||C.Object;r.$$prototype;t(e,"$$bridge",r),z(e.prototype,(r.$$super||C.Object).$$prototype),t(r,"$$prototype",e.prototype),t(r.$$prototype,"$$class",r),t(r,"$$constructor",e),t(r,"$$bridge",!0)},C.ancestors=function(e){if(!e)return[];if(e.$$ancestors_cache_version===C.const_cache_version)return e.$$ancestors;var t,r,n,a=[];for(t=0,n=(r=m(e)).length;t<n;t++)a.push(r[t]);if(e.$$super)for(t=0,n=(r=C.ancestors(e.$$super)).length;t<n;t++)a.push(r[t]);return e.$$ancestors_cache_version=C.const_cache_version,e.$$ancestors=a,a},C.included_modules=function(e){for(var t=[],r=null,n=Object.getPrototypeOf(e.$$prototype);n&&Object.getPrototypeOf(n);n=Object.getPrototypeOf(n))(r=y(n))&&r.$$is_module&&n.$$iclass&&n.$$included&&t.push(r);return t},C.add_stubs=function(e){for(var t=C.BasicObject.$$prototype,r=0,n=e.length;r<n;r++){var a=e[r],i=t[a];(null==i||i.$$stub)&&C.add_stub_for(t,a)}},C.add_stub_for=function(e,r){t(e,r,C.stub_for(r))},C.stub_for=function(e){function t(){this.$method_missing.$$p=t.$$p,t.$$p=null;for(var r=new Array(arguments.length),n=0,a=r.length;n<a;n++)r[n]=arguments[n];return this.$method_missing.apply(this,[e.slice(1)].concat(r))}return t.$$stub=!0,t},C.ac=function(e,t,r,n){var a="";throw r.$$is_a_module?a+=r.$$name+".":a+=r.$$class.$$name+"#",a+=n,C.ArgumentError.$new("["+a+"] wrong number of arguments("+e+" for "+t+")")},C.block_ac=function(e,t,r){var n="`block in "+r+"'";throw C.ArgumentError.$new(n+": wrong number of arguments ("+e+" for "+t+")")},C.find_super_dispatcher=function(e,t,r,n){for(var a,i,$="$"+t,o=(a=e.hasOwnProperty("$$meta")?C.ancestors(e.$$meta):C.ancestors(e.$$class)).indexOf(r.$$owner)+1;o<a.length;o++){var s=a[o].$$prototype;if(s.hasOwnProperty("$$dummy")&&(s=s.$$define_methods_on),s.hasOwnProperty($)){var l=s[$];l.$$stub||(i=l);break}}if(!n&&null==i&&C.Kernel.$method_missing===e.$method_missing)throw C.NoMethodError.$new("super: no superclass method `"+t+"' for "+e,t);return i},C.find_iter_super_dispatcher=function(e,t,r,n,a){var i=t;if(!r)throw C.RuntimeError.$new("super called outside of method");if(a&&r.$$define_meth)throw C.RuntimeError.$new("implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly");return r.$$def&&(i=r.$$jsid),C.find_super_dispatcher(e,i,r,n)},C.ret=function(e){throw C.returner.$v=e,C.returner},C.brk=function(e,t){throw t.$v=e,t},C.new_brk=function(){return new Error("unexpected break")},C.yield1=function(e,t){if("function"!=typeof e)throw C.LocalJumpError.$new("no block given");var r=e.$$has_top_level_mlhs_arg,n=e.$$has_trailing_comma_in_args;return(e.length>1||(r||n)&&1===e.length)&&(t=C.to_ary(t)),(e.length>1||n&&1===e.length)&&t.$$is_array?e.apply(null,t):e(t)},C.yieldX=function(e,t){if("function"!=typeof e)throw C.LocalJumpError.$new("no block given");if(e.length>1&&1===t.length&&t[0].$$is_array)return e.apply(null,t[0]);if(!t.$$is_array){for(var r=new Array(t.length),n=0,a=r.length;n<a;n++)r[n]=t[n];return e.apply(null,r)}return e.apply(null,t)},C.rescue=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(n.$$is_array){var a=C.rescue(e,n);if(a)return a}else{if(n===C.JS.Error)return n;if(n["$==="](e))return n}}return null},C.is_a=function(e,t){if(null!=t&&e.$$meta===t||e.$$class===t)return!0;if(e.$$is_number&&t.$$is_number_class)return!0;var r,n,a=C.ancestors(e.$$is_class?C.get_singleton_class(e):e.$$meta||e.$$class);for(r=0,n=a.length;r<n;r++)if(a[r]===t)return!0;return!1},C.to_hash=function(e){if(e.$$is_hash)return e;if(e["$respond_to?"]("to_hash",!0)){var t=e.$to_hash();if(t.$$is_hash)return t;throw C.TypeError.$new("Can't convert "+e.$$class+" to Hash ("+e.$$class+"#to_hash gives "+t.$$class+")")}throw C.TypeError.$new("no implicit conversion of "+e.$$class+" into Hash")},C.to_ary=function(e){if(e.$$is_array)return e;if(e["$respond_to?"]("to_ary",!0)){var t=e.$to_ary();if(t===O)return[e];if(t.$$is_array)return t;throw C.TypeError.$new("Can't convert "+e.$$class+" to Array ("+e.$$class+"#to_ary gives "+t.$$class+")")}return[e]},C.to_a=function(e){if(e.$$is_array)return e.slice();if(e["$respond_to?"]("to_a",!0)){var t=e.$to_a();if(t===O)return[e];if(t.$$is_array)return t;throw C.TypeError.$new("Can't convert "+e.$$class+" to Array ("+e.$$class+"#to_a gives "+t.$$class+")")}return[e]},C.extract_kwargs=function(e){var t=e[e.length-1];return null!=t&&t["$respond_to?"]("to_hash",!0)?(j.call(e,e.length-1,1),t.$to_hash()):C.hash2([],{})},C.kwrestargs=function(e,t){var r,n=[],a={},i=e.$$smap;for(r in i)t[r]||(n.push(r),a[r]=i[r]);return C.hash2(n,a)},C.send=function(e,t,r,n){var a="string"==typeof t?e["$"+t]:t;return null!=a?("function"==typeof n&&(a.$$p=n),a.apply(e,r)):e.$method_missing.apply(e,[t].concat(r))},C.lambda=function(e){return e.$$is_lambda=!0,e},C.def=function(e,t,r){e===C.top?C.defn(C.Object,t,r):!e.$$eval&&e.$$is_a_module?C.defn(e,t,r):C.defs(e,t,r)},C.defn=function(e,r,n){n.displayName=r,n.$$owner=e;var a=e.$$prototype;if(a.hasOwnProperty("$$dummy")&&(a=a.$$define_methods_on),t(a,r,n),e.$$is_module){e.$$module_function&&C.defs(e,r,n);for(var i=0,$=e.$$iclasses,o=$.length;i<o;i++){t($[i],r,n)}}var s=e.$$singleton_of;!e.$method_added||e.$method_added.$$stub||s?s&&s.$singleton_method_added&&!s.$singleton_method_added.$$stub&&s.$singleton_method_added(r.substr(1)):e.$method_added(r.substr(1))},C.defs=function(e,t,r){if(e.$$is_string||e.$$is_number)throw C.TypeError.$new("can't define singleton");C.defn(C.get_singleton_class(e),t,r)},C.rdef=function(e,t){if(!q.call(e.$$prototype,t))throw C.NameError.$new("method '"+t.substr(1)+"' not defined in "+e.$name());delete e.$$prototype[t],e.$$is_singleton?e.$$prototype.$singleton_method_removed&&!e.$$prototype.$singleton_method_removed.$$stub&&e.$$prototype.$singleton_method_removed(t.substr(1)):e.$method_removed&&!e.$method_removed.$$stub&&e.$method_removed(t.substr(1))},C.udef=function(e,t){if(!e.$$prototype[t]||e.$$prototype[t].$$stub)throw C.NameError.$new("method '"+t.substr(1)+"' not defined in "+e.$name());C.add_stub_for(e.$$prototype,t),e.$$is_singleton?e.$$prototype.$singleton_method_undefined&&!e.$$prototype.$singleton_method_undefined.$$stub&&e.$$prototype.$singleton_method_undefined(t.substr(1)):e.$method_undefined&&!e.$method_undefined.$$stub&&e.$method_undefined(t.substr(1))},C.alias=function(e,t,r){var n,a="$"+t,i="$"+r,$=e.$$prototype["$"+r];if(e.$$eval)return C.alias(C.get_singleton_class(e),t,r);if(!g($)){for(var o=e.$$super;"function"!=typeof $&&o;)$=o[i],o=o.$$super;if(!g($)&&e.$$is_module&&($=C.Object.$$prototype[i]),!g($))throw C.NameError.$new("undefined method `"+r+"' for class `"+e.$name()+"'")}return $.$$alias_of&&($=$.$$alias_of),(n=function(){var e,t,r,a=n.$$p;for(e=new Array(arguments.length),t=0,r=arguments.length;t<r;t++)e[t]=arguments[t];return null!=a&&(n.$$p=null),C.send(this,$,e,a)}).displayName=t,n.length=$.length,n.$$arity=$.$$arity,n.$$parameters=$.$$parameters,n.$$source_location=$.$$source_location,n.$$alias_of=$,n.$$alias_name=t,C.defn(e,a,n),e},C.alias_native=function(e,t,r){var n="$"+t,a=e.$$prototype[r];if("function"!=typeof a||a.$$stub)throw C.NameError.$new("undefined native method `"+r+"' for class `"+e.$name()+"'");return C.defn(e,n,a),e},C.hash_init=function(e){e.$$smap=Object.create(null),e.$$map=Object.create(null),e.$$keys=[]},C.hash_clone=function(e,t){t.$$none=e.$$none,t.$$proc=e.$$proc;for(var r,n,a=0,i=e.$$keys,$=e.$$smap,o=i.length;a<o;a++)(r=i[a]).$$is_string?n=$[r]:(n=r.value,r=r.key),C.hash_put(t,r,n)},C.hash_put=function(t,r,n){if(r.$$is_string)return q.call(t.$$smap,r)||t.$$keys.push(r),void(t.$$smap[r]=n);var a,i,$;if(a=t.$$by_identity?C.id(r):r.$hash(),!q.call(t.$$map,a))return i={key:r,key_hash:a,value:n},t.$$keys.push(i),void(t.$$map[a]=i);for(i=t.$$map[a];i;){if(r===i.key||r["$eql?"](i.key)){$=e,i.value=n;break}$=i,i=i.next}$&&(i={key:r,key_hash:a,value:n},t.$$keys.push(i),$.next=i)},C.hash_get=function(e,t){if(t.$$is_string)return q.call(e.$$smap,t)?e.$$smap[t]:void 0;var r,n;if(r=e.$$by_identity?C.id(t):t.$hash(),q.call(e.$$map,r))for(n=e.$$map[r];n;){if(t===n.key||t["$eql?"](n.key))return n.value;n=n.next}},C.hash_delete=function(e,t){var r,n,a=e.$$keys,i=a.length;if(t.$$is_string){if(!q.call(e.$$smap,t))return;for(r=0;r<i;r++)if(a[r]===t){a.splice(r,1);break}return n=e.$$smap[t],delete e.$$smap[t],n}var $=t.$hash();if(q.call(e.$$map,$))for(var o,s=e.$$map[$];s;){if(t===s.key||t["$eql?"](s.key)){for(n=s.value,r=0;r<i;r++)if(a[r]===s){a.splice(r,1);break}return o&&s.next?o.next=s.next:o?delete o.next:s.next?e.$$map[$]=s.next:delete e.$$map[$],n}o=s,s=s.next}},C.hash_rehash=function(t){for(var r,n,a,i=0,$=t.$$keys.length;i<$;i++)if(!t.$$keys[i].$$is_string&&(r=t.$$keys[i].key.$hash())!==t.$$keys[i].key_hash){for(n=t.$$map[t.$$keys[i].key_hash],a=e;n;){if(n===t.$$keys[i]){a&&n.next?a.next=n.next:a?delete a.next:n.next?t.$$map[t.$$keys[i].key_hash]=n.next:delete t.$$map[t.$$keys[i].key_hash];break}a=n,n=n.next}if(t.$$keys[i].key_hash=r,q.call(t.$$map,r)){for(n=t.$$map[r],a=e;n;){if(n===t.$$keys[i]){a=e;break}a=n,n=n.next}a&&(a.next=t.$$keys[i])}else t.$$map[r]=t.$$keys[i]}},C.hash=function(){var e,t,r,n,a,i,$=arguments.length;if(1===$&&arguments[0].$$is_hash)return arguments[0];if(t=new C.Hash,C.hash_init(t),1===$&&arguments[0].$$is_array){for(n=(e=arguments[0]).length,r=0;r<n;r++){if(2!==e[r].length)throw C.ArgumentError.$new("value not of length 2: "+e[r].$inspect());a=e[r][0],i=e[r][1],C.hash_put(t,a,i)}return t}if(1===$){for(a in e=arguments[0])q.call(e,a)&&(i=e[a],C.hash_put(t,a,i));return t}if($%2!=0)throw C.ArgumentError.$new("odd number of arguments for Hash");for(r=0;r<$;r+=2)a=arguments[r],i=arguments[r+1],C.hash_put(t,a,i);return t},C.hash2=function(e,t){var r=new C.Hash;return r.$$smap=t,r.$$map=Object.create(null),r.$$keys=e,r},C.range=function(e,t,r){var n=new C.Range;return n.begin=e,n.end=t,n.excl=r,n},C.ivar=function(e){return"constructor"===e||"displayName"===e||"__count__"===e||"__noSuchMethod__"===e||"__parent__"===e||"__proto__"===e||"hasOwnProperty"===e||"valueOf"===e?e+"$":e},C.escape_regexp=function(e){return e.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},C.global_regexp=function(e){return e.global?e:(null==e.$$g?e.$$g=new RegExp(e.source,(e.multiline?"gm":"g")+(e.ignoreCase?"i":"")):e.$$g.lastIndex=null,e.$$g)},C.global_multiline_regexp=function(e){var t;if(e.multiline){if(e.global)return e;t=null!=e.$$g?e.$$g:e.$$g=new RegExp(e.source,"gm"+(e.ignoreCase?"i":""))}else t=null!=e.$$gm?e.$$gm:e.$$gm=new RegExp(e.source,"gm"+(e.ignoreCase?"i":""));return t.lastIndex=null,t},C.modules={},C.loaded_features=["corelib/runtime"],C.current_dir=".",C.require_table={"corelib/runtime":!0},C.normalize=function(e){var t,r,n=[],a="/";"."!==C.current_dir&&(e=C.current_dir.replace(/\/*$/,"/")+e);for(var i=0,$=(t=(e=(e=e.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split(a)).length;i<$;i++)""!==(r=t[i])&&(".."===r?n.pop():n.push(r));return n.join(a)},C.loaded=function(e){var t,r,n;for(t=0,r=e.length;t<r;t++)n=C.normalize(e[t]),C.require_table[n]||(C.loaded_features.push(n),C.require_table[n]=!0)},C.load=function(e){e=C.normalize(e),C.loaded([e]);var t=C.modules[e];if(t)t(C);else{var r=C.config.missing_require_severity,n="cannot load such file -- "+e;if("error"===r)throw C.LoadError?C.LoadError.$new(n):n;"warning"===r&&E.warn("WARNING: LoadError: "+n)}return!0},C.require=function(e){return e=C.normalize(e),!C.require_table[e]&&C.load(e)},C.BasicObject=A=C.allocate_class("BasicObject",null,b),C.Object=T=C.allocate_class("Object",C.BasicObject,v),C.Module=S=C.allocate_class("Module",C.Object,w),C.Class=I=C.allocate_class("Class",C.Module,k),z(C.BasicObject,C.Class.$$prototype),z(C.Object,C.Class.$$prototype),z(C.Module,C.Class.$$prototype),z(C.Class,C.Class.$$prototype),A.$$const.BasicObject=A,C.const_set(T,"BasicObject",A),C.const_set(T,"Object",T),C.const_set(T,"Module",S),C.const_set(T,"Class",I),A.$$class=I,T.$$class=I,S.$$class=I,I.$$class=I,t(T.$$prototype,"toString",function(){var e=this.$to_s();return e.$$is_string&&"object"==typeof e?e.valueOf():e}),t(T.$$prototype,"$require",C.require),C.$$=T.$$,C.top=new T,C.top.$to_s=C.top.$inspect=function(){return"main"},C.NilClass=C.allocate_class("NilClass",C.Object,x),C.const_set(T,"NilClass",C.NilClass),(O=C.nil=new C.NilClass).$$id=P,O.call=O.apply=function(){throw C.LocalJumpError.$new("no block given")},C.breaker=new Error("unexpected break (old)"),C.returner=new Error("unexpected return"),TypeError.$$super=Error}).call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.truthy;return e.add_stubs(["$new","$class","$===","$respond_to?","$raise","$type_error","$__send__","$coerce_to","$nil?","$<=>","$coerce_to!","$!=","$[]","$upcase"]),function(t,$){var o,s,l,u,c,p,d,_,f,h,y,m,g,b,v=a(t,"Opal"),w=[v].concat($);e.defs(v,"$bridge",o=function(t,r){return e.bridge(t,r)},o.$$arity=2),e.defs(v,"$type_error",s=function(e,t,a,$){var o;return null==a&&(a=r),null==$&&($=r),i(i(o=a)?$:o)?n(w,"TypeError").$new("can't convert "+e.$class()+" into "+t+" ("+e.$class()+"#"+a+" gives "+$.$class()+")"):n(w,"TypeError").$new("no implicit conversion of "+e.$class()+" into "+t)},s.$$arity=-3),e.defs(v,"$coerce_to",l=function(e,t,r){var n=this;return i(t["$==="](e))?e:(i(e["$respond_to?"](r))||n.$raise(n.$type_error(e,t)),e.$__send__(r))},l.$$arity=3),e.defs(v,"$coerce_to!",u=function(e,t,n){var a=this,$=r;return $=a.$coerce_to(e,t,n),i(t["$==="]($))||a.$raise(a.$type_error(e,t,n,$)),$},u.$$arity=3),e.defs(v,"$coerce_to?",c=function(e,t,n){var a=this,$=r;return i(e["$respond_to?"](n))?($=a.$coerce_to(e,t,n),i($["$nil?"]())?r:(i(t["$==="]($))||a.$raise(a.$type_error(e,t,n,$)),$)):r},c.$$arity=3),e.defs(v,"$try_convert",p=function(e,t,n){return i(t["$==="](e))?e:i(e["$respond_to?"](n))?e.$__send__(n):r},p.$$arity=3),e.defs(v,"$compare",d=function(e,t){var a=this,$=r;return $=e["$<=>"](t),i($===r)&&a.$raise(n(w,"ArgumentError"),"comparison of "+e.$class()+" with "+t.$class()+" failed"),$},d.$$arity=2),e.defs(v,"$destructure",_=function(e){if(1==e.length)return e[0];if(e.$$is_array)return e;for(var t=new Array(e.length),r=0,n=t.length;r<n;r++)t[r]=e[r];return t},_.$$arity=1),e.defs(v,"$respond_to?",f=function(e,t,r){return null==r&&(r=!1),!(null==e||!e.$$class)&&e["$respond_to?"](t,r)},f.$$arity=-3),e.defs(v,"$inspect_obj",h=function(t){return e.inspect(t)},h.$$arity=1),e.defs(v,"$instance_variable_name!",y=function(e){var t=this;return e=n(w,"Opal")["$coerce_to!"](e,n(w,"String"),"to_str"),i(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(e))||t.$raise(n(w,"NameError").$new("'"+e+"' is not allowed as an instance variable name",e)),e},y.$$arity=1),e.defs(v,"$class_variable_name!",m=function(e){var t=this;return e=n(w,"Opal")["$coerce_to!"](e,n(w,"String"),"to_str"),i(e.length<3||"@@"!==e.slice(0,2))&&t.$raise(n(w,"NameError").$new("`"+e+"' is not allowed as a class variable name",e)),e},m.$$arity=1),e.defs(v,"$const_name!",g=function(e){var t=this;return e=n(w,"Opal")["$coerce_to!"](e,n(w,"String"),"to_str"),i(e["$[]"](0)["$!="](e["$[]"](0).$upcase()))&&t.$raise(n(w,"NameError"),"wrong constant name "+e),e},g.$$arity=1),e.defs(v,"$pristine",b=function(t){for(var n,a,i,$=(n=e.slice.call(arguments,1,arguments.length)).length-1;$>=0;$--)a=n[$],(i=t.$$prototype["$"+a])&&!i.$$stub&&(i.$$pristine=!0);return r},b.$$arity=-2)}(t[0],t)},Opal.modules["corelib/module"]=function(Opal){function $rb_lt(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function $rb_gt(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass,$send=Opal.send,$truthy=Opal.truthy,$lambda=Opal.lambda,$range=Opal.range,$hash2=Opal.hash2;return Opal.add_stubs(["$module_eval","$to_proc","$===","$raise","$equal?","$<","$>","$nil?","$attr_reader","$attr_writer","$class_variable_name!","$new","$const_name!","$=~","$inject","$split","$const_get","$==","$!~","$start_with?","$bind","$call","$class","$append_features","$included","$name","$cover?","$size","$merge","$compile","$proc","$any?","$prepend_features","$prepended","$to_s","$__id__","$constants","$include?","$copy_class_variables","$copy_constants"]),function($base,$super,$parent_nesting){var self=$klass($base,$super,"Module"),$nesting=[self].concat($parent_nesting),$Module_allocate$1,$Module_initialize$2,$Module_$eq_eq_eq$3,$Module_$lt$4,$Module_$lt_eq$5,$Module_$gt$6,$Module_$gt_eq$7,$Module_$lt_eq_gt$8,$Module_alias_method$9,$Module_alias_native$10,$Module_ancestors$11,$Module_append_features$12,$Module_attr_accessor$13,$Module_attr_reader$14,$Module_attr_writer$15,$Module_autoload$16,$Module_class_variables$17,$Module_class_variable_get$18,$Module_class_variable_set$19,$Module_class_variable_defined$ques$20,$Module_remove_class_variable$21,$Module_constants$22,$Module_constants$23,$Module_nesting$24,$Module_const_defined$ques$25,$Module_const_get$26,$Module_const_missing$28,$Module_const_set$29,$Module_public_constant$30,$Module_define_method$31,$Module_remove_method$33,$Module_singleton_class$ques$34,$Module_include$35,$Module_included_modules$36,$Module_include$ques$37,$Module_instance_method$38,$Module_instance_methods$39,$Module_included$40,$Module_extended$41,$Module_extend_object$42,$Module_method_added$43,$Module_method_removed$44,$Module_method_undefined$45,$Module_module_eval$46,$Module_module_exec$48,$Module_method_defined$ques$49,$Module_module_function$50,$Module_name$51,$Module_prepend$52,$Module_prepend_features$53,$Module_prepended$54,$Module_remove_const$55,$Module_to_s$56,$Module_undef_method$57,$Module_instance_variables$58,$Module_dup$59,$Module_copy_class_variables$60,$Module_copy_constants$61;return Opal.defs(self,"$allocate",$Module_allocate$1=function(){var e=this,t=Opal.allocate_module(nil,function(){});return e!==Opal.Module&&Object.setPrototypeOf(t,e.$$prototype),t},$Module_allocate$1.$$arity=0),Opal.def(self,"$initialize",$Module_initialize$2=function(){var e=$Module_initialize$2.$$p,t=e||nil,r=this;return e&&($Module_initialize$2.$$p=null),e&&($Module_initialize$2.$$p=null),t!==nil?$send(r,"module_eval",[],t.$to_proc()):nil},$Module_initialize$2.$$arity=0),Opal.def(self,"$===",$Module_$eq_eq_eq$3=function(e){var t=this;return!$truthy(null==e)&&Opal.is_a(e,t)},$Module_$eq_eq_eq$3.$$arity=1),Opal.def(self,"$<",$Module_$lt$4=function(e){var t,r,n,a=this;if($truthy($$($nesting,"Module")["$==="](e))||a.$raise($$($nesting,"TypeError"),"compared with non class/module"),a===e)return!1;for(r=0,n=(t=Opal.ancestors(a)).length;r<n;r++)if(t[r]===e)return!0;for(r=0,n=(t=Opal.ancestors(e)).length;r<n;r++)if(t[r]===a)return!1;return nil},$Module_$lt$4.$$arity=1),Opal.def(self,"$<=",$Module_$lt_eq$5=function(e){var t,r=this;return $truthy(t=r["$equal?"](e))?t:$rb_lt(r,e)},$Module_$lt_eq$5.$$arity=1),Opal.def(self,"$>",$Module_$gt$6=function(e){var t=this;return $truthy($$($nesting,"Module")["$==="](e))||t.$raise($$($nesting,"TypeError"),"compared with non class/module"),$rb_lt(e,t)},$Module_$gt$6.$$arity=1),Opal.def(self,"$>=",$Module_$gt_eq$7=function(e){var t,r=this;return $truthy(t=r["$equal?"](e))?t:$rb_gt(r,e)},$Module_$gt_eq$7.$$arity=1),Opal.def(self,"$<=>",$Module_$lt_eq_gt$8=function(e){var t=this,r=nil;return t===e?0:$truthy($$($nesting,"Module")["$==="](e))?(r=$rb_lt(t,e),$truthy(r["$nil?"]())?nil:$truthy(r)?-1:1):nil},$Module_$lt_eq_gt$8.$$arity=1),Opal.def(self,"$alias_method",$Module_alias_method$9=function(e,t){var r=this;return Opal.alias(r,e,t),r},$Module_alias_method$9.$$arity=2),Opal.def(self,"$alias_native",$Module_alias_native$10=function(e,t){var r=this;return null==t&&(t=e),Opal.alias_native(r,e,t),r},$Module_alias_native$10.$$arity=-2),Opal.def(self,"$ancestors",$Module_ancestors$11=function(){var e=this;return Opal.ancestors(e)},$Module_ancestors$11.$$arity=0),Opal.def(self,"$append_features",$Module_append_features$12=function(e){var t=this;return Opal.append_features(t,e),t},$Module_append_features$12.$$arity=1),Opal.def(self,"$attr_accessor",$Module_attr_accessor$13=function(){var e,t=this;return e=Opal.slice.call(arguments,0,arguments.length),$send(t,"attr_reader",Opal.to_a(e)),$send(t,"attr_writer",Opal.to_a(e))},$Module_attr_accessor$13.$$arity=-1),Opal.alias(self,"attr","attr_accessor"),Opal.def(self,"$attr_reader",$Module_attr_reader$14=function(){var e,t=this;e=Opal.slice.call(arguments,0,arguments.length);for(var r=t.$$prototype,n=e.length-1;n>=0;n--){var a=e[n],i="$"+a,$=Opal.ivar(a),o=function(e){return function(){return null==this[e]?nil:this[e]}}($);Opal.defineProperty(r,$,nil),o.$$parameters=[],o.$$arity=0,Opal.defn(t,i,o)}return nil},$Module_attr_reader$14.$$arity=-1),Opal.def(self,"$attr_writer",$Module_attr_writer$15=function(){var e,t=this;e=Opal.slice.call(arguments,0,arguments.length);for(var r=t.$$prototype,n=e.length-1;n>=0;n--){var a=e[n],i="$"+a+"=",$=Opal.ivar(a),o=function(e){return function(t){return this[e]=t}}($);o.$$parameters=[["req"]],o.$$arity=1,Opal.defineProperty(r,$,nil),Opal.defn(t,i,o)}return nil},$Module_attr_writer$15.$$arity=-1),Opal.def(self,"$autoload",$Module_autoload$16=function(e,t){var r=this;return null==r.$$autoload&&(r.$$autoload={}),Opal.const_cache_version++,r.$$autoload[e]=t,nil},$Module_autoload$16.$$arity=2),Opal.def(self,"$class_variables",$Module_class_variables$17=function(){var e=this;return Object.keys(Opal.class_variables(e))},$Module_class_variables$17.$$arity=0),Opal.def(self,"$class_variable_get",$Module_class_variable_get$18=function(e){var t=this;e=$$($nesting,"Opal")["$class_variable_name!"](e);var r=Opal.class_variables(t)[e];return null==r&&t.$raise($$($nesting,"NameError").$new("uninitialized class variable "+e+" in "+t,e)),r},$Module_class_variable_get$18.$$arity=1),Opal.def(self,"$class_variable_set",$Module_class_variable_set$19=function(e,t){var r=this;return e=$$($nesting,"Opal")["$class_variable_name!"](e),Opal.class_variable_set(r,e,t)},$Module_class_variable_set$19.$$arity=2),
Opal.def(self,"$class_variable_defined?",$Module_class_variable_defined$ques$20=function(e){var t=this;return e=$$($nesting,"Opal")["$class_variable_name!"](e),Opal.class_variables(t).hasOwnProperty(e)},$Module_class_variable_defined$ques$20.$$arity=1),Opal.def(self,"$remove_class_variable",$Module_remove_class_variable$21=function(e){var t=this;if(e=$$($nesting,"Opal")["$class_variable_name!"](e),Opal.hasOwnProperty.call(t.$$cvars,e)){var r=t.$$cvars[e];return delete t.$$cvars[e],r}t.$raise($$($nesting,"NameError"),"cannot remove "+e+" for "+t)},$Module_remove_class_variable$21.$$arity=1),Opal.def(self,"$constants",$Module_constants$22=function(e){var t=this;return null==e&&(e=!0),Opal.constants(t,e)},$Module_constants$22.$$arity=-1),Opal.defs(self,"$constants",$Module_constants$23=function(e){var t=this;if(null==e){var r,n,a,i=(t.$$nesting||[]).concat(Opal.Object),$={};for(n=0,a=i.length;n<a;n++)for(r in i[n].$$const)$[r]=!0;return Object.keys($)}return Opal.constants(t,e)},$Module_constants$23.$$arity=-1),Opal.defs(self,"$nesting",$Module_nesting$24=function(){return this.$$nesting||[]},$Module_nesting$24.$$arity=0),Opal.def(self,"$const_defined?",$Module_const_defined$ques$25=function(e,t){var r=this;null==t&&(t=!0),e=$$($nesting,"Opal")["$const_name!"](e),$truthy(e["$=~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))||r.$raise($$($nesting,"NameError").$new("wrong constant name "+e,e));var n,a,i=[r];for(t&&(i=i.concat(Opal.ancestors(r)),r.$$is_module&&(i=i.concat([Opal.Object]).concat(Opal.ancestors(Opal.Object)))),n=0,a=i.length;n<a;n++)if(null!=i[n].$$const[e])return!0;return!1},$Module_const_defined$ques$25.$$arity=-2),Opal.def(self,"$const_get",$Module_const_get$26=function(e,t){var r,n=this;return null==t&&(t=!0),0===(e=$$($nesting,"Opal")["$const_name!"](e)).indexOf("::")&&"::"!==e&&(e=e.slice(2)),$truthy(-1!=e.indexOf("::")&&"::"!=e)?$send(e.$split("::"),"inject",[n],((r=function(e,t){r.$$s;return null==e&&(e=nil),null==t&&(t=nil),e.$const_get(t)}).$$s=n,r.$$arity=2,r)):($truthy(e["$=~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))||n.$raise($$($nesting,"NameError").$new("wrong constant name "+e,e)),t?$$([n],e):Opal.const_get_local(n,e))},$Module_const_get$26.$$arity=-2),Opal.def(self,"$const_missing",$Module_const_missing$28=function(e){var t=this,r=nil;if(t.$$autoload){var n=t.$$autoload[e];if(n)return t.$require(n),t.$const_get(e)}return r=t["$=="]($$($nesting,"Object"))?e:t+"::"+e,t.$raise($$($nesting,"NameError").$new("uninitialized constant "+r,e))},$Module_const_missing$28.$$arity=1),Opal.def(self,"$const_set",$Module_const_set$29=function(e,t){var r,n=this;return e=$$($nesting,"Opal")["$const_name!"](e),$truthy($truthy(r=e["$!~"]($$$($$($nesting,"Opal"),"CONST_NAME_REGEXP")))?r:e["$start_with?"]("::"))&&n.$raise($$($nesting,"NameError").$new("wrong constant name "+e,e)),Opal.const_set(n,e,t),t},$Module_const_set$29.$$arity=2),Opal.def(self,"$public_constant",$Module_public_constant$30=function(){return nil},$Module_public_constant$30.$$arity=1),Opal.def(self,"$define_method",$Module_define_method$31=function(e,t){var r,n,a=$Module_define_method$31.$$p,i=a||nil,$=this,o=nil;a&&($Module_define_method$31.$$p=null),a&&($Module_define_method$31.$$p=null),$truthy(t===undefined&&i===nil)&&$.$raise($$($nesting,"ArgumentError"),"tried to create a Proc object without a block");var s="$"+e;return(i=$truthy(r=i)?r:(o=t,$$($nesting,"Proc")["$==="](o)?t:$$($nesting,"Method")["$==="](o)?t.$to_proc().$$unbound:$$($nesting,"UnboundMethod")["$==="](o)?$lambda(((n=function(){var e,r=n.$$s||this,a=nil;return e=Opal.slice.call(arguments,0,arguments.length),a=t.$bind(r),$send(a,"call",Opal.to_a(e))}).$$s=$,n.$$arity=-1,n)):$.$raise($$($nesting,"TypeError"),"wrong argument type "+i.$class()+" (expected Proc/Method)"))).$$jsid=e,i.$$s=null,i.$$def=i,i.$$define_meth=!0,Opal.defn($,s,i),e},$Module_define_method$31.$$arity=-2),Opal.def(self,"$remove_method",$Module_remove_method$33=function(){for(var e,t=this,r=0,n=(e=Opal.slice.call(arguments,0,arguments.length)).length;r<n;r++)Opal.rdef(t,"$"+e[r]);return t},$Module_remove_method$33.$$arity=-1),Opal.def(self,"$singleton_class?",$Module_singleton_class$ques$34=function(){return!!this.$$is_singleton},$Module_singleton_class$ques$34.$$arity=0),Opal.def(self,"$include",$Module_include$35=function(){for(var e,t=this,r=(e=Opal.slice.call(arguments,0,arguments.length)).length-1;r>=0;r--){var n=e[r];n.$$is_module||t.$raise($$($nesting,"TypeError"),"wrong argument type "+n.$class()+" (expected Module)"),n.$append_features(t),n.$included(t)}return t},$Module_include$35.$$arity=-1),Opal.def(self,"$included_modules",$Module_included_modules$36=function(){var e=this;return Opal.included_modules(e)},$Module_included_modules$36.$$arity=0),Opal.def(self,"$include?",$Module_include$ques$37=function(e){var t=this;e.$$is_module||t.$raise($$($nesting,"TypeError"),"wrong argument type "+e.$class()+" (expected Module)");var r,n,a,i=Opal.ancestors(t);for(r=0,n=i.length;r<n;r++)if((a=i[r])===e&&a!==t)return!0;return!1},$Module_include$ques$37.$$arity=1),Opal.def(self,"$instance_method",$Module_instance_method$38=function(e){var t=this,r=t.$$prototype["$"+e];return r&&!r.$$stub||t.$raise($$($nesting,"NameError").$new("undefined method `"+e+"' for class `"+t.$name()+"'",e)),$$($nesting,"UnboundMethod").$new(t,r.$$owner||t,r,e)},$Module_instance_method$38.$$arity=1),Opal.def(self,"$instance_methods",$Module_instance_methods$39=function(e){var t=this;return null==e&&(e=!0),$truthy(e)?Opal.instance_methods(t):Opal.own_instance_methods(t)},$Module_instance_methods$39.$$arity=-1),Opal.def(self,"$included",$Module_included$40=function(){return nil},$Module_included$40.$$arity=1),Opal.def(self,"$extended",$Module_extended$41=function(){return nil},$Module_extended$41.$$arity=1),Opal.def(self,"$extend_object",$Module_extend_object$42=function(){return nil},$Module_extend_object$42.$$arity=1),Opal.def(self,"$method_added",$Module_method_added$43=function(){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_added$43.$$arity=-1),Opal.def(self,"$method_removed",$Module_method_removed$44=function(){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_removed$44.$$arity=-1),Opal.def(self,"$method_undefined",$Module_method_undefined$45=function(){return Opal.slice.call(arguments,0,arguments.length),nil},$Module_method_undefined$45.$$arity=-1),Opal.def(self,"$module_eval",$Module_module_eval$46=function $$module_eval($a){var $iter=$Module_module_eval$46.$$p,block=$iter||nil,$post_args,args,$b,$$47,self=this,string=nil,file=nil,_lineno=nil,default_eval_options=nil,compiling_options=nil,compiled=nil;$iter&&($Module_module_eval$46.$$p=null),$iter&&($Module_module_eval$46.$$p=null),$post_args=Opal.slice.call(arguments,0,arguments.length),args=$post_args,$truthy($truthy($b=block["$nil?"]())?!!Opal.compile:$b)?($truthy($range(1,3,!1)["$cover?"](args.$size()))||$$($nesting,"Kernel").$raise($$($nesting,"ArgumentError"),"wrong number of arguments (0 for 1..3)"),$b=[].concat(Opal.to_a(args)),string=null==$b[0]?nil:$b[0],file=null==$b[1]?nil:$b[1],_lineno=null==$b[2]?nil:$b[2],default_eval_options=$hash2(["file","eval"],{file:$truthy($b=file)?$b:"(eval)",eval:!0}),compiling_options=Opal.hash({arity_check:!1}).$merge(default_eval_options),compiled=$$($nesting,"Opal").$compile(string,compiling_options),block=$send($$($nesting,"Kernel"),"proc",[],($$47=function(){var self=$$47.$$s||this;return function(self){return eval(compiled)}(self)},$$47.$$s=self,$$47.$$arity=0,$$47))):$truthy(args["$any?"]())&&$$($nesting,"Kernel").$raise($$($nesting,"ArgumentError"),"wrong number of arguments ("+args.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var old=block.$$s,result;return block.$$s=null,result=block.apply(self,[self]),block.$$s=old,result},$Module_module_eval$46.$$arity=-1),Opal.alias(self,"class_eval","module_eval"),Opal.def(self,"$module_exec",$Module_module_exec$48=function(){var e,t=$Module_module_exec$48.$$p,r=t||nil,n=this;t&&($Module_module_exec$48.$$p=null),t&&($Module_module_exec$48.$$p=null),e=Opal.slice.call(arguments,0,arguments.length),r===nil&&n.$raise($$($nesting,"LocalJumpError"),"no block given");var a,i=r.$$s;return r.$$s=null,a=r.apply(n,e),r.$$s=i,a},$Module_module_exec$48.$$arity=-1),Opal.alias(self,"class_exec","module_exec"),Opal.def(self,"$method_defined?",$Module_method_defined$ques$49=function(e){var t=this.$$prototype["$"+e];return!!t&&!t.$$stub},$Module_method_defined$ques$49.$$arity=1),Opal.def(self,"$module_function",$Module_module_function$50=function(){var e,t=this;if(0===(e=Opal.slice.call(arguments,0,arguments.length)).length)t.$$module_function=!0;else for(var r=0,n=e.length;r<n;r++){var a="$"+e[r],i=t.$$prototype[a];Opal.defs(t,a,i)}return t},$Module_module_function$50.$$arity=-1),Opal.def(self,"$name",$Module_name$51=function(){var e=this;if(e.$$full_name)return e.$$full_name;for(var t=[],r=e;r;){if(r.$$name===nil||null==r.$$name)return nil;if(t.unshift(r.$$name),(r=r.$$base_module)===Opal.Object)break}return 0===t.length?nil:e.$$full_name=t.join("::")},$Module_name$51.$$arity=0),Opal.def(self,"$prepend",$Module_prepend$52=function(){var e,t=this;0===(e=Opal.slice.call(arguments,0,arguments.length)).length&&t.$raise($$($nesting,"ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var r=e.length-1;r>=0;r--){var n=e[r];n.$$is_module||t.$raise($$($nesting,"TypeError"),"wrong argument type "+n.$class()+" (expected Module)"),n.$prepend_features(t),n.$prepended(t)}return t},$Module_prepend$52.$$arity=-1),Opal.def(self,"$prepend_features",$Module_prepend_features$53=function(e){var t=this;return t.$$is_module||t.$raise($$($nesting,"TypeError"),"wrong argument type "+t.$class()+" (expected Module)"),Opal.prepend_features(t,e),t},$Module_prepend_features$53.$$arity=1),Opal.def(self,"$prepended",$Module_prepended$54=function(){return nil},$Module_prepended$54.$$arity=1),Opal.def(self,"$remove_const",$Module_remove_const$55=function(e){var t=this;return Opal.const_remove(t,e)},$Module_remove_const$55.$$arity=1),Opal.def(self,"$to_s",$Module_to_s$56=function(){var e,t=this;return $truthy(e=Opal.Module.$name.call(t))?e:"#<"+(t.$$is_module?"Module":"Class")+":0x"+t.$__id__().$to_s(16)+">"},$Module_to_s$56.$$arity=0),Opal.def(self,"$undef_method",$Module_undef_method$57=function(){for(var e,t=this,r=0,n=(e=Opal.slice.call(arguments,0,arguments.length)).length;r<n;r++)Opal.udef(t,"$"+e[r]);return t},$Module_undef_method$57.$$arity=-1),Opal.def(self,"$instance_variables",$Module_instance_variables$58=function(){var e=this,t=nil;Opal.Module.$$nesting=$nesting,t=e.$constants();var r=[];for(var n in e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&"constructor"!==n&&!t["$include?"](n)&&r.push("@"+n);return r},$Module_instance_variables$58.$$arity=0),Opal.def(self,"$dup",$Module_dup$59=function(){var e=$Module_dup$59.$$p,t=this,r=nil,n=nil,a=nil,i=nil;for(e&&($Module_dup$59.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return(r=$send(t,Opal.find_super_dispatcher(t,"dup",$Module_dup$59,!1),n,e)).$copy_class_variables(t),r.$copy_constants(t),r},$Module_dup$59.$$arity=0),Opal.def(self,"$copy_class_variables",$Module_copy_class_variables$60=function(e){var t=this;for(var r in e.$$cvars)t.$$cvars[r]=e.$$cvars[r]},$Module_copy_class_variables$60.$$arity=1),Opal.def(self,"$copy_constants",$Module_copy_constants$61=function(e){var t,r=this,n=e.$$const;for(t in n)Opal.const_set(r,t,n[t])},$Module_copy_constants$61.$$arity=1),nil&&"copy_constants"}($nesting[0],null,$nesting)},Opal.modules["corelib/class"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.klass),$=e.send;return e.add_stubs(["$require","$class_eval","$to_proc","$initialize_copy","$allocate","$name","$to_s"]),t.$require("corelib/module"),function(t,$super,r){var o,s,l,u,c,p,d,_=i(t,null,"Class"),f=[_].concat(r);return e.defs(_,"$new",o=function(t){var r=o.$$p,i=r||n;if(r&&(o.$$p=null),r&&(o.$$p=null),null==t&&(t=a(f,"Object")),!t.$$is_class)throw e.TypeError.$new("superclass must be a Class");var s=e.allocate_class(n,t);return t.$inherited(s),i!==n&&$(s,"class_eval",[],i.$to_proc()),s},o.$$arity=-1),e.def(_,"$allocate",s=function(){var t=new this.$$constructor;return t.$$id=e.uid(),t},s.$$arity=0),e.def(_,"$inherited",l=function(){return n},l.$$arity=1),e.def(_,"$initialize_dup",u=function(e){var t=this;t.$initialize_copy(e),t.$$name=null,t.$$full_name=null},u.$$arity=1),e.def(_,"$new",c=function(){var t,r=c.$$p,a=r||n,i=this;r&&(c.$$p=null),r&&(c.$$p=null),t=e.slice.call(arguments,0,arguments.length);var $=i.$allocate();return e.send($,$.$initialize,t,a),$},c.$$arity=-1),e.def(_,"$superclass",p=function(){return this.$$super||n},p.$$arity=0),e.def(_,"$to_s",d=function(){var t=d.$$p,r=this;t&&(d.$$p=null);var n=r.$$singleton_of;return n&&n.$$is_a_module?"#<Class:"+n.$name()+">":n?"#<Class:#<"+n.$$class.$name()+":0x"+e.id(n).$to_s(16)+">>":$(r,e.find_super_dispatcher(r,"to_s",d,!1),[],null)},d.$$arity=0),n&&"to_s"}(r[0],0,r)},Opal.modules["corelib/basic_object"]=function(Opal){var self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$breaker=Opal.breaker,$slice=Opal.slice,$klass=Opal.klass,$truthy=Opal.truthy,$range=Opal.range,$hash2=Opal.hash2,$send=Opal.send;return Opal.add_stubs(["$==","$!","$nil?","$cover?","$size","$raise","$merge","$compile","$proc","$any?","$inspect","$new"]),function($base,$super,$parent_nesting){var self=$klass($base,$super,"BasicObject"),$nesting=[self].concat($parent_nesting),$BasicObject_initialize$1,$BasicObject_$eq_eq$2,$BasicObject_eql$ques$3,$BasicObject___id__$4,$BasicObject___send__$5,$BasicObject_$excl$6,$BasicObject_$not_eq$7,$BasicObject_instance_eval$8,$BasicObject_instance_exec$10,$BasicObject_singleton_method_added$11,$BasicObject_singleton_method_removed$12,$BasicObject_singleton_method_undefined$13,$BasicObject_class$14,$BasicObject_method_missing$15;return Opal.def(self,"$initialize",$BasicObject_initialize$1=function(){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_initialize$1.$$arity=-1),Opal.def(self,"$==",$BasicObject_$eq_eq$2=function(e){return this===e},$BasicObject_$eq_eq$2.$$arity=1),Opal.def(self,"$eql?",$BasicObject_eql$ques$3=function(e){return this["$=="](e)},$BasicObject_eql$ques$3.$$arity=1),Opal.alias(self,"equal?","=="),Opal.def(self,"$__id__",$BasicObject___id__$4=function(){var e=this;return null!=e.$$id?e.$$id:(Opal.defineProperty(e,"$$id",Opal.uid()),e.$$id)},$BasicObject___id__$4.$$arity=0),Opal.def(self,"$__send__",$BasicObject___send__$5=function(e){var t,r=$BasicObject___send__$5.$$p,n=r||nil,a=this;r&&($BasicObject___send__$5.$$p=null),r&&($BasicObject___send__$5.$$p=null),t=Opal.slice.call(arguments,1,arguments.length);var i=a["$"+e];return i?(n!==nil&&(i.$$p=n),i.apply(a,t)):(n!==nil&&(a.$method_missing.$$p=n),a.$method_missing.apply(a,[e].concat(t)))},$BasicObject___send__$5.$$arity=-2),Opal.def(self,"$!",$BasicObject_$excl$6=function(){return!1},$BasicObject_$excl$6.$$arity=0),Opal.def(self,"$!=",$BasicObject_$not_eq$7=function(e){return this["$=="](e)["$!"]()},$BasicObject_$not_eq$7.$$arity=1),Opal.def(self,"$instance_eval",$BasicObject_instance_eval$8=function $$instance_eval($a){var $iter=$BasicObject_instance_eval$8.$$p,block=$iter||nil,$post_args,args,$b,$$9,self=this,string=nil,file=nil,_lineno=nil,default_eval_options=nil,compiling_options=nil,compiled=nil;$iter&&($BasicObject_instance_eval$8.$$p=null),$iter&&($BasicObject_instance_eval$8.$$p=null),$post_args=Opal.slice.call(arguments,0,arguments.length),args=$post_args,$truthy($truthy($b=block["$nil?"]())?!!Opal.compile:$b)?($truthy($range(1,3,!1)["$cover?"](args.$size()))||$$$("::","Kernel").$raise($$$("::","ArgumentError"),"wrong number of arguments (0 for 1..3)"),$b=[].concat(Opal.to_a(args)),string=null==$b[0]?nil:$b[0],file=null==$b[1]?nil:$b[1],_lineno=null==$b[2]?nil:$b[2],default_eval_options=$hash2(["file","eval"],{file:$truthy($b=file)?$b:"(eval)",eval:!0}),compiling_options=Opal.hash({arity_check:!1}).$merge(default_eval_options),compiled=$$$("::","Opal").$compile(string,compiling_options),block=$send($$$("::","Kernel"),"proc",[],($$9=function(){var self=$$9.$$s||this;return function(self){return eval(compiled)}(self)},$$9.$$s=self,$$9.$$arity=0,$$9))):$truthy(args["$any?"]())&&$$$("::","Kernel").$raise($$$("::","ArgumentError"),"wrong number of arguments ("+args.$size()+" for 0)");var old=block.$$s,result;if(block.$$s=null,self.$$is_a_module){self.$$eval=!0;try{result=block.call(self,self)}finally{self.$$eval=!1}}else result=block.call(self,self);return block.$$s=old,result},$BasicObject_instance_eval$8.$$arity=-1),Opal.def(self,"$instance_exec",$BasicObject_instance_exec$10=function(){var e,t=$BasicObject_instance_exec$10.$$p,r=t||nil,n=this;t&&($BasicObject_instance_exec$10.$$p=null),t&&($BasicObject_instance_exec$10.$$p=null),e=Opal.slice.call(arguments,0,arguments.length),$truthy(r)||$$$("::","Kernel").$raise($$$("::","ArgumentError"),"no block given");var a,i=r.$$s;if(r.$$s=null,n.$$is_a_module){n.$$eval=!0;try{a=r.apply(n,e)}finally{n.$$eval=!1}}else a=r.apply(n,e);return r.$$s=i,a},$BasicObject_instance_exec$10.$$arity=-1),Opal.def(self,"$singleton_method_added",$BasicObject_singleton_method_added$11=function(){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_added$11.$$arity=-1),Opal.def(self,"$singleton_method_removed",$BasicObject_singleton_method_removed$12=function(){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_removed$12.$$arity=-1),Opal.def(self,"$singleton_method_undefined",$BasicObject_singleton_method_undefined$13=function(){return Opal.slice.call(arguments,0,arguments.length),nil},$BasicObject_singleton_method_undefined$13.$$arity=-1),Opal.def(self,"$class",$BasicObject_class$14=function(){return this.$$class},$BasicObject_class$14.$$arity=0),Opal.def(self,"$method_missing",$BasicObject_method_missing$15=function(e){var t=$BasicObject_method_missing$15.$$p,r=this,n=nil;return t&&($BasicObject_method_missing$15.$$p=null),t&&($BasicObject_method_missing$15.$$p=null),Opal.slice.call(arguments,1,arguments.length),n=$truthy(r.$inspect&&!r.$inspect.$$stub)?"undefined method `"+e+"' for "+r.$inspect()+":"+r.$$class:"undefined method `"+e+"' for "+r.$$class,$$$("::","Kernel").$raise($$$("::","NoMethodError").$new(n,e))},$BasicObject_method_missing$15.$$arity=-2),nil&&"method_missing"}($nesting[0],null,$nesting)},Opal.modules["corelib/kernel"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.truthy,s=e.gvars,l=e.hash2,u=e.send,c=e.klass;return e.add_stubs(["$raise","$new","$inspect","$!","$=~","$==","$object_id","$class","$coerce_to?","$<<","$allocate","$copy_instance_variables","$copy_singleton_methods","$initialize_clone","$initialize_copy","$define_method","$singleton_class","$to_proc","$initialize_dup","$for","$empty?","$pop","$call","$coerce_to","$append_features","$extend_object","$extended","$__id__","$to_s","$instance_variable_name!","$respond_to?","$to_int","$coerce_to!","$Integer","$nil?","$===","$enum_for","$result","$any?","$print","$format","$puts","$each","$<=","$length","$[]","$exception","$is_a?","$rand","$respond_to_missing?","$try_convert!","$expand_path","$join","$start_with?","$new_seed","$srand","$sym","$arg","$open","$include"]),function(r,c){var p,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q,ee,te,re,ne,ae,ie,$e,oe,se,le,ue,ce,pe,de,_e,fe,he,ye,me,ge,be,ve,we,ke=$(r,"Kernel"),xe=[ke].concat(c);e.def(ke,"$method_missing",p=function(t){var r,n=p.$$p,a=this;return n&&(p.$$p=null),n&&(p.$$p=null),r=e.slice.call(arguments,1,arguments.length),a.$raise(i(xe,"NoMethodError").$new("undefined method `"+t+"' for "+a.$inspect(),t,r))},p.$$arity=-2),e.def(ke,"$=~",d=function(){return!1},d.$$arity=1),e.def(ke,"$!~",_=function(e){return this["$=~"](e)["$!"]()},_.$$arity=1),e.def(ke,"$===",f=function(e){var t,r=this;return o(t=r.$object_id()["$=="](e.$object_id()))?t:r["$=="](e)},f.$$arity=1),e.def(ke,"$<=>",h=function(e){var t=this;t.$$comparable=!0;var r=t["$=="](e);return r&&r!==n?0:n},h.$$arity=1),e.def(ke,"$method",y=function(e){var t=this,r=t["$"+e];return r&&!r.$$stub||t.$raise(i(xe,"NameError").$new("undefined method `"+e+"' for class `"+t.$class()+"'",e)),i(xe,"Method").$new(t,r.$$owner||t.$class(),r,e)},y.$$arity=1),e.def(ke,"$methods",m=function(t){var r=this;return null==t&&(t=!0),o(t)?e.methods(r):e.own_methods(r)},m.$$arity=-1),e.def(ke,"$public_methods",g=function(t){var r=this;return null==t&&(t=!0),o(t)?e.methods(r):e.receiver_methods(r)},g.$$arity=-1),e.def(ke,"$Array",b=function(e){var t;return e===n?[]:e.$$is_array?e:(t=i(xe,"Opal")["$coerce_to?"](e,i(xe,"Array"),"to_ary"))!==n?t:(t=i(xe,"Opal")["$coerce_to?"](e,i(xe,"Array"),"to_a"))!==n?t:[e]},b.$$arity=1),e.def(ke,"$at_exit",v=function(){var e,t=v.$$p,r=t||n;return null==s.__at_exit__&&(s.__at_exit__=n),t&&(v.$$p=null),t&&(v.$$p=null),s.__at_exit__=o(e=s.__at_exit__)?e:[],s.__at_exit__["$<<"](r)},v.$$arity=0),e.def(ke,"$caller",w=function(){return e.slice.call(arguments,0,arguments.length),[]},w.$$arity=-1),e.def(ke,"$class",k=function(){return this.$$class},k.$$arity=0),e.def(ke,"$copy_instance_variables",x=function(e){var t,r,n,a=this,i=Object.keys(e);for(t=0,r=i.length;t<r;t++)"$"!==(n=i[t]).charAt(0)&&e.hasOwnProperty(n)&&(a[n]=e[n])},x.$$arity=1),e.def(ke,"$copy_singleton_methods",E=function(t){var r,n,a,i,$=this;if(t.hasOwnProperty("$$meta")){var o=e.get_singleton_class(t),s=e.get_singleton_class($);for(r=0,i=(a=Object.getOwnPropertyNames(o.$$prototype)).length;r<i;r++)n=a[r],e.is_method(n)&&(s.$$prototype[n]=o.$$prototype[n]);s.$$const=Object.assign({},o.$$const),Object.setPrototypeOf(s.$$prototype,Object.getPrototypeOf(o.$$prototype))}for(r=0,i=(a=Object.getOwnPropertyNames(t)).length;r<i;r++)"$"===(n=a[r]).charAt(0)&&"$"!==n.charAt(1)&&t.hasOwnProperty(n)&&($[n]=t[n])},E.$$arity=1),e.def(ke,"$clone",O=function(t){var r=this,a=n;if(null==t)t=l([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==t.$$smap.freeze&&!0,(a=r.$class().$allocate()).$copy_instance_variables(r),a.$copy_singleton_methods(r),a.$initialize_clone(r),a},O.$$arity=-1),e.def(ke,"$initialize_clone",A=function(e){return this.$initialize_copy(e)},A.$$arity=1),e.def(ke,"$define_singleton_method",T=function(e,t){var r=T.$$p,a=r||n,i=this;return r&&(T.$$p=null),r&&(T.$$p=null),u(i.$singleton_class(),"define_method",[e,t],a.$to_proc())},T.$$arity=-2),e.def(ke,"$dup",S=function(){var e=this,t=n;return(t=e.$class().$allocate()).$copy_instance_variables(e),t.$initialize_dup(e),t},S.$$arity=0),e.def(ke,"$initialize_dup",I=function(e){return this.$initialize_copy(e)},I.$$arity=1),e.def(ke,"$enum_for",R=function(){var t,r,a,$=R.$$p,o=$||n,s=this;return $&&(R.$$p=null),$&&(R.$$p=null),(t=e.slice.call(arguments,0,arguments.length)).length>0&&(r=t[0],t.splice(0,1)),null==r&&(r="each"),a=t,u(i(xe,"Enumerator"),"for",[s,r].concat(e.to_a(a)),o.$to_proc())},R.$$arity=-1),e.alias(ke,"to_enum","enum_for"),e.def(ke,"$equal?",C=function(e){return this===e},C.$$arity=1),e.def(ke,"$exit",q=function(t){var r;for(null==s.__at_exit__&&(s.__at_exit__=n),null==t&&(t=!0),s.__at_exit__=o(r=s.__at_exit__)?r:[];!o(s.__at_exit__["$empty?"]());)s.__at_exit__.$pop().$call();return t=t.$$is_boolean?t?0:1:i(xe,"Opal").$coerce_to(t,i(xe,"Integer"),"to_int"),e.exit(t),n},q.$$arity=-1),e.def(ke,"$extend",M=function(){var t,r=this;t=e.slice.call(arguments,0,arguments.length);for(var n=r.$singleton_class(),a=t.length-1;a>=0;a--){var $=t[a];$.$$is_module||r.$raise(i(xe,"TypeError"),"wrong argument type "+$.$class()+" (expected Module)"),$.$append_features(n),$.$extend_object(r),$.$extended(r)}return r},M.$$arity=-1),e.def(ke,"$hash",z=function(){return this.$__id__()},z.$$arity=0),e.def(ke,"$initialize_copy",N=function(){return n},N.$$arity=1),e.def(ke,"$inspect",j=function(){return this.$to_s()},j.$$arity=0),e.def(ke,"$instance_of?",P=function(e){var t=this;return e.$$is_class||e.$$is_module||t.$raise(i(xe,"TypeError"),"class or module required"),t.$$class===e},P.$$arity=1),e.def(ke,"$instance_variable_defined?",B=function(t){var r=this;return t=i(xe,"Opal")["$instance_variable_name!"](t),e.hasOwnProperty.call(r,t.substr(1))},B.$$arity=1),e.def(ke,"$instance_variable_get",L=function(t){var r=this;t=i(xe,"Opal")["$instance_variable_name!"](t);var a=r[e.ivar(t.substr(1))];return null==a?n:a},L.$$arity=1),e.def(ke,"$instance_variable_set",D=function(t,r){var n=this;return t=i(xe,"Opal")["$instance_variable_name!"](t),n[e.ivar(t.substr(1))]=r},D.$$arity=2),e.def(ke,"$remove_instance_variable",G=function(t){var r=this;t=i(xe,"Opal")["$instance_variable_name!"](t);var n,a=e.ivar(t.substr(1));return r.hasOwnProperty(a)?(n=r[a],delete r[a],n):r.$raise(i(xe,"NameError"),"instance variable "+t+" not defined")},G.$$arity=1),e.def(ke,"$instance_variables",H=function(){var e,t=this,r=[];for(var n in t)t.hasOwnProperty(n)&&"$"!==n.charAt(0)&&(e="$"===n.substr(-1)?n.slice(0,n.length-1):n,r.push("@"+e));return r},H.$$arity=0),e.def(ke,"$Integer",F=function(e,t){var r,a,$,o=this;return e.$$is_string?"0"===e?0:(t===undefined?t=0:(1===(t=i(xe,"Opal").$coerce_to(t,i(xe,"Integer"),"to_int"))||t<0||t>36)&&o.$raise(i(xe,"ArgumentError"),"invalid radix "+t),a=(a=(a=e.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function(r,n,a){switch(a){case"0b":if(0===t||2===t)return t=2,n;case"0":case"0o":if(0===t||8===t)return t=8,n;case"0d":if(0===t||10===t)return t=10,n;case"0x":if(0===t||16===t)return t=16,n}o.$raise(i(xe,"ArgumentError"),'invalid value for Integer(): "'+e+'"')}),$="0-"+((t=0===t?10:t)<=10?t-1:"9a-"+String.fromCharCode(t-11+97)),new RegExp("^\\s*[+-]?["+$+"]+\\s*$").test(a)||o.$raise(i(xe,"ArgumentError"),'invalid value for Integer(): "'+e+'"'),r=parseInt(a,t),isNaN(r)&&o.$raise(i(xe,"ArgumentError"),'invalid value for Integer(): "'+e+'"'),r):(t!==undefined&&o.$raise(i(xe,"ArgumentError"),"base specified for non string value"),e===n&&o.$raise(i(xe,"TypeError"),"can't convert nil into Integer"),e.$$is_number?((e===Infinity||e===-Infinity||isNaN(e))&&o.$raise(i(xe,"FloatDomainError"),e),Math.floor(e)):e["$respond_to?"]("to_int")&&(r=e.$to_int())!==n?r:i(xe,"Opal")["$coerce_to!"](e,i(xe,"Integer"),"to_i"))},F.$$arity=-2),e.def(ke,"$Float",U=function(e){var t,r=this;return e===n&&r.$raise(i(xe,"TypeError"),"can't convert nil into Float"),e.$$is_string?(t=(t=e.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(t)?r.$Integer(t):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(t)||r.$raise(i(xe,"ArgumentError"),'invalid value for Float(): "'+e+'"'),parseFloat(t))):i(xe,"Opal")["$coerce_to!"](e,i(xe,"Float"),"to_f")},U.$$arity=1),e.def(ke,"$Hash",K=function(e){var t;return o(o(t=e["$nil?"]())?t:e["$=="]([]))?l([],{}):o(i(xe,"Hash")["$==="](e))?e:i(xe,"Opal")["$coerce_to!"](e,i(xe,"Hash"),"to_hash")},K.$$arity=1),e.def(ke,"$is_a?",Y=function(t){var r=this;return t.$$is_class||t.$$is_module||r.$raise(i(xe,"TypeError"),"class or module required"),e.is_a(r,t)},Y.$$arity=1),e.def(ke,"$itself",V=function(){return this},V.$$arity=0),e.alias(ke,"kind_of?","is_a?"),e.def(ke,"$lambda",W=function(){var t=W.$$p,r=t||n;return t&&(W.$$p=null),t&&(W.$$p=null),e.lambda(r)},W.$$arity=0),e.def(ke,"$load",J=function(t){return t=i(xe,"Opal")["$coerce_to!"](t,i(xe,"String"),"to_str"),e.load(t)},J.$$arity=1),e.def(ke,"$loop",X=function(){var t,r=X.$$p,$=r||n,s=this,l=n;if(r&&(X.$$p=null),$===n)return u(s,"enum_for",["loop"],((t=function(){t.$$s;return a(i(xe,"Float"),"INFINITY")}).$$s=s,t.$$arity=0,t));for(;o(!0);)try{e.yieldX($,[])}catch(c){if(!e.rescue(c,[i(xe,"StopIteration")]))throw c;l=c;try{return l.$result()}finally{e.pop_exception()}}return s},X.$$arity=0),e.def(ke,"$nil?",Z=function(){return!1},Z.$$arity=0),e.alias(ke,"object_id","__id__"),e.def(ke,"$printf",Q=function(){var t,r,a=this;return t=e.slice.call(arguments,0,arguments.length),o((r=t)["$any?"]())&&a.$print(u(a,"format",e.to_a(r))),n},Q.$$arity=-1),e.def(ke,"$proc",ee=function(){var e=ee.$$p,t=e||n,r=this;return e&&(ee.$$p=null),e&&(ee.$$p=null),o(t)||r.$raise(i(xe,"ArgumentError"),"tried to create Proc object without a block"),t.$$is_lambda=!1,t},ee.$$arity=0),e.def(ke,"$puts",te=function(){var t;return null==s.stdout&&(s.stdout=n),t=e.slice.call(arguments,0,arguments.length),u(s.stdout,"puts",e.to_a(t))},te.$$arity=-1),e.def(ke,"$p",re=function(){var r,a,i,$=this;return r=e.slice.call(arguments,0,arguments.length),u(a=r,"each",[],((i=function(e){i.$$s;return null==s.stdout&&(s.stdout=n),null==e&&(e=n),s.stdout.$puts(e.$inspect())}).$$s=$,i.$$arity=1,i)),o(t(a.$length(),1))?a["$[]"](0):a},re.$$arity=-1),e.def(ke,"$print",ne=function(){var t;return null==s.stdout&&(s.stdout=n),t=e.slice.call(arguments,0,arguments.length),u(s.stdout,"print",e.to_a(t))},ne.$$arity=-1),e.def(ke,"$warn",ae=function(){var t,r;return null==s.VERBOSE&&(s.VERBOSE=n),null==s.stderr&&(s.stderr=n),t=e.slice.call(arguments,0,arguments.length),o(o(r=s.VERBOSE["$nil?"]())?r:t["$empty?"]())?n:u(s.stderr,"puts",e.to_a(t))},ae.$$arity=-1),e.def(ke,"$raise",ie=function(t,r,a){if(null==s["!"]&&(s["!"]=n),null==r&&(r=n),null==a&&(a=n),null==t&&s["!"]!==n)throw s["!"];throw null==t?t=i(xe,"RuntimeError").$new():t.$$is_string?t=i(xe,"RuntimeError").$new(t):t.$$is_class&&t["$respond_to?"]("exception")?t=t.$exception(r):t["$is_a?"](i(xe,"Exception"))||(t=i(xe,"TypeError").$new("exception class/object expected")),s["!"]!==n&&e.exceptions.push(s["!"]),s["!"]=t,t},ie.$$arity=-1),e.alias(ke,"fail","raise"),e.def(ke,"$rand",$e=function(e){return e===undefined?a(i(xe,"Random"),"DEFAULT").$rand():(e.$$is_number&&(e<0&&(e=Math.abs(e)),e%1!=0&&(e=e.$to_i()),0===e&&(e=undefined)),a(i(xe,"Random"),"DEFAULT").$rand(e))},$e.$$arity=-1),e.def(ke,"$respond_to?",oe=function(e,t){var r=this;if(null==t&&(t=!1),o(r["$respond_to_missing?"](e,t)))return!0;var n=r["$"+e];return"function"==typeof n&&!n.$$stub},oe.$$arity=-2),e.def(ke,"$respond_to_missing?",se=function(e,t){return null==t&&(t=!1),!1},se.$$arity=-2),e.def(ke,"$require",le=function(t){return t=i(xe,"Opal")["$coerce_to!"](t,i(xe,"String"),"to_str"),e.require(t)},le.$$arity=1),e.def(ke,"$require_relative",ue=function(t){return i(xe,"Opal")["$try_convert!"](t,i(xe,"String"),"to_str"),t=i(xe,"File").$expand_path(i(xe,"File").$join(e.current_file,"..",t)),e.require(t)},ue.$$arity=1),e.def(ke,"$require_tree",ce=function(t){var r=[];for(var n in t=i(xe,"File").$expand_path(t),"."===(t=e.normalize(t))&&(t=""),e.modules)n["$start_with?"](t)&&r.push([n,e.require(n)]);return r},ce.$$arity=1),e.alias(ke,"send","__send__"),e.alias(ke,"public_send","__send__"),e.def(ke,"$singleton_class",pe=function(){var t=this;return e.get_singleton_class(t)},pe.$$arity=0),e.def(ke,"$sleep",de=function(t){var r=this;null==t&&(t=n),t===n&&r.$raise(i(xe,"TypeError"),"can't convert NilClass into time interval"),t.$$is_number||r.$raise(i(xe,"TypeError"),"can't convert "+t.$class()+" into time interval"),t<0&&r.$raise(i(xe,"ArgumentError"),"time interval must be positive");for(var a=e.global.performance?function(){return performance.now()}:function(){return new Date},$=a();a()-$<=1e3*t;);return t},de.$$arity=-1),e.def(ke,"$srand",_e=function(e){return null==e&&(e=i(xe,"Random").$new_seed()),i(xe,"Random").$srand(e)},_e.$$arity=-1),e.def(ke,"$String",fe=function(e){var t;return o(t=i(xe,"Opal")["$coerce_to?"](e,i(xe,"String"),"to_str"))?t:i(xe,"Opal")["$coerce_to!"](e,i(xe,"String"),"to_s")},fe.$$arity=1),e.def(ke,"$tap",he=function(){var t=he.$$p,r=t||n,a=this;return t&&(he.$$p=null),t&&(he.$$p=null),e.yield1(r,a),a},he.$$arity=0),e.def(ke,"$to_proc",ye=function(){return this},ye.$$arity=0),e.def(ke,"$to_s",me=function(){var e=this;return"#<"+e.$class()+":0x"+e.$__id__().$to_s(16)+">"},me.$$arity=0),e.def(ke,"$catch",ge=function(t){var r=ge.$$p,a=r||n,$=this,o=n;r&&(ge.$$p=null);try{return e.yieldX(a,[])}catch(s){if(!e.rescue(s,[i(xe,"UncaughtThrowError")]))throw s;o=s;try{return o.$sym()["$=="](t)?o.$arg():$.$raise()}finally{e.pop_exception()}}},ge.$$arity=1),e.def(ke,"$throw",be=function(){var t,r=this;return t=e.slice.call(arguments,0,arguments.length),r.$raise(i(xe,"UncaughtThrowError"),t)},be.$$arity=-1),e.def(ke,"$open",ve=function(){var t,r=ve.$$p,a=r||n;return r&&(ve.$$p=null),r&&(ve.$$p=null),t=e.slice.call(arguments,0,arguments.length),
u(i(xe,"File"),"open",e.to_a(t),a.$to_proc())},ve.$$arity=-1),e.def(ke,"$yield_self",we=function(){var t,r=we.$$p,a=r||n,i=this;return r&&(we.$$p=null),a===n?u(i,"enum_for",["yield_self"],((t=function(){t.$$s;return 1}).$$s=i,t.$$arity=0,t)):e.yield1(a,i)},we.$$arity=0)}(r[0],r),function(e,$super,t){var r=c(e,null,"Object"),n=[r].concat(t);return r.$include(i(n,"Kernel"))}(r[0],0,r)},Opal.modules["corelib/error"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}e.top;var n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.klass),o=e.send,s=e.truthy,l=e.module,u=e.hash2;return e.add_stubs(["$new","$clone","$to_s","$empty?","$class","$raise","$+","$attr_reader","$[]","$>","$length","$inspect"]),function(t,$super,r){var n,l,u,c,p,d,_,f,h,y,m=$(t,$super,"Exception"),g=[m].concat(r);m.$$prototype.message=a,e.defs(m,"$new",n=function(){var t,r=this,n=(t=e.slice.call(arguments,0,arguments.length)).length>0?t[0]:a,i=new r.$$constructor(n);return i.name=r.$$name,i.message=n,e.send(i,i.$initialize,t),e.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(i,y),i},n.$$arity=-1),y=m.$new,e.defs(m,"$exception",l=function(){var t,r=this;return t=e.slice.call(arguments,0,arguments.length),o(r,"new",e.to_a(t))},l.$$arity=-1),e.def(m,"$initialize",u=function(){var t,r=this;return t=e.slice.call(arguments,0,arguments.length),r.message=t.length>0?t[0]:a},u.$$arity=-1),e.def(m,"$backtrace",c=function(){var e=this;if(e.backtrace)return e.backtrace;var t=e.stack;return"string"==typeof t?t.split("\n").slice(0,15):t?t.slice(0,15):[]},c.$$arity=0),e.def(m,"$exception",p=function(e){var t=this;if(null==e&&(e=a),e===a||t===e)return t;var r=t.$clone();return r.message=e,r.stack=t.stack,r},p.$$arity=-1),e.def(m,"$message",d=function(){return this.$to_s()},d.$$arity=0),e.def(m,"$inspect",_=function(){var e=this,t=a;return t=e.$to_s(),s(t["$empty?"]())?e.$class().$to_s():"#<"+e.$class().$to_s()+": "+e.$to_s()+">"},_.$$arity=0),e.def(m,"$set_backtrace",f=function(e){var t,r,n=this,$=!0;if(e===a)n.backtrace=a,n.stack="";else if(e.$$is_string)n.backtrace=[e],n.stack=e;else{if(e.$$is_array){for(t=0,r=e.length;t<r;t++)if(!e[t].$$is_string){$=!1;break}}else $=!1;!1===$&&n.$raise(i(g,"TypeError"),"backtrace must be Array of String"),n.backtrace=e,n.stack=e.join("\n")}return e},f.$$arity=1),e.def(m,"$to_s",h=function(){var e,t,r=this;return s(e=s(t=r.message)?r.message.$to_s():t)?e:r.$class().$to_s()},h.$$arity=0)}(n[0],Error,n),function(e,$super,t){[$(e,$super,"ScriptError")].concat(t)}(n[0],i(n,"Exception"),n),function(e,$super,t){[$(e,$super,"SyntaxError")].concat(t)}(n[0],i(n,"ScriptError"),n),function(e,$super,t){[$(e,$super,"LoadError")].concat(t)}(n[0],i(n,"ScriptError"),n),function(e,$super,t){[$(e,$super,"NotImplementedError")].concat(t)}(n[0],i(n,"ScriptError"),n),function(e,$super,t){[$(e,$super,"SystemExit")].concat(t)}(n[0],i(n,"Exception"),n),function(e,$super,t){[$(e,$super,"NoMemoryError")].concat(t)}(n[0],i(n,"Exception"),n),function(e,$super,t){[$(e,$super,"SignalException")].concat(t)}(n[0],i(n,"Exception"),n),function(e,$super,t){[$(e,$super,"Interrupt")].concat(t)}(n[0],i(n,"Exception"),n),function(e,$super,t){[$(e,$super,"SecurityError")].concat(t)}(n[0],i(n,"Exception"),n),function(e,$super,t){[$(e,$super,"StandardError")].concat(t)}(n[0],i(n,"Exception"),n),function(e,$super,t){[$(e,$super,"EncodingError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"ZeroDivisionError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"NameError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"NoMethodError")].concat(t)}(n[0],i(n,"NameError"),n),function(e,$super,t){[$(e,$super,"RuntimeError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"FrozenError")].concat(t)}(n[0],i(n,"RuntimeError"),n),function(e,$super,t){[$(e,$super,"LocalJumpError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"TypeError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"ArgumentError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"IndexError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"StopIteration")].concat(t)}(n[0],i(n,"IndexError"),n),function(e,$super,t){[$(e,$super,"KeyError")].concat(t)}(n[0],i(n,"IndexError"),n),function(e,$super,t){[$(e,$super,"RangeError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"FloatDomainError")].concat(t)}(n[0],i(n,"RangeError"),n),function(e,$super,t){[$(e,$super,"IOError")].concat(t)}(n[0],i(n,"StandardError"),n),function(e,$super,t){[$(e,$super,"SystemCallError")].concat(t)}(n[0],i(n,"StandardError"),n),function(r,n){var u=[l(r,"Errno")].concat(n);!function(r,$super,n){var i,l=$(r,$super,"EINVAL");[l].concat(n);e.defs(l,"$new",i=function(r){var n=i.$$p,$=this,l=a;return n&&(i.$$p=null),null==r&&(r=a),l="Invalid argument",s(r)&&(l=t(l," - "+r)),o($,e.find_super_dispatcher($,"new",i,!1,$.$$class.$$prototype),[l],null)},i.$$arity=-1)}(u[0],i(u,"SystemCallError"),u)}(n[0],n),function(t,$super,n){var i,l=$(t,$super,"UncaughtThrowError");[l].concat(n);l.$$prototype.sym=a,l.$attr_reader("sym","arg"),e.def(l,"$initialize",i=function(t){var n=i.$$p,a=this;return n&&(i.$$p=null),a.sym=t["$[]"](0),s(r(t.$length(),1))&&(a.arg=t["$[]"](1)),o(a,e.find_super_dispatcher(a,"initialize",i,!1),["uncaught throw "+a.sym.$inspect()],null)},i.$$arity=1)}(n[0],i(n,"ArgumentError"),n),function(t,$super,r){var n,i=$(t,null,"NameError");[i].concat(r);i.$attr_reader("name"),e.def(i,"$initialize",n=function(t,r){var i=n.$$p,$=this;return i&&(n.$$p=null),null==r&&(r=a),o($,e.find_super_dispatcher($,"initialize",n,!1),[t],null),$.name=r},n.$$arity=-2)}(n[0],0,n),function(t,$super,r){var n,i=$(t,null,"NoMethodError");[i].concat(r);i.$attr_reader("args"),e.def(i,"$initialize",n=function(t,r,i){var $=n.$$p,s=this;return $&&(n.$$p=null),null==r&&(r=a),null==i&&(i=[]),o(s,e.find_super_dispatcher(s,"initialize",n,!1),[t,r],null),s.args=i},n.$$arity=-2)}(n[0],0,n),function(e,$super,t){var r=$(e,null,"StopIteration");[r].concat(t);r.$attr_reader("result")}(n[0],0,n),function(t,$super,r){var n,l,c,p=$(t,null,"KeyError"),d=[p].concat(r);p.$$prototype.receiver=p.$$prototype.key=a,e.def(p,"$initialize",n=function(t,r){var i,$,s=n.$$p,l=this;if(s&&(n.$$p=null),null==r)r=u([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(i=r.$$smap.receiver)&&(i=a),null==($=r.$$smap.key)&&($=a),o(l,e.find_super_dispatcher(l,"initialize",n,!1),[t],null),l.receiver=i,l.key=$},n.$$arity=-2),e.def(p,"$receiver",l=function(){var e,t=this;return s(e=t.receiver)?e:t.$raise(i(d,"ArgumentError"),"no receiver is available")},l.$$arity=0),e.def(p,"$key",c=function(){var e,t=this;return s(e=t.key)?e:t.$raise(i(d,"ArgumentError"),"no key is available")},c.$$arity=0)}(n[0],0,n),function(e,t){var r=[l(e,"JS")].concat(t);!function(e,$super,t){[$(e,null,"Error")].concat(t)}(r[0],0,r)}(n[0],n)},Opal.modules["corelib/constants"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative);e.breaker,e.slice;return e.const_set(t[0],"RUBY_PLATFORM","opal"),e.const_set(t[0],"RUBY_ENGINE","opal"),e.const_set(t[0],"RUBY_VERSION","2.5.7"),e.const_set(t[0],"RUBY_ENGINE_VERSION","1.0.3"),e.const_set(t[0],"RUBY_RELEASE_DATE","2020-02-01"),e.const_set(t[0],"RUBY_PATCHLEVEL",0),e.const_set(t[0],"RUBY_REVISION",0),e.const_set(t[0],"RUBY_COPYRIGHT","opal - Copyright (C) 2013-2020 Adam Beynon and the Opal contributors"),e.const_set(t[0],"RUBY_DESCRIPTION","opal "+r(t,"RUBY_ENGINE_VERSION")+" ("+r(t,"RUBY_RELEASE_DATE")+" revision "+r(t,"RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(e){var t=e.top;e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice;return e.add_stubs(["$require"]),t.$require("corelib/runtime"),t.$require("corelib/helpers"),t.$require("corelib/module"),t.$require("corelib/class"),t.$require("corelib/basic_object"),t.$require("corelib/kernel"),t.$require("corelib/error"),t.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}e.top;var r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.klass),$=e.hash2,o=e.truthy;return e.add_stubs(["$raise","$name","$new","$>","$length","$Rational"]),function(r,$super,s){var l,u,c,p,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A=i(r,null,"NilClass"),T=[A].concat(s);A.$$prototype.$$meta=A,function(t,r){var n,i=[t].concat(r);e.def(t,"$allocate",n=function(){var e=this;return e.$raise(a(i,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),e.udef(t,"$new")}(e.get_singleton_class(A),T),e.def(A,"$!",l=function(){return!0},l.$$arity=0),e.def(A,"$&",u=function(){return!1},u.$$arity=1),e.def(A,"$|",c=function(e){return!1!==e&&e!==n},c.$$arity=1),e.def(A,"$^",p=function(e){return!1!==e&&e!==n},p.$$arity=1),e.def(A,"$==",d=function(e){return e===n},d.$$arity=1),e.def(A,"$dup",_=function(){return n},_.$$arity=0),e.def(A,"$clone",f=function(t){if(null==t)t=$([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==t.$$smap.freeze&&!0,n},f.$$arity=-1),e.def(A,"$inspect",h=function(){return"nil"},h.$$arity=0),e.def(A,"$nil?",y=function(){return!0},y.$$arity=0),e.def(A,"$singleton_class",m=function(){return a(T,"NilClass")},m.$$arity=0),e.def(A,"$to_a",g=function(){return[]},g.$$arity=0),e.def(A,"$to_h",b=function(){return e.hash()},b.$$arity=0),e.def(A,"$to_i",v=function(){return 0},v.$$arity=0),e.alias(A,"to_f","to_i"),e.def(A,"$to_s",w=function(){return""},w.$$arity=0),e.def(A,"$to_c",k=function(){return a(T,"Complex").$new(0,0)},k.$$arity=0),e.def(A,"$rationalize",x=function(){var r,n=this;return r=e.slice.call(arguments,0,arguments.length),o(t(r.$length(),1))&&n.$raise(a(T,"ArgumentError")),n.$Rational(0,1)},x.$$arity=-1),e.def(A,"$to_r",E=function(){return this.$Rational(0,1)},E.$$arity=0),e.def(A,"$instance_variables",O=function(){return[]},O.$$arity=0)}(r[0],0,r),e.const_set(r[0],"NIL",n)},Opal.modules["corelib/boolean"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.hash2;return e.add_stubs(["$raise","$name"]),function(t,$super,$){var o,s,l,u,c,p,d,_,f,h,y=a(t,$super,"Boolean"),m=[y].concat($);e.defineProperty(y.$$prototype,"$$is_boolean",!0),e.defineProperty(y.$$prototype,"$$meta",y),function(t,r){var a,i=[t].concat(r);e.def(t,"$allocate",a=function(){var e=this;return e.$raise(n(i,"TypeError"),"allocator undefined for "+e.$name())},a.$$arity=0),e.udef(t,"$new")}(e.get_singleton_class(y),m),e.def(y,"$__id__",o=function(){return this.valueOf()?2:0},o.$$arity=0),e.alias(y,"object_id","__id__"),e.def(y,"$!",s=function(){return 1!=this},s.$$arity=0),e.def(y,"$&",l=function(e){return 1==this&&(!1!==e&&e!==r)},l.$$arity=1),e.def(y,"$|",u=function(e){return 1==this||!1!==e&&e!==r},u.$$arity=1),e.def(y,"$^",c=function(e){return 1==this?!1===e||e===r:!1!==e&&e!==r},c.$$arity=1),e.def(y,"$==",p=function(e){return 1==this===e.valueOf()},p.$$arity=1),e.alias(y,"equal?","=="),e.alias(y,"eql?","=="),e.def(y,"$singleton_class",d=function(){return n(m,"Boolean")},d.$$arity=0),e.def(y,"$to_s",_=function(){return 1==this?"true":"false"},_.$$arity=0),e.def(y,"$dup",f=function(){return this},f.$$arity=0),e.def(y,"$clone",h=function(t){var r=this;if(null==t)t=i([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==t.$$smap.freeze&&!0,r},h.$$arity=-1)}(t[0],Boolean,t),e.const_set(t[0],"TrueClass",n(t,"Boolean")),e.const_set(t[0],"FalseClass",n(t,"Boolean")),e.const_set(t[0],"TRUE",!0),e.const_set(t[0],"FALSE",!1)},Opal.modules["corelib/comparable"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}e.top;var n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.truthy;return e.add_stubs(["$>","$<","$===","$raise","$class","$equal?","$<=>"]),function(n,s){function l(n){return e.is_a(n,e.Integer)?n:t(n,0)?1:r(n,0)?-1:0}function u(e,t){var r;b=t,r=a["$==="](b)||(!0)["$==="](b)||(!1)["$==="](b)||i(g,"Integer")["$==="](b)||i(g,"Float")["$==="](b)?t.$inspect():t.$$class,m.$raise(i(g,"ArgumentError"),"comparison of "+e.$class()+" with "+r+" failed")}var c,p,d,_,f,h,y,m=$(n,"Comparable"),g=[m].concat(s),b=a;e.def(m,"$==",c=function(t){var r=this,n=a;return!!o(r["$equal?"](t))||r["$<=>"]!=e.Kernel["$<=>"]&&(r.$$comparable?(delete r.$$comparable,!1):!!o(n=r["$<=>"](t))&&0==l(n))},c.$$arity=1),e.def(m,"$>",p=function(e){var t=this,r=a;return o(r=t["$<=>"](e))||u(t,e),l(r)>0},p.$$arity=1),e.def(m,"$>=",d=function(e){var t=this,r=a;return o(r=t["$<=>"](e))||u(t,e),l(r)>=0},d.$$arity=1),e.def(m,"$<",_=function(e){var t=this,r=a;return o(r=t["$<=>"](e))||u(t,e),l(r)<0},_.$$arity=1),e.def(m,"$<=",f=function(e){var t=this,r=a;return o(r=t["$<=>"](e))||u(t,e),l(r)<=0},f.$$arity=1),e.def(m,"$between?",h=function(e,n){var a=this;return!r(a,e)&&!t(a,n)},h.$$arity=2),e.def(m,"$clamp",y=function(e,t){var r=this,n=a;return n=e["$<=>"](t),o(n)||u(e,t),o(l(n)>0)&&r.$raise(i(g,"ArgumentError"),"min argument must be smaller than max argument"),o(l(r["$<=>"](e))<0)?e:o(l(r["$<=>"](t))>0)?t:r},y.$$arity=2)}(n[0],n)},Opal.modules["corelib/regexp"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.send,$=e.truthy,o=e.gvars;return e.add_stubs(["$nil?","$[]","$raise","$escape","$options","$to_str","$new","$join","$coerce_to!","$!","$match","$coerce_to?","$begin","$coerce_to","$=~","$attr_reader","$===","$inspect","$to_a"]),function(e,$super,t){[a(e,$super,"RegexpError")].concat(t)}(t[0],n(t,"StandardError"),t),function(t,$super,s){var l,u,c,p,d,_,f,h,y,m,g=a(t,$super,"Regexp"),b=[g].concat(s);e.const_set(b[0],"IGNORECASE",1),e.const_set(b[0],"EXTENDED",2),e.const_set(b[0],"MULTILINE",4),e.defineProperty(g.$$prototype,"$$is_regexp",!0),function(t,a){var s,l,u,c,p,d=[t].concat(a);e.def(t,"$allocate",s=function(){var t=s.$$p,n=this,a=r,$=r,o=r,l=r;for(t&&(s.$$p=null),o=0,l=arguments.length,$=new Array(l);o<l;o++)$[o]=arguments[o];return(a=i(n,e.find_super_dispatcher(n,"allocate",s,!1),$,t)).uninitialized=!0,a},s.$$arity=0),e.def(t,"$escape",l=function(t){return e.escape_regexp(t)},l.$$arity=1),e.def(t,"$last_match",u=function(e){return null==o["~"]&&(o["~"]=r),null==e&&(e=r),$(e["$nil?"]())?o["~"]:o["~"]["$[]"](e)},u.$$arity=-1),e.alias(t,"quote","escape"),e.def(t,"$union",c=function(){var t,r,a,i,$,o,s=this;if(0==(t=e.slice.call(arguments,0,arguments.length)).length)return/(?!)/;if(1==t.length&&t[0].$$is_regexp)return t[0];r=t[0].$$is_array,t.length>1&&r&&s.$raise(n(d,"TypeError"),"no implicit conversion of Array into String"),r&&(t=t[0]),$=undefined,a=[];for(var l=0;l<t.length;l++)(i=t[l]).$$is_string?a.push(s.$escape(i)):i.$$is_regexp?(o=i.$options(),$!=undefined&&$!=o&&s.$raise(n(d,"TypeError"),"All expressions must use the same options"),$=o,a.push("("+i.source+")")):a.push(s.$escape(i.$to_str()));return s.$new(a.$join("|"),$)},c.$$arity=-1),e.def(t,"$new",p=function(e,t){var r=this;if(e.$$is_regexp)return new RegExp(e);if("\\"===(e=n(d,"Opal")["$coerce_to!"](e,n(d,"String"),"to_str")).charAt(e.length-1)&&"\\"!==e.charAt(e.length-2)&&r.$raise(n(d,"RegexpError"),"too short escape sequence: /"+e+"/"),t===undefined||t["$!"]())return new RegExp(e);if(t.$$is_number){var a="";n(d,"IGNORECASE")&t&&(a+="i"),n(d,"MULTILINE")&t&&(a+="m"),t=a}else t="i";return new RegExp(e,t)},p.$$arity=-2)}(e.get_singleton_class(g),b),e.def(g,"$==",l=function(e){return e instanceof RegExp&&this.toString()===e.toString()},l.$$arity=1),e.def(g,"$===",u=function(e){return this.$match(n(b,"Opal")["$coerce_to?"](e,n(b,"String"),"to_str"))!==r},u.$$arity=1),e.def(g,"$=~",c=function(e){var t,n=this;return null==o["~"]&&(o["~"]=r),$(t=n.$match(e))?o["~"].$begin(0):t},c.$$arity=1),e.alias(g,"eql?","=="),e.def(g,"$inspect",p=function(){var e=/^\/(.*)\/([^\/]*)$/,t=this.toString(),r=e.exec(t);if(r){for(var n=r[1],a=r[2],i=n.split(""),$=i.length,o=!1,s="",l=0;l<$;l++){var u=i[l];o||"/"!=u||(s=s.concat("\\")),s=s.concat(u),o="\\"==u&&!o}return"/"+s+"/"+a}return t},p.$$arity=0),e.def(g,"$match",d=function(t,a){var i=d.$$p,$=i||r,s=this;if(null==o["~"]&&(o["~"]=r),i&&(d.$$p=null),i&&(d.$$p=null),s.uninitialized&&s.$raise(n(b,"TypeError"),"uninitialized Regexp"),a===undefined){if(t===r)return o["~"]=r;var l=s.exec(n(b,"Opal").$coerce_to(t,n(b,"String"),"to_str"));return l?(o["~"]=n(b,"MatchData").$new(s,l),$===r?o["~"]:e.yield1($,o["~"])):o["~"]=r}if(a=n(b,"Opal").$coerce_to(a,n(b,"Integer"),"to_int"),t===r)return o["~"]=r;if(t=n(b,"Opal").$coerce_to(t,n(b,"String"),"to_str"),a<0&&(a+=t.length)<0)return o["~"]=r;for(var u,c=e.global_regexp(s);;){if(null===(u=c.exec(t)))return o["~"]=r;if(u.index>=a)return o["~"]=n(b,"MatchData").$new(c,u),$===r?o["~"]:e.yield1($,o["~"]);c.lastIndex=u.index+1}},d.$$arity=-2),e.def(g,"$match?",_=function(t,a){var i,$=this;return $.uninitialized&&$.$raise(n(b,"TypeError"),"uninitialized Regexp"),a===undefined?t!==r&&$.test(n(b,"Opal").$coerce_to(t,n(b,"String"),"to_str")):(a=n(b,"Opal").$coerce_to(a,n(b,"Integer"),"to_int"),t!==r&&(t=n(b,"Opal").$coerce_to(t,n(b,"String"),"to_str"),!(a<0&&(a+=t.length)<0)&&!(null===(i=e.global_regexp($).exec(t))||i.index<a)))},_.$$arity=-2),e.def(g,"$~",f=function(){var e=this;return null==o._&&(o._=r),e["$=~"](o._)},f.$$arity=0),e.def(g,"$source",h=function(){return this.source},h.$$arity=0),e.def(g,"$options",y=function(){var e=this;e.uninitialized&&e.$raise(n(b,"TypeError"),"uninitialized Regexp");var t=0;return e.multiline&&(t|=n(b,"MULTILINE")),e.ignoreCase&&(t|=n(b,"IGNORECASE")),t},y.$$arity=0),e.def(g,"$casefold?",m=function(){return this.ignoreCase},m.$$arity=0),e.alias(g,"to_s","source")}(t[0],RegExp,t),function(t,$super,s){var l,u,c,p,d,_,f,h,y,m,g,b,v=a(t,null,"MatchData"),w=[v].concat(s);return v.$$prototype.matches=r,v.$attr_reader("post_match","pre_match","regexp","string"),e.def(v,"$initialize",l=function(e,t){var n=this;o["~"]=n,n.regexp=e,n.begin=t.index,n.string=t.input,n.pre_match=t.input.slice(0,t.index),n.post_match=t.input.slice(t.index+t[0].length),n.matches=[];for(var a=0,i=t.length;a<i;a++){var $=t[a];null==$?n.matches.push(r):n.matches.push($)}},l.$$arity=2),e.def(v,"$[]",u=function(){var t,r=this;return t=e.slice.call(arguments,0,arguments.length),i(r.matches,"[]",e.to_a(t))},u.$$arity=-1),e.def(v,"$offset",c=function(e){var t=this;return 0!==e&&t.$raise(n(w,"ArgumentError"),"MatchData#offset only supports 0th element"),[t.begin,t.begin+t.matches[e].length]},c.$$arity=1),e.def(v,"$==",p=function(e){var t,r,a,i,o=this;return!!$(n(w,"MatchData")["$==="](e))&&($(t=$(r=$(a=$(i=o.string==e.string)?o.regexp.toString()==e.regexp.toString():i)?o.pre_match==e.pre_match:a)?o.post_match==e.post_match:r)?o.begin==e.begin:t)},p.$$arity=1),e.alias(v,"eql?","=="),e.def(v,"$begin",d=function(e){var t=this;return 0!==e&&t.$raise(n(w,"ArgumentError"),"MatchData#begin only supports 0th element"),t.begin},d.$$arity=1),e.def(v,"$end",_=function(e){var t=this;return 0!==e&&t.$raise(n(w,"ArgumentError"),"MatchData#end only supports 0th element"),t.begin+t.matches[e].length},_.$$arity=1),e.def(v,"$captures",f=function(){return this.matches.slice(1)},f.$$arity=0),e.def(v,"$inspect",h=function(){for(var e=this,t="#<MatchData "+e.matches[0].$inspect(),r=1,n=e.matches.length;r<n;r++)t+=" "+r+":"+e.matches[r].$inspect();return t+">"},h.$$arity=0),e.def(v,"$length",y=function(){return this.matches.length},y.$$arity=0),e.alias(v,"size","length"),e.def(v,"$to_a",m=function(){return this.matches},m.$$arity=0),e.def(v,"$to_s",g=function(){return this.matches[0]},g.$$arity=0),e.def(v,"$values_at",b=function(){var t,a=this;t=e.slice.call(arguments,0,arguments.length);var i,$,o,s=[];for(i=0;i<t.length;i++)t[i].$$is_range&&(($=t[i].$to_a()).unshift(i,1),Array.prototype.splice.apply(t,$)),(o=n(w,"Opal")["$coerce_to!"](t[i],n(w,"Integer"),"to_int"))<0&&(o+=a.matches.length)<0?s.push(r):s.push(a.matches[o]);return s},b.$$arity=-1),r&&"values_at"}(t[0],0,t)},Opal.modules["corelib/string"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.klass),l=e.truthy,u=e.send,c=e.gvars;return e.add_stubs(["$require","$include","$coerce_to?","$coerce_to","$raise","$===","$format","$to_s","$respond_to?","$to_str","$<=>","$==","$=~","$new","$force_encoding","$casecmp","$empty?","$ljust","$ceil","$/","$+","$rjust","$floor","$to_a","$each_char","$to_proc","$coerce_to!","$copy_singleton_methods","$initialize_clone","$initialize_dup","$enum_for","$size","$chomp","$[]","$to_i","$each_line","$encoding","$class","$match","$match?","$captures","$proc","$succ","$escape"]),n.$require("corelib/comparable"),n.$require("corelib/regexp"),function(n,$super,a){function p(e){function t(e){var t,r,n,a,i,$,s="",l=e.length;for(t=0;t<l;t++)if("-"===(r=e.charAt(t))&&t>0&&t<l-1&&!n){for((a=e.charCodeAt(t-1))>(i=e.charCodeAt(t+1))&&ze.$raise(o(Ne,"ArgumentError"),'invalid range "'+a+"-"+i+'" in string transliteration'),$=a+1;$<i+1;$++)s+=String.fromCharCode($);n=!0,t++}else n="\\"===r,s+=r;return s}function r(e,t){if(0===e.length)return t;var r,n,a="",i=e.length;for(r=0;r<i;r++)n=e.charAt(r),-1!==t.indexOf(n)&&(a+=n);return a}var n,a,i,$,s,l,u="",c="";for(n=0,a=e.length;n<a;n++)i=t(($="^"===(i=o(Ne,"Opal").$coerce_to(e[n],o(Ne,"String"),"to_str")).charAt(0)&&i.length>1)?i.slice(1):i),$?c=r(c,i):u=r(u,i);if(u.length>0&&c.length>0){for(l="",n=0,a=u.length;n<a;n++)s=u.charAt(n),-1===c.indexOf(s)&&(l+=s);u=l,c=""}return u.length>0?"["+o(Ne,"Regexp").$escape(u)+"]":c.length>0?"[^"+o(Ne,"Regexp").$escape(c)+"]":null}var d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q,ee,te,re,ne,ae,ie,$e,oe,se,le,ue,ce,pe,de,_e,fe,he,ye,me,ge,be,ve,we,ke,xe,Ee,Oe,Ae,Te,Se,Ie,Re,Ce,qe,Me,ze=s(n,$super,"String"),Ne=[ze].concat(a);ze.$include(o(Ne,"Comparable")),e.defineProperty(ze.$$prototype,"$$is_string",!0),e.defineProperty(ze.$$prototype,"$$cast",function(e){var t=this.$$class;return t.$$constructor===String?e:new t.$$constructor(e)}),e.def(ze,"$__id__",d=function(){return this.toString()},d.$$arity=0),e.alias(ze,"object_id","__id__"),e.defs(ze,"$try_convert",_=function(e){return o(Ne,"Opal")["$coerce_to?"](e,o(Ne,"String"),"to_str")},_.$$arity=1),e.defs(ze,"$new",f=function(e){var t=this;return null==e&&(e=""),e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str"),new t.$$constructor(e)},f.$$arity=-1),e.def(ze,"$initialize",h=function(e){var t=this;return e===undefined?t:t.$raise(o(Ne,"NotImplementedError"),"Mutable strings are not supported in Opal.")},h.$$arity=-1),e.def(ze,"$%",y=function(t){var r=this;return l(o(Ne,"Array")["$==="](t))?u(r,"format",[r].concat(e.to_a(t))):r.$format(r,t)},y.$$arity=1),e.def(ze,"$*",m=function(e){var t=this;if((e=o(Ne,"Opal").$coerce_to(e,o(Ne,"Integer"),"to_int"))<0&&t.$raise(o(Ne,"ArgumentError"),"negative argument"),0===e)return t.$$cast("");var r="",n=t.toString();for(n.length*e>=1<<28&&t.$raise(o(Ne,"RangeError"),"multiply count must not overflow maximum string size");1==(1&e)&&(r+=n),0!==(e>>>=1);)n+=n;return t.$$cast(r)},m.$$arity=1),e.def(ze,"$+",g=function(e){return this+(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str")).$to_s()},g.$$arity=1),e.def(ze,"$<=>",b=function(e){var t=this;if(l(e["$respond_to?"]("to_str")))return t>(e=e.$to_str().$to_s())?1:t<e?-1:0;var r=e["$<=>"](t);return r===i?i:r>0?-1:r<0?1:0},b.$$arity=1),e.def(ze,"$==",v=function(e){var t=this;return e.$$is_string?t.toString()===e.toString():!!o(Ne,"Opal")["$respond_to?"](e,"to_str")&&e["$=="](t)},v.$$arity=1),e.alias(ze,"eql?","=="),e.alias(ze,"===","=="),e.def(ze,"$=~",w=function(e){var t=this;return e.$$is_string&&t.$raise(o(Ne,"TypeError"),"type mismatch: String given"),e["$=~"](t)},w.$$arity=1),e.def(ze,"$[]",k=function(e,t){var r,n=this,a=n.length;if(e.$$is_range)return r=e.excl,t=o(Ne,"Opal").$coerce_to(e.end,o(Ne,"Integer"),"to_int"),e=o(Ne,"Opal").$coerce_to(e.begin,o(Ne,"Integer"),"to_int"),Math.abs(e)>a?i:(e<0&&(e+=a),t<0&&(t+=a),r||(t+=1),(t-=e)<0&&(t=0),n.$$cast(n.substr(e,t)));if(e.$$is_string)return null!=t&&n.$raise(o(Ne,"TypeError")),-1!==n.indexOf(e)?n.$$cast(e):i;if(e.$$is_regexp){var $=n.match(e);return null===$?(c["~"]=i,i):(c["~"]=o(Ne,"MatchData").$new(e,$),null==t?n.$$cast($[0]):(t=o(Ne,"Opal").$coerce_to(t,o(Ne,"Integer"),"to_int"))<0&&-t<$.length?n.$$cast($[t+=$.length]):t>=0&&t<$.length?n.$$cast($[t]):i)}return(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"Integer"),"to_int"))<0&&(e+=a),null==t?e>=a||e<0?i:n.$$cast(n.substr(e,1)):(t=o(Ne,"Opal").$coerce_to(t,o(Ne,"Integer"),"to_int"))<0?i:e>a||e<0?i:n.$$cast(n.substr(e,t))},k.$$arity=-2),e.alias(ze,"byteslice","[]"),e.def(ze,"$b",x=function(){return this.$force_encoding("binary")},x.$$arity=0),e.def(ze,"$capitalize",E=function(){var e=this;return e.$$cast(e.charAt(0).toUpperCase()+e.substr(1).toLowerCase())},E.$$arity=0),e.def(ze,"$casecmp",O=function(e){var t=this;if(!l(e["$respond_to?"]("to_str")))return i;e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str").$to_s();var r=/^[\x00-\x7F]*$/;return r.test(t)&&r.test(e)&&(t=t.toLowerCase(),e=e.toLowerCase()),t["$<=>"](e)},O.$$arity=1),e.def(ze,"$casecmp?",A=function(e){var t=this.$casecmp(e);return t===i?i:0===t},A.$$arity=1),e.def(ze,"$center",T=function(e,n){var a=this;if(null==n&&(n=" "),e=o(Ne,"Opal").$coerce_to(e,o(Ne,"Integer"),"to_int"),n=o(Ne,"Opal").$coerce_to(n,o(Ne,"String"),"to_str").$to_s(),l(n["$empty?"]())&&a.$raise(o(Ne,"ArgumentError"),"zero width padding"),l(e<=a.length))return a;var i=a.$ljust(t(r(e,a.length),2).$ceil(),n),$=a.$rjust(t(r(e,a.length),2).$floor(),n);return a.$$cast($+i.slice(a.length))},T.$$arity=-2),e.def(ze,"$chars",S=function(){var e=S.$$p,t=e||i,r=this;return e&&(S.$$p=null),e&&(S.$$p=null),l(t)?u(r,"each_char",[],t.$to_proc()):r.$each_char().$to_a()},S.$$arity=0),e.def(ze,"$chomp",I=function(e){var t,r=this;if(null==c["/"]&&(c["/"]=i),null==e&&(e=c["/"]),l(e===i||0===r.length))return r;if("\n"===(e=o(Ne,"Opal")["$coerce_to!"](e,o(Ne,"String"),"to_str").$to_s()))t=r.replace(/\r?\n?$/,"");else if(""===e)t=r.replace(/(\r?\n)+$/,"");else if(r.length>=e.length){r.substr(r.length-e.length,e.length)===e&&(t=r.substr(0,r.length-e.length))}return null!=t?r.$$cast(t):r},I.$$arity=-1),e.def(ze,"$chop",R=function(){var e,t=this,r=t.length;return e=r<=1?"":"\n"===t.charAt(r-1)&&"\r"===t.charAt(r-2)?t.substr(0,r-2):t.substr(0,r-1),t.$$cast(e)},R.$$arity=0),e.def(ze,"$chr",C=function(){return this.charAt(0)},C.$$arity=0),e.def(ze,"$clone",q=function(){var e=this,t=i;return(t=e.slice()).$copy_singleton_methods(e),t.$initialize_clone(e),t},q.$$arity=0),e.def(ze,"$dup",M=function(){var e=this,t=i;return(t=e.slice()).$initialize_dup(e),t},M.$$arity=0),e.def(ze,"$count",z=function(){var t,r=this;0===(t=e.slice.call(arguments,0,arguments.length)).length&&r.$raise(o(Ne,"ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var n=p(t);return null===n?0:r.length-r.replace(new RegExp(n,"g"),"").length},z.$$arity=-1),e.def(ze,"$delete",N=function(){var t,r=this;0===(t=e.slice.call(arguments,0,arguments.length)).length&&r.$raise(o(Ne,"ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var n=p(t);return null===n?r:r.$$cast(r.replace(new RegExp(n,"g"),""))},N.$$arity=-1),e.def(ze,"$delete_prefix",j=function(e){var t=this;return e.$$is_string||(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str")),t.slice(0,e.length)===e?t.$$cast(t.slice(e.length)):t},j.$$arity=1),e.def(ze,"$delete_suffix",P=function(e){var t=this;return e.$$is_string||(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str")),t.slice(t.length-e.length)===e?t.$$cast(t.slice(0,t.length-e.length)):t},P.$$arity=1),e.def(ze,"$downcase",B=function(){var e=this;return e.$$cast(e.toLowerCase())},B.$$arity=0),e.def(ze,"$each_char",L=function(){var t,r=L.$$p,n=r||i,a=this;if(r&&(L.$$p=null),r&&(L.$$p=null),n===i)return u(a,"enum_for",["each_char"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var $=0,o=a.length;$<o;$++)e.yield1(n,a.charAt($));return a},L.$$arity=0),e.def(ze,"$each_line",D=function(t){var r,n,a,$,s,l,u,p=D.$$p,d=p||i,_=this;if(null==c["/"]&&(c["/"]=i),p&&(D.$$p=null),p&&(D.$$p=null),null==t&&(t=c["/"]),d===i)return _.$enum_for("each_line",t);if(t===i)return e.yield1(d,_),_;if(0===(t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str")).length){for(n=0,a=(r=_.split(/(\n{2,})/)).length;n<a;n+=2)if(r[n]||r[n+1]){var f=(r[n]||"")+(r[n+1]||"");e.yield1(d,_.$$cast(f))}return _}for(s=_.$chomp(t),l=_.length!=s.length,n=0,$=(u=s.split(t)).length;n<$;n++)n<$-1||l?e.yield1(d,_.$$cast(u[n]+t)):e.yield1(d,_.$$cast(u[n]));return _},D.$$arity=-1),e.def(ze,"$empty?",G=function(){return 0===this.length},G.$$arity=0),e.def(ze,"$end_with?",H=function(){for(var t,r=this,n=0,a=(t=e.slice.call(arguments,0,arguments.length)).length;n<a;n++){var i=o(Ne,"Opal").$coerce_to(t[n],o(Ne,"String"),"to_str").$to_s();if(r.length>=i.length&&r.substr(r.length-i.length,i.length)==i)return!0}return!1},H.$$arity=-1),e.alias(ze,"equal?","==="),e.def(ze,"$gsub",F=function(t,r){var n=F.$$p,a=n||i,$=this;if(n&&(F.$$p=null),n&&(F.$$p=null),r===undefined&&a===i)return $.$enum_for("gsub",t);var s,l,u,p="",d=i,_=0;for(t.$$is_regexp?t=e.global_multiline_regexp(t):(t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str"),t=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===(s=t.exec($))){c["~"]=i,p+=$.slice(_);break}d=o(Ne,"MatchData").$new(t,s),r===undefined?(u=t.lastIndex,l=a(s[0]),t.lastIndex=u):r.$$is_hash?l=r["$[]"](s[0]).$to_s():(r.$$is_string||(r=o(Ne,"Opal").$coerce_to(r,o(Ne,"String"),"to_str")),l=r.replace(/([\\]+)([0-9+&`'])/g,function(e,t,r){if(t.length%2==0)return e;switch(r){case"+":for(var n=s.length-1;n>0;n--)if(s[n]!==undefined)return t.slice(1)+s[n];return"";case"&":return t.slice(1)+s[0];case"`":return t.slice(1)+$.slice(0,s.index);case"'":return t.slice(1)+$.slice(s.index+s[0].length);default:return t.slice(1)+(s[r]||"")}}).replace(/\\\\/g,"\\")),t.lastIndex===s.index?(p+=l+$.slice(_,s.index+1),t.lastIndex+=1):p+=$.slice(_,s.index)+l,_=t.lastIndex}return c["~"]=d,$.$$cast(p)},F.$$arity=-2),e.def(ze,"$hash",U=function(){return this.toString()},U.$$arity=0),e.def(ze,"$hex",K=function(){return this.$to_i(16)},K.$$arity=0),e.def(ze,"$include?",Y=function(e){var t=this;return e.$$is_string||(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str")),-1!==t.indexOf(e)},Y.$$arity=1),e.def(ze,"$index",V=function(t,r){var n,a,$,s=this;if(r===undefined)r=0;else if((r=o(Ne,"Opal").$coerce_to(r,o(Ne,"Integer"),"to_int"))<0&&(r+=s.length)<0)return i;if(t.$$is_regexp)for($=e.global_multiline_regexp(t);;){if(null===(a=$.exec(s))){c["~"]=i,n=-1;break}if(a.index>=r){c["~"]=o(Ne,"MatchData").$new($,a),n=a.index;break}$.lastIndex=a.index+1}else n=0===(t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str")).length&&r>s.length?-1:s.indexOf(t,r);return-1===n?i:n},V.$$arity=-2),e.def(ze,"$inspect",W=function(){var e=/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,t={"\x07":"\\a","\x1b":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\x0B":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+this.replace(e,function(e){return t[e]||"\\u"+("0000"+e.charCodeAt(0).toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'},W.$$arity=0),e.def(ze,"$intern",J=function(){return this.toString()},J.$$arity=0),e.def(ze,"$lines",X=function(e){var t=X.$$p,r=t||i,n=this,a=i;return null==c["/"]&&(c["/"]=i),t&&(X.$$p=null),t&&(X.$$p=null),null==e&&(e=c["/"]),a=u(n,"each_line",[e],r.$to_proc()),l(r)?n:a.$to_a()},X.$$arity=-1),e.def(ze,"$length",Z=function(){return this.length},Z.$$arity=0),e.def(ze,"$ljust",Q=function(e,t){var r=this;if(null==t&&(t=" "),e=o(Ne,"Opal").$coerce_to(e,o(Ne,"Integer"),"to_int"),t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str").$to_s(),l(t["$empty?"]())&&r.$raise(o(Ne,"ArgumentError"),"zero width padding"),l(e<=r.length))return r;var n=-1,a="";for(e-=r.length;++n<e;)a+=t;return r.$$cast(r+a.slice(0,e))},Q.$$arity=-2),e.def(ze,"$lstrip",ee=function(){return this.replace(/^\s*/,"")},ee.$$arity=0),e.def(ze,"$ascii_only?",te=function(){var e=this
;return!e.$encoding()["$=="]($(o(Ne,"Encoding"),"UTF_16BE"))&&/^[\x00-\x7F]*$/.test(e)},te.$$arity=0),e.def(ze,"$match",re=function(e,t){var r,n=re.$$p,a=n||i,$=this;return n&&(re.$$p=null),n&&(re.$$p=null),l(l(r=o(Ne,"String")["$==="](e))?r:e["$respond_to?"]("to_str"))&&(e=o(Ne,"Regexp").$new(e.$to_str())),l(o(Ne,"Regexp")["$==="](e))||$.$raise(o(Ne,"TypeError"),"wrong argument type "+e.$class()+" (expected Regexp)"),u(e,"match",[$,t],a.$to_proc())},re.$$arity=-2),e.def(ze,"$match?",ne=function(e,t){var r,n=this;return l(l(r=o(Ne,"String")["$==="](e))?r:e["$respond_to?"]("to_str"))&&(e=o(Ne,"Regexp").$new(e.$to_str())),l(o(Ne,"Regexp")["$==="](e))||n.$raise(o(Ne,"TypeError"),"wrong argument type "+e.$class()+" (expected Regexp)"),e["$match?"](n,t)},ne.$$arity=-2),e.def(ze,"$next",ae=function(){var e=this,t=e.length;if(0===t)return e.$$cast("");for(var r,n=e,a=e.search(/[a-zA-Z0-9]/),i=!1;t--;){if((r=e.charCodeAt(t))>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122)switch(r){case 57:i=!0,r=48;break;case 90:i=!0,r=65;break;case 122:i=!0,r=97;break;default:i=!1,r+=1}else-1===a?255===r?(i=!0,r=0):(i=!1,r+=1):i=!0;if(n=n.slice(0,t)+String.fromCharCode(r)+n.slice(t+1),i&&(0===t||t===a)){switch(r){case 65:case 97:break;default:r+=1}n=0===t?String.fromCharCode(r)+n:n.slice(0,t)+String.fromCharCode(r)+n.slice(t),i=!1}if(!i)break}return e.$$cast(n)},ae.$$arity=0),e.def(ze,"$oct",ie=function(){var e,t=this,r=8;return/^\s*_/.test(t)?0:(t=t.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(e,t,n,a){switch(a.charAt(0)){case"+":case"-":return e;case"0":if("x"===a.charAt(1)&&"0x"===n)return e}switch(n){case"0b":r=2;break;case"0":case"0o":r=8;break;case"0d":r=10;break;case"0x":r=16}return t+a}),e=parseInt(t.replace(/_(?!_)/g,""),r),isNaN(e)?0:e)},ie.$$arity=0),e.def(ze,"$ord",$e=function(){return this.charCodeAt(0)},$e.$$arity=0),e.def(ze,"$partition",oe=function(e){var t,r,n=this;return e.$$is_regexp?null===(r=e.exec(n))?t=-1:(o(Ne,"MatchData").$new(e,r),e=r[0],t=r.index):(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str"),t=n.indexOf(e)),-1===t?[n,"",""]:[n.slice(0,t),n.slice(t,t+e.length),n.slice(t+e.length)]},oe.$$arity=1),e.def(ze,"$reverse",se=function(){return this.split("").reverse().join("")},se.$$arity=0),e.def(ze,"$rindex",le=function(t,r){var n,a,$,s,l=this;if(r===undefined)r=l.length;else if((r=o(Ne,"Opal").$coerce_to(r,o(Ne,"Integer"),"to_int"))<0&&(r+=l.length)<0)return i;if(t.$$is_regexp){for(a=null,$=e.global_multiline_regexp(t);!(null===(s=$.exec(l))||s.index>r);)a=s,$.lastIndex=a.index+1;null===a?(c["~"]=i,n=-1):(o(Ne,"MatchData").$new($,a),n=a.index)}else t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str"),n=l.lastIndexOf(t,r);return-1===n?i:n},le.$$arity=-2),e.def(ze,"$rjust",ue=function(e,t){var r=this;if(null==t&&(t=" "),e=o(Ne,"Opal").$coerce_to(e,o(Ne,"Integer"),"to_int"),t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str").$to_s(),l(t["$empty?"]())&&r.$raise(o(Ne,"ArgumentError"),"zero width padding"),l(e<=r.length))return r;var n=Math.floor(e-r.length),a=Math.floor(n/t.length),i=Array(a+1).join(t),$=n-i.length;return r.$$cast(i+t.slice(0,$)+r)},ue.$$arity=-2),e.def(ze,"$rpartition",ce=function(t){var r,n,a,i,$=this;if(t.$$is_regexp){for(n=null,a=e.global_multiline_regexp(t);null!==(i=a.exec($));)n=i,a.lastIndex=n.index+1;null===n?r=-1:(o(Ne,"MatchData").$new(a,n),t=n[0],r=n.index)}else t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str"),r=$.lastIndexOf(t);return-1===r?["","",$]:[$.slice(0,r),$.slice(r,r+t.length),$.slice(r+t.length)]},ce.$$arity=1),e.def(ze,"$rstrip",pe=function(){return this.replace(/[\s\u0000]*$/,"")},pe.$$arity=0),e.def(ze,"$scan",de=function(t){var r=de.$$p,n=r||i,a=this;r&&(de.$$p=null),r&&(de.$$p=null);var $,s=[],l=i;for(t.$$is_regexp?t=e.global_multiline_regexp(t):(t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str"),t=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=($=t.exec(a));)l=o(Ne,"MatchData").$new(t,$),n===i?1==$.length?s.push($[0]):s.push(l.$captures()):1==$.length?n($[0]):n.call(a,l.$captures()),t.lastIndex===$.index&&(t.lastIndex+=1);return c["~"]=l,n!==i?a:s},de.$$arity=1),e.alias(ze,"size","length"),e.alias(ze,"slice","[]"),e.def(ze,"$split",_e=function(t,r){function n(){for(u=0;u<d.length;u++)d[u]=$.$$cast(d[u])}var a,$=this;if(null==c[";"]&&(c[";"]=i),0===$.length)return[];if(r===undefined)r=0;else if(1===(r=o(Ne,"Opal")["$coerce_to!"](r,o(Ne,"Integer"),"to_int")))return[$];t!==undefined&&t!==i||(t=l(a=c[";"])?a:" ");var s,u,p,d=[],_=$.toString(),f=0;if(t.$$is_regexp?t=e.global_multiline_regexp(t):" "===(t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str").$to_s())?(t=/\s+/gm,_=_.replace(/^\s+/,"")):t=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===(d=_.split(t)).length&&d[0]===_)return[$.$$cast(d[0])];for(;-1!==(u=d.indexOf(undefined));)d.splice(u,1);if(0===r){for(;""===d[d.length-1];)d.length-=1;return n(),d}if(s=t.exec(_),r<0){if(null!==s&&""===s[0]&&-1===t.source.indexOf("(?="))for(u=0,p=s.length;u<p;u++)d.push("");return n(),d}if(null!==s&&""===s[0])return d.splice(r-1,d.length-1,d.slice(r-1).join("")),n(),d;if(r>=d.length)return n(),d;for(u=0;null!==s&&(u++,f=t.lastIndex,u+1!==r);)s=t.exec(_);return d.splice(r-1,d.length-1,_.slice(f)),n(),d},_e.$$arity=-1),e.def(ze,"$squeeze",fe=function(){var t,r=this;if(0===(t=e.slice.call(arguments,0,arguments.length)).length)return r.$$cast(r.replace(/(.)\1+/g,"$1"));var n=p(t);return null===n?r:r.$$cast(r.replace(new RegExp("("+n+")\\1+","g"),"$1"))},fe.$$arity=-1),e.def(ze,"$start_with?",he=function(){for(var t,r=this,n=0,a=(t=e.slice.call(arguments,0,arguments.length)).length;n<a;n++){var i=o(Ne,"Opal").$coerce_to(t[n],o(Ne,"String"),"to_str").$to_s();if(0===r.indexOf(i))return!0}return!1},he.$$arity=-1),e.def(ze,"$strip",ye=function(){return this.replace(/^\s*/,"").replace(/[\s\u0000]*$/,"")},ye.$$arity=0),e.def(ze,"$sub",me=function(e,t){var r=me.$$p,n=r||i,a=this;r&&(me.$$p=null),r&&(me.$$p=null),e.$$is_regexp||(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str"),e=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var $,s=e.exec(a);return null===s?(c["~"]=i,$=a.toString()):(o(Ne,"MatchData").$new(e,s),t===undefined?(n===i&&a.$raise(o(Ne,"ArgumentError"),"wrong number of arguments (1 for 2)"),$=a.slice(0,s.index)+n(s[0])+a.slice(s.index+s[0].length)):t.$$is_hash?$=a.slice(0,s.index)+t["$[]"](s[0]).$to_s()+a.slice(s.index+s[0].length):(t=(t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(e,t,r){if(t.length%2==0)return e;switch(r){case"+":for(var n=s.length-1;n>0;n--)if(s[n]!==undefined)return t.slice(1)+s[n];return"";case"&":return t.slice(1)+s[0];case"`":return t.slice(1)+a.slice(0,s.index);case"'":return t.slice(1)+a.slice(s.index+s[0].length);default:return t.slice(1)+(s[r]||"")}}).replace(/\\\\/g,"\\"),$=a.slice(0,s.index)+t+a.slice(s.index+s[0].length))),a.$$cast($)},me.$$arity=-2),e.alias(ze,"succ","next"),e.def(ze,"$sum",ge=function(e){var t=this;null==e&&(e=16),e=o(Ne,"Opal").$coerce_to(e,o(Ne,"Integer"),"to_int");for(var r=0,n=t.length,a=0;a<n;a++)r+=t.charCodeAt(a);return e<=0?r:r&Math.pow(2,e)-1},ge.$$arity=-1),e.def(ze,"$swapcase",be=function(){var e=this,t=e.replace(/([a-z]+)|([A-Z]+)/g,function(e,t){return t?e.toUpperCase():e.toLowerCase()});return e.constructor===String?t:e.$class().$new(t)},be.$$arity=0),e.def(ze,"$to_f",ve=function(){var e=this;if("_"===e.charAt(0))return 0;var t=parseFloat(e.replace(/_/g,""));return isNaN(t)||t==Infinity||t==-Infinity?0:t},ve.$$arity=0),e.def(ze,"$to_i",we=function(e){var t=this;null==e&&(e=10);var r,n=t.toLowerCase(),a=o(Ne,"Opal").$coerce_to(e,o(Ne,"Integer"),"to_int");return(1===a||a<0||a>36)&&t.$raise(o(Ne,"ArgumentError"),"invalid radix "+a),/^\s*_/.test(n)?0:(n=n.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(e,t,r,n){switch(n.charAt(0)){case"+":case"-":return e;case"0":if("x"===n.charAt(1)&&"0x"===r&&(0===a||16===a))return e}switch(r){case"0b":if(0===a||2===a)return a=2,t+n;break;case"0":case"0o":if(0===a||8===a)return a=8,t+n;break;case"0d":if(0===a||10===a)return a=10,t+n;break;case"0x":if(0===a||16===a)return a=16,t+n}return e}),r=parseInt(n.replace(/_(?!_)/g,""),a),isNaN(r)?0:r)},we.$$arity=-1),e.def(ze,"$to_proc",ke=function(){var t,n=ke.$$p,a=this,$=i;return n&&(ke.$$p=null),$=r("$",a.valueOf()),u(a,"proc",[],((t=function(){var r,n=t.$$s||this,a=t.$$p,s=a||i;a&&(t.$$p=null),0===(r=e.slice.call(arguments,0,arguments.length)).length&&n.$raise(o(Ne,"ArgumentError"),"no receiver given");var l=r[0];null==l&&(l=i);var u=l[$];return u?("function"==typeof s&&(u.$$p=s),1===r.length?u.call(l):u.apply(l,r.slice(1))):l.$method_missing.apply(l,r)}).$$s=a,t.$$arity=-1,t))},ke.$$arity=0),e.def(ze,"$to_s",xe=function(){return this.toString()},xe.$$arity=0),e.alias(ze,"to_str","to_s"),e.alias(ze,"to_sym","intern"),e.def(ze,"$tr",Ee=function(e,t){var r,n,a,i,$,s,l,u=this;if(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str").$to_s(),t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str").$to_s(),0==e.length||e===t)return u;var c={},p=e.split(""),d=p.length,_=t.split(""),f=_.length,h=!1,y=null;"^"===p[0]&&p.length>1&&(h=!0,p.shift(),y=_[f-1],d-=1);var m=[],g=null;for(n=!1,r=0;r<d;r++)if(i=p[r],null==g)g=i,m.push(i);else if("-"===i)"-"===g?(m.push("-"),m.push("-")):r==d-1?m.push("-"):n=!0;else if(n){for(($=g.charCodeAt(0))>(s=i.charCodeAt(0))&&u.$raise(o(Ne,"ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(s)+'" in string transliteration'),a=$+1;a<s;a++)m.push(String.fromCharCode(a));m.push(i),n=null,g=null}else m.push(i);if(d=(p=m).length,h)for(r=0;r<d;r++)c[p[r]]=!0;else{if(f>0){var b=[],v=null;for(n=!1,r=0;r<f;r++)if(i=_[r],null==v)v=i,b.push(i);else if("-"===i)"-"===v?(b.push("-"),b.push("-")):r==f-1?b.push("-"):n=!0;else if(n){for(($=v.charCodeAt(0))>(s=i.charCodeAt(0))&&u.$raise(o(Ne,"ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(s)+'" in string transliteration'),a=$+1;a<s;a++)b.push(String.fromCharCode(a));b.push(i),n=null,v=null}else b.push(i);f=(_=b).length}var w=d-f;if(w>0){var k=f>0?_[f-1]:"";for(r=0;r<w;r++)_.push(k)}for(r=0;r<d;r++)c[p[r]]=_[r]}var x="";for(r=0,l=u.length;r<l;r++){var E=c[i=u.charAt(r)];x+=h?null==E?y:i:null!=E?E:i}return u.$$cast(x)},Ee.$$arity=2),e.def(ze,"$tr_s",Oe=function(e,t){var r,n,a,i,$,s,l,u=this;if(e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str").$to_s(),t=o(Ne,"Opal").$coerce_to(t,o(Ne,"String"),"to_str").$to_s(),0==e.length)return u;var c={},p=e.split(""),d=p.length,_=t.split(""),f=_.length,h=!1,y=null;"^"===p[0]&&p.length>1&&(h=!0,p.shift(),y=_[f-1],d-=1);var m=[],g=null;for(n=!1,r=0;r<d;r++)if(i=p[r],null==g)g=i,m.push(i);else if("-"===i)"-"===g?(m.push("-"),m.push("-")):r==d-1?m.push("-"):n=!0;else if(n){for(($=g.charCodeAt(0))>(s=i.charCodeAt(0))&&u.$raise(o(Ne,"ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(s)+'" in string transliteration'),a=$+1;a<s;a++)m.push(String.fromCharCode(a));m.push(i),n=null,g=null}else m.push(i);if(d=(p=m).length,h)for(r=0;r<d;r++)c[p[r]]=!0;else{if(f>0){var b=[],v=null;for(n=!1,r=0;r<f;r++)if(i=_[r],null==g)g=i,b.push(i);else if("-"===i)"-"===v?(b.push("-"),b.push("-")):r==f-1?b.push("-"):n=!0;else if(n){for(($=g.charCodeAt(0))>(s=i.charCodeAt(0))&&u.$raise(o(Ne,"ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(s)+'" in string transliteration'),a=$+1;a<s;a++)b.push(String.fromCharCode(a));b.push(i),n=null,g=null}else b.push(i);f=(_=b).length}var w=d-f;if(w>0){var k=f>0?_[f-1]:"";for(r=0;r<w;r++)_.push(k)}for(r=0;r<d;r++)c[p[r]]=_[r]}var x="",E=null;for(r=0,l=u.length;r<l;r++){var O=c[i=u.charAt(r)];h?null==O?null==E&&(x+=y,E=!0):(x+=i,E=null):null!=O?null!=E&&E===O||(x+=O,E=O):(x+=i,E=null)}return u.$$cast(x)},Oe.$$arity=2),e.def(ze,"$upcase",Ae=function(){var e=this;return e.$$cast(e.toUpperCase())},Ae.$$arity=0),e.def(ze,"$upto",Te=function(e,t){var r=Te.$$p,n=r||i,a=this;if(r&&(Te.$$p=null),r&&(Te.$$p=null),null==t&&(t=!1),n===i)return a.$enum_for("upto",e,t);e=o(Ne,"Opal").$coerce_to(e,o(Ne,"String"),"to_str");var $,s,l=a.toString();if(1===l.length&&1===e.length)for($=l.charCodeAt(0),s=e.charCodeAt(0);$<=s&&(!t||$!==s);)n(String.fromCharCode($)),$+=1;else if(parseInt(l,10).toString()===l&&parseInt(e,10).toString()===e)for($=parseInt(l,10),s=parseInt(e,10);$<=s&&(!t||$!==s);)n($.toString()),$+=1;else for(;l.length<=e.length&&l<=e&&(!t||l!==e);)n(l),l=l.$succ();return a},Te.$$arity=-2),e.def(ze,"$instance_variables",Se=function(){return[]},Se.$$arity=0),e.defs(ze,"$_load",Ie=function(){var t,r=this;return t=e.slice.call(arguments,0,arguments.length),u(r,"new",e.to_a(t))},Ie.$$arity=-1),e.def(ze,"$unicode_normalize",Re=function(){return this.toString()},Re.$$arity=-1),e.def(ze,"$unicode_normalized?",Ce=function(){return!0},Ce.$$arity=-1),e.def(ze,"$unpack",qe=function(){return this.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")},qe.$$arity=1),e.def(ze,"$unpack1",Me=function(){return this.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")},Me.$$arity=1)}(a[0],String,a),e.const_set(a[0],"Symbol",o(a,"String"))},Opal.modules["corelib/enumerable"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}e.top;var s=[],l=e.nil,u=e.const_get_qualified,c=e.const_get_relative,p=(e.breaker,e.slice,e.module),d=e.truthy,_=e.send,f=e.falsy,h=e.hash2,y=e.lambda;return e.add_stubs(["$each","$public_send","$destructure","$to_enum","$enumerator_size","$new","$yield","$raise","$slice_when","$!","$enum_for","$flatten","$map","$warn","$proc","$==","$nil?","$respond_to?","$coerce_to!","$>","$*","$coerce_to","$try_convert","$<","$+","$-","$ceil","$/","$size","$__send__","$length","$<=","$[]","$push","$<<","$[]=","$===","$inspect","$<=>","$first","$reverse","$sort","$to_proc","$compare","$call","$dup","$to_a","$sort!","$map!","$key?","$values","$zip"]),function(s,m){function g(e){return 0===e.length&&(e=[l]),e.length>1&&(e=[e]),e}var b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q,ee,te,re,ne,ae,ie,$e,oe,se,le,ue,ce,pe,de,_e=p(s,"Enumerable"),fe=[_e].concat(m);e.def(_e,"$all?",b=function(t){try{var r,n,a,i=b.$$p,$=i||l,o=this;return i&&(b.$$p=null),i&&(b.$$p=null),d(t!==undefined)?_(o,"each",[],((r=function(){r.$$s;var n=l;if(n=g(e.slice.call(arguments,0,arguments.length)),d(_(t,"public_send",["==="].concat(e.to_a(n)))))return l;e.ret(!1)}).$$s=o,r.$$arity=-1,r)):_(o,"each",[],$!==l?((n=function(){var t;n.$$s;if(t=e.slice.call(arguments,0,arguments.length),d(e.yieldX($,e.to_a(t))))return l;e.ret(!1)}).$$s=o,n.$$arity=-1,n):((a=function(){var t;a.$$s;if(t=e.slice.call(arguments,0,arguments.length),d(c(fe,"Opal").$destructure(t)))return l;e.ret(!1)}).$$s=o,a.$$arity=-1,a)),!0}catch(s){if(s===e.returner)return s.$v;throw s}},b.$$arity=-1),e.def(_e,"$any?",v=function(t){try{var r,n,a,i=v.$$p,$=i||l,o=this;return i&&(v.$$p=null),i&&(v.$$p=null),d(t!==undefined)?_(o,"each",[],((r=function(){r.$$s;var n=l;if(n=g(e.slice.call(arguments,0,arguments.length)),!d(_(t,"public_send",["==="].concat(e.to_a(n)))))return l;e.ret(!0)}).$$s=o,r.$$arity=-1,r)):_(o,"each",[],$!==l?((n=function(){var t;n.$$s;if(t=e.slice.call(arguments,0,arguments.length),!d(e.yieldX($,e.to_a(t))))return l;e.ret(!0)}).$$s=o,n.$$arity=-1,n):((a=function(){var t;a.$$s;if(t=e.slice.call(arguments,0,arguments.length),!d(c(fe,"Opal").$destructure(t)))return l;e.ret(!0)}).$$s=o,a.$$arity=-1,a)),!1}catch(s){if(s===e.returner)return s.$v;throw s}},v.$$arity=-1),e.def(_e,"$chunk",w=function(){var t,r,n=w.$$p,a=n||l,i=this;return n&&(w.$$p=null),n&&(w.$$p=null),a===l?_(i,"to_enum",["chunk"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=i,t.$$arity=0,t)):_(u("::","Enumerator"),"new",[],((r=function(t){function n(){o.length>0&&t.$yield($,o)}var i=r.$$s||this;null==t&&(t=l);var $=l,o=[];i.$each.$$p=function(t){var r=e.yield1(a,t);r===l?(n(),o=[],$=l):($===l||$===r?o.push(t):(n(),o=[t]),$=r)},i.$each(),n()}).$$s=i,r.$$arity=1,r))},w.$$arity=0),e.def(_e,"$chunk_while",k=function(){var t,r=k.$$p,n=r||l,a=this;return r&&(k.$$p=null),r&&(k.$$p=null),n!==l||a.$raise(c(fe,"ArgumentError"),"no block given"),_(a,"slice_when",[],((t=function(r,a){t.$$s;return null==r&&(r=l),null==a&&(a=l),e.yieldX(n,[r,a])["$!"]()}).$$s=a,t.$$arity=2,t))},k.$$arity=0),e.def(_e,"$collect",x=function(){var t,r=x.$$p,n=r||l,a=this;if(r&&(x.$$p=null),r&&(x.$$p=null),n===l)return _(a,"enum_for",["collect"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=a,t.$$arity=0,t));var i=[];return a.$each.$$p=function(){var t=e.yieldX(n,arguments);i.push(t)},a.$each(),i},x.$$arity=0),e.def(_e,"$collect_concat",E=function(){var t,r,n=E.$$p,a=n||l,i=this;return n&&(E.$$p=null),n&&(E.$$p=null),a===l?_(i,"enum_for",["collect_concat"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=i,t.$$arity=0,t)):_(i,"map",[],(r=function(t){r.$$s;return null==t&&(t=l),e.yield1(a,t)},r.$$s=i,r.$$arity=1,r)).$flatten(1)},E.$$arity=0),e.def(_e,"$count",O=function(t){var r,n,a,i=O.$$p,$=i||l,o=this,s=l;return i&&(O.$$p=null),i&&(O.$$p=null),s=0,null!=t&&$!==l&&o.$warn("warning: given block not used"),d(null!=t)?$=_(o,"proc",[],((r=function(){var n;r.$$s;return n=e.slice.call(arguments,0,arguments.length),c(fe,"Opal").$destructure(n)["$=="](t)}).$$s=o,r.$$arity=-1,r)):d($["$nil?"]())&&($=_(o,"proc",[],((n=function(){n.$$s;return!0}).$$s=o,n.$$arity=0,n))),_(o,"each",[],((a=function(){var t;a.$$s;return t=e.slice.call(arguments,0,arguments.length),d(e.yieldX($,t))?s++:l}).$$s=o,a.$$arity=-1,a)),s},O.$$arity=-1),e.def(_e,"$cycle",A=function(n){var a,i=A.$$p,$=i||l,o=this;if(i&&(A.$$p=null),i&&(A.$$p=null),null==n&&(n=l),$===l)return _(o,"enum_for",["cycle",n],((a=function(){var e=a.$$s||this;return d(n["$nil?"]())?d(e["$respond_to?"]("size"))?u(c(fe,"Float"),"INFINITY"):l:(n=c(fe,"Opal")["$coerce_to!"](n,c(fe,"Integer"),"to_int"),d(t(n,0))?r(e.$enumerator_size(),n):0)}).$$s=o,a.$$arity=0,a));if(d(n["$nil?"]()));else if(n=c(fe,"Opal")["$coerce_to!"](n,c(fe,"Integer"),"to_int"),d(n<=0))return l;var s,p,f,h=[];if(o.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments);e.yield1($,t);h.push(t)},o.$each(),s!==undefined)return s;if(0===h.length)return l;if(n===l)for(;;)for(p=0,f=h.length;p<f;p++)e.yield1($,h[p]);else for(;n>1;){for(p=0,f=h.length;p<f;p++)e.yield1($,h[p]);n--}},A.$$arity=-1),e.def(_e,"$detect",T=function(t){try{var r,n=T.$$p,a=n||l,i=this;return n&&(T.$$p=null),n&&(T.$$p=null),a===l?i.$enum_for("detect",t):(_(i,"each",[],((r=function(){r.$$s;var t,n=l;if(t=e.slice.call(arguments,0,arguments.length),n=c(fe,"Opal").$destructure(t),!d(e.yield1(a,n)))return l;e.ret(n)}).$$s=i,r.$$arity=-1,r)),t!==undefined?"function"==typeof t?t():t:l)}catch($){if($===e.returner)return $.$v;throw $}},T.$$arity=-1),e.def(_e,"$drop",S=function(e){var t=this;e=c(fe,"Opal").$coerce_to(e,c(fe,"Integer"),"to_int"),d(e<0)&&t.$raise(c(fe,"ArgumentError"),"attempt to drop negative size");var r=[],n=0;return t.$each.$$p=function(){e<=n&&r.push(c(fe,"Opal").$destructure(arguments)),n++},t.$each(),r},S.$$arity=1),e.def(_e,"$drop_while",I=function(){var t=I.$$p,r=t||l,n=this;if(t&&(I.$$p=null),t&&(I.$$p=null),r===l)return n.$enum_for("drop_while");var a=[],i=!0;return n.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments);if(i){var n=e.yield1(r,t);f(n)&&(i=!1,a.push(t))}else a.push(t)},n.$each(),a},I.$$arity=0),e.def(_e,"$each_cons",R=function(t){var r,$=R.$$p,o=$||l,s=this;if($&&(R.$$p=null),$&&(R.$$p=null),d(1!=arguments.length)&&s.$raise(c(fe,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),t=c(fe,"Opal").$try_convert(t,c(fe,"Integer"),"to_int"),d(t<=0)&&s.$raise(c(fe,"ArgumentError"),"invalid size"),o===l)return _(s,"enum_for",["each_cons",t],((r=function(){var e,$=r.$$s||this,o=l;return o=$.$enumerator_size(),d(o["$nil?"]())?l:d(d(e=o["$=="](0))?e:n(o,t))?0:a(i(o,t),1)}).$$s=s,r.$$arity=0,r));var u=[],p=l;return s.$each.$$p=function(){var r=c(fe,"Opal").$destructure(arguments);u.push(r),u.length>t&&u.shift(),u.length==t&&e.yield1(o,u.slice(0,t))},s.$each(),p},R.$$arity=1),e.def(_e,"$each_entry",C=function(){var t,r,n=C.$$p,a=n||l,i=this;return n&&(C.$$p=null),n&&(C.$$p=null),t=e.slice.call(arguments,0,arguments.length),a===l?_(i,"to_enum",["each_entry"].concat(e.to_a(t)),((r=function(){return(r.$$s||this).$enumerator_size()}).$$s=i,r.$$arity=0,r)):(i.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments);e.yield1(a,t)},i.$each.apply(i,t),i)},C.$$arity=-1),e.def(_e,"$each_slice",q=function(t){var r,n=q.$$p,a=n||l,i=this;if(n&&(q.$$p=null),n&&(q.$$p=null),t=c(fe,"Opal").$coerce_to(t,c(fe,"Integer"),"to_int"),d(t<=0)&&i.$raise(c(fe,"ArgumentError"),"invalid slice size"),a===l)return _(i,"enum_for",["each_slice",t],((r=function(){var e=r.$$s||this;return d(e["$respond_to?"]("size"))?$(e.$size(),t).$ceil():l}).$$s=i,r.$$arity=0,r));var o,s=[];return i.$each.$$p=function(){var r=c(fe,"Opal").$destructure(arguments);s.push(r),s.length===t&&(e.yield1(a,s),s=[])},i.$each(),o!==undefined?o:(s.length>0&&e.yield1(a,s),l)},q.$$arity=1),e.def(_e,"$each_with_index",M=function(){var t,r,n=M.$$p,a=n||l,i=this;if(n&&(M.$$p=null),n&&(M.$$p=null),t=e.slice.call(arguments,0,arguments.length),a===l)return _(i,"enum_for",["each_with_index"].concat(e.to_a(t)),((r=function(){return(r.$$s||this).$enumerator_size()}).$$s=i,r.$$arity=0,r));var $,o=0;return i.$each.$$p=function(){var e=c(fe,"Opal").$destructure(arguments);a(e,o),o++},i.$each.apply(i,t),$!==undefined?$:i},M.$$arity=-1),e.def(_e,"$each_with_object",z=function(e){var t,r,n=z.$$p,a=n||l,i=this;return n&&(z.$$p=null),n&&(z.$$p=null),a===l?_(i,"enum_for",["each_with_object",e],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=i,t.$$arity=0,t)):(i.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments);a(t,e)},i.$each(),r!==undefined?r:e)},z.$$arity=1),e.def(_e,"$entries",N=function(){var t,r=this;t=e.slice.call(arguments,0,arguments.length);var n=[];return r.$each.$$p=function(){n.push(c(fe,"Opal").$destructure(arguments))},r.$each.apply(r,t),n},N.$$arity=-1),e.alias(_e,"find","detect"),e.def(_e,"$find_all",j=function(){var t,r=j.$$p,n=r||l,a=this;if(r&&(j.$$p=null),r&&(j.$$p=null),n===l)return _(a,"enum_for",["find_all"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=a,t.$$arity=0,t));var i=[];return a.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments),r=e.yield1(n,t);d(r)&&i.push(t)},a.$each(),i},j.$$arity=0),e.def(_e,"$find_index",P=function(t){try{var r,n,a=P.$$p,i=a||l,$=this,o=l;return a&&(P.$$p=null),a&&(P.$$p=null),d(t===undefined&&i===l)?$.$enum_for("find_index"):(null!=t&&i!==l&&$.$warn("warning: given block not used"),o=0,d(null!=t)?_($,"each",[],((r=function(){var n;r.$$s;return n=e.slice.call(arguments,0,arguments.length),c(fe,"Opal").$destructure(n)["$=="](t)&&e.ret(o),o+=1}).$$s=$,r.$$arity=-1,r)):_($,"each",[],((n=function(){var t;n.$$s;return t=e.slice.call(arguments,0,arguments.length),d(e.yieldX(i,e.to_a(t)))&&e.ret(o),o+=1}).$$s=$,n.$$arity=-1,n)),l)}catch(s){if(s===e.returner)return s.$v;throw s}},P.$$arity=-1),e.def(_e,"$first",B=function(t){try{var r,n,a=this,i=l,$=l;return d(t===undefined)?_(a,"each",[],((r=function(t){r.$$s;null==t&&(t=l),e.ret(t)}).$$s=a,r.$$arity=1,r)):(i=[],t=c(fe,"Opal").$coerce_to(t,c(fe,"Integer"),"to_int"),d(t<0)&&a.$raise(c(fe,"ArgumentError"),"attempt to take negative size"),d(0==t)?[]:($=0,_(a,"each",[],((n=function(){var r;n.$$s;if(r=e.slice.call(arguments,0,arguments.length),i.push(c(fe,"Opal").$destructure(r)),!d(t<=++$))return l;e.ret(i)}).$$s=a,n.$$arity=-1,n)),i))}catch(o){if(o===e.returner)return o.$v;throw o}},B.$$arity=-1),e.alias(_e,"flat_map","collect_concat"),e.def(_e,"$grep",L=function(r){var n,a=L.$$p,i=a||l,$=this,s=l;return a&&(L.$$p=null),a&&(L.$$p=null),s=[],_($,"each",[],((n=function(){n.$$s;var a,$=l;return $=g(a=e.slice.call(arguments,0,arguments.length)),d(_(r,"__send__",["==="].concat(e.to_a($))))?(i!==l?(d(t(a.$length(),1))&&(a=[a]),a=e.yieldX(i,e.to_a(a))):d(o(a.$length(),1))&&(a=a["$[]"](0)),s.$push(a)):l}).$$s=$,n.$$arity=-1,n)),s},L.$$arity=1),e.def(_e,"$grep_v",D=function(r){var n,a=D.$$p,i=a||l,$=this,s=l;return a&&(D.$$p=null),a&&(D.$$p=null),s=[],_($,"each",[],((n=function(){n.$$s;var a,$=l;return $=g(a=e.slice.call(arguments,0,arguments.length)),d(_(r,"__send__",["==="].concat(e.to_a($))))?l:(i!==l?(d(t(a.$length(),1))&&(a=[a]),a=e.yieldX(i,e.to_a(a))):d(o(a.$length(),1))&&(a=a["$[]"](0)),s.$push(a))}).$$s=$,n.$$arity=-1,n)),s},D.$$arity=1),e.def(_e,"$group_by",G=function(){var t,r,n,a=G.$$p,$=a||l,o=this,s=l,u=l;return a&&(G.$$p=null),a&&(G.$$p=null),$===l?_(o,"enum_for",["group_by"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=o,t.$$arity=0,t)):(s=h([],{}),o.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments),n=e.yield1($,t);(d(r=s["$[]"](n))?r:(u=[n,[]],_(s,"[]=",e.to_a(u)),u[i(u.length,1)]))["$<<"](t)},o.$each(),n!==undefined?n:s)},G.$$arity=0),e.def(_e,"$include?",H=function(t){try{var r,n=this;return _(n,"each",[],((r=function(){var n;r.$$s;if(n=e.slice.call(arguments,0,arguments.length),!c(fe,"Opal").$destructure(n)["$=="](t))return l;e.ret(!0)}).$$s=n,r.$$arity=-1,r)),!1}catch(a){if(a===e.returner)return a.$v;throw a}},H.$$arity=1),e.def(_e,"$inject",F=function(t,r){var n=F.$$p,a=n||l,i=this;n&&(F.$$p=null),n&&(F.$$p=null);var $=t;return a!==l&&r===undefined?i.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments);$!==undefined?(t=e.yieldX(a,[$,t]),$=t):$=t}:(r===undefined&&(c(fe,"Symbol")["$==="](t)||i.$raise(c(fe,"TypeError"),t.$inspect()+" is not a Symbol"),r=t,$=undefined),i.$each.$$p=function(){var e=c(fe,"Opal").$destructure(arguments);$=$!==undefined?$.$__send__(r,e):e}),i.$each(),$==undefined?l:$},F.$$arity=-1),e.def(_e,"$lazy",U=function(){var t,r=this;return _(u(c(fe,"Enumerator"),"Lazy"),"new",[r,r.$enumerator_size()],((t=function(r){var n;t.$$s;return null==r&&(r=l),n=e.slice.call(arguments,1,arguments.length),_(r,"yield",e.to_a(n))}).$$s=r,t.$$arity=-2,t))},U.$$arity=0),e.def(_e,"$enumerator_size",K=function(){var e=this;return d(e["$respond_to?"]("size"))?e.$size():l},K.$$arity=0),e.alias(_e,"map","collect"),e.def(_e,"$max",Y=function(t){var r,n,a=Y.$$p,i=a||l,$=this;return a&&(Y.$$p=null),a&&(Y.$$p=null),t===undefined||t===l?($.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments);r!==undefined?((n=i!==l?e.yieldX(i,[t,r]):t["$<=>"](r))===l&&$.$raise(c(fe,"ArgumentError"),"comparison failed"),n>0&&(r=t)):r=t},$.$each(),r===undefined?l:r):(t=c(fe,"Opal").$coerce_to(t,c(fe,"Integer"),"to_int"),_($,"sort",[],i.$to_proc()).$reverse().$first(t))},Y.$$arity=-1),e.def(_e,"$max_by",V=function(){var t,r,n,a=V.$$p,i=a||l,$=this;return a&&(V.$$p=null),a&&(V.$$p=null),d(i)?($.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments),a=e.yield1(i,t);if(r===undefined)return r=t,void(n=a);a["$<=>"](n)>0&&(r=t,n=a)},$.$each(),r===undefined?l:r):_($,"enum_for",["max_by"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=$,t.$$arity=0,t))},V.$$arity=0),e.alias(_e,"member?","include?"),e.def(_e,"$min",W=function(){var e,t=W.$$p,r=t||l,n=this;return t&&(W.$$p=null),t&&(W.$$p=null),n.$each.$$p=r!==l?function(){var t=c(fe,"Opal").$destructure(arguments);if(e!==undefined){var a=r(t,e);a===l&&n.$raise(c(fe,"ArgumentError"),"comparison failed"),a<0&&(e=t)}else e=t}:function(){var t=c(fe,"Opal").$destructure(arguments);e!==undefined?c(fe,"Opal").$compare(t,e)<0&&(e=t):e=t},n.$each(),e===undefined?l:e},W.$$arity=0),e.def(_e,"$min_by",J=function(){var t,r,n,a=J.$$p,i=a||l,$=this;return a&&(J.$$p=null),a&&(J.$$p=null),d(i)?($.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments),a=e.yield1(i,t);if(r===undefined)return r=t,void(n=a);a["$<=>"](n)<0&&(r=t,n=a)},$.$each(),r===undefined?l:r):_($,"enum_for",["min_by"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=$,t.$$arity=0,t))},J.$$arity=0),e.def(_e,"$minmax",X=function(){var e,t,r=X.$$p,n=r||l,a=this;r&&(X.$$p=null),r&&(X.$$p=null),n=d(e=n)?e:_(a,"proc",[],((t=function(e,r){t.$$s;return null==e&&(e=l),null==r&&(r=l),e["$<=>"](r)}).$$s=a,t.$$arity=2,t));var i=l,$=l,o=!0;return a.$each.$$p=function(){var e=c(fe,"Opal").$destructure(arguments);if(o)i=$=e,o=!1;else{var t=n.$call(i,e);t===l?a.$raise(c(fe,"ArgumentError"),"comparison failed"):t>0&&(i=e);var r=n.$call($,e);r===l?a.$raise(c(fe,"ArgumentError"),"comparison failed"):r<0&&($=e)}},a.$each(),[i,$]},X.$$arity=0),e.def(_e,"$minmax_by",Z=function(){var e=Z.$$p,t=this;return e&&(Z.$$p=null),e&&(Z.$$p=null),t.$raise(c(fe,"NotImplementedError"))},Z.$$arity=0),e.def(_e,"$none?",Q=function(t){try{var r,n,a,i=Q.$$p,$=i||l,o=this;return i&&(Q.$$p=null),i&&(Q.$$p=null),d(t!==undefined)?_(o,"each",[],((r=function(){r.$$s;var n=l;if(n=g(e.slice.call(arguments,0,arguments.length)),!d(_(t,"public_send",["==="].concat(e.to_a(n)))))return l;e.ret(!1)}).$$s=o,r.$$arity=-1,r)):_(o,"each",[],$!==l?((n=function(){var t;n.$$s;if(t=e.slice.call(arguments,0,arguments.length),!d(e.yieldX($,e.to_a(t))))return l;e.ret(!1)}).$$s=o,n.$$arity=-1,n):((a=function(){a.$$s;var t,r=l;if(t=e.slice.call(arguments,0,arguments.length),r=c(fe,"Opal").$destructure(t),!d(r))return l;e.ret(!1)}).$$s=o,a.$$arity=-1,a)),!0}catch(s){if(s===e.returner)return s.$v;throw s}},Q.$$arity=-1),e.def(_e,"$one?",ee=function(r){try{var n,i,$,o=ee.$$p,s=o||l,u=this,p=l;return o&&(ee.$$p=null),o&&(ee.$$p=null),p=0,d(r!==undefined)?_(u,"each",[],((n=function(){n.$$s;var i=l;return i=g(e.slice.call(arguments,0,arguments.length)),d(_(r,"public_send",["==="].concat(e.to_a(i))))?(p=a(p,1),d(t(p,1))?void e.ret(!1):l):l}).$$s=u,n.$$arity=-1,n)):_(u,"each",[],s!==l?((i=function(){var r;i.$$s;return r=e.slice.call(arguments,0,arguments.length),d(e.yieldX(s,e.to_a(r)))?(p=a(p,1),d(t(p,1))?void e.ret(!1):l):l}).$$s=u,i.$$arity=-1,i):(($=function(){var r;$.$$s;return r=e.slice.call(arguments,0,arguments.length),d(c(fe,"Opal").$destructure(r))?(p=a(p,1),d(t(p,1))?void e.ret(!1):l):l}).$$s=u,$.$$arity=-1,$)),p["$=="](1)}catch(f){if(f===e.returner)return f.$v;throw f}},ee.$$arity=-1),e.def(_e,"$partition",te=function(){var t,r=te.$$p,n=r||l,a=this;if(r&&(te.$$p=null),r&&(te.$$p=null),n===l)return _(a,"enum_for",["partition"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=a,t.$$arity=0,t));var i=[],$=[];return a.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments),r=e.yield1(n,t);d(r)?i.push(t):$.push(t)},a.$each(),[i,$]},te.$$arity=0),e.alias(_e,"reduce","inject"),e.def(_e,"$reject",re=function(){var t,r=re.$$p,n=r||l,a=this;if(r&&(re.$$p=null),r&&(re.$$p=null),n===l)return _(a,"enum_for",["reject"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=a,t.$$arity=0,t));var i=[];return a.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments),r=e.yield1(n,t);f(r)&&i.push(t)},a.$each(),i},re.$$arity=0),e.def(_e,"$reverse_each",ne=function(){var t,r=ne.$$p,n=r||l,a=this;if(r&&(ne.$$p=null),r&&(ne.$$p=null),n===l)return _(a,"enum_for",["reverse_each"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=a,t.$$arity=0,t));var i=[];a.$each.$$p=function(){i.push(arguments)},a.$each();for(var $=i.length-1;$>=0;$--)e.yieldX(n,i[$]);return i},ne.$$arity=0),e.alias(_e,"select","find_all"),e.def(_e,"$slice_before",ae=function(t){var r,n=ae.$$p,a=n||l,i=this;return n&&(ae.$$p=null),n&&(ae.$$p=null),d(t===undefined&&a===l)&&i.$raise(c(fe,"ArgumentError"),"both pattern and block are given"),d(t!==undefined&&a!==l||arguments.length>1)&&i.$raise(c(fe,"ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),_(c(fe,"Enumerator"),"new",[],((r=function(n){var i=r.$$s||this;null==n&&(n=l);var $=[];a!==l?t===undefined?i.$each.$$p=function(){var t=c(fe,"Opal").$destructure(arguments),r=e.yield1(a,t);d(r)&&$.length>0&&(n["$<<"]($),$=[]),$.push(t)}:i.$each.$$p=function(){var e=c(fe,"Opal").$destructure(arguments),r=a(e,t.$dup());d(r)&&$.length>0&&(n["$<<"]($),$=[]),$.push(e)}:i.$each.$$p=function(){var e=c(fe,"Opal").$destructure(arguments),r=t["$==="](e);d(r)&&$.length>0&&(n["$<<"]($),$=[]),$.push(e)},i.$each(),$.length>0&&n["$<<"]($)}).$$s=i,r.$$arity=1,r))},ae.$$arity=-1),e.def(_e,"$slice_after",ie=function(t){var r,n,a=ie.$$p,i=a||l,$=this;return a&&(ie.$$p=null),a&&(ie.$$p=null),
d(t===undefined&&i===l)&&$.$raise(c(fe,"ArgumentError"),"both pattern and block are given"),d(t!==undefined&&i!==l||arguments.length>1)&&$.$raise(c(fe,"ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),d(t!==undefined)&&(i=_($,"proc",[],((r=function(e){r.$$s;return null==e&&(e=l),t["$==="](e)}).$$s=$,r.$$arity=1,r))),_(c(fe,"Enumerator"),"new",[],((n=function(t){var r,a=n.$$s||this;null==t&&(t=l),a.$each.$$p=function(){var n=c(fe,"Opal").$destructure(arguments),a=e.yield1(i,n);null==r&&(r=[]),d(a)?(r.push(n),t.$yield(r),r=null):r.push(n)},a.$each(),null!=r&&t.$yield(r)}).$$s=$,n.$$arity=1,n))},ie.$$arity=-1),e.def(_e,"$slice_when",$e=function(){var t,r=$e.$$p,n=r||l,a=this;return r&&($e.$$p=null),r&&($e.$$p=null),n!==l||a.$raise(c(fe,"ArgumentError"),"wrong number of arguments (0 for 1)"),_(c(fe,"Enumerator"),"new",[],((t=function(r){var a=t.$$s||this;null==r&&(r=l);var i=l,$=l;a.$each_cons.$$p=function(){var t=c(fe,"Opal").$destructure(arguments),a=t[0],o=t[1],s=e.yieldX(n,[a,o]);$=o,i===l&&(i=[]),d(s)?(i.push(a),r.$yield(i),i=[]):i.push(a)},a.$each_cons(2),i!==l&&(i.push($),r.$yield(i))}).$$s=a,t.$$arity=1,t))},$e.$$arity=0),e.def(_e,"$sort",oe=function(){var e,t=oe.$$p,r=t||l,n=this,a=l;return t&&(oe.$$p=null),t&&(oe.$$p=null),a=n.$to_a(),r!==l||(r=y(((e=function(t,r){e.$$s;return null==t&&(t=l),null==r&&(r=l),t["$<=>"](r)}).$$s=n,e.$$arity=2,e))),_(a,"sort",[],r.$to_proc())},oe.$$arity=0),e.def(_e,"$sort_by",se=function(){var t,r,n,a,i=se.$$p,$=i||l,o=this,s=l;return i&&(se.$$p=null),i&&(se.$$p=null),$===l?_(o,"enum_for",["sort_by"],((t=function(){return(t.$$s||this).$enumerator_size()}).$$s=o,t.$$arity=0,t)):(s=_(o,"map",[],((r=function(){r.$$s;var t=l;return t=c(fe,"Opal").$destructure(arguments),[e.yield1($,t),t]}).$$s=o,r.$$arity=0,r)),_(s,"sort!",[],((n=function(e,t){n.$$s;return null==e&&(e=l),null==t&&(t=l),e[0]["$<=>"](t[0])}).$$s=o,n.$$arity=2,n)),_(s,"map!",[],((a=function(e){a.$$s;return null==e&&(e=l),e[1]}).$$s=o,a.$$arity=1,a)))},se.$$arity=0),e.def(_e,"$sum",le=function(t){var r,n=le.$$p,i=n||l,$=this,o=l;return n&&(le.$$p=null),null==t&&(t=0),o=t,_($,"each",[],((r=function(){r.$$s;var t,n,$=l;return t=e.slice.call(arguments,0,arguments.length),n=t,$=i!==l?e.yieldX(i,e.to_a(n)):c(fe,"Opal").$destructure(n),o=a(o,$)}).$$s=$,r.$$arity=-1,r)),o},le.$$arity=-1),e.def(_e,"$take",ue=function(e){return this.$first(e)},ue.$$arity=1),e.def(_e,"$take_while",ce=function(){try{var t,r=ce.$$p,n=r||l,a=this,i=l;return r&&(ce.$$p=null),r&&(ce.$$p=null),d(n)?(i=[],_(a,"each",[],((t=function(){t.$$s;var r,a=l;return r=e.slice.call(arguments,0,arguments.length),a=c(fe,"Opal").$destructure(r),d(e.yield1(n,a))||e.ret(i),i.push(a)}).$$s=a,t.$$arity=-1,t))):a.$enum_for("take_while")}catch($){if($===e.returner)return $.$v;throw $}},ce.$$arity=0),e.def(_e,"$uniq",pe=function(){var t,r=pe.$$p,n=r||l,a=this,$=l;return r&&(pe.$$p=null),r&&(pe.$$p=null),$=h([],{}),_(a,"each",[],((t=function(){t.$$s;var r,a=l,o=l,s=l;return r=e.slice.call(arguments,0,arguments.length),a=c(fe,"Opal").$destructure(r),o=n!==l?e.yield1(n,a):a,d($["$key?"](o))?l:(s=[o,a],_($,"[]=",e.to_a(s)),s[i(s.length,1)])}).$$s=a,t.$$arity=-1,t)),$.$values()},pe.$$arity=0),e.alias(_e,"to_a","entries"),e.def(_e,"$zip",de=function(){var t,r=de.$$p,n=this;return r&&(de.$$p=null),r&&(de.$$p=null),t=e.slice.call(arguments,0,arguments.length),_(n.$to_a(),"zip",e.to_a(t))},de.$$arity=-1)}(s[0],s)},Opal.modules["corelib/enumerator"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var n=e.top,a=[],i=e.nil,$=(e.const_get_qualified,e.const_get_relative),o=e.breaker,s=e.slice,l=e.klass,u=e.truthy,c=e.send,p=e.falsy;return e.add_stubs(["$require","$include","$allocate","$new","$to_proc","$coerce_to","$nil?","$empty?","$+","$class","$__send__","$===","$call","$enum_for","$size","$destructure","$inspect","$any?","$[]","$raise","$yield","$each","$enumerator_size","$respond_to?","$try_convert","$<","$for"]),n.$require("corelib/enumerable"),function(n,$super,a){var d,_,f,h,y,m,g=l(n,null,"Enumerator"),b=[g].concat(a);return g.$$prototype.size=g.$$prototype.args=g.$$prototype.object=g.$$prototype.method=i,g.$include($(b,"Enumerable")),g.$$prototype.$$is_enumerator=!0,e.defs(g,"$for",d=function(t){var r,n,a,$=d.$$p,o=$||i,s=this;$&&(d.$$p=null),$&&(d.$$p=null),(r=e.slice.call(arguments,1,arguments.length)).length>0&&(n=r[0],r.splice(0,1)),null==n&&(n="each"),a=r;var l=s.$allocate();return l.object=t,l.size=o,l.method=n,l.args=a,l},d.$$arity=-2),e.def(g,"$initialize",_=function(){var t=_.$$p,r=t||i,n=this;return t&&(_.$$p=null),t&&(_.$$p=null),e.slice.call(arguments,0,arguments.length),u(r)?(n.object=c($(b,"Generator"),"new",[],r.$to_proc()),n.method="each",n.args=[],n.size=arguments[0]||i,u(n.size)?n.size=$(b,"Opal").$coerce_to(n.size,$(b,"Integer"),"to_int"):i):(n.object=arguments[0],n.method=arguments[1]||"each",n.args=s.call(arguments,2),n.size=i)},_.$$arity=-1),e.def(g,"$each",f=function(){var r,n,a=f.$$p,$=a||i,o=this;return a&&(f.$$p=null),a&&(f.$$p=null),r=e.slice.call(arguments,0,arguments.length),u(u(n=$["$nil?"]())?r["$empty?"]():n)?o:(r=t(o.args,r),u($["$nil?"]())?c(o.$class(),"new",[o.object,o.method].concat(e.to_a(r))):c(o.object,"__send__",[o.method].concat(e.to_a(r)),$.$to_proc()))},f.$$arity=-1),e.def(g,"$size",h=function(){var t=this;return u($(b,"Proc")["$==="](t.size))?c(t.size,"call",e.to_a(t.args)):t.size},h.$$arity=0),e.def(g,"$with_index",y=function(e){var t,r=y.$$p,n=r||i,a=this;if(r&&(y.$$p=null),r&&(y.$$p=null),null==e&&(e=0),e=u(e)?$(b,"Opal").$coerce_to(e,$(b,"Integer"),"to_int"):0,!u(n))return c(a,"enum_for",["with_index",e],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));var o=e;return a.$each.$$p=function(){var e=$(b,"Opal").$destructure(arguments),t=n(e,o);return o++,t},a.$each()},y.$$arity=-1),e.alias(g,"with_object","each_with_object"),e.def(g,"$inspect",m=function(){var e=this,r=i;return r="#<"+e.$class()+": "+e.object.$inspect()+":"+e.method,u(e.args["$any?"]())&&(r=t(r,"("+e.args.$inspect()["$[]"]($(b,"Range").$new(1,-2))+")")),t(r,">")},m.$$arity=0),function(t,$super,r){var n,a,s=l(t,null,"Generator"),p=[s].concat(r);s.$$prototype.block=i,s.$include($(p,"Enumerable")),e.def(s,"$initialize",n=function(){var e=n.$$p,t=e||i,r=this;return e&&(n.$$p=null),e&&(n.$$p=null),u(t)||r.$raise($(p,"LocalJumpError"),"no block given"),r.block=t},n.$$arity=0),e.def(s,"$each",a=function(){var t,r=a.$$p,n=r||i,s=this,l=i;r&&(a.$$p=null),r&&(a.$$p=null),t=e.slice.call(arguments,0,arguments.length),l=c($(p,"Yielder"),"new",[],n.$to_proc());try{t.unshift(l),e.yieldX(s.block,t)}catch(u){if(u===o)return o.$v;throw u}return s},a.$$arity=-1)}(b[0],0,b),function(t,$super,r){var n,a,$,s=l(t,null,"Yielder");[s].concat(r);s.$$prototype.block=i,e.def(s,"$initialize",n=function(){var e=n.$$p,t=e||i,r=this;return e&&(n.$$p=null),e&&(n.$$p=null),r.block=t},n.$$arity=0),e.def(s,"$yield",a=function(){var t,r=this;t=e.slice.call(arguments,0,arguments.length);var n=e.yieldX(r.block,t);if(n===o)throw o;return n},a.$$arity=-1),e.def(s,"$<<",$=function(){var t,r=this;return t=e.slice.call(arguments,0,arguments.length),c(r,"yield",e.to_a(t)),r},$.$$arity=-1)}(b[0],0,b),function(n,$super,a){var o,s,d,_,f,h,y,m,g,b,v,w,k,x=l(n,$super,"Lazy"),E=[x].concat(a);return x.$$prototype.enumerator=i,function(e,$super,t){[l(e,$super,"StopLazyError")].concat(t)}(E[0],$(E,"Exception"),E),e.def(x,"$initialize",o=function(t,r){var n,a=o.$$p,s=a||i,l=this;return a&&(o.$$p=null),a&&(o.$$p=null),null==r&&(r=i),s!==i||l.$raise($(E,"ArgumentError"),"tried to call lazy new without a block"),l.enumerator=t,c(l,e.find_super_dispatcher(l,"initialize",o,!1),[r],((n=function(r){var a,o,l=n.$$s||this;null==r&&(r=i),a=e.slice.call(arguments,1,arguments.length);try{return c(t,"each",e.to_a(a),((o=function(){var t;o.$$s;(t=e.slice.call(arguments,0,arguments.length)).unshift(r),e.yieldX(s,t)}).$$s=l,o.$$arity=-1,o))}catch(u){if(!e.rescue(u,[$(E,"Exception")]))throw u;try{return i}finally{e.pop_exception()}}}).$$s=l,n.$$arity=-2,n))},o.$$arity=-2),e.alias(x,"force","to_a"),e.def(x,"$lazy",s=function(){return this},s.$$arity=0),e.def(x,"$collect",d=function(){var t,r=d.$$p,n=r||i,a=this;return r&&(d.$$p=null),r&&(d.$$p=null),u(n)||a.$raise($(E,"ArgumentError"),"tried to call lazy map without a block"),c($(E,"Lazy"),"new",[a,a.$enumerator_size()],((t=function(r){var a;t.$$s;null==r&&(r=i),a=e.slice.call(arguments,1,arguments.length);var $=e.yieldX(n,a);r.$yield($)}).$$s=a,t.$$arity=-2,t))},d.$$arity=0),e.def(x,"$collect_concat",_=function(){var t,r=_.$$p,n=r||i,a=this;return r&&(_.$$p=null),r&&(_.$$p=null),u(n)||a.$raise($(E,"ArgumentError"),"tried to call lazy map without a block"),c($(E,"Lazy"),"new",[a,i],((t=function(r){var a,o,s,l=t.$$s||this;null==r&&(r=i),a=e.slice.call(arguments,1,arguments.length);var u=e.yieldX(n,a);u["$respond_to?"]("force")&&u["$respond_to?"]("each")?c(u,"each",[],((o=function(e){o.$$s;return null==e&&(e=i),r.$yield(e)}).$$s=l,o.$$arity=1,o)):$(E,"Opal").$try_convert(u,$(E,"Array"),"to_ary")===i?r.$yield(u):c(u,"each",[],((s=function(e){s.$$s;return null==e&&(e=i),r.$yield(e)}).$$s=l,s.$$arity=1,s))}).$$s=a,t.$$arity=-2,t))},_.$$arity=0),e.def(x,"$drop",f=function(n){var a,o=this,s=i,l=i,p=i;return n=$(E,"Opal").$coerce_to(n,$(E,"Integer"),"to_int"),u(r(n,0))&&o.$raise($(E,"ArgumentError"),"attempt to drop negative size"),s=o.$enumerator_size(),l=u($(E,"Integer")["$==="](s))&&u(r(n,s))?n:s,p=0,c($(E,"Lazy"),"new",[o,l],((a=function($){var o;a.$$s;return null==$&&($=i),o=e.slice.call(arguments,1,arguments.length),u(r(p,n))?p=t(p,1):c($,"yield",e.to_a(o))}).$$s=o,a.$$arity=-2,a))},f.$$arity=1),e.def(x,"$drop_while",h=function(){var t,r=h.$$p,n=r||i,a=this,o=i;return r&&(h.$$p=null),r&&(h.$$p=null),u(n)||a.$raise($(E,"ArgumentError"),"tried to call lazy drop_while without a block"),o=!0,c($(E,"Lazy"),"new",[a,i],((t=function(r){var a;t.$$s;if(null==r&&(r=i),a=e.slice.call(arguments,1,arguments.length),!u(o))return c(r,"yield",e.to_a(a));var $=e.yieldX(n,a);p($)&&(o=!1,c(r,"yield",e.to_a(a)))}).$$s=a,t.$$arity=-2,t))},h.$$arity=0),e.def(x,"$enum_for",y=function(){var t,r,n,a=y.$$p,$=a||i,o=this;return a&&(y.$$p=null),a&&(y.$$p=null),(t=e.slice.call(arguments,0,arguments.length)).length>0&&(r=t[0],t.splice(0,1)),null==r&&(r="each"),n=t,c(o.$class(),"for",[o,r].concat(e.to_a(n)),$.$to_proc())},y.$$arity=-1),e.def(x,"$find_all",m=function(){var t,r=m.$$p,n=r||i,a=this;return r&&(m.$$p=null),r&&(m.$$p=null),u(n)||a.$raise($(E,"ArgumentError"),"tried to call lazy select without a block"),c($(E,"Lazy"),"new",[a,i],((t=function(r){var a;t.$$s;null==r&&(r=i),a=e.slice.call(arguments,1,arguments.length);var $=e.yieldX(n,a);u($)&&c(r,"yield",e.to_a(a))}).$$s=a,t.$$arity=-2,t))},m.$$arity=0),e.alias(x,"flat_map","collect_concat"),e.def(x,"$grep",g=function(t){var r,n,a=g.$$p,o=a||i,s=this;return a&&(g.$$p=null),a&&(g.$$p=null),u(o)?c($(E,"Lazy"),"new",[s,i],((r=function(n){var a;r.$$s;null==n&&(n=i),a=e.slice.call(arguments,1,arguments.length);var s=$(E,"Opal").$destructure(a),l=t["$==="](s);u(l)&&(l=e.yield1(o,s),n.$yield(e.yield1(o,s)))}).$$s=s,r.$$arity=-2,r)):c($(E,"Lazy"),"new",[s,i],((n=function(r){var a;n.$$s;null==r&&(r=i),a=e.slice.call(arguments,1,arguments.length);var o=$(E,"Opal").$destructure(a),s=t["$==="](o);u(s)&&r.$yield(o)}).$$s=s,n.$$arity=-2,n))},g.$$arity=1),e.alias(x,"map","collect"),e.alias(x,"select","find_all"),e.def(x,"$reject",b=function(){var t,r=b.$$p,n=r||i,a=this;return r&&(b.$$p=null),r&&(b.$$p=null),u(n)||a.$raise($(E,"ArgumentError"),"tried to call lazy reject without a block"),c($(E,"Lazy"),"new",[a,i],((t=function(r){var a;t.$$s;null==r&&(r=i),a=e.slice.call(arguments,1,arguments.length);var $=e.yieldX(n,a);p($)&&c(r,"yield",e.to_a(a))}).$$s=a,t.$$arity=-2,t))},b.$$arity=0),e.def(x,"$take",v=function(n){var a,o=this,s=i,l=i,p=i;return n=$(E,"Opal").$coerce_to(n,$(E,"Integer"),"to_int"),u(r(n,0))&&o.$raise($(E,"ArgumentError"),"attempt to take negative size"),s=o.$enumerator_size(),l=u($(E,"Integer")["$==="](s))&&u(r(n,s))?n:s,p=0,c($(E,"Lazy"),"new",[o,l],((a=function(o){var s,l=a.$$s||this;return null==o&&(o=i),s=e.slice.call(arguments,1,arguments.length),u(r(p,n))?(c(o,"yield",e.to_a(s)),p=t(p,1)):l.$raise($(E,"StopLazyError"))}).$$s=o,a.$$arity=-2,a))},v.$$arity=1),e.def(x,"$take_while",w=function(){var t,r=w.$$p,n=r||i,a=this;return r&&(w.$$p=null),r&&(w.$$p=null),u(n)||a.$raise($(E,"ArgumentError"),"tried to call lazy take_while without a block"),c($(E,"Lazy"),"new",[a,i],((t=function(r){var a,o=t.$$s||this;null==r&&(r=i),a=e.slice.call(arguments,1,arguments.length);var s=e.yieldX(n,a);u(s)?c(r,"yield",e.to_a(a)):o.$raise($(E,"StopLazyError"))}).$$s=a,t.$$arity=-2,t))},w.$$arity=0),e.alias(x,"to_enum","enum_for"),e.def(x,"$inspect",k=function(){var e=this;return"#<"+e.$class()+": "+e.enumerator.$inspect()+">"},k.$$arity=0),i&&"inspect"}(b[0],g,b)}(a[0],0,a)},Opal.modules["corelib/numeric"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var $=e.top,o=[],s=e.nil,l=e.const_get_qualified,u=e.const_get_relative,c=(e.breaker,e.slice,e.klass),p=e.truthy,d=e.hash2;return e.add_stubs(["$require","$include","$instance_of?","$class","$Float","$respond_to?","$coerce","$__send__","$===","$raise","$equal?","$-","$*","$div","$<","$-@","$ceil","$to_f","$denominator","$to_r","$==","$floor","$/","$%","$Complex","$zero?","$numerator","$abs","$arg","$coerce_to!","$round","$to_i","$truncate","$>"]),$.$require("corelib/comparable"),function($,$super,o){var _,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X=c($,null,"Numeric"),Z=[X].concat(o);return X.$include(u(Z,"Comparable")),e.def(X,"$coerce",_=function(e){var t=this;return p(e["$instance_of?"](t.$class()))?[e,t]:[t.$Float(e),t.$Float(t)]},_.$$arity=1),e.def(X,"$__coerced__",f=function(t,r){var n,a,i=this,$=s,o=s,l=s;return p(r["$respond_to?"]("coerce"))?(a=r.$coerce(i),$=null==(n=e.to_ary(a))[0]?s:n[0],o=null==n[1]?s:n[1],$.$__send__(t,o)):(l=t,"+"["$==="](l)||"-"["$==="](l)||"*"["$==="](l)||"/"["$==="](l)||"%"["$==="](l)||"&"["$==="](l)||"|"["$==="](l)||"^"["$==="](l)||"**"["$==="](l)?i.$raise(u(Z,"TypeError"),r.$class()+" can't be coerced into Numeric"):">"["$==="](l)||">="["$==="](l)||"<"["$==="](l)||"<="["$==="](l)||"<=>"["$==="](l)?i.$raise(u(Z,"ArgumentError"),"comparison of "+i.$class()+" with "+r.$class()+" failed"):s)},f.$$arity=2),e.def(X,"$<=>",h=function(e){return p(this["$equal?"](e))?0:s},h.$$arity=1),e.def(X,"$+@",y=function(){return this},y.$$arity=0),e.def(X,"$-@",m=function(){return t(0,this)},m.$$arity=0),e.def(X,"$%",g=function(e){var n=this;return t(n,r(e,n.$div(e)))},g.$$arity=1),e.def(X,"$abs",b=function(){var e=this;return n(e,0)?e["$-@"]():e},b.$$arity=0),e.def(X,"$abs2",v=function(){var e=this;return r(e,e)},v.$$arity=0),e.def(X,"$angle",w=function(){return n(this,0)?l(u(Z,"Math"),"PI"):0},w.$$arity=0),e.alias(X,"arg","angle"),e.def(X,"$ceil",k=function(e){return null==e&&(e=0),this.$to_f().$ceil(e)},k.$$arity=-1),e.def(X,"$conj",x=function(){return this},x.$$arity=0),e.alias(X,"conjugate","conj"),e.def(X,"$denominator",E=function(){return this.$to_r().$denominator()},E.$$arity=0),e.def(X,"$div",O=function(e){var t=this;return e["$=="](0)&&t.$raise(u(Z,"ZeroDivisionError"),"divided by o"),a(t,e).$floor()},O.$$arity=1),e.def(X,"$divmod",A=function(e){var t=this;return[t.$div(e),t["$%"](e)]},A.$$arity=1),e.def(X,"$fdiv",T=function(e){return a(this.$to_f(),e)},T.$$arity=1),e.def(X,"$floor",S=function(e){return null==e&&(e=0),this.$to_f().$floor(e)},S.$$arity=-1),e.def(X,"$i",I=function(){var e=this;return e.$Complex(0,e)},I.$$arity=0),e.def(X,"$imag",R=function(){return 0},R.$$arity=0),e.alias(X,"imaginary","imag"),e.def(X,"$integer?",C=function(){return!1},C.$$arity=0),e.alias(X,"magnitude","abs"),e.alias(X,"modulo","%"),e.def(X,"$nonzero?",q=function(){var e=this;return p(e["$zero?"]())?s:e},q.$$arity=0),e.def(X,"$numerator",M=function(){return this.$to_r().$numerator()},M.$$arity=0),e.alias(X,"phase","arg"),e.def(X,"$polar",z=function(){var e=this;return[e.$abs(),e.$arg()]},z.$$arity=0),e.def(X,"$quo",N=function(e){var t=this;return a(u(Z,"Opal")["$coerce_to!"](t,u(Z,"Rational"),"to_r"),e)},N.$$arity=1),e.def(X,"$real",j=function(){return this},j.$$arity=0),e.def(X,"$real?",P=function(){return!0},P.$$arity=0),e.def(X,"$rect",B=function(){return[this,0]},B.$$arity=0),e.alias(X,"rectangular","rect"),e.def(X,"$round",L=function(e){return this.$to_f().$round(e)},L.$$arity=-1),e.def(X,"$to_c",D=function(){var e=this;return e.$Complex(e,0)},D.$$arity=0),e.def(X,"$to_int",G=function(){return this.$to_i()},G.$$arity=0),e.def(X,"$truncate",H=function(e){return null==e&&(e=0),this.$to_f().$truncate(e)},H.$$arity=-1),e.def(X,"$zero?",F=function(){return this["$=="](0)},F.$$arity=0),e.def(X,"$positive?",U=function(){return i(this,0)},U.$$arity=0),e.def(X,"$negative?",K=function(){return n(this,0)},K.$$arity=0),e.def(X,"$dup",Y=function(){return this},Y.$$arity=0),e.def(X,"$clone",V=function(t){var r=this;if(null==t)t=d([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==t.$$smap.freeze&&!0,r},V.$$arity=-1),e.def(X,"$finite?",W=function(){return!0},W.$$arity=0),e.def(X,"$infinite?",J=function(){return s},J.$$arity=0),s&&"infinite?"}(o[0],0,o)},Opal.modules["corelib/array"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var $=e.top,o=[],s=e.nil,l=e.const_get_qualified,u=e.const_get_relative,c=(e.breaker,e.slice,e.klass),p=e.truthy,d=e.hash2,_=e.send,f=e.gvars;return e.add_stubs(["$require","$include","$to_a","$warn","$raise","$replace","$respond_to?","$to_ary","$coerce_to","$coerce_to?","$===","$join","$to_str","$class","$hash","$<=>","$==","$object_id","$inspect","$enum_for","$bsearch_index","$to_proc","$nil?","$coerce_to!","$>","$*","$enumerator_size","$empty?","$size","$map","$equal?","$dup","$each","$[]","$dig","$eql?","$length","$begin","$end","$exclude_end?","$flatten","$__id__","$to_s","$new","$max","$min","$!","$>=","$**","$delete_if","$reverse","$rotate","$rand","$at","$keep_if","$shuffle!","$<","$sort","$sort_by","$!=","$times","$[]=","$-","$<<","$values","$is_a?","$last","$first","$upto","$reject","$pristine","$singleton_class"]),$.$require("corelib/enumerable"),$.$require("corelib/numeric"),function($,$super,o){function h(t,r){return r.$$name===e.Array?t:r.$allocate().$replace(t.$to_a())}function y(t,r){var n,a,i,$=t.length;return n=r.excl,a=e.Opal.$coerce_to(r.begin,e.Integer,"to_int"),i=e.Opal.$coerce_to(r.end,e.Integer,"to_int"),a<0&&(a+=$)<0?s:a>$?s:i<0&&(i+=$)<0?[]:(n||(i+=1),h(t.slice(a,i),t.$class()))}function m(t,r,n){var a=t.length;return(r=e.Opal.$coerce_to(r,e.Integer,"to_int"))<0&&(r+=a)<0?s:n===undefined?r>=a||r<0?s:t[r]:(n=e.Opal.$coerce_to(n,e.Integer,"to_int"))<0||r>a||r<0?s:h(t.slice(r,r+n),t.$class())}function g(e,t){return e===t||0===t?1:t>0&&e>t?g(e-1,t-1)+g(e-1,t):0}function b(e,t){for(var r=t>=0?1:0;t;)r*=e,e--,t--;return r}var v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q,ee,te,re,ne,ae,ie,$e,oe,se,le,ue,ce,pe,de,_e,fe,he,ye,me,ge,be,ve,we,ke,xe,Ee,Oe,Ae,Te,Se,Ie,Re,Ce,qe,Me,ze,Ne,je,Pe,Be,Le,De,Ge,He,Fe,Ue,Ke,Ye,Ve,We,Je,Xe,Ze,Qe,et,tt,rt,nt,at,it,$t=c($,$super,"Array"),ot=[$t].concat(o);return $t.$include(u(ot,"Enumerable")),e.defineProperty($t.$$prototype,"$$is_array",!0),e.defs($t,"$[]",v=function(){var t=this;return h(e.slice.call(arguments,0,arguments.length),t)},v.$$arity=-1),e.def($t,"$initialize",w=function(e,t){var r,n,a=w.$$p,i=a||s,$=this;if(a&&(w.$$p=null),a&&(w.$$p=null),null==e&&(e=s),null==t&&(t=s),t!==s&&i!==s&&$.$warn("warning: block supersedes default value argument"),e>l(u(ot,"Integer"),"MAX")&&$.$raise(u(ot,"ArgumentError"),"array size too big"),arguments.length>2&&$.$raise(u(ot,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return $.splice(0,$.length),$;if(1===arguments.length){if(e.$$is_array)return $.$replace(e.$to_a()),$;if(e["$respond_to?"]("to_ary"))return $.$replace(e.$to_ary()),$}if((e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"))<0&&$.$raise(u(ot,"ArgumentError"),"negative array size"),$.splice(0,$.length),i===s)for(r=0;r<e;r++)$.push(t);else for(r=0;r<e;r++)n=i(r),$[r]=n;return $},w.$$arity=-1),e.defs($t,"$try_convert",k=function(e){return u(ot,"Opal")["$coerce_to?"](e,u(ot,"Array"),"to_ary")},k.$$arity=1),e.def($t,"$&",x=function(t){var r=this;t=p(u(ot,"Array")["$==="](t))?t.$to_a():u(ot,"Opal").$coerce_to(t,u(ot,"Array"),"to_ary").$to_a();var n,a,i,$=[],o=d([],{});for(n=0,a=t.length;n<a;n++)e.hash_put(o,t[n],!0);for(n=0,a=r.length;n<a;n++)i=r[n],e.hash_delete(o,i)!==undefined&&$.push(i);return $},x.$$arity=1),e.def($t,"$|",E=function(t){var r=this;t=p(u(ot,"Array")["$==="](t))?t.$to_a():u(ot,"Opal").$coerce_to(t,u(ot,"Array"),"to_ary").$to_a();var n,a,i=d([],{});for(n=0,a=r.length;n<a;n++)e.hash_put(i,r[n],!0);for(n=0,a=t.length;n<a;n++)e.hash_put(i,t[n],!0);return i.$keys()},E.$$arity=1),e.def($t,"$*",O=function(e){var t=this;if(p(e["$respond_to?"]("to_str")))return t.$join(e.$to_str());e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),p(e<0)&&t.$raise(u(ot,"ArgumentError"),"negative argument");for(var r=[],n=t.$to_a(),a=0;a<e;a++)r=r.concat(n);return h(r,t.$class())},O.$$arity=1),e.def($t,"$+",A=function(e){var t=this;return e=p(u(ot,"Array")["$==="](e))?e.$to_a():u(ot,"Opal").$coerce_to(e,u(ot,"Array"),"to_ary").$to_a(),t.concat(e)},A.$$arity=1),e.def($t,"$-",T=function(t){var r=this;if(t=p(u(ot,"Array")["$==="](t))?t.$to_a():u(ot,"Opal").$coerce_to(t,u(ot,"Array"),"to_ary").$to_a(),p(0===r.length))return[];if(p(0===t.length))return r.slice();var n,a,i,$=[],o=d([],{});for(n=0,a=t.length;n<a;n++)e.hash_put(o,t[n],!0);for(n=0,a=r.length;n<a;n++)i=r[n],e.hash_get(o,i)===undefined&&$.push(i);return $},T.$$arity=1),e.def($t,"$<<",S=function(e){var t=this;return t.push(e),t},S.$$arity=1),e.def($t,"$<=>",I=function(e){var t=this;if(p(u(ot,"Array")["$==="](e)))e=e.$to_a();else{if(!p(e["$respond_to?"]("to_ary")))return s;e=e.$to_ary().$to_a()}if(t.$hash()===e.$hash())return 0;for(var r=Math.min(t.length,e.length),n=0;n<r;n++){var a=t[n]["$<=>"](e[n]);if(0!==a)return a}return t.length["$<=>"](e.length)},I.$$arity=1),e.def($t,"$==",R=function(e){function t(e,n){var a,i,$,o;if(e===n)return!0;if(!n.$$is_array)return!!u(ot,"Opal")["$respond_to?"](n,"to_ary")&&n["$=="](e);if(e.$$constructor!==Array&&(e=e.$to_a()),n.$$constructor!==Array&&(n=n.$to_a()),e.length!==n.length)return!1;for(r[e.$object_id()]=!0,a=0,i=e.length;a<i;a++)if($=e[a],o=n[a],$.$$is_array){if(o.$$is_array&&o.length!==$.length)return!1;if(!r.hasOwnProperty($.$object_id())&&!t($,o))return!1}else if(!$["$=="](o))return!1;return!0}var r={};return t(this,e)},R.$$arity=1),e.def($t,"$[]",C=function(e,t){var r=this;return e.$$is_range?y(r,e):m(r,e,t)},C.$$arity=-2),e.def($t,"$[]=",q=function(e,t,r){var n,a,i=this,$=s,o=s,l=i.length;if(p(u(ot,"Range")["$==="](e))){$=p(u(ot,"Array")["$==="](t))?t.$to_a():p(t["$respond_to?"]("to_ary"))?t.$to_ary().$to_a():[t];var c=e.excl,d=u(ot,"Opal").$coerce_to(e.begin,u(ot,"Integer"),"to_int"),_=u(ot,"Opal").$coerce_to(e.end,u(ot,"Integer"),"to_int");if(d<0&&(d+=l)<0&&i.$raise(u(ot,"RangeError"),e.$inspect()+" out of range"),_<0&&(_+=l),c||(_+=1),d>l)for(n=l;n<d;n++)i[n]=s;return _<0?i.splice.apply(i,[d,0].concat($)):i.splice.apply(i,[d,_-d].concat($)),t}if(p(r===undefined)?o=1:(o=t,t=r,$=p(u(ot,"Array")["$==="](t))?t.$to_a():p(t["$respond_to?"]("to_ary"))?t.$to_ary().$to_a():[t]),e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),o=u(ot,"Opal").$coerce_to(o,u(ot,"Integer"),"to_int"),e<0&&(a=e,(e+=l)<0&&i.$raise(u(ot,"IndexError"),"index "+a+" too small for array; minimum "+-i.length)),o<0&&i.$raise(u(ot,"IndexError"),"negative length ("+o+")"),e>l)for(n=l;n<e;n++)i[n]=s;return r===undefined?i[e]=t:i.splice.apply(i,[e,o].concat($)),t},q.$$arity=-3),e.def($t,"$any?",M=function(){var t=M.$$p,r=this,n=s,a=s,i=s;for(t&&(M.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return t&&(M.$$p=null),0!==r.length&&_(r,e.find_super_dispatcher(r,"any?",M,!1),n,t)},M.$$arity=-1),e.def($t,"$assoc",z=function(e){for(var t,r=this,n=0,a=r.length;n<a;n++)if((t=r[n]).length&&t[0]["$=="](e))return t;return s},z.$$arity=1),e.def($t,"$at",N=function(e){var t=this;return(e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"))<0&&(e+=t.length),e<0||e>=t.length?s:t[e]},N.$$arity=1),e.def($t,"$bsearch_index",j=function(){var t=j.$$p,r=t||s,n=this;if(t&&(j.$$p=null),t&&(j.$$p=null),r===s)return n.$enum_for("bsearch_index");for(var a,i,$,o=0,l=n.length,c=!1,p=s;o<l;){if(i=n[a=o+Math.floor((l-o)/2)],!0===($=e.yield1(r,i)))p=a,c=!0;else if(!1===$||$===s)c=!1;else if($.$$is_number){if(0===$)return a;c=$<0}else n.$raise(u(ot,"TypeError"),"wrong argument type "+$.$class()+" (must be numeric, true, false or nil)");c?l=a:o=a+1}return p},j.$$arity=0),e.def($t,"$bsearch",P=function(){var e=P.$$p,t=e||s,r=this,n=s;return e&&(P.$$p=null),e&&(P.$$p=null),t===s?r.$enum_for("bsearch"):null!=(n=_(r,"bsearch_index",[],t.$to_proc()))&&n.$$is_number?r[n]:n},P.$$arity=0),e.def($t,"$cycle",B=function(n){var a,i,$,o,c=B.$$p,d=c||s,f=this;if(c&&(B.$$p=null),c&&(B.$$p=null),null==n&&(n=s),d===s)return _(f,"enum_for",["cycle",n],((a=function(){var e=a.$$s||this;return p(n["$nil?"]())?l(u(ot,"Float"),"INFINITY"):(n=u(ot,"Opal")["$coerce_to!"](n,u(ot,"Integer"),"to_int"),p(t(n,0))?r(e.$enumerator_size(),n):0)}).$$s=f,a.$$arity=0,a));if(p(p(i=f["$empty?"]())?i:n["$=="](0)))return s;if(n===s)for(;;)for($=0,o=f.length;$<o;$++)e.yield1(d,f[$]);else{if((n=u(ot,"Opal")["$coerce_to!"](n,u(ot,"Integer"),"to_int"))<=0)return f;for(;n>0;){for($=0,o=f.length;$<o;$++)e.yield1(d,f[$]);n--}}return f},B.$$arity=-1),e.def($t,"$clear",L=function(){var e=this;return e.splice(0,e.length),e},L.$$arity=0),e.def($t,"$count",D=function(t){var r,n=D.$$p,a=n||s,i=this,$=s,o=s,l=s;for(n&&(D.$$p=null),o=0,l=arguments.length,$=new Array(l);o<l;o++)$[o]=arguments[o];return n&&(D.$$p=null),null==t&&(t=s),p(p(r=t)?r:a)?_(i,e.find_super_dispatcher(i,"count",D,!1),$,n):i.$size()},D.$$arity=-1),e.def($t,"$initialize_copy",G=function(e){return this.$replace(e)},G.$$arity=1),e.def($t,"$collect",H=function(){var t,r=H.$$p,n=r||s,a=this;if(r&&(H.$$p=null),r&&(H.$$p=null),n===s)return _(a,"enum_for",["collect"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i=[],$=0,o=a.length;$<o;$++){var l=e.yield1(n,a[$]);i.push(l)}return i},H.$$arity=0),e.def($t,"$collect!",F=function(){var t,r=F.$$p,n=r||s,a=this;if(r&&(F.$$p=null),r&&(F.$$p=null),n===s)return _(a,"enum_for",["collect!"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i=0,$=a.length;i<$;i++){var o=e.yield1(n,a[i]);a[i]=o}return a},F.$$arity=0),e.def($t,"$combination",U=function(t){var r,n,a,i,$,o,l,c,p=U.$$p,d=p||s,f=this,h=s;if(p&&(U.$$p=null),h=u(ot,"Opal")["$coerce_to!"](t,u(ot,"Integer"),"to_int"),d===s)return _(f,"enum_for",["combination",h],((r=function(){return g((r.$$s||this).length,h)}).$$s=f,r.$$arity=0,r));if(0===h)e.yield1(d,[]);else if(1===h)for(n=0,a=f.length;n<a;n++)e.yield1(d,[f[n]]);else if(h===f.length)e.yield1(d,f.slice());else if(h>=0&&h<f.length){for(i=[],n=0;n<=h+1;n++)i.push(0);for($=[],o=0,l=!1,i[0]=-1;!l;){for($[o]=f[i[o+1]];o<h-1;)c=i[++o+1]=i[o]+1,$[o]=f[c];e.yield1(d,$.slice()),o++;do{l=0===o,i[o]++,o--}while(i[o+1]+h===f.length+o+1)}}return f},U.$$arity=1),e.def($t,"$repeated_combination",K=function(t){function r(t,n,a,$){if(a.length!=t)for(var o=n;o<$.length;o++)a.push($[o]),r(t,o,a,$),a.pop();else{var s=a.slice();e.yield1(i,s)}}var n,a=K.$$p,i=a||s,$=this,o=s;return a&&(K.$$p=null),o=u(ot,"Opal")["$coerce_to!"](t,u(ot,"Integer"),"to_int"),i===s?_($,"enum_for",["repeated_combination",o],((n=function(){return g((n.$$s||this).length+o-1,o)}).$$s=$,n.$$arity=0,n)):(o>=0&&r(o,0,[],$),$)},K.$$arity=1),e.def($t,"$compact",Y=function(){for(var e,t=this,r=[],n=0,a=t.length;n<a;n++)(e=t[n])!==s&&r.push(e);return r},Y.$$arity=0),e.def($t,"$compact!",V=function(){for(var e=this,t=e.length,r=0,n=e.length;r<n;r++)e[r]===s&&(e.splice(r,1),n--,r--);return e.length===t?s:e},V.$$arity=0),e.def($t,"$concat",W=function(){var t,r,n,a,i=this;return t=e.slice.call(arguments,0,arguments.length),r=_(r=t,"map",[],((n=function(e){var t=n.$$s||this;return null==e&&(e=s),e=p(u(ot,"Array")["$==="](e))?e.$to_a():u(ot,"Opal").$coerce_to(e,u(ot,"Array"),"to_ary").$to_a(),p(e["$equal?"](t))&&(e=e.$dup()),e}).$$s=i,n.$$arity=1,n)),_(r,"each",[],((a=function(e){var t=a.$$s||this;null==e&&(e=s);for(var r=0,n=e.length;r<n;r++)t.push(e[r])}).$$s=i,a.$$arity=1,a)),i},W.$$arity=-1),e.def($t,"$delete",J=function(t){var r=J.$$p,n=r||s,a=this;r&&(J.$$p=null);for(var i=a.length,$=0,o=i;$<o;$++)a[$]["$=="](t)&&(a.splice($,1),o--,$--);return a.length===i?n!==s?e.yieldX(n,[]):s:t},J.$$arity=1),e.def($t,"$delete_at",X=function(e){var t=this;if((e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"))<0&&(e+=t.length),e<0||e>=t.length)return s;var r=t[e];return t.splice(e,1),r},X.$$arity=1),e.def($t,"$delete_if",Z=function(){var e,t=Z.$$p,r=t||s,n=this;if(t&&(Z.$$p=null),t&&(Z.$$p=null),r===s)return _(n,"enum_for",["delete_if"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e));for(var a,i=0,$=n.length;i<$;i++)!1!==(a=r(n[i]))&&a!==s&&(n.splice(i,1),$--,i--);return n},Z.$$arity=0),e.def($t,"$dig",Q=function(t){var r,n=this,a=s;return r=e.slice.call(arguments,1,arguments.length),(a=n["$[]"](t))===s||0===r.length?a:(p(a["$respond_to?"]("dig"))||n.$raise(u(ot,"TypeError"),a.$class()+" does not have #dig method"),_(a,"dig",e.to_a(r)))},Q.$$arity=-2),e.def($t,"$drop",ee=function(e){var t=this;return e<0&&t.$raise(u(ot,"ArgumentError")),t.slice(e)},ee.$$arity=1),e.def($t,"$dup",te=function(){var t=te.$$p,r=this,n=s,a=s,i=s;for(t&&(te.$$p=null),a=0,i=arguments.length,n=new Array(i);a<i;a++)n[a]=arguments[a];return r.$$class===e.Array&&r.$$class.$allocate.$$pristine&&r.$copy_instance_variables.$$pristine&&r.$initialize_dup.$$pristine?r.slice(0):_(r,e.find_super_dispatcher(r,"dup",te,!1),n,t)},te.$$arity=0),e.def($t,"$each",re=function(){var t,r=re.$$p,n=r||s,a=this;if(r&&(re.$$p=null),r&&(re.$$p=null),n===s)return _(a,"enum_for",["each"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i=0,$=a.length;i<$;i++)e.yield1(n,a[i]);return a},re.$$arity=0),e.def($t,"$each_index",ne=function(){var t,r=ne.$$p,n=r||s,a=this;if(r&&(ne.$$p=null),r&&(ne.$$p=null),n===s)return _(a,"enum_for",["each_index"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i=0,$=a.length;i<$;i++)e.yield1(n,i);return a},ne.$$arity=0),e.def($t,"$empty?",ae=function(){return 0===this.length},ae.$$arity=0),e.def($t,"$eql?",ie=function(e){function t(e,n){var a,i,$,o;if(!n.$$is_array)return!1;if(n=n.$to_a(),e.length!==n.length)return!1;for(r[e.$object_id()]=!0,a=0,i=e.length;a<i;a++)if($=e[a],o=n[a],$.$$is_array){if(o.$$is_array&&o.length!==$.length)return!1;if(!r.hasOwnProperty($.$object_id())&&!t($,o))return!1}else if(!$["$eql?"](o))return!1;return!0}var r={};return t(this,e)},ie.$$arity=1),e.def($t,"$fetch",$e=function(e,t){var r=$e.$$p,n=r||s,a=this;r&&($e.$$p=null),r&&($e.$$p=null);var i=e;return(e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"))<0&&(e+=a.length),e>=0&&e<a.length?a[e]:(n!==s&&null!=t&&a.$warn("warning: block supersedes default value argument"),n!==s?n(i):null!=t?t:void(0===a.length?a.$raise(u(ot,"IndexError"),"index "+i+" outside of array bounds: 0...0"):a.$raise(u(ot,"IndexError"),"index "+i+" outside of array bounds: -"+a.length+"..."+a.length)))},$e.$$arity=-2),e.def($t,"$fill",oe=function(){var t,r,n,a,i,$=oe.$$p,o=$||s,l=this,c=s,d=s,_=s,f=s,h=s;if($&&(oe.$$p=null),$&&(oe.$$p=null),t=e.slice.call(arguments,0,arguments.length),p(o)?(p(t.length>2)&&l.$raise(u(ot,"ArgumentError"),"wrong number of arguments ("+t.$length()+" for 0..2)"),n=t,c=null==(r=e.to_ary(n))[0]?s:r[0],
d=null==r[1]?s:r[1]):(p(0==t.length)?l.$raise(u(ot,"ArgumentError"),"wrong number of arguments (0 for 1..3)"):p(t.length>3)&&l.$raise(u(ot,"ArgumentError"),"wrong number of arguments ("+t.$length()+" for 1..3)"),n=t,_=null==(r=e.to_ary(n))[0]?s:r[0],c=null==r[1]?s:r[1],d=null==r[2]?s:r[2]),p(u(ot,"Range")["$==="](c))){if(p(d)&&l.$raise(u(ot,"TypeError"),"length invalid with range"),f=u(ot,"Opal").$coerce_to(c.$begin(),u(ot,"Integer"),"to_int"),p(f<0)&&(f+=this.length),p(f<0)&&l.$raise(u(ot,"RangeError"),c.$inspect()+" out of range"),h=u(ot,"Opal").$coerce_to(c.$end(),u(ot,"Integer"),"to_int"),p(h<0)&&(h+=this.length),p(c["$exclude_end?"]())||(h+=1),p(h<=f))return l}else if(p(c))if(f=u(ot,"Opal").$coerce_to(c,u(ot,"Integer"),"to_int"),p(f<0)&&(f+=this.length),p(f<0)&&(f=0),p(d)){if(h=u(ot,"Opal").$coerce_to(d,u(ot,"Integer"),"to_int"),p(0==h))return l;h+=f}else h=this.length;else f=0,h=this.length;if(p(f>this.length))for(a=this.length;a<h;a++)l[a]=s;if(p(h>this.length)&&(this.length=h),p(o))for(this.length;f<h;f++)i=o(f),l[f]=i;else for(this.length;f<h;f++)l[f]=_;return l},oe.$$arity=-1),e.def($t,"$first",se=function(e){var t=this;return null==e?0===t.length?s:t[0]:((e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"))<0&&t.$raise(u(ot,"ArgumentError"),"negative array size"),t.slice(0,e))},se.$$arity=-1),e.def($t,"$flatten",le=function(e){function t(e,n){var a,i,$,o,l=[];for(a=0,i=(e=e.$to_a()).length;a<i;a++)if($=e[a],u(ot,"Opal")["$respond_to?"]($,"to_ary",!0))if((o=$.$to_ary())!==s)switch(o.$$is_array||r.$raise(u(ot,"TypeError")),o===r&&r.$raise(u(ot,"ArgumentError")),n){case undefined:l=l.concat(t(o));break;case 0:l.push(o);break;default:l.push.apply(l,t(o,n-1))}else l.push($);else l.push($);return l}var r=this;return e!==undefined&&(e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int")),h(t(r,e),r.$class())},le.$$arity=-1),e.def($t,"$flatten!",ue=function(e){var t=this,r=t.$flatten(e);if(t.length==r.length){for(var n=0,a=t.length;n<a&&t[n]===r[n];n++);if(n==a)return s}return t.$replace(r),t},ue.$$arity=-1),e.def($t,"$hash",ce=function(){var t,r,n,a=this,i=e.hash_ids===undefined,$=["A"],o=a.$object_id();try{if(i&&(e.hash_ids=Object.create(null)),e.hash_ids[o])return"self";for(n in e.hash_ids)if(t=e.hash_ids[n],a["$eql?"](t))return"self";for(e.hash_ids[o]=a,r=0;r<a.length;r++)t=a[r],$.push(t.$hash());return $.join(",")}finally{i&&(e.hash_ids=undefined)}},ce.$$arity=0),e.def($t,"$include?",pe=function(e){for(var t=this,r=0,n=t.length;r<n;r++)if(t[r]["$=="](e))return!0;return!1},pe.$$arity=1),e.def($t,"$index",de=function(e){var t,r,n,a=de.$$p,i=a||s,$=this;if(a&&(de.$$p=null),a&&(de.$$p=null),null!=e&&i!==s&&$.$warn("warning: given block not used"),null!=e){for(t=0,r=$.length;t<r;t++)if($[t]["$=="](e))return t}else{if(i===s)return $.$enum_for("index");for(t=0,r=$.length;t<r;t++)if(!1!==(n=i($[t]))&&n!==s)return t}return s},de.$$arity=-1),e.def($t,"$insert",_e=function(t){var r,n=this;if(r=e.slice.call(arguments,1,arguments.length),t=u(ot,"Opal").$coerce_to(t,u(ot,"Integer"),"to_int"),r.length>0){if(t<0&&(t+=n.length+1)<0&&n.$raise(u(ot,"IndexError"),t+" is out of bounds"),t>n.length)for(var a=n.length;a<t;a++)n.push(s);n.splice.apply(n,[t,0].concat(r))}return n},_e.$$arity=-2),e.def($t,"$inspect",fe=function(){for(var e=this,t=[],r=e.$__id__(),n=0,a=e.length;n<a;n++){var i=e["$[]"](n);i.$__id__()===r?t.push("[...]"):t.push(i.$inspect())}return"["+t.join(", ")+"]"},fe.$$arity=0),e.def($t,"$join",he=function(t){var r=this;if(null==f[","]&&(f[","]=s),null==t&&(t=s),p(0===r.length))return"";p(t===s)&&(t=f[","]);var n,a,i,$,o=[];for(n=0,a=r.length;n<a;n++)i=r[n],u(ot,"Opal")["$respond_to?"](i,"to_str")&&($=i.$to_str())!==s?o.push($.$to_s()):u(ot,"Opal")["$respond_to?"](i,"to_ary")&&(($=i.$to_ary())===r&&r.$raise(u(ot,"ArgumentError")),$!==s)?o.push($.$join(t)):u(ot,"Opal")["$respond_to?"](i,"to_s")&&($=i.$to_s())!==s?o.push($):r.$raise(u(ot,"NoMethodError").$new(e.inspect(i)+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return t===s?o.join(""):o.join(u(ot,"Opal")["$coerce_to!"](t,u(ot,"String"),"to_str").$to_s())},he.$$arity=-1),e.def($t,"$keep_if",ye=function(){var e,t=ye.$$p,r=t||s,n=this;if(t&&(ye.$$p=null),t&&(ye.$$p=null),r===s)return _(n,"enum_for",["keep_if"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e));for(var a,i=0,$=n.length;i<$;i++)!1!==(a=r(n[i]))&&a!==s||(n.splice(i,1),$--,i--);return n},ye.$$arity=0),e.def($t,"$last",me=function(e){var t=this;return null==e?0===t.length?s:t[t.length-1]:((e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"))<0&&t.$raise(u(ot,"ArgumentError"),"negative array size"),e>t.length&&(e=t.length),t.slice(t.length-e,t.length))},me.$$arity=-1),e.def($t,"$length",ge=function(){return this.length},ge.$$arity=0),e.alias($t,"map","collect"),e.alias($t,"map!","collect!"),e.def($t,"$max",be=function(e){var t=be.$$p,r=t||s,n=this;return t&&(be.$$p=null),t&&(be.$$p=null),_(n.$each(),"max",[e],r.$to_proc())},be.$$arity=-1),e.def($t,"$min",ve=function(){var e=ve.$$p,t=e||s,r=this;return e&&(ve.$$p=null),e&&(ve.$$p=null),_(r.$each(),"min",[],t.$to_proc())},ve.$$arity=0),e.def($t,"$permutation",we=function(t){var r,n,a,i,$=we.$$p,o=$||s,l=this,c=s,p=s;if($&&(we.$$p=null),$&&(we.$$p=null),o===s)return _(l,"enum_for",["permutation",t],((r=function(){var e=r.$$s||this;return b(e.length,t===undefined?e.length:t)}).$$s=l,r.$$arity=0,r));if((t=t===undefined?l.length:u(ot,"Opal").$coerce_to(t,u(ot,"Integer"),"to_int"))<0||l.length<t);else if(0===t)e.yield1(o,[]);else if(1===t)for(var d=0;d<l.length;d++)e.yield1(o,[l[d]]);else c=u(ot,"Array").$new(t),p=u(ot,"Array").$new(l.length,!1),n=function(t,r,a,$,o){l=this;for(var s=0;s<l.length;s++)if($["$[]"](s)["$!"]())if(r[a]=s,a<t-1)$[s]=!0,n.call(l,t,r,a+1,$,o),$[s]=!1;else{i=[];for(var u=0;u<r.length;u++)i.push(l[r[u]]);e.yield1(o,i)}},o!==s?(a=l.slice(),n.call(a,t,c,0,p,o)):n.call(l,t,c,0,p,o);return l},we.$$arity=-1),e.def($t,"$repeated_permutation",ke=function(t){function r(t,n,a){if(n.length!=t)for(var i=0;i<a.length;i++)n.push(a[i]),r(t,n,a),n.pop();else{var o=n.slice();e.yield1($,o)}}var a,i=ke.$$p,$=i||s,o=this,l=s;return i&&(ke.$$p=null),l=u(ot,"Opal")["$coerce_to!"](t,u(ot,"Integer"),"to_int"),$===s?_(o,"enum_for",["repeated_permutation",l],((a=function(){var e=a.$$s||this;return p(n(l,0))?e.$size()["$**"](l):0}).$$s=o,a.$$arity=0,a)):(r(l,[],o.slice()),o)},ke.$$arity=1),e.def($t,"$pop",xe=function(e){var t=this;return p(e===undefined)?p(0===t.length)?s:t.pop():(e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),p(e<0)&&t.$raise(u(ot,"ArgumentError"),"negative array size"),p(0===t.length)?[]:p(e>t.length)?t.splice(0,t.length):t.splice(t.length-e,t.length))},xe.$$arity=-1),e.def($t,"$product",Ee=function(){var t,r,n=Ee.$$p,a=n||s,i=this;n&&(Ee.$$p=null),n&&(Ee.$$p=null),t=e.slice.call(arguments,0,arguments.length);var $,o,l,c,p=a!==s?null:[],d=(r=t).length+1,_=new Array(d),f=new Array(d),h=new Array(d),y=1;for(h[0]=i,$=1;$<d;$++)h[$]=u(ot,"Opal").$coerce_to(r[$-1],u(ot,"Array"),"to_ary");for($=0;$<d;$++){if(0===(c=h[$].length))return p||i;(y*=c)>2147483647&&i.$raise(u(ot,"RangeError"),"too big to product"),f[$]=c,_[$]=0}e:for(;;){for(l=[],$=0;$<d;$++)l.push(h[$][_[$]]);for(p?p.push(l):e.yield1(a,l),_[o=d-1]++;_[o]===f[o];){if(_[o]=0,--o<0)break e;_[o]++}}return p||i},Ee.$$arity=-1),e.def($t,"$push",Oe=function(){for(var t,r=this,n=0,a=(t=e.slice.call(arguments,0,arguments.length)).length;n<a;n++)r.push(t[n]);return r},Oe.$$arity=-1),e.alias($t,"append","push"),e.def($t,"$rassoc",Ae=function(e){for(var t,r=this,n=0,a=r.length;n<a;n++)if((t=r[n]).length&&t[1]!==undefined&&t[1]["$=="](e))return t;return s},Ae.$$arity=1),e.def($t,"$reject",Te=function(){var e,t=Te.$$p,r=t||s,n=this;if(t&&(Te.$$p=null),t&&(Te.$$p=null),r===s)return _(n,"enum_for",["reject"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e));for(var a,i=[],$=0,o=n.length;$<o;$++)!1!==(a=r(n[$]))&&a!==s||i.push(n[$]);return i},Te.$$arity=0),e.def($t,"$reject!",Se=function(){var e,t=Se.$$p,r=t||s,n=this,a=s;return t&&(Se.$$p=null),t&&(Se.$$p=null),r===s?_(n,"enum_for",["reject!"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e)):(a=n.$length(),_(n,"delete_if",[],r.$to_proc()),n.$length()["$=="](a)?s:n)},Se.$$arity=0),e.def($t,"$replace",Ie=function(e){var t=this;return e=p(u(ot,"Array")["$==="](e))?e.$to_a():u(ot,"Opal").$coerce_to(e,u(ot,"Array"),"to_ary").$to_a(),t.splice(0,t.length),t.push.apply(t,e),t},Ie.$$arity=1),e.def($t,"$reverse",Re=function(){return this.slice(0).reverse()},Re.$$arity=0),e.def($t,"$reverse!",Ce=function(){return this.reverse()},Ce.$$arity=0),e.def($t,"$reverse_each",qe=function(){var e,t=qe.$$p,r=t||s,n=this;return t&&(qe.$$p=null),t&&(qe.$$p=null),r===s?_(n,"enum_for",["reverse_each"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e)):(_(n.$reverse(),"each",[],r.$to_proc()),n)},qe.$$arity=0),e.def($t,"$rindex",Me=function(e){var t,r,n=Me.$$p,a=n||s,i=this;if(n&&(Me.$$p=null),n&&(Me.$$p=null),null!=e&&a!==s&&i.$warn("warning: given block not used"),null!=e){for(t=i.length-1;t>=0&&!(t>=i.length);t--)if(i[t]["$=="](e))return t}else if(a!==s){for(t=i.length-1;t>=0&&!(t>=i.length);t--)if(!1!==(r=a(i[t]))&&r!==s)return t}else if(null==e)return i.$enum_for("rindex");return s},Me.$$arity=-1),e.def($t,"$rotate",ze=function(e){var t,r,n,a,i=this;return null==e&&(e=1),e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),1===i.length?i.slice():0===i.length?[]:(r=e%(t=i.slice()).length,n=t.slice(r),a=t.slice(0,r),n.concat(a))},ze.$$arity=-1),e.def($t,"$rotate!",Ne=function(e){var t=this,r=s;return null==e&&(e=1),0===t.length||1===t.length?t:(e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),r=t.$rotate(e),t.$replace(r))},Ne.$$arity=-1),function(t,$super,r){var n,a,i=c(t,null,"SampleRandom"),$=[i].concat(r);i.$$prototype.rng=s,e.def(i,"$initialize",n=function(e){return this.rng=e},n.$$arity=1),e.def(i,"$rand",a=function(e){var t=this,r=s;return r=u($,"Opal").$coerce_to(t.rng.$rand(e),u($,"Integer"),"to_int"),p(r<0)&&t.$raise(u($,"RangeError"),"random value must be >= 0"),p(r<e)||t.$raise(u($,"RangeError"),"random value must be less than Array size"),r},a.$$arity=1)}(ot[0],0,ot),e.def($t,"$sample",je=function(e,t){var r,n,a,i,$,o,l,c,d,_=this,f=s,h=s;if(p(e===undefined))return _.$at(u(ot,"Kernel").$rand(_.length));if(p(t===undefined)?p(f=u(ot,"Opal")["$coerce_to?"](e,u(ot,"Hash"),"to_hash"))?(t=f,e=s):(t=s,e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int")):(e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),t=u(ot,"Opal").$coerce_to(t,u(ot,"Hash"),"to_hash")),p(p(r=e)?e<0:r)&&_.$raise(u(ot,"ArgumentError"),"count must be greater than 0"),p(t)&&(h=t["$[]"]("random")),h=p(p(r=h)?h["$respond_to?"]("rand"):r)?u(ot,"SampleRandom").$new(h):u(ot,"Kernel"),!p(e))return _[h.$rand(_.length)];switch(e>_.length&&(e=_.length),e){case 0:return[];case 1:return[_[h.$rand(_.length)]];case 2:return($=h.$rand(_.length))===(o=h.$rand(_.length))&&(o=0===$?$+1:$-1),[_[$],_[o]];default:if(_.length/e>3){for(n=!1,a=0,$=1,(i=u(ot,"Array").$new(e))[0]=h.$rand(_.length);$<e;){for(l=h.$rand(_.length),o=0;o<$;){for(;l===i[o];){if(++a>100){n=!0;break}l=h.$rand(_.length)}if(n)break;o++}if(n)break;i[$]=l,$++}if(!n){for($=0;$<e;)i[$]=_[i[$]],$++;return i}}i=_.slice();for(var y=0;y<e;y++)c=h.$rand(_.length),d=i[y],i[y]=i[c],i[c]=d;return e===_.length?i:i["$[]"](0,e)}},je.$$arity=-1),e.def($t,"$select",Pe=function(){var t,r=Pe.$$p,n=r||s,a=this;if(r&&(Pe.$$p=null),r&&(Pe.$$p=null),n===s)return _(a,"enum_for",["select"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,$,o=[],l=0,u=a.length;l<u;l++)i=a[l],$=e.yield1(n,i),e.truthy($)&&o.push(i);return o},Pe.$$arity=0),e.def($t,"$select!",Be=function(){var e,t=Be.$$p,r=t||s,n=this;if(t&&(Be.$$p=null),t&&(Be.$$p=null),r===s)return _(n,"enum_for",["select!"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e));var a=n.length;return _(n,"keep_if",[],r.$to_proc()),n.length===a?s:n},Be.$$arity=0),e.def($t,"$shift",Le=function(e){var t=this;return p(e===undefined)?p(0===t.length)?s:t.shift():(e=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),p(e<0)&&t.$raise(u(ot,"ArgumentError"),"negative array size"),p(0===t.length)?[]:t.splice(0,e))},Le.$$arity=-1),e.alias($t,"size","length"),e.def($t,"$shuffle",De=function(e){return this.$dup().$to_a()["$shuffle!"](e)},De.$$arity=-1),e.def($t,"$shuffle!",Ge=function(e){var t,r,n,a=this,i=a.length;for(e!==undefined&&(e=u(ot,"Opal")["$coerce_to?"](e,u(ot,"Hash"),"to_hash"))!==s&&(e=e["$[]"]("random"))!==s&&e["$respond_to?"]("rand")&&(t=e);i;)t?((r=t.$rand(i).$to_int())<0&&a.$raise(u(ot,"RangeError"),"random number too small "+r),r>=i&&a.$raise(u(ot,"RangeError"),"random number too big "+r)):r=a.$rand(i),n=a[--i],a[i]=a[r],a[r]=n;return a},Ge.$$arity=-1),e.alias($t,"slice","[]"),e.def($t,"$slice!",He=function(e,t){var r=this,n=s,a=s,i=s,$=s,o=s;if(n=s,p(t===undefined))if(p(u(ot,"Range")["$==="](e))){a=e,n=r["$[]"](a),i=u(ot,"Opal").$coerce_to(a.$begin(),u(ot,"Integer"),"to_int"),$=u(ot,"Opal").$coerce_to(a.$end(),u(ot,"Integer"),"to_int"),i<0&&(i+=r.length),$<0?$+=r.length:$>=r.length&&($=r.length-1,a.excl&&($+=1));var l=$-i;a.excl?$-=1:l+=1,i<r.length&&i>=0&&$<r.length&&$>=0&&l>0&&r.splice(i,l)}else{if((o=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"))<0&&(o+=r.length),o<0||o>=r.length)return s;n=r[o],0===o?r.shift():r.splice(o,1)}else{if(o=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),(t=u(ot,"Opal").$coerce_to(t,u(ot,"Integer"),"to_int"))<0)return s;n=r["$[]"](o,t),o<0&&(o+=r.length),o+t>r.length&&(t=r.length-o),o<r.length&&o>=0&&r.splice(o,t)}return n},He.$$arity=-2),e.def($t,"$sort",Fe=function(){var e=Fe.$$p,r=e||s,n=this;return e&&(Fe.$$p=null),e&&(Fe.$$p=null),p(n.length>1)?(r===s&&(r=function(e,t){return e["$<=>"](t)}),n.slice().sort(function(e,i){var $=r(e,i);return $===s&&n.$raise(u(ot,"ArgumentError"),"comparison of "+e.$inspect()+" with "+i.$inspect()+" failed"),t($,0)?1:a($,0)?-1:0})):n},Fe.$$arity=0),e.def($t,"$sort!",Ue=function(){var e,t=Ue.$$p,r=t||s,n=this;t&&(Ue.$$p=null),t&&(Ue.$$p=null),e=r!==s?_(n.slice(),"sort",[],r.$to_proc()):n.slice().$sort(),n.length=0;for(var a=0,i=e.length;a<i;a++)n.push(e[a]);return n},Ue.$$arity=0),e.def($t,"$sort_by!",Ke=function(){var e,t=Ke.$$p,r=t||s,n=this;return t&&(Ke.$$p=null),t&&(Ke.$$p=null),r===s?_(n,"enum_for",["sort_by!"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e)):n.$replace(_(n,"sort_by",[],r.$to_proc()))},Ke.$$arity=0),e.def($t,"$take",Ye=function(e){var t=this;return e<0&&t.$raise(u(ot,"ArgumentError")),t.slice(0,e)},Ye.$$arity=1),e.def($t,"$take_while",Ve=function(){var e=Ve.$$p,t=e||s,r=this;e&&(Ve.$$p=null),e&&(Ve.$$p=null);for(var n,a,i=[],$=0,o=r.length;$<o;$++){if(!1===(a=t(n=r[$]))||a===s)return i;i.push(n)}return i},Ve.$$arity=0),e.def($t,"$to_a",We=function(){return this},We.$$arity=0),e.alias($t,"to_ary","to_a"),e.def($t,"$to_h",Je=function(){var t,r,n,a,i=this,$=i.length,o=d([],{});for(t=0;t<$;t++)(r=u(ot,"Opal")["$coerce_to?"](i[t],u(ot,"Array"),"to_ary")).$$is_array||i.$raise(u(ot,"TypeError"),"wrong element type "+r.$class()+" at "+t+" (expected array)"),2!==r.length&&i.$raise(u(ot,"ArgumentError"),"wrong array length at "+t+" (expected 2, was "+r.$length()+")"),n=r[0],a=r[1],e.hash_put(o,n,a);return o},Je.$$arity=0),e.alias($t,"to_s","inspect"),e.def($t,"$transpose",Xe=function(){var t,r=this,n=s,a=s;return p(r["$empty?"]())?[]:(n=[],a=s,_(r,"each",[],((t=function(r){var $,o,l=t.$$s||this;return null==r&&(r=s),r=p(u(ot,"Array")["$==="](r))?r.$to_a():u(ot,"Opal").$coerce_to(r,u(ot,"Array"),"to_ary").$to_a(),a=p($=a)?$:r.length,p(r.length["$!="](a))&&l.$raise(u(ot,"IndexError"),"element size differs ("+r.length+" should be "+a+")"),_(r.length,"times",[],((o=function(t){o.$$s;var a,$=s;return null==t&&(t=s),(p(a=n["$[]"](t))?a:($=[t,[]],_(n,"[]=",e.to_a($)),$[i($.length,1)]))["$<<"](r.$at(t))}).$$s=l,o.$$arity=1,o))}).$$s=r,t.$$arity=1,t)),n)},Xe.$$arity=0),e.def($t,"$uniq",Ze=function(){var t=Ze.$$p,r=t||s,n=this;t&&(Ze.$$p=null),t&&(Ze.$$p=null);var a,i,$,o,l=d([],{});if(r===s)for(a=0,i=n.length;a<i;a++)$=n[a],e.hash_get(l,$)===undefined&&e.hash_put(l,$,$);else for(a=0,i=n.length;a<i;a++)$=n[a],o=e.yield1(r,$),e.hash_get(l,o)===undefined&&e.hash_put(l,o,$);return h(l.$values(),n.$class())},Ze.$$arity=0),e.def($t,"$uniq!",Qe=function(){var t=Qe.$$p,r=t||s,n=this;t&&(Qe.$$p=null),t&&(Qe.$$p=null);var a,i,$,o,l=n.length,u=d([],{});for(a=0,i=l;a<i;a++)$=n[a],o=r===s?$:e.yield1(r,$),e.hash_get(u,o)!==undefined?(n.splice(a,1),i--,a--):e.hash_put(u,o,$);return n.length===l?s:n},Qe.$$arity=0),e.def($t,"$unshift",et=function(){for(var t,r=this,n=(t=e.slice.call(arguments,0,arguments.length)).length-1;n>=0;n--)r.unshift(t[n]);return r},et.$$arity=-1),e.alias($t,"prepend","unshift"),e.def($t,"$values_at",tt=function(){var t,r,n=this,a=s;return t=e.slice.call(arguments,0,arguments.length),a=[],_(t,"each",[],((r=function(e){var t,n=r.$$s||this,i=s,$=s,o=s;return null==e&&(e=s),p(e["$is_a?"](u(ot,"Range")))?(i=u(ot,"Opal").$coerce_to(e.$last(),u(ot,"Integer"),"to_int"),($=u(ot,"Opal").$coerce_to(e.$first(),u(ot,"Integer"),"to_int"))<0?($+=n.length,s):(i<0&&(i+=n.length),e["$exclude_end?"]()&&i--,i<$?s:_($,"upto",[i],((t=function(e){var r=t.$$s||this;return null==e&&(e=s),a["$<<"](r.$at(e))}).$$s=n,t.$$arity=1,t)))):(o=u(ot,"Opal").$coerce_to(e,u(ot,"Integer"),"to_int"),a["$<<"](n.$at(o)))}).$$s=n,r.$$arity=1,r)),a},tt.$$arity=-1),e.def($t,"$zip",rt=function(){var t,r,n=rt.$$p,a=n||s,i=this;n&&(rt.$$p=null),n&&(rt.$$p=null),t=e.slice.call(arguments,0,arguments.length);var $,o,l,c,d,_=[],f=i.length;for(c=0,d=t.length;c<d;c++)(o=t[c]).$$is_array||(o.$$is_enumerator?o.$size()===Infinity?t[c]=o.$take(f):t[c]=o.$to_a():t[c]=(p(r=u(ot,"Opal")["$coerce_to?"](o,u(ot,"Array"),"to_ary"))?r:u(ot,"Opal")["$coerce_to!"](o,u(ot,"Enumerator"),"each")).$to_a());for(l=0;l<f;l++){for($=[i[l]],c=0,d=t.length;c<d;c++)null==(o=t[c][l])&&(o=s),$[c+1]=o;_[l]=$}if(a!==s){for(l=0;l<f;l++)a(_[l]);return s}return _},rt.$$arity=-1),e.defs($t,"$inherited",nt=function(e){e.$$prototype.$to_a=function(){return this.slice(0,this.length)}},nt.$$arity=1),e.def($t,"$instance_variables",at=function(){var t,r=at.$$p,n=this,a=s,i=s,$=s;for(r&&(at.$$p=null),i=0,$=arguments.length,a=new Array($);i<$;i++)a[i]=arguments[i];return _(_(n,e.find_super_dispatcher(n,"instance_variables",at,!1),a,r),"reject",[],((t=function(e){var r;t.$$s;return null==e&&(e=s),p(r=/^@\d+$/.test(e))?r:e["$=="]("@length")}).$$s=n,t.$$arity=1,t))},at.$$arity=0),u(ot,"Opal").$pristine($t.$singleton_class(),"allocate"),u(ot,"Opal").$pristine($t,"copy_instance_variables","initialize_dup"),e.def($t,"$pack",it=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},it.$$arity=-1),s&&"pack"}(o[0],Array,o)},Opal.modules["corelib/hash"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var a=e.top,i=[],$=e.nil,o=(e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.klass),l=e.send,u=e.hash2,c=e.truthy;return e.add_stubs(["$require","$include","$coerce_to?","$[]","$merge!","$allocate","$raise","$coerce_to!","$each","$fetch","$>=","$>","$==","$compare_by_identity","$lambda?","$abs","$arity","$enum_for","$size","$respond_to?","$class","$dig","$new","$inspect","$map","$to_proc","$flatten","$eql?","$default","$dup","$default_proc","$default_proc=","$-","$default=","$proc"]),a.$require("corelib/enumerable"),function(a,$super,i){var p,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q,ee,te,re,ne,ae,ie,$e,oe,se,le,ue,ce,pe,de,_e,fe,he,ye,me,ge,be,ve=s(a,null,"Hash"),we=[ve].concat(i);return ve.$include(o(we,"Enumerable")),ve.$$prototype.$$is_hash=!0,e.defs(ve,"$[]",p=function(){var t,r,n,a=this,i=(t=e.slice.call(arguments,0,arguments.length)).length;if(1===i){if((r=o(we,"Opal")["$coerce_to?"](t["$[]"](0),o(we,"Hash"),"to_hash"))!==$)return a.$allocate()["$merge!"](r);for((t=o(we,"Opal")["$coerce_to?"](t["$[]"](0),o(we,"Array"),"to_ary"))===$&&a.$raise(o(we,"ArgumentError"),"odd number of arguments for Hash"),i=t.length,r=a.$allocate(),n=0;n<i;n++)if(t[n].$$is_array)switch(t[n].length){case 1:r.$store(t[n][0],$);break;case 2:r.$store(t[n][0],t[n][1]);break;default:a.$raise(o(we,"ArgumentError"),"invalid number of elements ("+t[n].length+" for 1..2)")}return r}for(i%2!=0&&a.$raise(o(we,"ArgumentError"),"odd number of arguments for Hash"),r=a.$allocate(),n=0;n<i;n+=2)r.$store(t[n],t[n+1]);return r},p.$$arity=-1),e.defs(ve,"$allocate",d=function(){var t=new this.$$constructor;return e.hash_init(t),t.$$none=$,t.$$proc=$,t},d.$$arity=0),e.defs(ve,"$try_convert",_=function(e){return o(we,"Opal")["$coerce_to?"](e,o(we,"Hash"),"to_hash")},_.$$arity=1),e.def(ve,"$initialize",f=function(e){var t=f.$$p,r=t||$,n=this;return t&&(f.$$p=null),t&&(f.$$p=null),e!==undefined&&r!==$&&n.$raise(o(we,"ArgumentError"),"wrong number of arguments (1 for 0)"),n.$$none=e===undefined?$:e,n.$$proc=r,n},f.$$arity=-1),e.def(ve,"$==",h=function(t){var r=this;if(r===t)return!0;if(!t.$$is_hash)return!1;if(r.$$keys.length!==t.$$keys.length)return!1;for(var n,a,i,$=0,o=r.$$keys,s=o.length;$<s;$++)if((n=o[$]).$$is_string?(a=r.$$smap[n],i=t.$$smap[n]):(a=n.value,i=e.hash_get(t,n.key)),i===undefined||!a["$eql?"](i))return!1;return!0},h.$$arity=1),e.def(ve,"$>=",y=function(e){var t,r=this,n=$;return e=o(we,"Opal")["$coerce_to!"](e,o(we,"Hash"),"to_hash"),!(r.$$keys.length<e.$$keys.length)&&(n=!0,l(e,"each",[],((t=function(e,r){var a=t.$$s||this,i=$;null==e&&(e=$),null==r&&(r=$),null!=(i=a.$fetch(e,null))&&i===r||(n=!1)}).$$s=r,t.$$arity=2,t)),n)},y.$$arity=1),e.def(ve,"$>",m=function(e){var r=this;return e=o(we,"Opal")["$coerce_to!"](e,o(we,"Hash"),"to_hash"),!(r.$$keys.length<=e.$$keys.length)&&t(r,e)},m.$$arity=1),e.def(ve,"$<",g=function(e){var t=this;return r(e=o(we,"Opal")["$coerce_to!"](e,o(we,"Hash"),"to_hash"),t)},g.$$arity=1),e.def(ve,"$<=",b=function(e){var r=this;return t(e=o(we,"Opal")["$coerce_to!"](e,o(we,"Hash"),"to_hash"),r)},b.$$arity=1),e.def(ve,"$[]",v=function(t){var r=this,n=e.hash_get(r,t);return n!==undefined?n:r.$default(t)},v.$$arity=1),e.def(ve,"$[]=",w=function(t,r){var n=this;return e.hash_put(n,t,r),r},w.$$arity=2),e.def(ve,"$assoc",k=function(e){for(var t,r=this,n=0,a=r.$$keys,i=a.length;n<i;n++)if((t=a[n]).$$is_string){if(t["$=="](e))return[t,r.$$smap[t]]}else if(t.key["$=="](e))return[t.key,t.value];return $},k.$$arity=1),e.def(ve,"$clear",x=function(){var t=this;return e.hash_init(t),t},x.$$arity=0),e.def(ve,"$clone",E=function(){var t=this,r=new t.$$class;return e.hash_init(r),e.hash_clone(t,r),r},E.$$arity=0),e.def(ve,"$compact",O=function(){for(var t,r,n=this,a=e.hash(),i=0,o=n.$$keys,s=o.length;i<s;i++)(t=o[i]).$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),r!==$&&e.hash_put(a,t,r);return a},O.$$arity=0),e.def(ve,"$compact!",A=function(){for(var t,r,n=this,a=!1,i=0,o=n.$$keys,s=o.length;i<s;i++)(t=o[i]).$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),r===$&&e.hash_delete(n,t)!==undefined&&(a=!0,s--,i--);return a?n:$},A.$$arity=0),e.def(ve,"$compare_by_identity",T=function(){var t,r,n,a,i=this,$=i.$$keys;if(i.$$by_identity)return i;if(0===i.$$keys.length)return i.$$by_identity=!0,i;for(a=u([],{}).$compare_by_identity(),t=0,r=$.length;t<r;t++)(n=$[t]).$$is_string||(n=n.key),e.hash_put(a,n,e.hash_get(i,n));return i.$$by_identity=!0,i.$$map=a.$$map,i.$$smap=a.$$smap,i},T.$$arity=0),e.def(ve,"$compare_by_identity?",S=function(){return!0===this.$$by_identity},S.$$arity=0),e.def(ve,"$default",I=function(e){var t=this;return e!==undefined&&t.$$proc!==$&&t.$$proc!==undefined?t.$$proc.$call(t,e):t.$$none===undefined?$:t.$$none},I.$$arity=-1),e.def(ve,"$default=",R=function(e){var t=this;return t.$$proc=$,t.$$none=e,e},R.$$arity=1),e.def(ve,"$default_proc",C=function(){var e=this;return e.$$proc!==undefined?e.$$proc:$},C.$$arity=0),e.def(ve,"$default_proc=",q=function(e){var t=this,r=e;return r!==$&&(r=o(we,"Opal")["$coerce_to!"](r,o(we,"Proc"),"to_proc"))["$lambda?"]()&&2!==r.$arity().$abs()&&t.$raise(o(we,"TypeError"),"default_proc takes two arguments"),t.$$none=$,t.$$proc=r,e},q.$$arity=1),e.def(ve,"$delete",M=function(t){var r=M.$$p,n=r||$,a=this;r&&(M.$$p=null),r&&(M.$$p=null);var i=e.hash_delete(a,t);return i!==undefined?i:n!==$?e.yield1(n,t):$},M.$$arity=1),e.def(ve,"$delete_if",z=function(){var t,r=z.$$p,n=r||$,a=this;if(r&&(z.$$p=null),r&&(z.$$p=null),!c(n))return l(a,"enum_for",["delete_if"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s,u=0,p=a.$$keys,d=p.length;u<d;u++)(i=p[u]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(s=n(i,o))&&s!==$&&e.hash_delete(a,i)!==undefined&&(d--,u--);return a},z.$$arity=0),e.alias(ve,"dup","clone"),e.def(ve,"$dig",N=function(t){var r,n=this,a=$;return r=e.slice.call(arguments,1,arguments.length),(a=n["$[]"](t))===$||0===r.length?a:(c(a["$respond_to?"]("dig"))||n.$raise(o(we,"TypeError"),a.$class()+" does not have #dig method"),l(a,"dig",e.to_a(r)))},N.$$arity=-2),e.def(ve,"$each",j=function(){var t,r=j.$$p,n=r||$,a=this;if(r&&(j.$$p=null),r&&(j.$$p=null),!c(n))return l(a,"enum_for",["each"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s=0,u=a.$$keys,p=u.length;s<p;s++)(i=u[s]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),e.yield1(n,[i,o]);return a},j.$$arity=0),e.def(ve,"$each_key",P=function(){var e,t=P.$$p,r=t||$,n=this;if(t&&(P.$$p=null),t&&(P.$$p=null),!c(r))return l(n,"enum_for",["each_key"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e));for(var a,i=0,o=n.$$keys,s=o.length;i<s;i++)r((a=o[i]).$$is_string?a:a.key);return n},P.$$arity=0),e.alias(ve,"each_pair","each"),e.def(ve,"$each_value",B=function(){var e,t=B.$$p,r=t||$,n=this;if(t&&(B.$$p=null),t&&(B.$$p=null),!c(r))return l(n,"enum_for",["each_value"],((e=function(){return(e.$$s||this).$size()}).$$s=n,e.$$arity=0,e));for(var a,i=0,o=n.$$keys,s=o.length;i<s;i++)r((a=o[i]).$$is_string?n.$$smap[a]:a.value);return n},B.$$arity=0),e.def(ve,"$empty?",L=function(){return 0===this.$$keys.length},L.$$arity=0),e.alias(ve,"eql?","=="),e.def(ve,"$fetch",D=function(t,r){var n=D.$$p,a=n||$,i=this;n&&(D.$$p=null),n&&(D.$$p=null);var s=e.hash_get(i,t);return s!==undefined?s:a!==$?a(t):r!==undefined?r:i.$raise(o(we,"KeyError").$new("key not found: "+t.$inspect(),u(["key","receiver"],{key:t,receiver:i})))},D.$$arity=-2),e.def(ve,"$fetch_values",G=function(){var t,r,n=G.$$p,a=n||$,i=this;return n&&(G.$$p=null),n&&(G.$$p=null),t=e.slice.call(arguments,0,arguments.length),l(t,"map",[],((r=function(e){var t=r.$$s||this;return null==e&&(e=$),l(t,"fetch",[e],a.$to_proc())}).$$s=i,r.$$arity=1,r))},G.$$arity=-1),e.def(ve,"$flatten",H=function(e){var t=this;null==e&&(e=1),e=o(we,"Opal")["$coerce_to!"](e,o(we,"Integer"),"to_int");for(var r,n,a=[],i=0,$=t.$$keys,s=$.length;i<s;i++)if((r=$[i]).$$is_string?n=t.$$smap[r]:(n=r.value,r=r.key),a.push(r),n.$$is_array){if(1===e){a.push(n);continue}a=a.concat(n.$flatten(e-2))}else a.push(n);return a},H.$$arity=-1),e.def(ve,"$has_key?",F=function(t){var r=this;return e.hash_get(r,t)!==undefined},F.$$arity=1),e.def(ve,"$has_value?",U=function(e){for(var t,r=this,n=0,a=r.$$keys,i=a.length;n<i;n++)if(((t=a[n]).$$is_string?r.$$smap[t]:t.value)["$=="](e))return!0;return!1},U.$$arity=1),e.def(ve,"$hash",K=function(){var t,r,n=this,a=e.hash_ids===undefined,i=n.$object_id(),$=["Hash"];try{if(a&&(e.hash_ids=Object.create(null)),e[i])return"self";for(t in e.hash_ids)if(r=e.hash_ids[t],n["$eql?"](r))return"self";e.hash_ids[i]=n;for(var o=0,s=n.$$keys,l=s.length;o<l;o++)(t=s[o]).$$is_string?$.push([t,n.$$smap[t].$hash()]):$.push([t.key_hash,t.value.$hash()]);return $.sort().join()}finally{a&&(e.hash_ids=undefined)}},K.$$arity=0),e.alias(ve,"include?","has_key?"),e.def(ve,"$index",Y=function(e){for(var t,r,n=this,a=0,i=n.$$keys,o=i.length;a<o;a++)if((t=i[a]).$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),r["$=="](e))return t;return $},Y.$$arity=1),e.def(ve,"$indexes",V=function(){for(var t,r,n,a=this,i=[],$=0,o=(t=e.slice.call(arguments,0,arguments.length)).length;$<o;$++)r=t[$],(n=e.hash_get(a,r))!==undefined?i.push(n):i.push(a.$default());return i},V.$$arity=-1),e.alias(ve,"indices","indexes"),e.def(ve,"$inspect",W=function(){var e=this,t=be===undefined,r=e.$object_id(),n=[];try{if(t&&(be={}),be.hasOwnProperty(r))return"{...}";be[r]=!0;for(var a,i,$=0,o=e.$$keys,s=o.length;$<s;$++)(a=o[$]).$$is_string?i=e.$$smap[a]:(i=a.value,a=a.key),n.push(a.$inspect()+"=>"+i.$inspect());return"{"+n.join(", ")+"}"}finally{t&&(be=undefined)}},W.$$arity=0),e.def(ve,"$invert",J=function(){for(var t,r,n=this,a=e.hash(),i=0,$=n.$$keys,o=$.length;i<o;i++)(t=$[i]).$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),e.hash_put(a,r,t);return a},J.$$arity=0),e.def(ve,"$keep_if",X=function(){var t,r=X.$$p,n=r||$,a=this;if(r&&(X.$$p=null),r&&(X.$$p=null),!c(n))return l(a,"enum_for",["keep_if"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s,u=0,p=a.$$keys,d=p.length;u<d;u++)(i=p[u]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(s=n(i,o))&&s!==$||e.hash_delete(a,i)!==undefined&&(d--,u--);return a},X.$$arity=0),e.alias(ve,"key","index"),e.alias(ve,"key?","has_key?"),e.def(ve,"$keys",Z=function(){for(var e,t=[],r=0,n=this.$$keys,a=n.length;r<a;r++)(e=n[r]).$$is_string?t.push(e):t.push(e.key);return t},Z.$$arity=0),e.def(ve,"$length",Q=function(){return this.$$keys.length},Q.$$arity=0),e.alias(ve,"member?","has_key?"),e.def(ve,"$merge",ee=function(e){var t=ee.$$p,r=t||$,n=this;return t&&(ee.$$p=null),t&&(ee.$$p=null),l(n.$dup(),"merge!",[e],r.$to_proc())},ee.$$arity=1),e.def(ve,"$merge!",te=function(t){var r=te.$$p,n=r||$,a=this;r&&(te.$$p=null),r&&(te.$$p=null),t.$$is_hash||(t=o(we,"Opal")["$coerce_to!"](t,o(we,"Hash"),"to_hash"));var i,s,l,u,c=t.$$keys,p=c.length;if(n===$){for(i=0;i<p;i++)(s=c[i]).$$is_string?u=t.$$smap[s]:(u=s.value,s=s.key),e.hash_put(a,s,u);return a}for(i=0;i<p;i++)(s=c[i]).$$is_string?u=t.$$smap[s]:(u=s.value,s=s.key),(l=e.hash_get(a,s))!==undefined?e.hash_put(a,s,n(s,l,u)):e.hash_put(a,s,u);return a},te.$$arity=1),e.def(ve,"$rassoc",re=function(e){for(var t,r,n=this,a=0,i=n.$$keys,o=i.length;a<o;a++)if((t=i[a]).$$is_string?r=n.$$smap[t]:(r=t.value,t=t.key),r["$=="](e))return[t,r];return $},re.$$arity=1),e.def(ve,"$rehash",ne=function(){var t=this;return e.hash_rehash(t),t},ne.$$arity=0),e.def(ve,"$reject",ae=function(){var t,r=ae.$$p,n=r||$,a=this;if(r&&(ae.$$p=null),r&&(ae.$$p=null),!c(n))return l(a,"enum_for",["reject"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s,u=e.hash(),p=0,d=a.$$keys,_=d.length;p<_;p++)(i=d[p]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(s=n(i,o))&&s!==$||e.hash_put(u,i,o);return u},ae.$$arity=0),e.def(ve,"$reject!",ie=function(){var t,r=ie.$$p,n=r||$,a=this;if(r&&(ie.$$p=null),r&&(ie.$$p=null),!c(n))return l(a,"enum_for",["reject!"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s,u=!1,p=0,d=a.$$keys,_=d.length;p<_;p++)(i=d[p]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(s=n(i,o))&&s!==$&&e.hash_delete(a,i)!==undefined&&(u=!0,_--,p--);return u?a:$},ie.$$arity=0),e.def(ve,"$replace",$e=function(t){var r=this,a=$;t=o(we,"Opal")["$coerce_to!"](t,o(we,"Hash"),"to_hash"),e.hash_init(r);for(var i,s,u=0,p=t.$$keys,d=p.length;u<d;u++)(i=p[u]).$$is_string?s=t.$$smap[i]:(s=i.value,i=i.key),e.hash_put(r,i,s);return c(t.$default_proc())?(a=[t.$default_proc()],l(r,"default_proc=",e.to_a(a)),a[n(a.length,1)]):(a=[t.$default()],l(r,"default=",e.to_a(a)),a[n(a.length,1)]),r},$e.$$arity=1),e.def(ve,"$select",oe=function(){var t,r=oe.$$p,n=r||$,a=this;if(r&&(oe.$$p=null),r&&(oe.$$p=null),!c(n))return l(a,"enum_for",["select"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s,u=e.hash(),p=0,d=a.$$keys,_=d.length;p<_;p++)(i=d[p]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(s=n(i,o))&&s!==$&&e.hash_put(u,i,o);return u},oe.$$arity=0),e.def(ve,"$select!",se=function(){var t,r=se.$$p,n=r||$,a=this;if(r&&(se.$$p=null),r&&(se.$$p=null),!c(n))return l(a,"enum_for",["select!"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s,u=$,p=0,d=a.$$keys,_=d.length;p<_;p++)(i=d[p]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),!1!==(s=n(i,o))&&s!==$||(e.hash_delete(a,i)!==undefined&&(_--,p--),u=a);return u},se.$$arity=0),e.def(ve,"$shift",le=function(){var t,r=this,n=r.$$keys
;return n.length>0?[t=(t=n[0]).$$is_string?t:t.key,e.hash_delete(r,t)]:r.$default($)},le.$$arity=0),e.alias(ve,"size","length"),e.def(ve,"$slice",ue=function(){var t,r=this;t=e.slice.call(arguments,0,arguments.length);for(var n=e.hash(),a=0,i=t.length;a<i;a++){var $=t[a],o=e.hash_get(r,$);o!==undefined&&e.hash_put(n,$,o)}return n},ue.$$arity=-1),e.alias(ve,"store","[]="),e.def(ve,"$to_a",ce=function(){for(var e,t,r=this,n=[],a=0,i=r.$$keys,$=i.length;a<$;a++)(e=i[a]).$$is_string?t=r.$$smap[e]:(t=e.value,e=e.key),n.push([e,t]);return n},ce.$$arity=0),e.def(ve,"$to_h",pe=function(){var t=this;if(t.$$class===e.Hash)return t;var r=new e.Hash;return e.hash_init(r),e.hash_clone(t,r),r},pe.$$arity=0),e.def(ve,"$to_hash",de=function(){return this},de.$$arity=0),e.def(ve,"$to_proc",_e=function(){var e,t=this;return l(t,"proc",[],((e=function(t){var r=e.$$s||this;return null==t&&r.$raise(o(we,"ArgumentError"),"no key given"),r["$[]"](t)}).$$s=t,e.$$arity=-1,e))},_e.$$arity=0),e.alias(ve,"to_s","inspect"),e.def(ve,"$transform_keys",fe=function(){var t,r=fe.$$p,n=r||$,a=this;if(r&&(fe.$$p=null),r&&(fe.$$p=null),!c(n))return l(a,"enum_for",["transform_keys"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s=e.hash(),u=0,p=a.$$keys,d=p.length;u<d;u++)(i=p[u]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),i=e.yield1(n,i),e.hash_put(s,i,o);return s},fe.$$arity=0),e.def(ve,"$transform_keys!",he=function(){var t,r=he.$$p,n=r||$,a=this;if(r&&(he.$$p=null),r&&(he.$$p=null),!c(n))return l(a,"enum_for",["transform_keys!"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));var i,o,s,u,p=e.slice.call(a.$$keys),d=p.length;for(i=0;i<d;i++)(o=p[i]).$$is_string?s=a.$$smap[o]:(s=o.value,o=o.key),u=e.yield1(n,o),e.hash_delete(a,o),e.hash_put(a,u,s);return a},he.$$arity=0),e.def(ve,"$transform_values",ye=function(){var t,r=ye.$$p,n=r||$,a=this;if(r&&(ye.$$p=null),r&&(ye.$$p=null),!c(n))return l(a,"enum_for",["transform_values"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s=e.hash(),u=0,p=a.$$keys,d=p.length;u<d;u++)(i=p[u]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),o=e.yield1(n,o),e.hash_put(s,i,o);return s},ye.$$arity=0),e.def(ve,"$transform_values!",me=function(){var t,r=me.$$p,n=r||$,a=this;if(r&&(me.$$p=null),r&&(me.$$p=null),!c(n))return l(a,"enum_for",["transform_values!"],((t=function(){return(t.$$s||this).$size()}).$$s=a,t.$$arity=0,t));for(var i,o,s=0,u=a.$$keys,p=u.length;s<p;s++)(i=u[s]).$$is_string?o=a.$$smap[i]:(o=i.value,i=i.key),o=e.yield1(n,o),e.hash_put(a,i,o);return a},me.$$arity=0),e.alias(ve,"update","merge!"),e.alias(ve,"value?","has_value?"),e.alias(ve,"values_at","indexes"),e.def(ve,"$values",ge=function(){for(var e,t=this,r=[],n=0,a=t.$$keys,i=a.length;n<i;n++)(e=a[n]).$$is_string?r.push(t.$$smap[e]):r.push(e.value);return r},ge.$$arity=0),$&&"values"}(i[0],0,i)},Opal.modules["corelib/number"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var l=e.top,u=[],c=e.nil,p=e.const_get_qualified,d=e.const_get_relative,_=(e.breaker,e.slice,e.klass),f=e.truthy,h=e.send,y=e.hash2;return e.add_stubs(["$require","$bridge","$raise","$name","$class","$Float","$respond_to?","$coerce_to!","$__coerced__","$===","$!","$>","$**","$new","$<","$to_f","$==","$nan?","$infinite?","$enum_for","$+","$-","$gcd","$lcm","$%","$/","$frexp","$to_i","$ldexp","$rationalize","$*","$<<","$to_r","$truncate","$-@","$size","$<=","$>=","$<=>","$compare","$any?"]),l.$require("corelib/numeric"),function(l,$super,u){var m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q,ee,te,re,ne,ae,ie,$e,oe,se,le,ue,ce,pe,de,_e,fe,he,ye,me,ge,be,ve,we,ke,xe,Ee,Oe,Ae,Te,Se,Ie,Re,Ce,qe,Me,ze,Ne=_(l,$super,"Number"),je=[Ne].concat(u);d(je,"Opal").$bridge(Number,Ne),e.defineProperty(Ne.$$prototype,"$$is_number",!0),Ne.$$is_number_class=!0,function(t,r){var n,a=[t].concat(r);e.def(t,"$allocate",n=function(){var e=this;return e.$raise(d(a,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),e.udef(t,"$new")}(e.get_singleton_class(Ne),je),e.def(Ne,"$coerce",m=function(e){var t=this;if(e===c)t.$raise(d(je,"TypeError"),"can't convert "+e.$class()+" into Float");else{if(e.$$is_string)return[t.$Float(e),t];if(e["$respond_to?"]("to_f"))return[d(je,"Opal")["$coerce_to!"](e,d(je,"Float"),"to_f"),t];if(e.$$is_number)return[e,t];t.$raise(d(je,"TypeError"),"can't convert "+e.$class()+" into Float")}},m.$$arity=1),e.def(Ne,"$__id__",g=function(){return 2*this+1},g.$$arity=0),e.alias(Ne,"object_id","__id__"),e.def(Ne,"$+",b=function(e){var t=this;return e.$$is_number?t+e:t.$__coerced__("+",e)},b.$$arity=1),e.def(Ne,"$-",v=function(e){var t=this;return e.$$is_number?t-e:t.$__coerced__("-",e)},v.$$arity=1),e.def(Ne,"$*",w=function(e){var t=this;return e.$$is_number?t*e:t.$__coerced__("*",e)},w.$$arity=1),e.def(Ne,"$/",k=function(e){var t=this;return e.$$is_number?t/e:t.$__coerced__("/",e)},k.$$arity=1),e.alias(Ne,"fdiv","/"),e.def(Ne,"$%",x=function(e){var t=this;return e.$$is_number?e==-Infinity?e:0!=e?e<0||t<0?(t%e+e)%e:t%e:void t.$raise(d(je,"ZeroDivisionError"),"divided by 0"):t.$__coerced__("%",e)},x.$$arity=1),e.def(Ne,"$&",E=function(e){var t=this;return e.$$is_number?t&e:t.$__coerced__("&",e)},E.$$arity=1),e.def(Ne,"$|",O=function(e){var t=this;return e.$$is_number?t|e:t.$__coerced__("|",e)},O.$$arity=1),e.def(Ne,"$^",A=function(e){var t=this;return e.$$is_number?t^e:t.$__coerced__("^",e)},A.$$arity=1),e.def(Ne,"$<",T=function(e){var t=this;return e.$$is_number?t<e:t.$__coerced__("<",e)},T.$$arity=1),e.def(Ne,"$<=",S=function(e){var t=this;return e.$$is_number?t<=e:t.$__coerced__("<=",e)},S.$$arity=1),e.def(Ne,"$>",I=function(e){var t=this;return e.$$is_number?t>e:t.$__coerced__(">",e)},I.$$arity=1),e.def(Ne,"$>=",R=function(e){var t=this;return e.$$is_number?t>=e:t.$__coerced__(">=",e)},R.$$arity=1);var Pe=function(e,t){return t.$$is_number?isNaN(e)||isNaN(t)?c:e>t?1:e<t?-1:0:e.$__coerced__("<=>",t)};e.def(Ne,"$<=>",C=function(t){var r=this;try{return Pe(r,t)}catch(n){if(!e.rescue(n,[d(je,"ArgumentError")]))throw n;try{return c}finally{e.pop_exception()}}},C.$$arity=1),e.def(Ne,"$<<",q=function(e){var t=this;return(e=d(je,"Opal")["$coerce_to!"](e,d(je,"Integer"),"to_int"))>0?t<<e:t>>-e},q.$$arity=1),e.def(Ne,"$>>",M=function(e){var t=this;return(e=d(je,"Opal")["$coerce_to!"](e,d(je,"Integer"),"to_int"))>0?t>>e:t<<-e},M.$$arity=1),e.def(Ne,"$[]",z=function(e){var t=this;return(e=d(je,"Opal")["$coerce_to!"](e,d(je,"Integer"),"to_int"))<0?0:e>=32?t<0?1:0:t>>e&1},z.$$arity=1),e.def(Ne,"$+@",N=function(){return+this},N.$$arity=0),e.def(Ne,"$-@",j=function(){return-this},j.$$arity=0),e.def(Ne,"$~",P=function(){return~this},P.$$arity=0),e.def(Ne,"$**",B=function(e){var n,a,i=this;return f(d(je,"Integer")["$==="](e))?f(f(n=d(je,"Integer")["$==="](i)["$!"]())?n:t(e,0))?Math.pow(i,e):d(je,"Rational").$new(i,1)["$**"](e):f((n=r(i,0))?f(a=d(je,"Float")["$==="](e))?a:d(je,"Rational")["$==="](e):r(i,0))?d(je,"Complex").$new(i,0)["$**"](e.$to_f()):f(null!=e.$$is_number)?Math.pow(i,e):i.$__coerced__("**",e)},B.$$arity=1),e.def(Ne,"$===",L=function(e){var t=this;return e.$$is_number?t.valueOf()===e.valueOf():!!e["$respond_to?"]("==")&&e["$=="](t)},L.$$arity=1),e.def(Ne,"$==",D=function(e){var t=this;return e.$$is_number?t.valueOf()===e.valueOf():!!e["$respond_to?"]("==")&&e["$=="](t)},D.$$arity=1),e.def(Ne,"$abs",G=function(){var e=this;return Math.abs(e)},G.$$arity=0),e.def(Ne,"$abs2",H=function(){var e=this;return Math.abs(e*e)},H.$$arity=0),e.def(Ne,"$allbits?",F=function(e){return(this&(e=d(je,"Opal")["$coerce_to!"](e,d(je,"Integer"),"to_int")))==e},F.$$arity=1),e.def(Ne,"$anybits?",U=function(e){return 0!=(this&(e=d(je,"Opal")["$coerce_to!"](e,d(je,"Integer"),"to_int")))},U.$$arity=1),e.def(Ne,"$angle",K=function(){var e=this;return f(e["$nan?"]())?e:0==e?1/e>0?0:Math.PI:e<0?Math.PI:0},K.$$arity=0),e.alias(Ne,"arg","angle"),e.alias(Ne,"phase","angle"),e.def(Ne,"$bit_length",Y=function(){var e=this;if(f(d(je,"Integer")["$==="](e))||e.$raise(d(je,"NoMethodError").$new("undefined method `bit_length` for "+e+":Float","bit_length")),0===e||-1===e)return 0;for(var t=0,r=e<0?~e:e;0!=r;)t+=1,r>>>=1;return t},Y.$$arity=0),e.def(Ne,"$ceil",V=function(e){null==e&&(e=0);var t=this.$to_f();if(t%1==0&&e>=0)return t;var r=Math.pow(10,e),n=Math.ceil(t*r)/r;return t%1==0&&(n=Math.round(n)),n},V.$$arity=-1),e.def(Ne,"$chr",W=function(){var e=this;return String.fromCharCode(e)},W.$$arity=-1),e.def(Ne,"$denominator",J=function(){var t,r=J.$$p,n=this,a=c,i=c,$=c;for(r&&(J.$$p=null),i=0,$=arguments.length,a=new Array($);i<$;i++)a[i]=arguments[i];return f(f(t=n["$nan?"]())?t:n["$infinite?"]())?1:h(n,e.find_super_dispatcher(n,"denominator",J,!1),a,r)},J.$$arity=0),e.def(Ne,"$downto",X=function(e){var r,i=X.$$p,$=i||c,o=this;if(i&&(X.$$p=null),i&&(X.$$p=null),$===c)return h(o,"enum_for",["downto",e],((r=function(){var i=r.$$s||this;return f(d(je,"Numeric")["$==="](e))||i.$raise(d(je,"ArgumentError"),"comparison of "+i.$class()+" with "+e.$class()+" failed"),f(t(e,i))?0:n(a(i,e),1)}).$$s=o,r.$$arity=0,r));e.$$is_number||o.$raise(d(je,"ArgumentError"),"comparison of "+o.$class()+" with "+e.$class()+" failed");for(var s=o;s>=e;s--)$(s);return o},X.$$arity=1),e.alias(Ne,"eql?","=="),e.def(Ne,"$equal?",Z=function(e){var t,r=this;return f(t=r["$=="](e))?t:isNaN(r)&&isNaN(e)},Z.$$arity=1),e.def(Ne,"$even?",Q=function(){return this%2==0},Q.$$arity=0),e.def(Ne,"$floor",ee=function(e){null==e&&(e=0);var t=this.$to_f();if(t%1==0&&e>=0)return t;var r=Math.pow(10,e),n=Math.floor(t*r)/r;return t%1==0&&(n=Math.round(n)),n},ee.$$arity=-1),e.def(Ne,"$gcd",te=function(e){var t=this;f(d(je,"Integer")["$==="](e))||t.$raise(d(je,"TypeError"),"not an integer");for(var r=Math.abs(t),n=Math.abs(e);r>0;){var a=r;r=n%r,n=a}return n},te.$$arity=1),e.def(Ne,"$gcdlcm",re=function(){var e=this;return[e.$gcd(),e.$lcm()]},re.$$arity=1),e.def(Ne,"$integer?",ne=function(){return this%1==0},ne.$$arity=0),e.def(Ne,"$is_a?",ae=function(t){var r=ae.$$p,n=this,a=c,i=c,$=c;for(r&&(ae.$$p=null),i=0,$=arguments.length,a=new Array($);i<$;i++)a[i]=arguments[i];return!!f(t["$=="](d(je,"Integer"))?d(je,"Integer")["$==="](n):t["$=="](d(je,"Integer")))||(!!f(t["$=="](d(je,"Integer"))?d(je,"Integer")["$==="](n):t["$=="](d(je,"Integer")))||(!!f(t["$=="](d(je,"Float"))?d(je,"Float")["$==="](n):t["$=="](d(je,"Float")))||h(n,e.find_super_dispatcher(n,"is_a?",ae,!1),a,r)))},ae.$$arity=1),e.alias(Ne,"kind_of?","is_a?"),e.def(Ne,"$instance_of?",ie=function(t){var r=ie.$$p,n=this,a=c,i=c,$=c;for(r&&(ie.$$p=null),i=0,$=arguments.length,a=new Array($);i<$;i++)a[i]=arguments[i];return!!f(t["$=="](d(je,"Integer"))?d(je,"Integer")["$==="](n):t["$=="](d(je,"Integer")))||(!!f(t["$=="](d(je,"Integer"))?d(je,"Integer")["$==="](n):t["$=="](d(je,"Integer")))||(!!f(t["$=="](d(je,"Float"))?d(je,"Float")["$==="](n):t["$=="](d(je,"Float")))||h(n,e.find_super_dispatcher(n,"instance_of?",ie,!1),a,r)))},ie.$$arity=1),e.def(Ne,"$lcm",$e=function(e){var t=this;return f(d(je,"Integer")["$==="](e))||t.$raise(d(je,"TypeError"),"not an integer"),0==t||0==e?0:Math.abs(t*e/t.$gcd(e))},$e.$$arity=1),e.alias(Ne,"magnitude","abs"),e.alias(Ne,"modulo","%"),e.def(Ne,"$next",oe=function(){return this+1},oe.$$arity=0),e.def(Ne,"$nobits?",se=function(e){return 0==(this&(e=d(je,"Opal")["$coerce_to!"](e,d(je,"Integer"),"to_int")))},se.$$arity=1),e.def(Ne,"$nonzero?",le=function(){var e=this;return 0==e?c:e},le.$$arity=0),e.def(Ne,"$numerator",ue=function(){var t,r=ue.$$p,n=this,a=c,i=c,$=c;for(r&&(ue.$$p=null),i=0,$=arguments.length,a=new Array($);i<$;i++)a[i]=arguments[i];return f(f(t=n["$nan?"]())?t:n["$infinite?"]())?n:h(n,e.find_super_dispatcher(n,"numerator",ue,!1),a,r)},ue.$$arity=0),e.def(Ne,"$odd?",ce=function(){return this%2!=0},ce.$$arity=0),e.def(Ne,"$ord",pe=function(){return this},pe.$$arity=0),e.def(Ne,"$pow",de=function(e,t){var r=this;return 0==r&&r.$raise(d(je,"ZeroDivisionError"),"divided by 0"),t===undefined?r["$**"](e):(d(je,"Integer")["$==="](e)||r.$raise(d(je,"TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),e<0&&r.$raise(d(je,"TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),d(je,"Integer")["$==="](t)||r.$raise(d(je,"TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===t&&r.$raise(d(je,"ZeroDivisionError"),"divided by 0"),r["$**"](e)["$%"](t))},de.$$arity=-2),e.def(Ne,"$pred",_e=function(){return this-1},_e.$$arity=0),e.def(Ne,"$quo",fe=function(t){var r=fe.$$p,n=this,a=c,$=c,o=c;for(r&&(fe.$$p=null),$=0,o=arguments.length,a=new Array(o);$<o;$++)a[$]=arguments[$];return f(d(je,"Integer")["$==="](n))?h(n,e.find_super_dispatcher(n,"quo",fe,!1),a,r):i(n,t)},fe.$$arity=1),e.def(Ne,"$rationalize",he=function(t){var r,n,i=this,o=c,s=c;return arguments.length>1&&i.$raise(d(je,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),f(d(je,"Integer")["$==="](i))?d(je,"Rational").$new(i,1):f(i["$infinite?"]())?i.$raise(d(je,"FloatDomainError"),"Infinity"):f(i["$nan?"]())?i.$raise(d(je,"FloatDomainError"),"NaN"):f(null==t)?(n=d(je,"Math").$frexp(i),o=null==(r=e.to_ary(n))[0]?c:r[0],s=null==r[1]?c:r[1],o=d(je,"Math").$ldexp(o,p(d(je,"Float"),"MANT_DIG")).$to_i(),s=a(s,p(d(je,"Float"),"MANT_DIG")),d(je,"Rational").$new($(2,o),1["$<<"](a(1,s))).$rationalize(d(je,"Rational").$new(1,1["$<<"](a(1,s))))):i.$to_r().$rationalize(t)},he.$$arity=-1),e.def(Ne,"$remainder",ye=function(e){var t=this;return a(t,$(e,i(t,e).$truncate()))},ye.$$arity=1),e.def(Ne,"$round",me=function($){var l,u,_=this,h=c;if(f(d(je,"Integer")["$==="](_))){if(f(null==$))return _;if(f(f(l=d(je,"Float")["$==="]($))?$["$infinite?"]():l)&&_.$raise(d(je,"RangeError"),"Infinity"),$=d(je,"Opal")["$coerce_to!"]($,d(je,"Integer"),"to_int"),f(r($,p(d(je,"Integer"),"MIN")))&&_.$raise(d(je,"RangeError"),"out of bounds"),f($>=0))return _;if(.415241*($=$["$-@"]())-.125>_.$size())return 0;var y=Math.pow(10,$),m=Math.floor((Math.abs(m)+y/2)/y)*y;return _<0?-m:m}if(f(f(l=_["$nan?"]())?null==$:l)&&_.$raise(d(je,"FloatDomainError"),"NaN"),$=d(je,"Opal")["$coerce_to!"]($||0,d(je,"Integer"),"to_int"),f(o($,0)))f(_["$nan?"]())?_.$raise(d(je,"RangeError"),"NaN"):f(_["$infinite?"]())&&_.$raise(d(je,"FloatDomainError"),"Infinity");else{if($["$=="](0))return Math.round(_);if(f(f(l=_["$nan?"]())?l:_["$infinite?"]()))return _}return u=d(je,"Math").$frexp(_),null==(l=e.to_ary(u))[0]?c:l[0],h=null==l[1]?c:l[1],f(s($,a(n(p(d(je,"Float"),"DIG"),2),f(t(h,0))?i(h,4):a(i(h,3),1))))?_:f(r($,(f(t(h,0))?n(i(h,3),1):i(h,4))["$-@"]()))?0:Math.round(_*Math.pow(10,$))/Math.pow(10,$)},me.$$arity=-1),e.def(Ne,"$step",ge=function(){function t(){s!==undefined&&($=s),$===undefined&&($=c),o===c&&m.$raise(d(je,"TypeError"),"step must be numeric"),0===o&&m.$raise(d(je,"ArgumentError"),"step can't be 0"),l!==undefined&&(o=l),o!==c&&null!=o||(o=1);var e=o["$<=>"](0);e===c&&m.$raise(d(je,"ArgumentError"),"0 can't be coerced into "+o.$class()),$!==c&&null!=$||($=e>0?p(d(je,"Float"),"INFINITY"):p(d(je,"Float"),"INFINITY")["$-@"]()),d(je,"Opal").$compare(m,$)}function r(){if(o>0&&m>$||o<0&&m<$)return 0;if(o===Infinity||o===-Infinity)return 1;var e=Math.abs,t=Math.floor,r=(e(m)+e($)+e($-m))/e(o)*p(d(je,"Float"),"EPSILON");return r===Infinity||r===-Infinity?0:(r>.5&&(r=.5),t(($-m)/o+r)+1)}function n(){if(t(),0===o)return Infinity;if(o%1!=0)return r();if(o>0&&m>$||o<0&&m<$)return 0;var e=Math.ceil,n=Math.abs;return e((n(m-$)+1)/n(o))}var a,i,$,o,s,l,u,_=ge.$$p,f=_||c,m=this,g=c,b=c;if(_&&(ge.$$p=null),_&&(ge.$$p=null),a=e.slice.call(arguments,0,arguments.length),null==(i=e.extract_kwargs(a)))i=y([],{});else if(!i.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(a.length>0&&($=a[0],a.splice(0,1)),a.length>0&&(o=a[0],a.splice(0,1)),s=i.$$smap.to,l=i.$$smap.by,$!==undefined&&s!==undefined&&m.$raise(d(je,"ArgumentError"),"to is given twice"),o!==undefined&&l!==undefined&&m.$raise(d(je,"ArgumentError"),"step is given twice"),f===c)return g=[],b=y([],{}),$!==undefined&&g.push($),o!==undefined&&g.push(o),s!==undefined&&e.hash_put(b,"to",s),l!==undefined&&e.hash_put(b,"by",l),b["$any?"]()&&g.push(b),h(m,"enum_for",["step"].concat(e.to_a(g)),((u=function(){u.$$s;return n()}).$$s=m,u.$$arity=0,u));if(t(),0===o)for(;;)f(m);if(m%1!=0||$%1!=0||o%1!=0){var v=r();if(v>0)if(o===Infinity||o===-Infinity)f(m);else{var w,k=0;if(o>0)for(;k<v;)$<(w=k*o+m)&&(w=$),f(w),k+=1;else for(;k<v;)$>(w=k*o+m)&&(w=$),f(w),k+=1}}else{var x=m;if(o>0)for(;x<=$;)f(x),x+=o;else for(;x>=$;)f(x),x+=o}return m},ge.$$arity=-1),e.alias(Ne,"succ","next"),e.def(Ne,"$times",be=function(){var e,t=be.$$p,r=t||c,n=this;if(t&&(be.$$p=null),t&&(be.$$p=null),!f(r))return h(n,"enum_for",["times"],((e=function(){return e.$$s||this}).$$s=n,e.$$arity=0,e));for(var a=0;a<n;a++)r(a);return n},be.$$arity=0),e.def(Ne,"$to_f",ve=function(){return this},ve.$$arity=0),e.def(Ne,"$to_i",we=function(){return parseInt(this,10)},we.$$arity=0),e.alias(Ne,"to_int","to_i"),e.def(Ne,"$to_r",ke=function(){var t,r,n=this,i=c,o=c;return f(d(je,"Integer")["$==="](n))?d(je,"Rational").$new(n,1):(r=d(je,"Math").$frexp(n),i=null==(t=e.to_ary(r))[0]?c:t[0],o=null==t[1]?c:t[1],i=d(je,"Math").$ldexp(i,p(d(je,"Float"),"MANT_DIG")).$to_i(),o=a(o,p(d(je,"Float"),"MANT_DIG")),$(i,p(d(je,"Float"),"RADIX")["$**"](o)).$to_r())},ke.$$arity=0),e.def(Ne,"$to_s",xe=function(e){var n,a=this;return null==e&&(e=10),e=d(je,"Opal")["$coerce_to!"](e,d(je,"Integer"),"to_int"),f(f(n=r(e,2))?n:t(e,36))&&a.$raise(d(je,"ArgumentError"),"invalid radix "+e),a.toString(e)},xe.$$arity=-1),e.def(Ne,"$truncate",Ee=function(e){null==e&&(e=0);var t=this.$to_f();if(t%1==0&&e>=0)return t;var r=Math.pow(10,e),n=parseInt(t*r,10)/r;return t%1==0&&(n=Math.round(n)),n},Ee.$$arity=-1),e.alias(Ne,"inspect","to_s"),e.def(Ne,"$digits",Oe=function(e){var t=this;null==e&&(e=10),r(t,0)&&t.$raise(p(d(je,"Math"),"DomainError"),"out of domain"),e=d(je,"Opal")["$coerce_to!"](e,d(je,"Integer"),"to_int"),f(r(e,2))&&t.$raise(d(je,"ArgumentError"),"invalid radix "+e);for(var n=t,a=[];0!==n;)a.push(n%e),n=parseInt(n/e,10);return a},Oe.$$arity=-1),e.def(Ne,"$divmod",Ae=function(t){var r,n=Ae.$$p,a=this,i=c,$=c,o=c;for(n&&(Ae.$$p=null),$=0,o=arguments.length,i=new Array(o);$<o;$++)i[$]=arguments[$];return f(f(r=a["$nan?"]())?r:t["$nan?"]())?a.$raise(d(je,"FloatDomainError"),"NaN"):f(a["$infinite?"]())?a.$raise(d(je,"FloatDomainError"),"Infinity"):h(a,e.find_super_dispatcher(a,"divmod",Ae,!1),i,n)},Ae.$$arity=1),e.def(Ne,"$upto",Te=function(e){var t,i=Te.$$p,$=i||c,o=this;if(i&&(Te.$$p=null),i&&(Te.$$p=null),$===c)return h(o,"enum_for",["upto",e],((t=function(){var i=t.$$s||this;return f(d(je,"Numeric")["$==="](e))||i.$raise(d(je,"ArgumentError"),"comparison of "+i.$class()+" with "+e.$class()+" failed"),f(r(e,i))?0:n(a(e,i),1)}).$$s=o,t.$$arity=0,t));e.$$is_number||o.$raise(d(je,"ArgumentError"),"comparison of "+o.$class()+" with "+e.$class()+" failed");for(var s=o;s<=e;s++)$(s);return o},Te.$$arity=1),e.def(Ne,"$zero?",Se=function(){return 0==this},Se.$$arity=0),e.def(Ne,"$size",Ie=function(){return 4},Ie.$$arity=0),e.def(Ne,"$nan?",Re=function(){return isNaN(this)},Re.$$arity=0),e.def(Ne,"$finite?",Ce=function(){var e=this;return e!=Infinity&&e!=-Infinity&&!isNaN(e)},Ce.$$arity=0),e.def(Ne,"$infinite?",qe=function(){var e=this;return e==Infinity?1:e==-Infinity?-1:c},qe.$$arity=0),e.def(Ne,"$positive?",Me=function(){var e=this;return 0!=e&&(e==Infinity||1/e>0)},Me.$$arity=0),e.def(Ne,"$negative?",ze=function(){var e=this;return e==-Infinity||1/e<0},ze.$$arity=0)}(u[0],d(u,"Numeric"),u),e.const_set(u[0],"Fixnum",d(u,"Number")),function(t,$super,r){var n=_(t,$super,"Integer"),a=[n].concat(r);n.$$is_number_class=!0,function(t,r){var n,a,i,$=[t].concat(r);e.def(t,"$allocate",n=function(){var e=this;return e.$raise(d($,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),e.udef(t,"$new"),e.def(t,"$===",a=function(e){return!!e.$$is_number&&e%1==0},a.$$arity=1),e.def(t,"$sqrt",i=function(e){var t=this;return(e=d($,"Opal")["$coerce_to!"](e,d($,"Integer"),"to_int"))<0&&t.$raise(p(d($,"Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(e),10)},i.$$arity=1)}(e.get_singleton_class(n),a),e.const_set(a[0],"MAX",Math.pow(2,30)-1),e.const_set(a[0],"MIN",-Math.pow(2,30))}(u[0],d(u,"Numeric"),u),function(t,$super,r){var n=_(t,$super,"Float"),a=[n].concat(r);return n.$$is_number_class=!0,function(t,r){var n,a,i=[t].concat(r);e.def(t,"$allocate",n=function(){var e=this;return e.$raise(d(i,"TypeError"),"allocator undefined for "+e.$name())},n.$$arity=0),e.udef(t,"$new"),e.def(t,"$===",a=function(e){return!!e.$$is_number},a.$$arity=1)}(e.get_singleton_class(n),a),e.const_set(a[0],"INFINITY",Infinity),e.const_set(a[0],"MAX",Number.MAX_VALUE),e.const_set(a[0],"MIN",Number.MIN_VALUE),e.const_set(a[0],"NAN",NaN),e.const_set(a[0],"DIG",15),e.const_set(a[0],"MANT_DIG",53),e.const_set(a[0],"RADIX",2),e.const_set(a[0],"EPSILON",Number.EPSILON||2.220446049250313e-16)}(u[0],d(u,"Numeric"),u)},Opal.modules["corelib/range"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var l=e.top,u=[],c=e.nil,p=e.const_get_qualified,d=e.const_get_relative,_=(e.breaker,e.slice,e.klass),f=e.truthy,h=e.send;return e.add_stubs(["$require","$include","$attr_reader","$raise","$<=>","$include?","$<=","$<","$enum_for","$upto","$to_proc","$respond_to?","$class","$succ","$!","$==","$===","$exclude_end?","$eql?","$begin","$end","$last","$to_a","$>","$-","$abs","$to_i","$coerce_to!","$ceil","$/","$size","$loop","$+","$*","$>=","$each_with_index","$%","$bsearch","$inspect","$[]","$hash"]),l.$require("corelib/enumerable"),function(l,$super,u){var y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z=_(l,null,"Range"),N=[z].concat(u);return z.$$prototype.begin=z.$$prototype.end=z.$$prototype.excl=c,z.$include(d(N,"Enumerable")),z.$$prototype.$$is_range=!0,z.$attr_reader("begin","end"),e.def(z,"$initialize",y=function(e,t,r){var n=this;return null==r&&(r=!1),f(n.begin)&&n.$raise(d(N,"NameError"),"'initialize' called twice"),f(e["$<=>"](t))||n.$raise(d(N,"ArgumentError"),"bad value for range"),n.begin=e,n.end=t,n.excl=r},y.$$arity=-3),e.def(z,"$==",m=function(e){var t=this;return!!e.$$is_range&&(t.excl===e.excl&&t.begin==e.begin&&t.end==e.end)},m.$$arity=1),e.def(z,"$===",g=function(e){return this["$include?"](e)},g.$$arity=1),e.def(z,"$cover?",b=function(e){var n,a=this,i=c,$=c;return i=a.begin["$<=>"](e),!!f(f(n=i)?t(i,0):n)&&($=e["$<=>"](a.end),f(a.excl)?f(n=$)?r($,0):n:f(n=$)?t($,0):n)},b.$$arity=1),e.def(z,"$each",v=function(){var t,n,a,i=v.$$p,$=i||c,o=this,s=c,l=c;if(i&&(v.$$p=null),i&&(v.$$p=null),$===c)return o.$enum_for("each");if(o.begin.$$is_number&&o.end.$$is_number){for(o.begin%1==0&&o.end%1==0||o.$raise(d(N,"TypeError"),"can't iterate from Float"),n=o.begin,a=o.end+(f(o.excl)?0:1);n<a;n++)$(n);return o}if(o.begin.$$is_string&&o.end.$$is_string)return h(o.begin,"upto",[o.end,o.excl],$.$to_proc()),o;for(s=o.begin,l=o.end,f(s["$respond_to?"]("succ"))||o.$raise(d(N,"TypeError"),"can't iterate from "+s.$class());f(r(s["$<=>"](l),0));)e.yield1($,s),s=s.$succ();return f(f(t=o.excl["$!"]())?s["$=="](l):t)&&e.yield1($,s),o},v.$$arity=0),e.def(z,"$eql?",w=function(e){var t,r,n=this;return!!f(d(N,"Range")["$==="](e))&&(f(t=f(r=n.excl["$==="](e["$exclude_end?"]()))?n.begin["$eql?"](e.$begin()):r)?n.end["$eql?"](e.$end()):t)},w.$$arity=1),e.def(z,"$exclude_end?",k=function(){return this.excl},k.$$arity=0),e.def(z,"$first",x=function(t){var r=x.$$p,n=this,a=c,i=c,$=c;for(r&&(x.$$p=null),i=0,$=arguments.length,a=new Array($);i<$;i++)a[i]=arguments[i];return f(null==t)?n.begin:h(n,e.find_super_dispatcher(n,"first",x,!1),a,r)},x.$$arity=-1),e.alias(z,"include?","cover?"),e.def(z,"$last",E=function(e){var t=this;return f(null==e)?t.end:t.$to_a().$last(e)},E.$$arity=-1),e.def(z,"$max",O=function(){var t,r=O.$$p,a=r||c,i=this,$=c,o=c,s=c;for(r&&(O.$$p=null),o=0,s=arguments.length,$=new Array(s);o<s;o++)$[o]=arguments[o];return a!==c?h(i,e.find_super_dispatcher(i,"max",O,!1),$,r):f(n(i.begin,i.end))?c:f(f(t=i.excl)?i.begin["$=="](i.end):t)?c:i.excl?i.end-1:i.end},O.$$arity=0),e.alias(z,"member?","cover?"),e.def(z,"$min",A=function(){var t,r=A.$$p,a=r||c,i=this,$=c,o=c,s=c;for(r&&(A.$$p=null),o=0,s=arguments.length,$=new Array(s);o<s;o++)$[o]=arguments[o];return a!==c?h(i,e.find_super_dispatcher(i,"min",A,!1),$,r):f(n(i.begin,i.end))?c:f(f(t=i.excl)?i.begin["$=="](i.end):t)?c:i.begin},A.$$arity=0),e.def(z,"$size",T=function(){var e,t=this,n=c,i=c,$=c;return n=t.begin,i=t.end,f(t.excl)&&(i=a(i,1)),f(f(e=d(N,"Numeric")["$==="](n))?d(N,"Numeric")["$==="](i):e)?f(r(i,n))?0:($=p(d(N,"Float"),"INFINITY"),f([n.$abs(),i.$abs()]["$include?"]($))?$:(Math.abs(i-n)+1).$to_i()):c},T.$$arity=0),e.def(z,"$step",S=function(t){function r(){t.$$is_number||(t=d(N,"Opal")["$coerce_to!"](t,d(N,"Integer"),"to_int")),t<0?g.$raise(d(N,"ArgumentError"),"step can't be negative"):0===t&&g.$raise(d(N,"ArgumentError"),"step can't be 0")}function a(){if(!g.begin["$respond_to?"]("succ"))return c;if(g.begin.$$is_string&&g.end.$$is_string)return c;if(t%1==0)return i(g.$size(),t).$ceil();var e,r=g.begin,n=g.end,a=Math.abs,$=Math.floor,o=(a(r)+a(n)+a(n-r))/a(t)*p(d(N,"Float"),"EPSILON");return o>.5&&(o=.5),g.excl?(e=$((n-r)/t-o))*t+r<n&&e++:e=$((n-r)/t+o)+1,e}var l,u,_,y=S.$$p,m=y||c,g=this,b=c;return y&&(S.$$p=null),null==t&&(t=1),m===c?h(g,"enum_for",["step",t],((l=function(){l.$$s;return r(),a()}).$$s=g,l.$$arity=0,l)):(r(),f(g.begin.$$is_number&&g.end.$$is_number)?(b=0,function(){var r=e.new_brk();try{h(g,"loop",[],((u=function(){var a=u.$$s||this,i=c;return null==a.begin&&(a.begin=c),null==a.excl&&(a.excl=c),null==a.end&&(a.end=c),i=$(a.begin,o(b,t)),f(a.excl)?f(s(i,a.end))&&e.brk(c,r):f(n(i,a.end))&&e.brk(c,r),e.yield1(m,i),b=$(b,1)}).$$s=g,u.$$brk=r,u.$$arity=0,u))}catch(a){if(a===r)return a.$v;throw a}}()):(g.begin.$$is_string&&g.end.$$is_string&&t%1!=0&&g.$raise(d(N,"TypeError"),"no implicit conversion to float from string"),h(g,"each_with_index",[],((_=function(r,n){_.$$s;return null==r&&(r=c),null==n&&(n=c),n["$%"](t)["$=="](0)?e.yield1(m,r):c}).$$s=g,_.$$arity=2,_))),g)},S.$$arity=-1),e.def(z,"$bsearch",I=function(){var e=I.$$p,t=e||c,r=this;return e&&(I.$$p=null),e&&(I.$$p=null),t===c?r.$enum_for("bsearch"):(f(r.begin.$$is_number&&r.end.$$is_number)||r.$raise(d(N,"TypeError"),"can't do binary search for "+r.begin.$class()),h(r.$to_a(),"bsearch",[],t.$to_proc()))},I.$$arity=0),e.def(z,"$to_s",R=function(){var e=this;return e.begin+(f(e.excl)?"...":"..")+e.end},R.$$arity=0),e.def(z,"$inspect",C=function(){var e=this;return e.begin.$inspect()+(f(e.excl)?"...":"..")+e.end.$inspect()},C.$$arity=0),e.def(z,"$marshal_load",q=function(e){var t=this;return t.begin=e["$[]"]("begin"),t.end=e["$[]"]("end"),t.excl=e["$[]"]("excl")},q.$$arity=1),e.def(z,"$hash",M=function(){var e=this;return[e.begin,e.end,e.excl].$hash()},M.$$arity=0),c&&"hash"}(u[0],0,u)},Opal.modules["corelib/proc"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice),i=e.klass,$=e.truthy;return e.add_stubs(["$raise","$coerce_to!"]),function(t,$super,o){var s,l,u,c,p,d,_,f,h,y,m=i(t,$super,"Proc"),g=[m].concat(o);return e.defineProperty(m.$$prototype,"$$is_proc",!0),e.defineProperty(m.$$prototype,"$$is_lambda",!1),e.defs(m,"$new",s=function(){var e=s.$$p,t=e||r,a=this;return e&&(s.$$p=null),e&&(s.$$p=null),$(t)||a.$raise(n(g,"ArgumentError"),"tried to create a Proc object without a block"),t},s.$$arity=0),e.def(m,"$call",l=function(){var t,n=l.$$p,a=n||r,i=this;n&&(l.$$p=null),n&&(l.$$p=null),t=e.slice.call(arguments,0,arguments.length),a!==r&&(i.$$p=a);var $,o=i.$$brk;if(o)try{$=i.$$is_lambda?i.apply(null,t):e.yieldX(i,t)}catch(s){if(s===o)return o.$v;throw s}else $=i.$$is_lambda?i.apply(null,t):e.yieldX(i,t);return $},l.$$arity=-1),e.alias(m,"[]","call"),e.alias(m,"===","call"),e.alias(m,"yield","call"),e.def(m,"$to_proc",u=function(){return this},u.$$arity=0),e.def(m,"$lambda?",c=function(){return!!this.$$is_lambda},c.$$arity=0),e.def(m,"$arity",p=function(){var e=this;return e.$$is_curried?-1:e.$$arity},p.$$arity=0),e.def(m,"$source_location",d=function(){return this.$$is_curried,r},d.$$arity=0),e.def(m,"$binding",_=function(){var e=this;return e.$$is_curried&&e.$raise(n(g,"ArgumentError"),"Can't create Binding"),r},_.$$arity=0),e.def(m,"$parameters",f=function(){var e=this;if(e.$$is_curried)return[["rest"]];if(e.$$parameters){if(e.$$is_lambda)return e.$$parameters;var t,r,n=[];for(t=0,r=e.$$parameters.length;t<r;t++){var a=e.$$parameters[t];"req"===a[0]&&(a=["opt",a[1]]),n.push(a)}return n}return[]},f.$$arity=0),e.def(m,"$curry",h=function(e){function t(){var i,$=a.call(arguments),o=$.length;return o>e&&r.$$is_lambda&&!r.$$is_curried&&r.$raise(n(g,"ArgumentError"),"wrong number of arguments ("+o+" for "+e+")"),o>=e?r.$call.apply(r,$):((i=function(){return t.apply(null,$.concat(a.call(arguments)))}).$$is_lambda=r.$$is_lambda,i.$$is_curried=!0,i)}var r=this;return e===undefined?e=r.length:(e=n(g,"Opal")["$coerce_to!"](e,n(g,"Integer"),"to_int"),r.$$is_lambda&&e!==r.length&&r.$raise(n(g,"ArgumentError"),"wrong number of arguments ("+e+" for "+r.length+")")),t.$$is_lambda=r.$$is_lambda,t.$$is_curried=!0,t},h.$$arity=-1),e.def(m,"$dup",y=function(){var e=this,t=e.$$original_proc||e,r=function(){return t.apply(this,arguments)};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r},y.$$arity=0),e.alias(m,"clone","dup")}(t[0],Function,t)},Opal.modules["corelib/method"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.truthy;return e.add_stubs(["$attr_reader","$arity","$new","$class","$join","$source_location","$raise"]),function(t,$super,$){var o,s,l,u,c,p,d,_,f,h=a(t,null,"Method"),y=[h].concat($);h.$$prototype.method=h.$$prototype.receiver=h.$$prototype.owner=h.$$prototype.name=r,h.$attr_reader("owner","receiver","name"),e.def(h,"$initialize",o=function(e,t,r,n){var a=this;return a.receiver=e,a.owner=t,a.name=n,a.method=r},o.$$arity=4),e.def(h,"$arity",s=function(){return this.method.$arity()},s.$$arity=0),e.def(h,"$parameters",l=function(){return this.method.$$parameters},l.$$arity=0),e.def(h,"$source_location",u=function(){var e;return i(e=this.method.$$source_location)?e:["(eval)",0]},u.$$arity=0),e.def(h,"$comments",c=function(){var e;return i(e=this.method.$$comments)?e:[]},c.$$arity=0),e.def(h,"$call",p=function(){var t,n=p.$$p,a=n||r,i=this;return n&&(p.$$p=null),n&&(p.$$p=null),t=e.slice.call(arguments,0,arguments.length),i.method.$$p=a,i.method.apply(i.receiver,t)},p.$$arity=-1),e.alias(h,"[]","call"),e.def(h,"$unbind",d=function(){var e=this;return n(y,"UnboundMethod").$new(e.receiver.$class(),e.owner,e.method,e.name)},d.$$arity=0),e.def(h,"$to_proc",_=function(){var e=this,t=e.$call.bind(e);return t.$$unbound=e.method,t.$$is_lambda=!0,t.$$arity=e.method.$$arity,t.$$parameters=e.method.$$parameters,t},_.$$arity=0),e.def(h,"$inspect",f=function(){var e=this;return"#<"+e.$class()+": "+e.receiver.$class()+"#"+e.name+" (defined in "+e.owner+" in "+e.$source_location().$join(":")+")>"},f.$$arity=0)}(t[0],0,t),function(t,$super,$){var o,s,l,u,c,p,d,_=a(t,null,"UnboundMethod"),f=[_].concat($);return _.$$prototype.method=_.$$prototype.owner=_.$$prototype.name=_.$$prototype.source=r,_.$attr_reader("source","owner","name"),e.def(_,"$initialize",o=function(e,t,r,n){var a=this;return a.source=e,a.owner=t,a.method=r,a.name=n},o.$$arity=4),e.def(_,"$arity",s=function(){return this.method.$arity()},s.$$arity=0),e.def(_,"$parameters",l=function(){
return this.method.$$parameters},l.$$arity=0),e.def(_,"$source_location",u=function(){var e;return i(e=this.method.$$source_location)?e:["(eval)",0]},u.$$arity=0),e.def(_,"$comments",c=function(){var e;return i(e=this.method.$$comments)?e:[]},c.$$arity=0),e.def(_,"$bind",p=function(t){var r=this;if(r.owner.$$is_module||e.is_a(t,r.owner))return n(f,"Method").$new(t,r.owner,r.method,r.name);r.$raise(n(f,"TypeError"),"can't bind singleton method to a different class (expected "+t+".kind_of?("+r.owner+" to be true)")},p.$$arity=1),e.def(_,"$inspect",d=function(){var e=this;return"#<"+e.$class()+": "+e.source+"#"+e.name+" (defined in "+e.owner+" in "+e.$source_location().$join(":")+")>"},d.$$arity=0),r&&"inspect"}(t[0],0,t)},Opal.modules["corelib/variables"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.gvars),i=e.hash2;return e.add_stubs(["$new"]),a["&"]=a["~"]=a["`"]=a["'"]=r,a.LOADED_FEATURES=a['"']=e.loaded_features,a.LOAD_PATH=a[":"]=[],a["/"]="\n",a[","]=r,e.const_set(t[0],"ARGV",[]),e.const_set(t[0],"ARGF",n(t,"Object").$new()),e.const_set(t[0],"ENV",i([],{})),a.VERBOSE=!1,a.DEBUG=!1,a.SAFE=0},Opal.modules["opal/regexp_anchors"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module);return e.add_stubs(["$==","$new"]),function(t,i){var $=[a(t,"Opal")].concat(i);e.const_set($[0],"REGEXP_START",n($,"RUBY_ENGINE")["$=="]("opal")?"^":r),e.const_set($[0],"REGEXP_END",n($,"RUBY_ENGINE")["$=="]("opal")?"$":r),e.const_set($[0],"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),e.const_set($[0],"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),e.const_set($[0],"INLINE_IDENTIFIER_REGEXP",n($,"Regexp").$new("[^"+n($,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+n($,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),e.const_set($[0],"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),e.const_set($[0],"CONST_NAME_REGEXP",n($,"Regexp").$new(n($,"REGEXP_START")+"(::)?[A-Z][^"+n($,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+n($,"REGEXP_END")))}(t[0],t)},Opal.modules["opal/mini"]=function(e){var t=e.top;e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice;return e.add_stubs(["$require"]),t.$require("opal/base"),t.$require("corelib/nil"),t.$require("corelib/boolean"),t.$require("corelib/string"),t.$require("corelib/comparable"),t.$require("corelib/enumerable"),t.$require("corelib/enumerator"),t.$require("corelib/array"),t.$require("corelib/hash"),t.$require("corelib/number"),t.$require("corelib/range"),t.$require("corelib/proc"),t.$require("corelib/method"),t.$require("corelib/regexp"),t.$require("corelib/variables"),t.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.truthy,$=e.gvars;return e.add_stubs(["$==","$length","$respond_to?","$[]","$coerce_to?","$nil?","$to_a","$raise","$to_int","$fetch","$Integer","$Float","$to_ary","$to_str","$coerce_to","$inspect","$to_s"]),function(t,o){var s,l=a(t,"Kernel"),u=[l].concat(o);e.def(l,"$format",s=function(t){function a(){M&K&&y.$raise(n(u,"ArgumentError"),"flag after width"),M&V&&y.$raise(n(u,"ArgumentError"),"flag after precision")}function o(){M&K&&y.$raise(n(u,"ArgumentError"),"width given twice"),M&V&&y.$raise(n(u,"ArgumentError"),"width after precision")}function s(e){return e>=h.length&&y.$raise(n(u,"ArgumentError"),"too few arguments"),h[e]}function l(){switch(B){case-1:y.$raise(n(u,"ArgumentError"),"unnumbered("+P+") mixed with numbered");case-2:y.$raise(n(u,"ArgumentError"),"unnumbered("+P+") mixed with named")}return s((B=P++)-1)}function c(e){return B>0&&y.$raise(n(u,"ArgumentError"),"numbered("+e+") after unnumbered("+B+")"),-2===B&&y.$raise(n(u,"ArgumentError"),"numbered("+e+") after named"),e<1&&y.$raise(n(u,"ArgumentError"),"invalid index - "+e+"$"),B=-1,s(e-1)}function p(){return q===undefined?l():q}function d(e){for(var r,a="";;b++){if(b===j&&y.$raise(n(u,"ArgumentError"),"malformed format string - %*[0-9]"),t.charCodeAt(b)<48||t.charCodeAt(b)>57)return b--,(r=parseInt(a,10)||0)>2147483647&&y.$raise(n(u,"ArgumentError"),e+" too big"),r;a+=t.charAt(b)}}function _(e){var r,n=d(e);return"$"===t.charAt(b+1)?(b++,r=c(n)):r=l(),r.$to_int()}var f,h,y=this,m=r;null==$.DEBUG&&($.DEBUG=r),f=e.slice.call(arguments,1,arguments.length),i((h=f).$length()["$=="](1)?h["$[]"](0)["$respond_to?"]("to_ary"):h.$length()["$=="](1))&&(m=n(u,"Opal")["$coerce_to?"](h["$[]"](0),n(u,"Array"),"to_ary"),i(m["$nil?"]())||(h=m.$to_a()));var g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z="",N=0,j=t.length,P=1,B=0,L=0,D=1,G=2,H=4,F=8,U=16,K=32,Y=64,V=128;for(b=t.indexOf("%");-1!==b;b=t.indexOf("%",b)){switch(w=undefined,M=L,x=-1,E=-1,q=undefined,g=b,b++,t.charAt(b)){case"%":N=b;case"":case"\n":case"\0":b++;continue}e:for(;b<j;b++)switch(t.charAt(b)){case" ":a(),M|=U;continue e;case"#":a(),M|=D;continue e;case"+":a(),M|=H;continue e;case"-":a(),M|=G;continue e;case"0":a(),M|=F;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(O=d("width"),"$"===t.charAt(b+1)){if(b+2===j){w="%",b++;break e}q!==undefined&&y.$raise(n(u,"ArgumentError"),"value given twice - %"+O+"$"),q=c(O),b++}else o(),M|=K,x=O;continue e;case"<":case"{":for(T="<"===t.charAt(b)?">":"}",A="",b++;;b++){if(b===j&&y.$raise(n(u,"ArgumentError"),"malformed name - unmatched parenthesis"),t.charAt(b)===T){if(B>0&&y.$raise(n(u,"ArgumentError"),"named "+A+" after unnumbered("+B+")"),-1===B&&y.$raise(n(u,"ArgumentError"),"named "+A+" after numbered"),B=-2,h[0]!==undefined&&h[0].$$is_hash||y.$raise(n(u,"ArgumentError"),"one hash required"),q=h[0].$fetch(A),">"===T)continue e;if(w=q.toString(),-1!==E&&(w=w.slice(0,E)),M&G)for(;w.length<x;)w+=" ";else for(;w.length<x;)w=" "+w;break e}A+=t.charAt(b)}case"*":b++,o(),M|=K,(x=_("width"))<0&&(M|=G,x=-x);continue e;case".":if(M&V&&y.$raise(n(u,"ArgumentError"),"precision given twice"),M|=Y|V,E=0,b++,"*"===t.charAt(b)){b++,(E=_("precision"))<0&&(M&=~Y);continue e}E=d("precision");continue e;case"d":case"i":case"u":if((v=y.$Integer(p()))>=0){for(w=v.toString();w.length<E;)w="0"+w;if(M&G)for((M&H||M&U)&&(w=(M&H?"+":" ")+w);w.length<x;)w+=" ";else if(M&F&&-1===E){for(;w.length<x-(M&H||M&U?1:0);)w="0"+w;(M&H||M&U)&&(w=(M&H?"+":" ")+w)}else for((M&H||M&U)&&(w=(M&H?"+":" ")+w);w.length<x;)w=" "+w}else{for(w=(-v).toString();w.length<E;)w="0"+w;if(M&G)for(w="-"+w;w.length<x;)w+=" ";else if(M&F&&-1===E){for(;w.length<x-1;)w="0"+w;w="-"+w}else for(w="-"+w;w.length<x;)w=" "+w}break e;case"b":case"B":case"o":case"x":case"X":switch(t.charAt(b)){case"b":case"B":S=2,I="0b",R=/^1+/,C="1";break;case"o":S=8,I="0",R=/^3?7+/,C="7";break;case"x":case"X":S=16,I="0x",R=/^f+/,C="f"}if((v=y.$Integer(p()))>=0){for(w=v.toString(S);w.length<E;)w="0"+w;if(M&G)for((M&H||M&U)&&(w=(M&H?"+":" ")+w),M&D&&0!==v&&(w=I+w);w.length<x;)w+=" ";else if(M&F&&-1===E){for(;w.length<x-(M&H||M&U?1:0)-(M&D&&0!==v?I.length:0);)w="0"+w;M&D&&0!==v&&(w=I+w),(M&H||M&U)&&(w=(M&H?"+":" ")+w)}else for(M&D&&0!==v&&(w=I+w),(M&H||M&U)&&(w=(M&H?"+":" ")+w);w.length<x;)w=" "+w}else if(M&H||M&U){for(w=(-v).toString(S);w.length<E;)w="0"+w;if(M&G)for(M&D&&(w=I+w),w="-"+w;w.length<x;)w+=" ";else if(M&F&&-1===E){for(;w.length<x-1-(M&D?2:0);)w="0"+w;M&D&&(w=I+w),w="-"+w}else for(M&D&&(w=I+w),w="-"+w;w.length<x;)w=" "+w}else{for(w=(v>>>0).toString(S).replace(R,C);w.length<E-2;)w=C+w;if(M&G)for(w=".."+w,M&D&&(w=I+w);w.length<x;)w+=" ";else if(M&F&&-1===E){for(;w.length<x-2-(M&D?I.length:0);)w=C+w;w=".."+w,M&D&&(w=I+w)}else for(w=".."+w,M&D&&(w=I+w);w.length<x;)w=" "+w}t.charAt(b)===t.charAt(b).toUpperCase()&&(w=w.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((v=y.$Float(p()))>=0||isNaN(v)){if(v===Infinity)w="Inf";else switch(t.charAt(b)){case"f":w=v.toFixed(-1===E?6:E);break;case"e":case"E":w=v.toExponential(-1===E?6:E);break;case"g":case"G":w=v.toExponential(),(k=parseInt(w.split("e")[1],10))<-4||k>=(-1===E?6:E)||(w=v.toPrecision(-1===E?M&D?6:undefined:E))}if(M&G)for((M&H||M&U)&&(w=(M&H?"+":" ")+w);w.length<x;)w+=" ";else if(M&F&&v!==Infinity&&!isNaN(v)){for(;w.length<x-(M&H||M&U?1:0);)w="0"+w;(M&H||M&U)&&(w=(M&H?"+":" ")+w)}else for((M&H||M&U)&&(w=(M&H?"+":" ")+w);w.length<x;)w=" "+w}else{if(v===-Infinity)w="Inf";else switch(t.charAt(b)){case"f":w=(-v).toFixed(-1===E?6:E);break;case"e":case"E":w=(-v).toExponential(-1===E?6:E);break;case"g":case"G":w=(-v).toExponential(),(k=parseInt(w.split("e")[1],10))<-4||k>=(-1===E?6:E)||(w=(-v).toPrecision(-1===E?M&D?6:undefined:E))}if(M&G)for(w="-"+w;w.length<x;)w+=" ";else if(M&F&&v!==-Infinity){for(;w.length<x-1;)w="0"+w;w="-"+w}else for(w="-"+w;w.length<x;)w=" "+w}t.charAt(b)!==t.charAt(b).toUpperCase()||v===Infinity||v===-Infinity||isNaN(v)||(w=w.toUpperCase()),w=w.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":y.$raise(n(u,"NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((v=p())["$respond_to?"]("to_ary")&&(v=v.$to_ary()[0]),1!==(w=v["$respond_to?"]("to_str")?v.$to_str():String.fromCharCode(n(u,"Opal").$coerce_to(v,n(u,"Integer"),"to_int"))).length&&y.$raise(n(u,"ArgumentError"),"%c requires a character"),M&G)for(;w.length<x;)w+=" ";else for(;w.length<x;)w=" "+w;break e;case"p":if(w=p().$inspect(),-1!==E&&(w=w.slice(0,E)),M&G)for(;w.length<x;)w+=" ";else for(;w.length<x;)w=" "+w;break e;case"s":if(w=p().$to_s(),-1!==E&&(w=w.slice(0,E)),M&G)for(;w.length<x;)w+=" ";else for(;w.length<x;)w=" "+w;break e;default:y.$raise(n(u,"ArgumentError"),"malformed format string - %"+t.charAt(b))}w===undefined&&y.$raise(n(u,"ArgumentError"),"malformed format string - %"),z+=t.slice(N,g)+w,N=b+1}return $.DEBUG&&B>=0&&P<h.length&&y.$raise(n(u,"ArgumentError"),"too many arguments for format string"),z+t.slice(N)},s.$$arity=-2),e.alias(l,"sprintf","format")}(t[0],t)},Opal.modules["corelib/string/encoding"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r,n,a,i,$,o=e.top,s=[],l=e.nil,u=e.const_get_qualified,c=e.const_get_relative,p=(e.breaker,e.slice,e.klass),d=e.hash2,_=e.truthy,f=e.send;return e.add_stubs(["$require","$+","$[]","$new","$to_proc","$each","$const_set","$sub","$==","$default_external","$upcase","$raise","$attr_accessor","$attr_reader","$register","$length","$bytes","$to_a","$each_byte","$bytesize","$enum_for","$each_codepoint","$force_encoding","$dup","$coerce_to!","$find","$getbyte"]),o.$require("corelib/string"),function(r,$super,n){var a,i,$,o,s,u,h,y,m,g,b=p(r,null,"Encoding"),v=[b].concat(n);b.$$prototype.ascii=b.$$prototype.dummy=b.$$prototype.name=l,e.defineProperty(b,"$$register",{}),e.defs(b,"$register",a=function(e,r){var n,i,$=a.$$p,o=$||l,s=this,u=l,p=l,h=l;return $&&(a.$$p=null),$&&(a.$$p=null),null==r&&(r=d([],{})),u=t([e],_(n=r["$[]"]("aliases"))?n:[]),p=f(c(v,"Class"),"new",[s],o.$to_proc()).$new(e,u,!!_(n=r["$[]"]("ascii"))&&n,!!_(n=r["$[]"]("dummy"))&&n),h=s.$$register,f(u,"each",[],((i=function(e){var t=i.$$s||this;return null==e&&(e=l),t.$const_set(e.$sub("-","_"),p),h["$$"+e]=p}).$$s=s,i.$$arity=1,i))},a.$$arity=-2),e.defs(b,"$find",i=function(e){var t,r=this,n=l,a=l;return e["$=="]("default_external")?r.$default_external():(n=r.$$register,a=_(t=n["$$"+e])?t:n["$$"+e.$upcase()],_(a)||r.$raise(c(v,"ArgumentError"),"unknown encoding name - "+e),a)},i.$$arity=1),function(e,t){[e].concat(t);e.$attr_accessor("default_external")}(e.get_singleton_class(b),v),b.$attr_reader("name","names"),e.def(b,"$initialize",$=function(e,t,r,n){var a=this;return a.name=e,a.names=t,a.ascii=r,a.dummy=n},$.$$arity=4),e.def(b,"$ascii_compatible?",o=function(){return this.ascii},o.$$arity=0),e.def(b,"$dummy?",s=function(){return this.dummy},s.$$arity=0),e.def(b,"$to_s",u=function(){return this.name},u.$$arity=0),e.def(b,"$inspect",h=function(){var e=this;return"#<Encoding:"+e.name+(_(e.dummy)?" (dummy)":l)+">"},h.$$arity=0),e.def(b,"$each_byte",y=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(c(v,"NotImplementedError"))},y.$$arity=-1),e.def(b,"$getbyte",m=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(c(v,"NotImplementedError"))},m.$$arity=-1),e.def(b,"$bytesize",g=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(c(v,"NotImplementedError"))},g.$$arity=-1),function(e,$super,t){[p(e,$super,"EncodingError")].concat(t)}(v[0],c(v,"StandardError"),v),function(e,$super,t){[p(e,$super,"CompatibilityError")].concat(t)}(v[0],c(v,"EncodingError"),v)}(s[0],0,s),f(c(s,"Encoding"),"register",["UTF-8",d(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],((r=function(){var t,n,a=r.$$s||this;return e.def(a,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,$=r.length;i<$;i++){var o=r.charCodeAt(i);if(o<=127)e.yield1(a,o);else for(var s=encodeURIComponent(r.charAt(i)).substr(1).split("%"),u=0,c=s.length;u<c;u++)e.yield1(a,parseInt(s[u],16))}},t.$$arity=1),e.def(a,"$bytesize",n=function(e){return e.$bytes().$length()},n.$$arity=1),l&&"bytesize"}).$$s=o,r.$$arity=0,r)),f(c(s,"Encoding"),"register",["UTF-16LE"],((n=function(){var t,r,a=n.$$s||this;return e.def(a,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,$=r.length;i<$;i++){var o=r.charCodeAt(i);e.yield1(a,255&o),e.yield1(a,o>>8)}},t.$$arity=1),e.def(a,"$bytesize",r=function(e){return e.$bytes().$length()},r.$$arity=1),l&&"bytesize"}).$$s=o,n.$$arity=0,n)),f(c(s,"Encoding"),"register",["UTF-16BE"],((a=function(){var t,r,n=a.$$s||this;return e.def(n,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,$=r.length;i<$;i++){var o=r.charCodeAt(i);e.yield1(a,o>>8),e.yield1(a,255&o)}},t.$$arity=1),e.def(n,"$bytesize",r=function(e){return e.$bytes().$length()},r.$$arity=1),l&&"bytesize"}).$$s=o,a.$$arity=0,a)),f(c(s,"Encoding"),"register",["UTF-32LE"],((i=function(){var t,r,n=i.$$s||this;return e.def(n,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,$=r.length;i<$;i++){var o=r.charCodeAt(i);e.yield1(a,255&o),e.yield1(a,o>>8)}},t.$$arity=1),e.def(n,"$bytesize",r=function(e){return e.$bytes().$length()},r.$$arity=1),l&&"bytesize"}).$$s=o,i.$$arity=0,i)),f(c(s,"Encoding"),"register",["ASCII-8BIT",d(["aliases","ascii","dummy"],{aliases:["BINARY","US-ASCII","ASCII"],ascii:!0,dummy:!0})],(($=function(){var t,r,n=$.$$s||this;return e.def(n,"$each_byte",t=function(r){var n=t.$$p,a=n||l;n&&(t.$$p=null),n&&(t.$$p=null);for(var i=0,$=r.length;i<$;i++){var o=r.charCodeAt(i);e.yield1(a,255&o),e.yield1(a,o>>8)}},t.$$arity=1),e.def(n,"$bytesize",r=function(e){return e.$bytes().$length()},r.$$arity=1),l&&"bytesize"}).$$s=o,$.$$arity=0,$)),function(t,$super,r){var n,a,i,$,o,s,d,_,h,y=p(t,null,"String"),m=[y].concat(r);return y.$$prototype.encoding=l,y.$attr_reader("encoding"),e.defineProperty(String.prototype,"encoding",u(c(m,"Encoding"),"UTF_16LE")),e.def(y,"$bytes",n=function(){return this.$each_byte().$to_a()},n.$$arity=0),e.def(y,"$bytesize",a=function(){var e=this;return e.encoding.$bytesize(e)},a.$$arity=0),e.def(y,"$each_byte",i=function(){var e=i.$$p,t=e||l,r=this;return e&&(i.$$p=null),e&&(i.$$p=null),t===l?r.$enum_for("each_byte"):(f(r.encoding,"each_byte",[r],t.$to_proc()),r)},i.$$arity=0),e.def(y,"$each_codepoint",$=function(){var t=$.$$p,r=t||l,n=this;if(t&&($.$$p=null),t&&($.$$p=null),r===l)return n.$enum_for("each_codepoint");for(var a=0,i=n.length;a<i;a++)e.yield1(r,n.codePointAt(a));return n},$.$$arity=0),e.def(y,"$codepoints",o=function(){var e=o.$$p,t=e||l,r=this;return e&&(o.$$p=null),e&&(o.$$p=null),t!==l?f(r,"each_codepoint",[],t.$to_proc()):r.$each_codepoint().$to_a()},o.$$arity=0),e.def(y,"$encode",s=function(e){return this.$dup().$force_encoding(e)},s.$$arity=1),e.def(y,"$force_encoding",d=function(e){var t=this;return e===t.encoding?t:(e=c(m,"Opal")["$coerce_to!"](e,c(m,"String"),"to_s"),(e=c(m,"Encoding").$find(e))===t.encoding?t:(t.encoding=e,t))},d.$$arity=1),e.def(y,"$getbyte",_=function(e){var t=this;return t.encoding.$getbyte(t,e)},_.$$arity=1),e.def(y,"$valid_encoding?",h=function(){return!0},h.$$arity=0),l&&"valid_encoding?"}(s[0],0,s)},Opal.modules["corelib/math"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}e.top;var n=[],a=(e.nil,e.const_get_qualified),i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.truthy;return e.add_stubs(["$new","$raise","$Float","$type_error","$Integer","$module_function","$checked","$float!","$===","$gamma","$-","$integer!","$/","$infinite?"]),function(n,s){var l,u,c,p,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P=$(n,"Math"),B=[P].concat(s);e.const_set(B[0],"E",Math.E),e.const_set(B[0],"PI",Math.PI),e.const_set(B[0],"DomainError",i(B,"Class").$new(i(B,"StandardError"))),e.defs(P,"$checked",l=function(t){var r,n=this;if(r=e.slice.call(arguments,1,arguments.length),isNaN(r[0])||2==r.length&&isNaN(r[1]))return NaN;var a=Math[t].apply(null,r);return isNaN(a)&&n.$raise(i(B,"DomainError"),'Numerical argument is out of domain - "'+t+'"'),a},l.$$arity=-2),e.defs(P,"$float!",u=function(t){var r=this;try{return r.$Float(t)}catch(n){if(!e.rescue(n,[i(B,"ArgumentError")]))throw n;try{return r.$raise(i(B,"Opal").$type_error(t,i(B,"Float")))}finally{e.pop_exception()}}},u.$$arity=1),e.defs(P,"$integer!",c=function(t){var r=this;try{return r.$Integer(t)}catch(n){if(!e.rescue(n,[i(B,"ArgumentError")]))throw n;try{return r.$raise(i(B,"Opal").$type_error(t,i(B,"Integer")))}finally{e.pop_exception()}}},c.$$arity=1),P.$module_function(),e.def(P,"$acos",p=function(e){return i(B,"Math").$checked("acos",i(B,"Math")["$float!"](e))},p.$$arity=1),o("undefined"!=typeof Math.acosh)||(Math.acosh=function(e){return Math.log(e+Math.sqrt(e*e-1))}),e.def(P,"$acosh",d=function(e){return i(B,"Math").$checked("acosh",i(B,"Math")["$float!"](e))},d.$$arity=1),e.def(P,"$asin",_=function(e){return i(B,"Math").$checked("asin",i(B,"Math")["$float!"](e))},_.$$arity=1),o("undefined"!=typeof Math.asinh)||(Math.asinh=function(e){return Math.log(e+Math.sqrt(e*e+1))}),e.def(P,"$asinh",f=function(e){return i(B,"Math").$checked("asinh",i(B,"Math")["$float!"](e))},f.$$arity=1),e.def(P,"$atan",h=function(e){return i(B,"Math").$checked("atan",i(B,"Math")["$float!"](e))},h.$$arity=1),e.def(P,"$atan2",y=function(e,t){return i(B,"Math").$checked("atan2",i(B,"Math")["$float!"](e),i(B,"Math")["$float!"](t))},y.$$arity=2),o("undefined"!=typeof Math.atanh)||(Math.atanh=function(e){return.5*Math.log((1+e)/(1-e))}),e.def(P,"$atanh",m=function(e){return i(B,"Math").$checked("atanh",i(B,"Math")["$float!"](e))},m.$$arity=1),o("undefined"!=typeof Math.cbrt)||(Math.cbrt=function(e){if(0==e)return 0;if(e<0)return-Math.cbrt(-e);for(var t=e,r=0;t<.125;)t*=8,r--;for(;t>1;)t*=.125,r++;for(t=(-.46946116*t+1.072302)*t+.3812513;r<0;)t*=.5,r++;for(;r>0;)t*=2,r--;return t=2/3*(t=2/3*(t=2/3*(t=2/3*t+1/3*e/(t*t))+1/3*e/(t*t))+1/3*e/(t*t))+1/3*e/(t*t)}),e.def(P,"$cbrt",g=function(e){return i(B,"Math").$checked("cbrt",i(B,"Math")["$float!"](e))},g.$$arity=1),e.def(P,"$cos",b=function(e){return i(B,"Math").$checked("cos",i(B,"Math")["$float!"](e))},b.$$arity=1),o("undefined"!=typeof Math.cosh)||(Math.cosh=function(e){return(Math.exp(e)+Math.exp(-e))/2}),e.def(P,"$cosh",v=function(e){return i(B,"Math").$checked("cosh",i(B,"Math")["$float!"](e))},v.$$arity=1),o("undefined"!=typeof Math.erf)||e.defineProperty(Math,"erf",function(e){var t=.254829592,r=-.284496736,n=1.421413741,a=-1.453152027,i=1.061405429,$=1;e<0&&($=-1);var o=1/(1+.3275911*(e=Math.abs(e)));return $*(1-((((i*o+a)*o+n)*o+r)*o+t)*o*Math.exp(-e*e))}),e.def(P,"$erf",w=function(e){return i(B,"Math").$checked("erf",i(B,"Math")["$float!"](e))},w.$$arity=1),o("undefined"!=typeof Math.erfc)||e.defineProperty(Math,"erfc",function(e){var t=Math.abs(e),r=1/(.5*t+1),n=-t*t-1.26551223+r*(r*(r*(r*(r*(r*(r*(r*(.17087277*r-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368),a=r*Math.exp(n);return e<0?2-a:a}),e.def(P,"$erfc",k=function(e){return i(B,"Math").$checked("erfc",i(B,"Math")["$float!"](e))},k.$$arity=1),e.def(P,"$exp",x=function(e){return i(B,"Math").$checked("exp",i(B,"Math")["$float!"](e))},x.$$arity=1),e.def(P,"$frexp",E=function(e){if(e=i(B,"Math")["$float!"](e),isNaN(e))return[NaN,0];var t=Math.floor(Math.log(Math.abs(e))/Math.log(2))+1;return[e/Math.pow(2,t),t]},E.$$arity=1),e.def(P,"$gamma",O=function(e){var r,n,a,$,o,s,l,u,c,p=this;e=i(B,"Math")["$float!"](e);var d=4.7421875,_=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(e))return NaN;if(0===e&&1/e<0)return-Infinity;if(-1!==e&&e!==-Infinity||p.$raise(i(B,"DomainError"),'Numerical argument is out of domain - "gamma"'),i(B,"Integer")["$==="](e)){if(e<=0)return isFinite(e)?Infinity:NaN;if(e>171)return Infinity;for($=e-2,o=e-1;$>1;)o*=$,$--;return 0==o&&(o=1),o}if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*i(B,"Math").$gamma(t(1,e)));if(e>=171.35)return Infinity;if(e>85)return c=(u=(l=(s=e*e)*e)*e)*e,Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*s)-139/(51840*l)-571/(2488320*u)+163879/(209018880*c)+5246819/(75246796800*c*e));for(e-=1,a=_[0],r=1;r<_.length;++r)a+=_[r]/(e+r);return n=e+d+.5,Math.sqrt(2*Math.PI)*Math.pow(n,e+.5)*Math.exp(-n)*a},O.$$arity=1),o("undefined"!=typeof Math.hypot)||(Math.hypot=function(e,t){return Math.sqrt(e*e+t*t)}),e.def(P,"$hypot",A=function(e,t){return i(B,"Math").$checked("hypot",i(B,"Math")["$float!"](e),i(B,"Math")["$float!"](t))},A.$$arity=2),e.def(P,"$ldexp",T=function(e,t){var r=this;return e=i(B,"Math")["$float!"](e),t=i(B,"Math")["$integer!"](t),isNaN(t)&&r.$raise(i(B,"RangeError"),"float NaN out of range of integer"),e*Math.pow(2,t)},T.$$arity=2),e.def(P,"$lgamma",S=function(e){return-1==e?[Infinity,1]:[Math.log(Math.abs(i(B,"Math").$gamma(e))),i(B,"Math").$gamma(e)<0?-1:1]},S.$$arity=1),e.def(P,"$log",I=function(e,t){var n=this;return o(i(B,"String")["$==="](e))&&n.$raise(i(B,"Opal").$type_error(e,i(B,"Float"))),o(null==t)?i(B,"Math").$checked("log",i(B,"Math")["$float!"](e)):(o(i(B,"String")["$==="](t))&&n.$raise(i(B,"Opal").$type_error(t,i(B,"Float"))),r(i(B,"Math").$checked("log",i(B,"Math")["$float!"](e)),i(B,"Math").$checked("log",i(B,"Math")["$float!"](t))))},I.$$arity=-2),o("undefined"!=typeof Math.log10)||(Math.log10=function(e){return Math.log(e)/Math.LN10}),e.def(P,"$log10",R=function(e){var t=this;return o(i(B,"String")["$==="](e))&&t.$raise(i(B,"Opal").$type_error(e,i(B,"Float"))),i(B,"Math").$checked("log10",i(B,"Math")["$float!"](e))},R.$$arity=1),o("undefined"!=typeof Math.log2)||(Math.log2=function(e){return Math.log(e)/Math.LN2}),e.def(P,"$log2",C=function(e){var t=this;return o(i(B,"String")["$==="](e))&&t.$raise(i(B,"Opal").$type_error(e,i(B,"Float"))),i(B,"Math").$checked("log2",i(B,"Math")["$float!"](e))},C.$$arity=1),e.def(P,"$sin",q=function(e){return i(B,"Math").$checked("sin",i(B,"Math")["$float!"](e))},q.$$arity=1),o("undefined"!=typeof Math.sinh)||(Math.sinh=function(e){return(Math.exp(e)-Math.exp(-e))/2}),e.def(P,"$sinh",M=function(e){return i(B,"Math").$checked("sinh",i(B,"Math")["$float!"](e))},M.$$arity=1),e.def(P,"$sqrt",z=function(e){return i(B,"Math").$checked("sqrt",i(B,"Math")["$float!"](e))},z.$$arity=1),e.def(P,"$tan",N=function(e){return e=i(B,"Math")["$float!"](e),o(e["$infinite?"]())?a(i(B,"Float"),"NAN"):i(B,"Math").$checked("tan",i(B,"Math")["$float!"](e))},N.$$arity=1),o("undefined"!=typeof Math.tanh)||(Math.tanh=function(e){return e==Infinity?1:e==-Infinity?-1:(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))}),e.def(P,"$tanh",j=function(e){return i(B,"Math").$checked("tanh",i(B,"Math")["$float!"](e))},j.$$arity=1)}(n[0],n)},Opal.modules["corelib/complex"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var $=e.top,o=[],s=e.nil,l=e.const_get_qualified,u=e.const_get_relative,c=(e.breaker,e.slice,e.klass),p=e.truthy,d=e.module;return e.add_stubs(["$require","$===","$real?","$raise","$new","$*","$cos","$sin","$attr_reader","$class","$==","$real","$imag","$Complex","$-@","$+","$__coerced__","$-","$nan?","$/","$conj","$abs2","$quo","$polar","$exp","$log","$>","$!=","$divmod","$**","$hypot","$atan2","$lcm","$denominator","$finite?","$infinite?","$numerator","$abs","$arg","$rationalize","$to_f","$to_i","$to_r","$inspect","$positive?","$zero?","$Rational"]),$.$require("corelib/numeric"),function($,$super,o){var d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F=c($,$super,"Complex"),U=[F].concat(o);F.$$prototype.real=F.$$prototype.imag=s,e.defs(F,"$rect",d=function(e,t){var r,n,a,i=this;return null==t&&(t=0),p(p(r=p(n=p(a=u(U,"Numeric")["$==="](e))?e["$real?"]():a)?u(U,"Numeric")["$==="](t):n)?t["$real?"]():r)||i.$raise(u(U,"TypeError"),"not a real"),i.$new(e,t)},d.$$arity=-2),function(t,r){[t].concat(r);e.alias(t,"rectangular","rect")}(e.get_singleton_class(F),U),e.defs(F,"$polar",_=function(e,r){var n,a,i,$=this;return null==r&&(r=0),p(p(n=p(a=p(i=u(U,"Numeric")["$==="](e))?e["$real?"]():i)?u(U,"Numeric")["$==="](r):a)?r["$real?"]():n)||$.$raise(u(U,"TypeError"),"not a real"),$.$new(t(e,u(U,"Math").$cos(r)),t(e,u(U,"Math").$sin(r)))},_.$$arity=-2),F.$attr_reader("real","imag"),e.def(F,"$initialize",f=function(e,t){var r=this;return null==t&&(t=0),r.real=e,r.imag=t},f.$$arity=-2),e.def(F,"$coerce",h=function(e){var t,r=this;return p(u(U,"Complex")["$==="](e))?[e,r]:p(p(t=u(U,"Numeric")["$==="](e))?e["$real?"]():t)?[u(U,"Complex").$new(e,0),r]:r.$raise(u(U,"TypeError"),e.$class()+" can't be coerced into Complex")},h.$$arity=1),e.def(F,"$==",y=function(e){var t,r=this;return p(u(U,"Complex")["$==="](e))?(t=r.real["$=="](e.$real()))?r.imag["$=="](e.$imag()):r.real["$=="](e.$real()):p(p(t=u(U,"Numeric")["$==="](e))?e["$real?"]():t)?(t=r.real["$=="](e))?r.imag["$=="](0):r.real["$=="](e):e["$=="](r)},y.$$arity=1),e.def(F,"$-@",m=function(){var e=this;return e.$Complex(e.real["$-@"](),e.imag["$-@"]())},m.$$arity=0),e.def(F,"$+",g=function(e){var t,n=this;return p(u(U,"Complex")["$==="](e))?n.$Complex(r(n.real,e.$real()),r(n.imag,e.$imag())):p(p(t=u(U,"Numeric")["$==="](e))?e["$real?"]():t)?n.$Complex(r(n.real,e),n.imag):n.$__coerced__("+",e)},g.$$arity=1),e.def(F,"$-",b=function(e){var t,r=this;return p(u(U,"Complex")["$==="](e))?r.$Complex(n(r.real,e.$real()),n(r.imag,e.$imag())):p(p(t=u(U,"Numeric")["$==="](e))?e["$real?"]():t)?r.$Complex(n(r.real,e),r.imag):r.$__coerced__("-",e)},b.$$arity=1),e.def(F,"$*",v=function(e){var a,i=this;return p(u(U,"Complex")["$==="](e))?i.$Complex(n(t(i.real,e.$real()),t(i.imag,e.$imag())),r(t(i.real,e.$imag()),t(i.imag,e.$real()))):p(p(a=u(U,"Numeric")["$==="](e))?e["$real?"]():a)?i.$Complex(t(i.real,e),t(i.imag,e)):i.$__coerced__("*",e)},v.$$arity=1),e.def(F,"$/",w=function(e){var r,n,i,$,o=this;return p(u(U,"Complex")["$==="](e))?p(p(r=p(n=p(i=p($=u(U,"Number")["$==="](o.real))?o.real["$nan?"]():$)?i:p($=u(U,"Number")["$==="](o.imag))?o.imag["$nan?"]():$)?n:p(i=u(U,"Number")["$==="](e.$real()))?e.$real()["$nan?"]():i)?r:p(n=u(U,"Number")["$==="](e.$imag()))?e.$imag()["$nan?"]():n)?u(U,"Complex").$new(l(u(U,"Float"),"NAN"),l(u(U,"Float"),"NAN")):a(t(o,e.$conj()),e.$abs2()):p(p(r=u(U,"Numeric")["$==="](e))?e["$real?"]():r)?o.$Complex(o.real.$quo(e),o.imag.$quo(e)):o.$__coerced__("/",e)},w.$$arity=1),e.def(F,"$**",k=function($){var o,l,c,d,_=this,f=s,h=s,y=s,m=s,g=s,b=s,v=s,w=s,k=s,x=s,E=s;if($["$=="](0))return u(U,"Complex").$new(1,0);if(p(u(U,"Complex")["$==="]($)))return l=_.$polar(),f=null==(o=e.to_ary(l))[0]?s:o[0],h=null==o[1]?s:o[1],y=$.$real(),m=$.$imag(),g=u(U,"Math").$exp(n(t(y,u(U,"Math").$log(f)),t(m,h))),b=r(t(h,y),t(m,u(U,"Math").$log(f))),u(U,"Complex").$polar(g,b);if(p(u(U,"Integer")["$==="]($))){if(p(i($,0))){for(w=v=_,k=n($,1);p(k["$!="](0));){for(c=k.$divmod(2),x=null==(l=e.to_ary(c))[0]?s:l[0],E=null==l[1]?s:l[1];E["$=="](0);)v=_.$Complex(n(t(v.$real(),v.$real()),t(v.$imag(),v.$imag())),t(t(2,v.$real()),v.$imag())),d=(k=x).$divmod(2),x=null==(c=e.to_ary(d))[0]?s:c[0],E=null==c[1]?s:c[1];w=t(w,v),k=n(k,1)}return w}return a(u(U,"Rational").$new(1,1),_)["$**"]($["$-@"]())}return p(p(o=u(U,"Float")["$==="]($))?o:u(U,"Rational")["$==="]($))?(l=_.$polar(),f=null==(o=e.to_ary(l))[0]?s:o[0],h=null==o[1]?s:o[1],u(U,"Complex").$polar(f["$**"]($),t(h,$))):_.$__coerced__("**",$)},k.$$arity=1),e.def(F,"$abs",x=function(){var e=this;return u(U,"Math").$hypot(e.real,e.imag)},x.$$arity=0),e.def(F,"$abs2",E=function(){var e=this;return r(t(e.real,e.real),t(e.imag,e.imag))},E.$$arity=0),e.def(F,"$angle",O=function(){var e=this;return u(U,"Math").$atan2(e.imag,e.real)},O.$$arity=0),e.alias(F,"arg","angle"),e.def(F,"$conj",A=function(){var e=this;return e.$Complex(e.real,e.imag["$-@"]())},A.$$arity=0),e.alias(F,"conjugate","conj"),e.def(F,"$denominator",T=function(){var e=this;return e.real.$denominator().$lcm(e.imag.$denominator())},T.$$arity=0),e.alias(F,"divide","/"),e.def(F,"$eql?",S=function(e){var t,r,n=this;return p(t=p(r=u(U,"Complex")["$==="](e))?n.real.$class()["$=="](n.imag.$class()):r)?n["$=="](e):t},S.$$arity=1),e.def(F,"$fdiv",I=function(e){var t=this;return p(u(U,"Numeric")["$==="](e))||t.$raise(u(U,"TypeError"),e.$class()+" can't be coerced into Complex"),a(t,e)},I.$$arity=1),e.def(F,"$finite?",R=function(){var e,t=this;return p(e=t.real["$finite?"]())?t.imag["$finite?"]():e},R.$$arity=0),e.def(F,"$hash",C=function(){var e=this;return"Complex:"+e.real+":"+e.imag},C.$$arity=0),e.alias(F,"imaginary","imag"),e.def(F,"$infinite?",q=function(){var e,t=this;return p(e=t.real["$infinite?"]())?e:t.imag["$infinite?"]()},q.$$arity=0),e.def(F,"$inspect",M=function(){return"("+this+")"},M.$$arity=0),e.alias(F,"magnitude","abs"),e.udef(F,"$negative?"),e.def(F,"$numerator",z=function(){var e=this,r=s;return r=e.$denominator(),e.$Complex(t(e.real.$numerator(),a(r,e.real.$denominator())),t(e.imag.$numerator(),a(r,e.imag.$denominator())))},z.$$arity=0),e.alias(F,"phase","arg"),e.def(F,"$polar",N=function(){var e=this;return[e.$abs(),e.$arg()]},N.$$arity=0),e.udef(F,"$positive?"),e.alias(F,"quo","/"),e.def(F,"$rationalize",j=function(e){var t=this;return arguments.length>1&&t.$raise(u(U,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),p(t.imag["$!="](0))&&t.$raise(u(U,"RangeError"),"can't' convert "+t+" into Rational"),t.$real().$rationalize(e)},j.$$arity=-1),e.def(F,"$real?",P=function(){return!1},P.$$arity=0),e.def(F,"$rect",B=function(){var e=this;return[e.real,e.imag]},B.$$arity=0),e.alias(F,"rectangular","rect"),e.def(F,"$to_f",L=function(){var e=this;return e.imag["$=="](0)||e.$raise(u(U,"RangeError"),"can't convert "+e+" into Float"),e.real.$to_f()},L.$$arity=0),e.def(F,"$to_i",D=function(){var e=this;return e.imag["$=="](0)||e.$raise(u(U,"RangeError"),"can't convert "+e+" into Integer"),e.real.$to_i()},D.$$arity=0),e.def(F,"$to_r",G=function(){var e=this;return e.imag["$=="](0)||e.$raise(u(U,"RangeError"),"can't convert "+e+" into Rational"),e.real.$to_r()},G.$$arity=0),e.def(F,"$to_s",H=function(){var e,t,n,a=this,i=s;return i=r(i=r(i=a.real.$inspect(),p(p(e=p(t=p(n=u(U,"Number")["$==="](a.imag))?a.imag["$nan?"]():n)?t:a.imag["$positive?"]())?e:a.imag["$zero?"]())?"+":"-"),a.imag.$abs().$inspect()),p(p(e=u(U,"Number")["$==="](a.imag))?p(t=a.imag["$nan?"]())?t:a.imag["$infinite?"]():e)&&(i=r(i,"*")),r(i,"i")},H.$$arity=0),e.const_set(U[0],"I",F.$new(0,1))}(o[0],u(o,"Numeric"),o),function(t,r){var n,a=d(t,"Kernel"),i=[a].concat(r);e.def(a,"$Complex",n=function(e,t){return null==t&&(t=s),p(t)?u(i,"Complex").$new(e,t):u(i,"Complex").$new(e,0)},n.$$arity=-2)}(o[0],o),function(t,$super,r){var n,a=c(t,null,"String");[a].concat(r);return e.def(a,"$to_c",n=function(){function e(){return o.test($)}function t(){var e=$.match(o)[0];return $=$.slice(e.length),e.replace(/_/g,"")}function r(){if(e()){var r=parseFloat(t());if("/"===$[0]){if($=$.slice(1),e()){
var n=parseFloat(t());return i.$Rational(r,n)}return $="/"+$,r}return r}return null}var n,a,i=this,$=i,o=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;$.match(o);return(n=r())?(a=r())?i.$Complex(n,a):"i"===$[0]?i.$Complex(0,n):i.$Complex(n,0):"i"===$[0]?i.$Complex(0,1):"-"===$[0]&&"i"===$[1]?i.$Complex(0,-1):"+"===$[0]&&"i"===$[1]?i.$Complex(0,1):i.$Complex(0,0)},n.$$arity=0),s&&"to_c"}(o[0],0,o)},Opal.modules["corelib/rational"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}var s=e.top,l=[],u=e.nil,c=e.const_get_qualified,p=e.const_get_relative,d=(e.breaker,e.slice,e.klass),_=e.truthy,f=e.module;return e.add_stubs(["$require","$to_i","$==","$raise","$<","$-@","$new","$gcd","$/","$nil?","$===","$reduce","$to_r","$equal?","$!","$coerce_to!","$to_f","$numerator","$denominator","$<=>","$-","$*","$__coerced__","$+","$Rational","$>","$**","$abs","$ceil","$with_precision","$floor","$<=","$truncate","$send","$convert"]),s.$require("corelib/numeric"),function(s,$super,l){var f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D=d(s,$super,"Rational"),G=[D].concat(l);D.$$prototype.num=D.$$prototype.den=u,e.defs(D,"$reduce",f=function(e,n){var a=this,i=u;if(e=e.$to_i(),(n=n.$to_i())["$=="](0))a.$raise(p(G,"ZeroDivisionError"),"divided by 0");else if(_(t(n,0)))e=e["$-@"](),n=n["$-@"]();else if(n["$=="](1))return a.$new(e,n);return i=e.$gcd(n),a.$new(r(e,i),r(n,i))},f.$$arity=2),e.defs(D,"$convert",h=function(e,t){var n,a,i=this;return _(_(n=e["$nil?"]())?n:t["$nil?"]())&&i.$raise(p(G,"TypeError"),"cannot convert nil into Rational"),_(_(n=p(G,"Integer")["$==="](e))?p(G,"Integer")["$==="](t):n)?i.$reduce(e,t):(_(_(n=_(a=p(G,"Float")["$==="](e))?a:p(G,"String")["$==="](e))?n:p(G,"Complex")["$==="](e))&&(e=e.$to_r()),_(_(n=_(a=p(G,"Float")["$==="](t))?a:p(G,"String")["$==="](t))?n:p(G,"Complex")["$==="](t))&&(t=t.$to_r()),_(_(n=t["$equal?"](1))?p(G,"Integer")["$==="](e)["$!"]():n)?p(G,"Opal")["$coerce_to!"](e,p(G,"Rational"),"to_r"):_(_(n=p(G,"Numeric")["$==="](e))?p(G,"Numeric")["$==="](t):n)?r(e,t):i.$reduce(e,t))},h.$$arity=2),e.def(D,"$initialize",y=function(e,t){var r=this;return r.num=e,r.den=t},y.$$arity=2),e.def(D,"$numerator",m=function(){return this.num},m.$$arity=0),e.def(D,"$denominator",g=function(){return this.den},g.$$arity=0),e.def(D,"$coerce",b=function(e){var t=this,r=u;return r=e,p(G,"Rational")["$==="](r)?[e,t]:p(G,"Integer")["$==="](r)?[e.$to_r(),t]:p(G,"Float")["$==="](r)?[e,t.$to_f()]:u},b.$$arity=1),e.def(D,"$==",v=function(e){var t=this,r=u;return r=e,p(G,"Rational")["$==="](r)?t.num["$=="](e.$numerator())?t.den["$=="](e.$denominator()):t.num["$=="](e.$numerator()):p(G,"Integer")["$==="](r)?t.num["$=="](e)?t.den["$=="](1):t.num["$=="](e):p(G,"Float")["$==="](r)?t.$to_f()["$=="](e):e["$=="](t)},v.$$arity=1),e.def(D,"$<=>",w=function(e){var t=this,r=u;return r=e,p(G,"Rational")["$==="](r)?n(a(t.num,e.$denominator()),a(t.den,e.$numerator()))["$<=>"](0):p(G,"Integer")["$==="](r)?n(t.num,a(t.den,e))["$<=>"](0):p(G,"Float")["$==="](r)?t.$to_f()["$<=>"](e):t.$__coerced__("<=>",e)},w.$$arity=1),e.def(D,"$+",k=function(e){var t=this,r=u,n=u,$=u;return r=e,p(G,"Rational")["$==="](r)?(n=i(a(t.num,e.$denominator()),a(t.den,e.$numerator())),$=a(t.den,e.$denominator()),t.$Rational(n,$)):p(G,"Integer")["$==="](r)?t.$Rational(i(t.num,a(e,t.den)),t.den):p(G,"Float")["$==="](r)?i(t.$to_f(),e):t.$__coerced__("+",e)},k.$$arity=1),e.def(D,"$-",x=function(e){var t=this,r=u,i=u,$=u;return r=e,p(G,"Rational")["$==="](r)?(i=n(a(t.num,e.$denominator()),a(t.den,e.$numerator())),$=a(t.den,e.$denominator()),t.$Rational(i,$)):p(G,"Integer")["$==="](r)?t.$Rational(n(t.num,a(e,t.den)),t.den):p(G,"Float")["$==="](r)?n(t.$to_f(),e):t.$__coerced__("-",e)},x.$$arity=1),e.def(D,"$*",E=function(e){var t=this,r=u,n=u,i=u;return r=e,p(G,"Rational")["$==="](r)?(n=a(t.num,e.$numerator()),i=a(t.den,e.$denominator()),t.$Rational(n,i)):p(G,"Integer")["$==="](r)?t.$Rational(a(t.num,e),t.den):p(G,"Float")["$==="](r)?a(t.$to_f(),e):t.$__coerced__("*",e)},E.$$arity=1),e.def(D,"$/",O=function(e){var t=this,n=u,i=u,$=u;return n=e,p(G,"Rational")["$==="](n)?(i=a(t.num,e.$denominator()),$=a(t.den,e.$numerator()),t.$Rational(i,$)):p(G,"Integer")["$==="](n)?e["$=="](0)?r(t.$to_f(),0):t.$Rational(t.num,a(t.den,e)):p(G,"Float")["$==="](n)?r(t.$to_f(),e):t.$__coerced__("/",e)},O.$$arity=1),e.def(D,"$**",A=function(e){var r=this,n=u;return n=e,p(G,"Integer")["$==="](n)?_(r["$=="](0)?t(e,0):r["$=="](0))?c(p(G,"Float"),"INFINITY"):_($(e,0))?r.$Rational(r.num["$**"](e),r.den["$**"](e)):_(t(e,0))?r.$Rational(r.den["$**"](e["$-@"]()),r.num["$**"](e["$-@"]())):r.$Rational(1,1):p(G,"Float")["$==="](n)?r.$to_f()["$**"](e):p(G,"Rational")["$==="](n)?e["$=="](0)?r.$Rational(1,1):e.$denominator()["$=="](1)?_(t(e,0))?r.$Rational(r.den["$**"](e.$numerator().$abs()),r.num["$**"](e.$numerator().$abs())):r.$Rational(r.num["$**"](e.$numerator()),r.den["$**"](e.$numerator())):_(r["$=="](0)?t(e,0):r["$=="](0))?r.$raise(p(G,"ZeroDivisionError"),"divided by 0"):r.$to_f()["$**"](e):r.$__coerced__("**",e)},A.$$arity=1),e.def(D,"$abs",T=function(){var e=this;return e.$Rational(e.num.$abs(),e.den.$abs())},T.$$arity=0),e.def(D,"$ceil",S=function(e){var t=this;return null==e&&(e=0),e["$=="](0)?r(t.num["$-@"](),t.den)["$-@"]().$ceil():t.$with_precision("ceil",e)},S.$$arity=-1),e.alias(D,"divide","/"),e.def(D,"$floor",I=function(e){var t=this;return null==e&&(e=0),e["$=="](0)?r(t.num["$-@"](),t.den)["$-@"]().$floor():t.$with_precision("floor",e)},I.$$arity=-1),e.def(D,"$hash",R=function(){var e=this;return"Rational:"+e.num+":"+e.den},R.$$arity=0),e.def(D,"$inspect",C=function(){return"("+this+")"},C.$$arity=0),e.alias(D,"quo","/"),e.def(D,"$rationalize",q=function(e){var t=this;if(arguments.length>1&&t.$raise(p(G,"ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==e)return t;for(var a,$,s,l,u,c=e.$abs(),d=n(t,c),_=i(t,c),f=0,h=1,y=1,m=0;!o(s=d.$ceil(),_);)a=(l=s-1)*h+f,$=l*m+y,u=r(1,n(_,l)),_=r(1,n(d,l)),d=u,f=h,y=m,h=a,m=$;return t.$Rational(s*h+f,s*m+y)},q.$$arity=-1),e.def(D,"$round",M=function(e){var n=this,$=u;return null==e&&(e=0),e["$=="](0)?n.num["$=="](0)?0:n.den["$=="](1)?n.num:($=r(i(a(n.num.$abs(),2),n.den),a(n.den,2)).$truncate(),_(t(n.num,0))?$["$-@"]():$):n.$with_precision("round",e)},M.$$arity=-1),e.def(D,"$to_f",z=function(){var e=this;return r(e.num,e.den)},z.$$arity=0),e.def(D,"$to_i",N=function(){return this.$truncate()},N.$$arity=0),e.def(D,"$to_r",j=function(){return this},j.$$arity=0),e.def(D,"$to_s",P=function(){var e=this;return e.num+"/"+e.den},P.$$arity=0),e.def(D,"$truncate",B=function(e){var r=this;return null==e&&(e=0),e["$=="](0)?_(t(r.num,0))?r.$ceil():r.$floor():r.$with_precision("truncate",e)},B.$$arity=-1),e.def(D,"$with_precision",L=function(e,n){var i=this,$=u,o=u;return _(p(G,"Integer")["$==="](n))||i.$raise(p(G,"TypeError"),"not an Integer"),o=a(i,$=10["$**"](n)),_(t(n,1))?r(o.$send(e),$).$to_i():i.$Rational(o.$send(e),$)},L.$$arity=2)}(l[0],p(l,"Numeric"),l),function(t,r){var n,a=f(t,"Kernel"),i=[a].concat(r);e.def(a,"$Rational",n=function(e,t){return null==t&&(t=1),p(i,"Rational").$convert(e,t)},n.$$arity=-2)}(l[0],l),function(t,$super,r){var n,a=d(t,null,"String");[a].concat(r);return e.def(a,"$to_r",n=function(){function e(){return $.test(i)}function t(){var e=i.match($)[0];return i=i.slice(e.length),e.replace(/_/g,"")}var r,n,a=this,i=a.trimLeft(),$=/^[+-]?[\d_]+(\.[\d_]+)?/;i.match($);return e()?(r=parseFloat(t()),"/"===i[0]?(i=i.slice(1),e()?(n=parseFloat(t()),a.$Rational(r,n)):a.$Rational(r,1)):a.$Rational(r,1)):a.$Rational(0,1)},n.$$arity=0),u&&"to_r"}(l[0],0,l)},Opal.modules["corelib/time"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}var o=e.top,s=[],l=e.nil,u=(e.const_get_qualified,e.const_get_relative),c=(e.breaker,e.slice),p=e.klass,d=e.truthy,_=e.range;return e.add_stubs(["$require","$include","$===","$raise","$coerce_to!","$respond_to?","$to_str","$to_i","$new","$<=>","$to_f","$nil?","$>","$<","$strftime","$year","$month","$day","$+","$round","$/","$-","$copy_instance_variables","$initialize_dup","$is_a?","$zero?","$wday","$utc?","$mon","$yday","$hour","$min","$sec","$rjust","$ljust","$zone","$to_s","$[]","$cweek_cyear","$isdst","$<=","$!=","$==","$ceil"]),o.$require("corelib/comparable"),function(o,$super,s){function f(e,t,r,n,a,i){if(e=e.$$is_string?parseInt(e,10):u(ie,"Opal")["$coerce_to!"](e,u(ie,"Integer"),"to_int"),t===l)t=1;else if(!t.$$is_number)if(t["$respond_to?"]("to_str"))switch((t=t.$to_str()).toLowerCase()){case"jan":t=1;break;case"feb":t=2;break;case"mar":t=3;break;case"apr":t=4;break;case"may":t=5;break;case"jun":t=6;break;case"jul":t=7;break;case"aug":t=8;break;case"sep":t=9;break;case"oct":t=10;break;case"nov":t=11;break;case"dec":t=12;break;default:t=t.$to_i()}else t=u(ie,"Opal")["$coerce_to!"](t,u(ie,"Integer"),"to_int");return(t<1||t>12)&&ae.$raise(u(ie,"ArgumentError"),"month out of range: "+t),t-=1,((r=r===l?1:r.$$is_string?parseInt(r,10):u(ie,"Opal")["$coerce_to!"](r,u(ie,"Integer"),"to_int"))<1||r>31)&&ae.$raise(u(ie,"ArgumentError"),"day out of range: "+r),((n=n===l?0:n.$$is_string?parseInt(n,10):u(ie,"Opal")["$coerce_to!"](n,u(ie,"Integer"),"to_int"))<0||n>24)&&ae.$raise(u(ie,"ArgumentError"),"hour out of range: "+n),((a=a===l?0:a.$$is_string?parseInt(a,10):u(ie,"Opal")["$coerce_to!"](a,u(ie,"Integer"),"to_int"))<0||a>59)&&ae.$raise(u(ie,"ArgumentError"),"min out of range: "+a),i===l?i=0:i.$$is_number||(i=i.$$is_string?parseInt(i,10):u(ie,"Opal")["$coerce_to!"](i,u(ie,"Integer"),"to_int")),(i<0||i>60)&&ae.$raise(u(ie,"ArgumentError"),"sec out of range: "+i),[e,t,r,n,a,i]}var h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q,ee,te,re,ne,ae=p(o,$super,"Time"),ie=[ae].concat(s);ae.$include(u(ie,"Comparable"));var $e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],oe=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],se=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],le=["January","February","March","April","May","June","July","August","September","October","November","December"];return e.defs(ae,"$at",h=function(e,t){var r,n=this;return u(ie,"Time")["$==="](e)?(t!==undefined&&n.$raise(u(ie,"TypeError"),"can't convert Time into an exact number"),(r=new Date(e.getTime())).is_utc=e.is_utc,r):(e.$$is_number||(e=u(ie,"Opal")["$coerce_to!"](e,u(ie,"Integer"),"to_int")),t===undefined?new Date(1e3*e):(t.$$is_number||(t=u(ie,"Opal")["$coerce_to!"](t,u(ie,"Integer"),"to_int")),new Date(1e3*e+t/1e3)))},h.$$arity=-2),e.defs(ae,"$new",y=function(e,t,r,n,a,i,$){var o,s,c=this;return null==t&&(t=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==$&&($=l),e===undefined?new Date:($!==l&&c.$raise(u(ie,"ArgumentError"),"Opal does not support explicitly specifying UTC offset for Time"),e=(o=f(e,t,r,n,a,i))[0],t=o[1],r=o[2],n=o[3],a=o[4],i=o[5],s=new Date(e,t,r,n,a,0,1e3*i),e<100&&s.setFullYear(e),s)},y.$$arity=-1),e.defs(ae,"$local",m=function(e,t,r,n,a,i,$,o,s,u){var p,d;return null==t&&(t=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==$&&($=l),null==o&&(o=l),null==s&&(s=l),null==u&&(u=l),10===arguments.length&&(e=(p=c.call(arguments))[5],t=p[4],r=p[3],n=p[2],a=p[1],i=p[0]),e=(p=f(e,t,r,n,a,i))[0],t=p[1],r=p[2],n=p[3],a=p[4],i=p[5],d=new Date(e,t,r,n,a,0,1e3*i),e<100&&d.setFullYear(e),d},m.$$arity=-2),e.defs(ae,"$gm",g=function(e,t,r,n,a,i,$,o,s,u){var p,d;return null==t&&(t=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),null==i&&(i=l),null==$&&($=l),null==o&&(o=l),null==s&&(s=l),null==u&&(u=l),10===arguments.length&&(e=(p=c.call(arguments))[5],t=p[4],r=p[3],n=p[2],a=p[1],i=p[0]),e=(p=f(e,t,r,n,a,i))[0],t=p[1],r=p[2],n=p[3],a=p[4],i=p[5],d=new Date(Date.UTC(e,t,r,n,a,0,1e3*i)),e<100&&d.setUTCFullYear(e),d.is_utc=!0,d},g.$$arity=-2),function(t,r){[t].concat(r);e.alias(t,"mktime","local"),e.alias(t,"utc","gm")}(e.get_singleton_class(ae),ie),e.defs(ae,"$now",b=function(){return this.$new()},b.$$arity=0),e.def(ae,"$+",v=function(e){var t=this;d(u(ie,"Time")["$==="](e))&&t.$raise(u(ie,"TypeError"),"time + time?"),e.$$is_number||(e=u(ie,"Opal")["$coerce_to!"](e,u(ie,"Integer"),"to_int"));var r=new Date(t.getTime()+1e3*e);return r.is_utc=t.is_utc,r},v.$$arity=1),e.def(ae,"$-",w=function(e){var t=this;if(d(u(ie,"Time")["$==="](e)))return(t.getTime()-e.getTime())/1e3;e.$$is_number||(e=u(ie,"Opal")["$coerce_to!"](e,u(ie,"Integer"),"to_int"));var r=new Date(t.getTime()-1e3*e);return r.is_utc=t.is_utc,r},w.$$arity=1),e.def(ae,"$<=>",k=function(e){var n=this,a=l;return d(u(ie,"Time")["$==="](e))?n.$to_f()["$<=>"](e.$to_f()):(a=e["$<=>"](n),d(a["$nil?"]())?l:d(t(a,0))?-1:d(r(a,0))?1:0)},k.$$arity=1),e.def(ae,"$==",x=function(e){var t,r=this;return d(t=u(ie,"Time")["$==="](e))?r.$to_f()===e.$to_f():t},x.$$arity=1),e.def(ae,"$asctime",E=function(){return this.$strftime("%a %b %e %H:%M:%S %Y")},E.$$arity=0),e.alias(ae,"ctime","asctime"),e.def(ae,"$day",O=function(){var e=this;return e.is_utc?e.getUTCDate():e.getDate()},O.$$arity=0),e.def(ae,"$yday",A=function(){var e=this,t=l,r=l;return t=u(ie,"Time").$new(e.$year()).$to_i(),r=86400,n(a(i(u(ie,"Time").$new(e.$year(),e.$month(),e.$day()).$to_i(),t),r).$round(),1)},A.$$arity=0),e.def(ae,"$isdst",T=function(){var e=this,t=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),6,1);return e.getTimezoneOffset()<Math.max(t.getTimezoneOffset(),r.getTimezoneOffset())},T.$$arity=0),e.alias(ae,"dst?","isdst"),e.def(ae,"$dup",S=function(){var e=this,t=l;return(t=new Date(e.getTime())).$copy_instance_variables(e),t.$initialize_dup(e),t},S.$$arity=0),e.def(ae,"$eql?",I=function(e){var t,r=this;return d(t=e["$is_a?"](u(ie,"Time")))?r["$<=>"](e)["$zero?"]():t},I.$$arity=1),e.def(ae,"$friday?",R=function(){return 5==this.$wday()},R.$$arity=0),e.def(ae,"$hash",C=function(){return"Time:"+this.getTime()},C.$$arity=0),e.def(ae,"$hour",q=function(){var e=this;return e.is_utc?e.getUTCHours():e.getHours()},q.$$arity=0),e.def(ae,"$inspect",M=function(){var e=this;return d(e["$utc?"]())?e.$strftime("%Y-%m-%d %H:%M:%S UTC"):e.$strftime("%Y-%m-%d %H:%M:%S %z")},M.$$arity=0),e.alias(ae,"mday","day"),e.def(ae,"$min",z=function(){var e=this;return e.is_utc?e.getUTCMinutes():e.getMinutes()},z.$$arity=0),e.def(ae,"$mon",N=function(){var e=this;return(e.is_utc?e.getUTCMonth():e.getMonth())+1},N.$$arity=0),e.def(ae,"$monday?",j=function(){return 1==this.$wday()},j.$$arity=0),e.alias(ae,"month","mon"),e.def(ae,"$saturday?",P=function(){return 6==this.$wday()},P.$$arity=0),e.def(ae,"$sec",B=function(){var e=this;return e.is_utc?e.getUTCSeconds():e.getSeconds()},B.$$arity=0),e.def(ae,"$succ",L=function(){var e=this,t=new Date(e.getTime()+1e3);return t.is_utc=e.is_utc,t},L.$$arity=0),e.def(ae,"$usec",D=function(){return 1e3*this.getMilliseconds()},D.$$arity=0),e.def(ae,"$zone",G=function(){var e,t=this.toString();return"GMT"==(e=-1==t.indexOf("(")?t.match(/[A-Z]{3,4}/)[0]:t.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(t)?RegExp.$1:e},G.$$arity=0),e.def(ae,"$getgm",H=function(){var e=new Date(this.getTime());return e.is_utc=!0,e},H.$$arity=0),e.alias(ae,"getutc","getgm"),e.def(ae,"$gmtime",F=function(){var e=this;return e.is_utc=!0,e},F.$$arity=0),e.alias(ae,"utc","gmtime"),e.def(ae,"$gmt?",U=function(){return!0===this.is_utc},U.$$arity=0),e.def(ae,"$gmt_offset",K=function(){var e=this;return e.is_utc?0:60*-e.getTimezoneOffset()},K.$$arity=0),e.def(ae,"$strftime",Y=function(e){var t=this;return e.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(e,r,n,a,i){var $="",o=-1!==r.indexOf("0"),s=-1===r.indexOf("-"),l=-1!==r.indexOf("_"),u=-1!==r.indexOf("^"),c=-1!==r.indexOf("#"),p=(r.match(":")||[]).length;switch(n=parseInt(n,10),o&&l&&(r.indexOf("0")<r.indexOf("_")?o=!1:l=!1),i){case"Y":$+=t.$year();break;case"C":o=!l,$+=Math.round(t.$year()/100);break;case"y":o=!l,$+=t.$year()%100;break;case"m":o=!l,$+=t.$mon();break;case"B":$+=le[t.$mon()-1];break;case"b":case"h":l=!o,$+=se[t.$mon()-1];break;case"d":o=!l,$+=t.$day();break;case"e":l=!o,$+=t.$day();break;case"j":$+=t.$yday();break;case"H":o=!l,$+=t.$hour();break;case"k":l=!o,$+=t.$hour();break;case"I":o=!l,$+=t.$hour()%12||12;break;case"l":l=!o,$+=t.$hour()%12||12;break;case"P":$+=t.$hour()>=12?"pm":"am";break;case"p":$+=t.$hour()>=12?"PM":"AM";break;case"M":o=!l,$+=t.$min();break;case"S":o=!l,$+=t.$sec();break;case"L":o=!l,n=isNaN(n)?3:n,$+=t.getMilliseconds();break;case"N":n=isNaN(n)?9:n,$=($+=t.getMilliseconds().toString().$rjust(3,"0")).$ljust(n,"0");break;case"z":var d=t.getTimezoneOffset(),f=Math.floor(Math.abs(d)/60),h=Math.abs(d)%60;$+=d<0?"+":"-",$+=f<10?"0":"",$+=f,p>0&&($+=":"),$+=h<10?"0":"",$+=h,p>1&&($+=":00");break;case"Z":$+=t.$zone();break;case"A":$+=$e[t.$wday()];break;case"a":$+=oe[t.$wday()];break;case"u":$+=t.$wday()+1;break;case"w":$+=t.$wday();break;case"V":$+=t.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":$+=t.$cweek_cyear()["$[]"](1);break;case"g":$+=t.$cweek_cyear()["$[]"](1)["$[]"](_(-2,-1,!1));break;case"s":$+=t.$to_i();break;case"n":$+="\n";break;case"t":$+="\t";break;case"%":$+="%";break;case"c":$+=t.$strftime("%a %b %e %T %Y");break;case"D":case"x":$+=t.$strftime("%m/%d/%y");break;case"F":$+=t.$strftime("%Y-%m-%d");break;case"v":$+=t.$strftime("%e-%^b-%4Y");break;case"r":$+=t.$strftime("%I:%M:%S %p");break;case"R":$+=t.$strftime("%H:%M");break;case"T":case"X":$+=t.$strftime("%H:%M:%S");break;default:return e}return u&&($=$.toUpperCase()),c&&($=$.replace(/[A-Z]/,function(e){e.toLowerCase()}).replace(/[a-z]/,function(e){e.toUpperCase()})),s&&(o||l)&&($=$.$rjust(isNaN(n)?2:n,l?" ":"0")),$})},Y.$$arity=1),e.def(ae,"$sunday?",V=function(){return 0==this.$wday()},V.$$arity=0),e.def(ae,"$thursday?",W=function(){return 4==this.$wday()},W.$$arity=0),e.def(ae,"$to_a",J=function(){var e=this;return[e.$sec(),e.$min(),e.$hour(),e.$day(),e.$month(),e.$year(),e.$wday(),e.$yday(),e.$isdst(),e.$zone()]},J.$$arity=0),e.def(ae,"$to_f",X=function(){return this.getTime()/1e3},X.$$arity=0),e.def(ae,"$to_i",Z=function(){return parseInt(this.getTime()/1e3,10)},Z.$$arity=0),e.alias(ae,"to_s","inspect"),e.def(ae,"$tuesday?",Q=function(){return 2==this.$wday()},Q.$$arity=0),e.alias(ae,"tv_sec","to_i"),e.alias(ae,"tv_usec","usec"),e.alias(ae,"utc?","gmt?"),e.alias(ae,"gmtoff","gmt_offset"),e.alias(ae,"utc_offset","gmt_offset"),e.def(ae,"$wday",ee=function(){var e=this;return e.is_utc?e.getUTCDay():e.getDay()},ee.$$arity=0),e.def(ae,"$wednesday?",te=function(){return 3==this.$wday()},te.$$arity=0),e.def(ae,"$year",re=function(){var e=this;return e.is_utc?e.getUTCFullYear():e.getFullYear()},re.$$arity=0),e.def(ae,"$cweek_cyear",ne=function(){var e,t=this,r=l,o=l,s=l,c=l,p=l;return r=u(ie,"Time").$new(t.$year(),1,1).$wday(),0,o=t.$year(),d(d(e=$(r,4))?r["$!="](0):e)?s=i(r,1):(s=i(i(r,7),1))["$=="](-8)&&(s=-1),c=a(n(t.$yday(),s),7).$ceil(),d($(c,0))?u(ie,"Time").$new(i(t.$year(),1),12,31).$cweek_cyear():(c["$=="](53)&&(p=u(ie,"Time").$new(t.$year(),12,31).$wday(),d(d(e=$(p,3))?p["$!="](0):e)&&(c=1,o=n(o,1))),[c,o])},ne.$$arity=0),l&&"cweek_cyear"}(s[0],Date,s)},Opal.modules["corelib/struct"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var $=e.top,o=[],s=e.nil,l=(e.const_get_qualified,e.const_get_relative),u=(e.breaker,e.slice,e.klass),c=e.hash2,p=e.truthy,d=e.send;return e.add_stubs(["$require","$include","$const_name!","$unshift","$map","$coerce_to!","$new","$each","$define_struct_attribute","$allocate","$initialize","$alias_method","$module_eval","$to_proc","$const_set","$==","$raise","$<<","$members","$define_method","$instance_eval","$class","$last","$>","$length","$-","$keys","$any?","$join","$[]","$[]=","$each_with_index","$hash","$===","$<","$-@","$size","$>=","$include?","$to_sym","$instance_of?","$__id__","$eql?","$enum_for","$name","$+","$each_pair","$inspect","$each_with_object","$flatten","$to_a","$respond_to?","$dig"]),$.$require("corelib/enumerable"),function($,$super,o){var _,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q=u($,null,"Struct"),M=[q].concat(o);return q.$include(l(M,"Enumerable")),e.defs(q,"$new",_=function(t){var r,n,a,i,$,o,u=_.$$p,f=u||s,h=this,y=s;if(u&&(_.$$p=null),u&&(_.$$p=null),r=e.slice.call(arguments,1,arguments.length),null==(n=e.extract_kwargs(r)))n=c([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(a=r,null==(i=n.$$smap.keyword_init)&&(i=!1),p(t))try{t=l(M,"Opal")["$const_name!"](t)}catch(m){if(!e.rescue(m,[l(M,"TypeError"),l(M,"NameError")]))throw m;try{a.$unshift(t),t=s}finally{e.pop_exception()}}return d(a,"map",[],(($=function(e){$.$$s;return null==e&&(e=s),l(M,"Opal")["$coerce_to!"](e,l(M,"String"),"to_str")}).$$s=h,$.$$arity=1,$)),y=d(l(M,"Class"),"new",[h],((o=function(){var t,r=o.$$s||this;return d(a,"each",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=s),r.$define_struct_attribute(e)}).$$s=r,t.$$arity=1,t)),function(t,r){var n;[t].concat(r);return e.def(t,"$new",n=function(){var t,r=this,n=s;return t=e.slice.call(arguments,0,arguments.length),(n=r.$allocate()).$$data={},d(n,"initialize",e.to_a(t)),n},n.$$arity=-1),t.$alias_method("[]","new")}(e.get_singleton_class(r),M)}).$$s=h,o.$$arity=0,o)),p(f)&&d(y,"module_eval",[],f.$to_proc()),y.$$keyword_init=i,p(t)&&l(M,"Struct").$const_set(t,y),y},_.$$arity=-2),e.defs(q,"$define_struct_attribute",f=function(e){var t,r,n=this;return n["$=="](l(M,"Struct"))&&n.$raise(l(M,"ArgumentError"),"you cannot define attributes to the Struct class"),n.$members()["$<<"](e),d(n,"define_method",[e],((t=function(){return(t.$$s||this).$$data[e]}).$$s=n,t.$$arity=0,t)),d(n,"define_method",[e+"="],((r=function(t){var n=r.$$s||this;return null==t&&(t=s),n.$$data[e]=t}).$$s=n,r.$$arity=1,r))},f.$$arity=1),e.defs(q,"$members",h=function(){var e,t=this;return null==t.members&&(t.members=s),t["$=="](l(M,"Struct"))&&t.$raise(l(M,"ArgumentError"),"the Struct class has no members"),t.members=p(e=t.members)?e:[]},h.$$arity=0),e.defs(q,"$inherited",y=function(e){var t,r=this,n=s;return null==r.members&&(r.members=s),n=r.members,d(e,"instance_eval",[],((t=function(){return(t.$$s||this).members=n}).$$s=r,t.$$arity=0,t))},y.$$arity=1),e.def(q,"$initialize",m=function(){var n,a,i,$,o,u=this,_=s,f=s;return n=e.slice.call(arguments,0,arguments.length),a=n,p(u.$class().$$keyword_init)?(_=p(i=a.$last())?i:c([],{}),p(p(i=t(a.$length(),1))?i:1===a.length&&!_.$$is_hash)&&u.$raise(l(M,"ArgumentError"),"wrong number of arguments (given "+a.$length()+", expected 0)"),f=r(_.$keys(),u.$class().$members()),p(f["$any?"]())&&u.$raise(l(M,"ArgumentError"),"unknown keywords: "+f.$join(", ")),d(u.$class().$members(),"each",[],(($=function(t){var n=$.$$s||this,a=s;return null==t&&(t=s),a=[t,_["$[]"](t)],d(n,"[]=",e.to_a(a)),a[r(a.length,1)]}).$$s=u,$.$$arity=1,$))):(p(t(a.$length(),u.$class().$members().$length()))&&u.$raise(l(M,"ArgumentError"),"struct size differs"),d(u.$class().$members(),"each_with_index",[],((o=function(t,n){var i=o.$$s||this,$=s;return null==t&&(t=s),null==n&&(n=s),$=[t,a["$[]"](n)],d(i,"[]=",e.to_a($)),$[r($.length,1)]}).$$s=u,o.$$arity=2,o)))},m.$$arity=-1),e.def(q,"$members",g=function(){return this.$class().$members()},g.$$arity=0),e.def(q,"$hash",b=function(){var e=this;return l(M,"Hash").$new(e.$$data).$hash()},b.$$arity=0),e.def(q,"$[]",v=function(e){var t=this;return p(l(M,"Integer")["$==="](e))?(p(n(e,t.$class().$members().$size()["$-@"]()))&&t.$raise(l(M,"IndexError"),"offset "+e+" too small for struct(size:"+t.$class().$members().$size()+")"),p(a(e,t.$class().$members().$size()))&&t.$raise(l(M,"IndexError"),"offset "+e+" too large for struct(size:"+t.$class().$members().$size()+")"),e=t.$class().$members()["$[]"](e)):p(l(M,"String")["$==="](e))?t.$$data.hasOwnProperty(e)||t.$raise(l(M,"NameError").$new("no member '"+e+"' in struct",e)):t.$raise(l(M,"TypeError"),"no implicit conversion of "+e.$class()+" into Integer"),e=l(M,"Opal")["$coerce_to!"](e,l(M,"String"),"to_str"),t.$$data[e]},v.$$arity=1),e.def(q,"$[]=",w=function(e,t){var r=this;return p(l(M,"Integer")["$==="](e))?(p(n(e,r.$class().$members().$size()["$-@"]()))&&r.$raise(l(M,"IndexError"),"offset "+e+" too small for struct(size:"+r.$class().$members().$size()+")"),p(a(e,r.$class().$members().$size()))&&r.$raise(l(M,"IndexError"),"offset "+e+" too large for struct(size:"+r.$class().$members().$size()+")"),e=r.$class().$members()["$[]"](e)):p(l(M,"String")["$==="](e))?p(r.$class().$members()["$include?"](e.$to_sym()))||r.$raise(l(M,"NameError").$new("no member '"+e+"' in struct",e)):r.$raise(l(M,"TypeError"),"no implicit conversion of "+e.$class()+" into Integer"),e=l(M,"Opal")["$coerce_to!"](e,l(M,"String"),"to_str"),r.$$data[e]=t},w.$$arity=2),e.def(q,"$==",k=function(e){function t(e,r){var i,$,o;for(i in n[e.$__id__()]=!0,a[r.$__id__()]=!0,e.$$data)if($=e.$$data[i],o=r.$$data[i],l(M,"Struct")["$==="]($)){if(!(n.hasOwnProperty($.$__id__())&&a.hasOwnProperty(o.$__id__())||t($,o)))return!1}else if(!$["$=="](o))return!1;return!0}var r=this;if(!p(e["$instance_of?"](r.$class())))return!1;var n={},a={};return t(r,e)},k.$$arity=1),e.def(q,"$eql?",x=function(e){function t(e,r){var i,$,o;for(i in n[e.$__id__()]=!0,a[r.$__id__()]=!0,e.$$data)if($=e.$$data[i],o=r.$$data[i],l(M,"Struct")["$==="]($)){if(!(n.hasOwnProperty($.$__id__())&&a.hasOwnProperty(o.$__id__())||t($,o)))return!1}else if(!$["$eql?"](o))return!1;return!0}var r=this;if(!p(e["$instance_of?"](r.$class())))return!1;var n={},a={};return t(r,e)},x.$$arity=1),e.def(q,"$each",E=function(){var t,r,n=E.$$p,a=n||s,i=this;return n&&(E.$$p=null),a===s?d(i,"enum_for",["each"],((t=function(){return(t.$$s||this).$size()}).$$s=i,t.$$arity=0,t)):(d(i.$class().$members(),"each",[],((r=function(t){var n=r.$$s||this;return null==t&&(t=s),e.yield1(a,n["$[]"](t))}).$$s=i,r.$$arity=1,r)),i)},E.$$arity=0),e.def(q,"$each_pair",O=function(){var t,r,n=O.$$p,a=n||s,i=this;return n&&(O.$$p=null),a===s?d(i,"enum_for",["each_pair"],((t=function(){return(t.$$s||this).$size()}).$$s=i,t.$$arity=0,t)):(d(i.$class().$members(),"each",[],((r=function(t){var n=r.$$s||this;return null==t&&(t=s),e.yield1(a,[t,n["$[]"](t)])}).$$s=i,r.$$arity=1,r)),i)},O.$$arity=0),e.def(q,"$length",A=function(){return this.$class().$members().$length()},A.$$arity=0),e.alias(q,"size","length"),e.def(q,"$to_a",T=function(){var e,t=this;return d(t.$class().$members(),"map",[],((e=function(t){var r=e.$$s||this;return null==t&&(t=s),r["$[]"](t)}).$$s=t,e.$$arity=1,e))},T.$$arity=0),e.alias(q,"values","to_a"),e.def(q,"$inspect",S=function(){var e,t,r=this,n=s;return n="#<struct ",p(p(e=l(M,"Struct")["$==="](r))?r.$class().$name():e)&&(n=i(n,r.$class()+" ")),n=i(n=i(n,d(r.$each_pair(),"map",[],(t=function(e,r){t.$$s;return null==e&&(e=s),null==r&&(r=s),e+"="+r.$inspect()},t.$$s=r,t.$$arity=2,t)).$join(", ")),">")},S.$$arity=0),e.alias(q,"to_s","inspect"),e.def(q,"$to_h",I=function(){var t,n=this;return d(n.$class().$members(),"each_with_object",[c([],{})],((t=function(n,a){var i=t.$$s||this,$=s;return null==n&&(n=s),null==a&&(a=s),$=[n,i["$[]"](n)],d(a,"[]=",e.to_a($)),$[r($.length,1)]}).$$s=n,t.$$arity=2,t))},I.$$arity=0),e.def(q,"$values_at",R=function(){var t,r,n,a=this;t=e.slice.call(arguments,0,arguments.length);for(var i=[],$=0,o=(r=d(r=t,"map",[],(n=function(e){n.$$s;return null==e&&(e=s),e.$$is_range?e.$to_a():e},n.$$s=a,n.$$arity=1,n)).$flatten()).length;$<o;$++)r[$].$$is_number||a.$raise(l(M,"TypeError"),"no implicit conversion of "+r[$].$class()+" into Integer"),i.push(a["$[]"](r[$]));return i},R.$$arity=-1),e.def(q,"$dig",C=function(t){var r,n=this,a=s;return r=e.slice.call(arguments,1,arguments.length),(a=p(t.$$is_string&&n.$$data.hasOwnProperty(t))&&n.$$data[t]||s)===s||0===r.length?a:(p(a["$respond_to?"]("dig"))||n.$raise(l(M,"TypeError"),a.$class()+" does not have #dig method"),d(a,"dig",e.to_a(r)))},C.$$arity=-2),s&&"dig"}(o[0],0,o)},Opal.modules["corelib/io"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.klass),o=e.module,s=e.send,l=e.gvars,u=e.truthy,c=n;e.add_stubs(["$attr_accessor","$size","$write","$join","$map","$String","$empty?","$concat","$chomp","$getbyte","$getc","$raise","$new","$write_proc=","$-","$extend"]),function(t,$super,r){var a,c,p,d,_=$(t,null,"IO"),f=[_].concat(r);_.$$prototype.tty=_.$$prototype.closed=n,e.const_set(f[0],"SEEK_SET",0),e.const_set(f[0],"SEEK_CUR",1),e.const_set(f[0],"SEEK_END",2),e.def(_,"$tty?",a=function(){return this.tty},a.$$arity=0),e.def(_,"$closed?",c=function(){return this.closed},c.$$arity=0),_.$attr_accessor("write_proc"),e.def(_,"$write",p=function(e){return this.write_proc(e),e.$size()},p.$$arity=1),_.$attr_accessor("sync","tty"),e.def(_,"$flush",d=function(){return n},d.$$arity=0),function(t,r){var a,i,$,c=o(t,"Writable");[c].concat(r);e.def(c,"$<<",a=function(e){var t=this;return t.$write(e),t},a.$$arity=1),e.def(c,"$print",i=function(){var t,r,a=this;return null==l[","]&&(l[","]=n),t=e.slice.call(arguments,0,arguments.length),a.$write(s(t,"map",[],(r=function(e){var t=r.$$s||this;return null==e&&(e=n),t.$String(e)},r.$$s=a,r.$$arity=1,r)).$join(l[","])),n},i.$$arity=-1),e.def(c,"$puts",$=function(){var t,r,a=this,i=n;return null==l["/"]&&(l["/"]=n),t=e.slice.call(arguments,0,arguments.length),i=l["/"],u(t["$empty?"]())?a.$write(l["/"]):a.$write(s(t,"map",[],(r=function(e){var t=r.$$s||this;return null==e&&(e=n),t.$String(e).$chomp()},r.$$s=a,r.$$arity=1,r)).$concat([n]).$join(i)),n},$.$$arity=-1)}(f[0],f),function(t,r){var a,$,s,u,c=o(t,"Readable"),p=[c].concat(r);e.def(c,"$readbyte",a=function(){return this.$getbyte()},a.$$arity=0),e.def(c,"$readchar",$=function(){return this.$getc()},$.$$arity=0),e.def(c,"$readline",s=function(e){var t=this;return null==l["/"]&&(l["/"]=n),null==e&&(e=l["/"]),t.$raise(i(p,"NotImplementedError"))},s.$$arity=-1),e.def(c,"$readpartial",u=function(e,t){return null==t&&(t=n),this.$raise(i(p,"NotImplementedError"))},u.$$arity=-2)}(f[0],f)}(r[0],0,r),e.const_set(r[0],"STDERR",l.stderr=i(r,"IO").$new()),e.const_set(r[0],"STDIN",l.stdin=i(r,"IO").$new()),e.const_set(r[0],"STDOUT",l.stdout=i(r,"IO").$new());var p=e.global.console;return c=["object"==typeof process&&"object"==typeof process.stdout?function(e){process.stdout.write(e)}:function(e){p.log(e)}],s(i(r,"STDOUT"),"write_proc=",e.to_a(c)),c[t(c.length,1)],c=["object"==typeof process&&"object"==typeof process.stderr?function(e){process.stderr.write(e)}:function(e){p.warn(e)}],s(i(r,"STDERR"),"write_proc=",e.to_a(c)),c[t(c.length,1)],i(r,"STDOUT").$extend(a(i(r,"IO"),"Writable")),i(r,"STDERR").$extend(a(i(r,"IO"),"Writable"))},Opal.modules["corelib/main"]=function(e){var t,r,n=e.top,a=[],i=e.nil,$=(e.const_get_qualified,e.const_get_relative);e.breaker,e.slice;return e.add_stubs(["$include"]),e.defs(n,"$to_s",t=function(){return"main"},t.$$arity=0),e.defs(n,"$include",r=function(e){return $(a,"Object").$include(e)},r.$$arity=1),i&&"include"},Opal.modules["corelib/dir"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.klass),i=e.truthy;return e.add_stubs(["$[]"]),function(t,$super,$){var o=a(t,null,"Dir"),s=[o].concat($);return function(t,a){var $,o,s,l=[t].concat(a);return e.def(t,"$chdir",$=function(t){var n=$.$$p,a=n||r,i=r;return n&&($.$$p=null),function(){try{return i=e.current_dir,e.current_dir=t,e.yieldX(a,[])}finally{e.current_dir=i}}()},$.$$arity=1),e.def(t,"$pwd",o=function(){return e.current_dir||"."},o.$$arity=0),e.alias(t,"getwd","pwd"),e.def(t,"$home",s=function(){var e
;return i(e=n(l,"ENV")["$[]"]("HOME"))?e:"."},s.$$arity=0),r&&"home"}(e.get_singleton_class(o),s)}(t[0],0,t)},Opal.modules["corelib/file"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.klass),o=e.truthy,s=e.range,l=e.send;return e.add_stubs(["$respond_to?","$to_path","$pwd","$split","$sub","$+","$unshift","$join","$home","$raise","$start_with?","$absolute_path","$coerce_to!","$basename","$empty?","$rindex","$[]","$nil?","$==","$-","$length","$gsub","$find","$=~","$map","$each_with_index","$flatten","$reject","$to_proc","$end_with?"]),function(n,$super,u){var c=$(n,$super,"File"),p=[c].concat(u),d=a;return e.const_set(p[0],"Separator",e.const_set(p[0],"SEPARATOR","/")),e.const_set(p[0],"ALT_SEPARATOR",a),e.const_set(p[0],"PATH_SEPARATOR",":"),e.const_set(p[0],"FNM_SYSCASE",0),d=/^[a-zA-Z]:(?:\\|\/)/,function(n,$){function u(e){return o(e["$respond_to?"]("to_path"))&&(e=e.$to_path()),e=i(w,"Opal")["$coerce_to!"](e,i(w,"String"),"to_str")}function c(){return i(w,"ALT_SEPARATOR")===a?e.escape_regexp(i(w,"SEPARATOR")):e.escape_regexp(t(i(w,"SEPARATOR"),i(w,"ALT_SEPARATOR")))}var p,_,f,h,y,m,g,b,v,w=[n].concat($);return e.def(n,"$absolute_path",p=function(e,r){var n,$,s=a,l=a,u=a,p=a,_=a,f=a,h=a,y=a,m=a;null==r&&(r=a),s=i(w,"SEPARATOR"),l=c(),u=[],e=o(e["$respond_to?"]("to_path"))?e.$to_path():e,r=o(n=r)?n:i(w,"Dir").$pwd(),p=e.substr(0,s.length)===s||d.test(e),_=r.substr(0,s.length)===s||d.test(r),o(p)?(f=e.$split(new RegExp("["+l+"]")),h=d.test(e)?"":e.$sub(new RegExp("^(["+l+"]+).*$"),"\\1"),y=!0):(f=t(r.$split(new RegExp("["+l+"]")),e.$split(new RegExp("["+l+"]"))),h=d.test(r)?"":r.$sub(new RegExp("^(["+l+"]+).*$"),"\\1"),y=_);for(var g=0,b=f.length;g<b;g++)($=f[g])===a||""===$&&(0===u.length||y)||"."===$&&(0===u.length||y)||(".."===$?u.pop():u.push($));return y||"."===f[0]||u.$unshift("."),m=u.$join(s),o(y)&&(m=t(h,m)),m},p.$$arity=-2),e.def(n,"$expand_path",_=function(e,r){var n=this,$=a,s=a,l=a,u=a,p=a;return null==r&&(r=a),$=i(w,"SEPARATOR"),s=c(),o("~"===e[0]||r&&"~"===r[0])&&(l=i(w,"Dir").$home(),o(l)||n.$raise(i(w,"ArgumentError"),"couldn't find HOME environment -- expanding `~'"),u=d.test(l)?"":l.$sub(new RegExp("^(["+s+"]+).*$"),"\\1"),o(l["$start_with?"](u))||n.$raise(i(w,"ArgumentError"),"non-absolute home"),l=t(l,$),p=new RegExp("^\\~(?:"+$+"|$)"),e=e.$sub(p,l),o(r)&&(r=r.$sub(p,l))),n.$absolute_path(e,r)},_.$$arity=-2),e.alias(n,"realpath","expand_path"),e.def(n,"$dirname",f=function(e){var t=a;t=c();var r=(e=u(e)).match(new RegExp("^["+t+"]"));return""===(e=(e=(e=e.replace(new RegExp("["+t+"]+$"),"")).replace(new RegExp("[^"+t+"]+$"),"")).replace(new RegExp("["+t+"]+$"),""))?r?"/":".":e},f.$$arity=1),e.def(n,"$basename",h=function(t,r){var n=a;return null==r&&(r=a),n=c(),0==(t=u(t)).length?t:(r=r!==a?i(w,"Opal")["$coerce_to!"](r,i(w,"String"),"to_str"):null,t=(t=t.replace(new RegExp("(.)["+n+"]*$"),"$1")).replace(new RegExp("^(?:.*["+n+"])?([^"+n+"]+)$"),"$1"),".*"===r?t=t.replace(/\.[^\.]+$/,""):null!==r&&(r=e.escape_regexp(r),t=t.replace(new RegExp(r+"$"),"")),t)},h.$$arity=-2),e.def(n,"$extname",y=function(n){var i,$=this,l=a,c=a;return n=u(n),l=$.$basename(n),o(l["$empty?"]())?"":(c=l["$[]"](s(1,-1,!1)).$rindex("."),o(o(i=c["$nil?"]())?i:t(c,1)["$=="](r(l.$length(),1)))?"":l["$[]"](e.Range.$new(t(c,1),-1,!1)))},y.$$arity=1),e.def(n,"$exist?",m=function(t){return null!=e.modules[t]},m.$$arity=1),e.alias(n,"exists?","exist?"),e.def(n,"$directory?",g=function(t){var r,n=this,$=a;for(var o in $=[],e.modules)$.push(o);return t=t.$gsub(new RegExp("(^."+i(w,"SEPARATOR")+"+|"+i(w,"SEPARATOR")+"+$)")),l($,"find",[],((r=function(e){r.$$s;return null==e&&(e=a),e["$=~"](new RegExp("^"+t))}).$$s=n,r.$$arity=1,r))},g.$$arity=1),e.def(n,"$join",b=function(){var r,n,$,s,u=this,c=a;return r=e.slice.call(arguments,0,arguments.length),o((n=r)["$empty?"]())?"":(c="",n=l(n.$flatten().$each_with_index(),"map",[],(($=function(e,r){$.$$s;return null==e&&(e=a),null==r&&(r=a),o(r["$=="](0)?e["$empty?"]():r["$=="](0))?i(w,"SEPARATOR"):o(n.$length()["$=="](t(r,1))?e["$empty?"]():n.$length()["$=="](t(r,1)))?i(w,"SEPARATOR"):e}).$$s=u,$.$$arity=2,$)),n=l(n,"reject",[],"empty?".$to_proc()),l(n,"each_with_index",[],((s=function(e,r){s.$$s;var $,l=a;return null==e&&(e=a),null==r&&(r=a),l=n["$[]"](t(r,1)),o(l["$nil?"]())?c=""+c+e:(o(o($=e["$end_with?"](i(w,"SEPARATOR")))?l["$start_with?"](i(w,"SEPARATOR")):$)&&(e=e.$sub(new RegExp(i(w,"SEPARATOR")+"+$"),"")),c=o(o($=e["$end_with?"](i(w,"SEPARATOR")))?$:l["$start_with?"](i(w,"SEPARATOR")))?""+c+e:""+c+e+i(w,"SEPARATOR"))}).$$s=u,s.$$arity=2,s)),c)},b.$$arity=-1),e.def(n,"$split",v=function(e){return e.$split(i(w,"SEPARATOR"))},v.$$arity=1),a&&"split"}(e.get_singleton_class(c),p)}(n[0],i(n,"IO"),n)},Opal.modules["corelib/process"]=function(e){e.top;var t=[],r=e.nil,n=e.const_get_qualified,a=e.const_get_relative,i=(e.breaker,e.slice,e.klass),$=e.truthy;return e.add_stubs(["$const_set","$size","$<<","$__register_clock__","$to_f","$now","$new","$[]","$raise"]),function(t,$super,o){var s,l,u,c,p=i(t,null,"Process"),d=[p].concat(o),_=r;if(p.__clocks__=[],e.defs(p,"$__register_clock__",s=function(e,t){var n=this;return null==n.__clocks__&&(n.__clocks__=r),n.$const_set(e,n.__clocks__.$size()),n.__clocks__["$<<"](t)},s.$$arity=2),p.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),_=!1,e.global.performance)_=function(){return performance.now()};else if(e.global.process&&process.hrtime){var f=process.hrtime();_=function(){var e=process.hrtime(f),t=e[1]/1e3|0;return 1e3*e[0]+t/1e3}}$(_)&&p.$__register_clock__("CLOCK_MONOTONIC",_),e.defs(p,"$pid",l=function(){return 0},l.$$arity=0),e.defs(p,"$times",u=function(){var e=r;return e=a(d,"Time").$now().$to_f(),n(a(d,"Benchmark"),"Tms").$new(e,e,e,e,e)},u.$$arity=0),e.defs(p,"$clock_gettime",c=function(e,t){var i=this,o=r;null==i.__clocks__&&(i.__clocks__=r),null==t&&(t="float_second"),$(o=i.__clocks__["$[]"](e))||i.$raise(n(a(d,"Errno"),"EINVAL"),"clock_gettime("+e+") "+i.__clocks__["$[]"](e));var s=o();switch(t){case"float_second":return s/1e3;case"float_millisecond":return s/1;case"float_microsecond":return 1e3*s;case"second":return s/1e3|0;case"millisecond":return s/1|0;case"microsecond":return 1e3*s|0;case"nanosecond":return 1e6*s|0;default:i.$raise(a(d,"ArgumentError"),"unexpected unit: "+t)}},c.$$arity=-2)}(t[0],0,t),function(t,$super,n){var a,$=i(t,null,"Signal");[$].concat(n);e.defs($,"$trap",a=function(){return e.slice.call(arguments,0,arguments.length),r},a.$$arity=-1)}(t[0],0,t),function(t,$super,n){var a,$=i(t,null,"GC");[$].concat(n);return e.defs($,"$start",a=function(){return r},a.$$arity=0),r&&"start"}(t[0],0,t)},Opal.modules["corelib/random"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}e.top;var r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.klass),$=e.truthy,o=e.send;return e.add_stubs(["$attr_reader","$new_seed","$coerce_to!","$reseed","$rand","$seed","$<","$raise","$encode","$join","$new","$chr","$===","$==","$state","$const_defined?","$const_set"]),function(r,$super,s){var l,u,c,p,d,_,f,h,y,m,g=i(r,null,"Random"),b=[g].concat(s);return g.$attr_reader("seed","state"),e.def(g,"$initialize",l=function(e){var t=this;return null==e&&(e=a(b,"Random").$new_seed()),e=a(b,"Opal")["$coerce_to!"](e,a(b,"Integer"),"to_int"),t.state=e,t.$reseed(e)},l.$$arity=-1),e.def(g,"$reseed",u=function(t){var r=this;return r.seed=t,r.$rng=e.$$rand.reseed(t)},u.$$arity=1),e.defs(g,"$new_seed",c=function(){return e.$$rand.new_seed()},c.$$arity=0),e.defs(g,"$rand",p=function(e){return a(b,"DEFAULT").$rand(e)},p.$$arity=-1),e.defs(g,"$srand",d=function(e){var t=n;return null==e&&(e=a(b,"Random").$new_seed()),e=a(b,"Opal")["$coerce_to!"](e,a(b,"Integer"),"to_int"),t=a(b,"DEFAULT").$seed(),a(b,"DEFAULT").$reseed(e),t},d.$$arity=-1),e.defs(g,"$urandom",_=function(e){var r,n=this;return e=a(b,"Opal")["$coerce_to!"](e,a(b,"Integer"),"to_int"),$(t(e,0))&&n.$raise(a(b,"ArgumentError"),"negative string size (or size too big)"),o(a(b,"Array"),"new",[e],(r=function(){return(r.$$s||this).$rand(255).$chr()},r.$$s=n,r.$$arity=0,r)).$join().$encode("ASCII-8BIT")},_.$$arity=1),e.def(g,"$==",f=function(e){var t=this;return!!$(a(b,"Random")["$==="](e))&&(t.$seed()["$=="](e.$seed())?t.$state()["$=="](e.$state()):t.$seed()["$=="](e.$seed()))},f.$$arity=1),e.def(g,"$bytes",h=function(e){var t,r=this;return e=a(b,"Opal")["$coerce_to!"](e,a(b,"Integer"),"to_int"),o(a(b,"Array"),"new",[e],(t=function(){return(t.$$s||this).$rand(255).$chr()},t.$$s=r,t.$$arity=0,t)).$join().$encode("ASCII-8BIT")},h.$$arity=1),e.def(g,"$rand",y=function(t){function r(){return o.state++,e.$$rand.rand(o.$rng)}function i(){return Math.floor(r()*t)}function $(){var e=t.begin,r=t.end;if(e===n||r===n)return n;var a=r-e;return a<0?n:0===a?e:(r%1!=0||e%1!=0||t.excl||a++,o.$rand(a)+e)}var o=this;return null==t?r():t.$$is_range?$():t.$$is_number?(t<=0&&o.$raise(a(b,"ArgumentError"),"invalid argument - "+t),t%1==0?i():r()*t):((t=a(b,"Opal")["$coerce_to!"](t,a(b,"Integer"),"to_int"))<=0&&o.$raise(a(b,"ArgumentError"),"invalid argument - "+t),i())},y.$$arity=-1),e.defs(g,"$generator=",m=function(t){var r=this;return e.$$rand=t,$(r["$const_defined?"]("DEFAULT"))?a(b,"DEFAULT").$reseed():r.$const_set("DEFAULT",r.$new(r.$new_seed()))},m.$$arity=1),n&&"generator="}(r[0],0,r)};
/*
This is based on an adaptation of Makoto Matsumoto and Takuji Nishimura's code
done by Sean McCullough <banksean@gmail.com> and Dave Heitzman
<daveheitzman@yahoo.com>, subsequently readapted from an updated version of
ruby's random.c (rev c38a183032a7826df1adabd8aa0725c713d53e1c).

The original copyright notice from random.c follows.

  This is based on trimmed version of MT19937.  To get the original version,
  contact <http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html>.

  The original copyright notice follows.

     A C-program for MT19937, with initialization improved 2002/2/10.
     Coded by Takuji Nishimura and Makoto Matsumoto.
     This is a faster version by taking Shawn Cokus's optimization,
     Matthe Bellew's simplification, Isaku Wada's real version.

     Before using, initialize the state by using init_genrand(mt, seed)
     or init_by_array(mt, init_key, key_length).

     Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
     All rights reserved.

     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
     are met:

       1. Redistributions of source code must retain the above copyright
          notice, this list of conditions and the following disclaimer.

       2. Redistributions in binary form must reproduce the above copyright
          notice, this list of conditions and the following disclaimer in the
          documentation and/or other materials provided with the distribution.

       3. The names of its contributors may not be used to endorse or promote
          products derived from this software without specific prior written
          permission.

     THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
     A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
     CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
     EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
     PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
     PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
     LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
     NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
     SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


     Any feedback is very welcome.
     http://www.math.keio.ac.jp/matumoto/emt.html
     email: matumoto@math.keio.ac.jp
*/
var MersenneTwister=function(){function e(e){var r={left:0,next:$,state:new Array($)};return t(r,e),r}function t(e,t){var r;for(e.state[0]=t>>>0,r=1;r<$;r++)e.state[r]=1812433253*(e.state[r-1]^e.state[r-1]>>30>>>0)+r,e.state[r]&=4294967295;e.left=1,e.next=$}function r(e){var t,r=0,n=e.state;for(e.left=$,e.next=0,t=$-o+1;--t;r++)n[r]=n[r+o]^p(n[r+0],n[r+1]);for(t=o;--t;r++)n[r]=n[r+(o-$)]^p(n[r+0],n[r+1]);n[r]=n[r+(o-$)]^p(n[r+0],n[0])}function n(e){var t;return--e.left<=0&&r(e),t=e.state[e.next++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0}function a(e,t){return(67108864*(e>>>=5)+(t>>>=6))*(1/9007199254740992)}function i(e){return a(n(e),n(e))}var $=624,o=397,s=2567483615,l=2147483648,u=2147483647,c=function(e,t){return e&l|t&u},p=function(e,t){return c(e,t)>>>1^(1&t?s:0)};return{genrand_real:i,init:e}}();if(Opal.loaded(["corelib/random/MersenneTwister.js"]),Opal.modules["corelib/random/mersenne_twister"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.klass),o=e.send;return e.add_stubs(["$require","$generator=","$-"]),r.$require("corelib/random/MersenneTwister"),function(r,$super,n){var s=$(r,null,"Random"),l=[s].concat(n),u=a,c=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1;return e.const_set(l[0],"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*c)},reseed:function(e){return MersenneTwister.init(e)},rand:function(e){return MersenneTwister.genrand_real(e)}}),u=[i(l,"MERSENNE_TWISTER_GENERATOR")],o(s,"generator=",e.to_a(u)),u[t(u.length,1)]}(n[0],0,n)},Opal.modules["corelib/unsupported"]=function(e){function t(t){switch(e.config.unsupported_features_severity){case"error":s($,"Kernel").$raise(s($,"NotImplementedError"),t);break;case"warning":r(t)}}function r(e){c[e]||(c[e]=!0,i.$warn(e))}var n,a,i=e.top,$=[],o=e.nil,s=(e.const_get_qualified,e.const_get_relative),l=(e.breaker,e.slice,e.klass),u=e.module;e.add_stubs(["$raise","$warn","$%"]);var c={};return function(t,$super,r){var n,a,i,$,o,u,c,p,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T=l(t,null,"String"),S=[T].concat(r),I="String#%s not supported. Mutable String methods are not supported in Opal.";e.def(T,"$<<",n=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("<<"))},n.$$arity=-1),e.def(T,"$capitalize!",a=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("capitalize!"))},a.$$arity=-1),e.def(T,"$chomp!",i=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("chomp!"))},i.$$arity=-1),e.def(T,"$chop!",$=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("chop!"))},$.$$arity=-1),e.def(T,"$downcase!",o=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("downcase!"))},o.$$arity=-1),e.def(T,"$gsub!",u=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("gsub!"))},u.$$arity=-1),e.def(T,"$lstrip!",c=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("lstrip!"))},c.$$arity=-1),e.def(T,"$next!",p=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("next!"))},p.$$arity=-1),e.def(T,"$reverse!",d=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("reverse!"))},d.$$arity=-1),e.def(T,"$slice!",_=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("slice!"))},_.$$arity=-1),e.def(T,"$squeeze!",f=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("squeeze!"))},f.$$arity=-1),e.def(T,"$strip!",h=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("strip!"))},h.$$arity=-1),e.def(T,"$sub!",y=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("sub!"))},y.$$arity=-1),e.def(T,"$succ!",m=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("succ!"))},m.$$arity=-1),e.def(T,"$swapcase!",g=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("swapcase!"))},g.$$arity=-1),e.def(T,"$tr!",b=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("tr!"))},b.$$arity=-1),e.def(T,"$tr_s!",v=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("tr_s!"))},v.$$arity=-1),e.def(T,"$upcase!",w=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("upcase!"))},w.$$arity=-1),e.def(T,"$prepend",k=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("prepend"))},k.$$arity=-1),e.def(T,"$[]=",x=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("[]="))},x.$$arity=-1),e.def(T,"$clear",E=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("clear"))},E.$$arity=-1),e.def(T,"$encode!",O=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("encode!"))},O.$$arity=-1),e.def(T,"$unicode_normalize!",A=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(S,"NotImplementedError"),I["$%"]("unicode_normalize!"))},A.$$arity=-1)}($[0],0,$),function(r,n){var a,i,$=u(r,"Kernel"),o=([$].concat(n),"Object freezing is not supported by Opal");e.def($,"$freeze",a=function(){var e=this;return t(o),e},a.$$arity=0),e.def($,"$frozen?",i=function(){return t(o),!1},i.$$arity=0)}($[0],$),function(r,n){var a,i,$,o=u(r,"Kernel"),s=([o].concat(n),"Object tainting is not supported by Opal");e.def(o,"$taint",a=function(){var e=this;return t(s),e},a.$$arity=0),e.def(o,"$untaint",i=function(){var e=this;return t(s),e},i.$$arity=0),e.def(o,"$tainted?",$=function(){return t(s),!1},$.$$arity=0)}($[0],$),function(t,$super,r){var n,a,i,$,s=l(t,null,"Module");[s].concat(r);e.def(s,"$public",n=function(){var t=this;return 0===e.slice.call(arguments,0,arguments.length).length&&(t.$$module_function=!1),o},n.$$arity=-1),e.alias(s,"private","public"),e.alias(s,"protected","public"),e.alias(s,"nesting","public"),e.def(s,"$private_class_method",a=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t},a.$$arity=-1),e.alias(s,"public_class_method","private_class_method"),e.def(s,"$private_method_defined?",i=function(){return!1},i.$$arity=1),e.def(s,"$private_constant",$=function(){return e.slice.call(arguments,0,arguments.length),o},$.$$arity=-1),e.alias(s,"protected_method_defined?","private_method_defined?"),e.alias(s,"public_instance_methods","instance_methods"),e.alias(s,"public_instance_method","instance_method"),e.alias(s,"public_method_defined?","method_defined?")}($[0],0,$),function(t,r){var n,a=u(t,"Kernel");[a].concat(r);e.def(a,"$private_methods",n=function(){return e.slice.call(arguments,0,arguments.length),[]},n.$$arity=-1),e.alias(a,"private_instance_methods","private_methods")}($[0],$),function(t,r){var n,a=u(t,"Kernel"),i=[a].concat(r);e.def(a,"$eval",n=function(){var t=this;return e.slice.call(arguments,0,arguments.length),t.$raise(s(i,"NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+s(i,"RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},n.$$arity=-1)}($[0],$),e.defs(i,"$public",n=function(){return e.slice.call(arguments,0,arguments.length),o},n.$$arity=-1),e.defs(i,"$private",a=function(){return e.slice.call(arguments,0,arguments.length),o},a.$$arity=-1),o&&"private"},function(e){var t=e.top;e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice;e.add_stubs(["$require"]),t.$require("opal/base"),t.$require("opal/mini"),t.$require("corelib/kernel/format"),t.$require("corelib/string/encoding"),t.$require("corelib/math"),t.$require("corelib/complex"),t.$require("corelib/rational"),t.$require("corelib/time"),t.$require("corelib/struct"),t.$require("corelib/io"),t.$require("corelib/main"),t.$require("corelib/dir"),t.$require("corelib/file"),t.$require("corelib/process"),t.$require("corelib/random"),t.$require("corelib/random/mersenne_twister.js"),t.$require("corelib/unsupported")}(Opal),Opal.modules.native=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.truthy,u=e.send,c=e.hash2,p=e.range,d=e.klass,_=e.gvars;return e.add_stubs(["$try_convert","$native?","$respond_to?","$to_n","$raise","$inspect","$Native","$proc","$map!","$end_with?","$define_method","$[]","$convert","$call","$to_proc","$new","$each","$native_reader","$native_writer","$extend","$warn","$include","$is_a?","$map","$to_a","$_Array","$method_missing","$bind","$instance_method","$slice","$-","$length","$[]=","$enum_for","$===","$>=","$<<","$each_pair","$_initialize","$name","$native_module"]),function(t,r){var n,a,d,_,f,h,y=s(t,"Native"),m=[y].concat(r);e.defs(y,"$is_a?",n=function(e,t){var r=this;try{return e instanceof r.$try_convert(t)}catch(n){return!1}},n.$$arity=2),e.defs(y,"$try_convert",a=function(e,t){return null==t&&(t=i),this["$native?"](e)?e:e["$respond_to?"]("to_n")?e.$to_n():t},a.$$arity=-2),e.defs(y,"$convert",d=function(e){var t=this;return t["$native?"](e)?e:e["$respond_to?"]("to_n")?e.$to_n():void t.$raise(o(m,"ArgumentError"),e.$inspect()+" isn't native")},d.$$arity=1),e.defs(y,"$call",_=function(t,r){var n,a=_.$$p,$=a||i,o=this;a&&(_.$$p=null),a&&(_.$$p=null),n=e.slice.call(arguments,2,arguments.length);var s=t[r];if(s instanceof Function){for(var l=new Array(n.length),u=0,c=n.length;u<c;u++){var p=n[u],d=o.$try_convert(p);l[u]=d===i?p:d}return $!==i&&l.push($),o.$Native(s.apply(t,l))}return o.$Native(s)},_.$$arity=-3),e.defs(y,"$proc",f=function(){var t,r=f.$$p,n=r||i,a=this;return r&&(f.$$p=null),r&&(f.$$p=null),l(n)||a.$raise(o(m,"LocalJumpError"),"no block given"),u($("::","Kernel"),"proc",[],((t=function(){var r,a,$,o=t.$$s||this,s=i;if(r=e.slice.call(arguments,0,arguments.length),u(a=r,"map!",[],(($=function(e){var t=$.$$s||this;return null==e&&(e=i),t.$Native(e)}).$$s=o,$.$$arity=1,$)),s=o.$Native(this),this===e.global)return n.apply(o,a);var l=n.$$s;n.$$s=null;try{return n.apply(s,a)}finally{n.$$s=l}}).$$s=a,t.$$arity=-1,t))},f.$$arity=0),function(t,r){var n,a,$,d,_=s(t,"Helpers"),f=[_].concat(r);e.def(_,"$alias_native",n=function(t){var r,a,$,s,d,_,h,y=n.$$p,m=this;if(y&&(n.$$p=null),r=e.slice.call(arguments,1,arguments.length),null==(a=e.extract_kwargs(r)))a=c([],{});else if(!a.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return r.length>0&&($=r[0],r.splice(0,1)),null==$&&($=t),null==(s=a.$$smap.as)&&(s=i),l($["$end_with?"]("="))?u(m,"define_method",[t],((d=function(e){var t=d.$$s||this;return null==t.native&&(t.native=i),null==e&&(e=i),t.native[$["$[]"](p(0,-2,!1))]=o(f,"Native").$convert(e),e}).$$s=m,d.$$arity=1,d)):l(s)?u(m,"define_method",[t],((_=function(){var t,r=_.$$s||this,n=_.$$p,a=n||i,c=i;return null==r.native&&(r.native=i),n&&(_.$$p=null),t=e.slice.call(arguments,0,arguments.length),c=u(o(f,"Native"),"call",[r.native,$].concat(e.to_a(t)),a.$to_proc()),l(c)?s.$new(c.$to_n()):i}).$$s=m,_.$$arity=-1,_)):u(m,"define_method",[t],((h=function(){var t,r=h.$$s||this,n=h.$$p,a=n||i;return null==r.native&&(r.native=i),n&&(h.$$p=null),t=e.slice.call(arguments,0,arguments.length),u(o(f,"Native"),"call",[r.native,$].concat(e.to_a(t)),a.$to_proc())}).$$s=m,h.$$arity=-1,h))},n.$$arity=-2),e.def(_,"$native_reader",a=function(){var t,r,n=this;return t=e.slice.call(arguments,0,arguments.length),u(t,"each",[],((r=function(e){var t,n=r.$$s||this;return null==e&&(e=i),u(n,"define_method",[e],((t=function(){var r=t.$$s||this;return null==r.native&&(r.native=i),r.$Native(r.native[e])}).$$s=n,t.$$arity=0,t))}).$$s=n,r.$$arity=1,r))},a.$$arity=-1),e.def(_,"$native_writer",$=function(){var t,r,n=this;return t=e.slice.call(arguments,0,arguments.length),u(t,"each",[],((r=function(e){var t,n=r.$$s||this;return null==e&&(e=i),u(n,"define_method",[e+"="],((t=function(r){var n=t.$$s||this;return null==n.native&&(n.native=i),null==r&&(r=i),n.$Native(n.native[e]=r)}).$$s=n,t.$$arity=1,t))}).$$s=n,r.$$arity=1,r))},$.$$arity=-1),e.def(_,"$native_accessor",d=function(){var t,r=this;return t=e.slice.call(arguments,0,arguments.length),u(r,"native_reader",e.to_a(t)),u(r,"native_writer",e.to_a(t))},d.$$arity=-1)}(m[0],m),function(t,r){var n,a,u,c=s(t,"Wrapper"),p=[c].concat(r);e.def(c,"$initialize",n=function(e){var t=this;return l($("::","Kernel")["$native?"](e))||$("::","Kernel").$raise(o(p,"ArgumentError"),e.$inspect()+" isn't native"),t.native=e},n.$$arity=1),e.def(c,"$to_n",a=function(){var e=this;return null==e.native&&(e.native=i),e.native},a.$$arity=0),e.defs(c,"$included",u=function(e){return e.$extend(o(p,"Helpers"))},u.$$arity=1)}(m[0],m),e.defs(y,"$included",h=function(e){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),e.$include(o(m,"Wrapper"))},h.$$arity=1)}(a[0],a),function(t,r){var n,a,c,p=s(t,"Kernel"),d=[p].concat(r);e.def(p,"$native?",n=function(e){return null==e||!e.$$class},n.$$arity=1),e.def(p,"$Native",a=function(t){var r,n,s=a.$$p,c=this;return s&&(a.$$p=null),l(null==t)?i:l(c["$native?"](t))?$(o(d,"Native"),"Object").$new(t):l(t["$is_a?"](o(d,"Array")))?u(t,"map",[],((r=function(e){var t=r.$$s||this;return null==e&&(e=i),t.$Native(e)}).$$s=c,r.$$arity=1,r)):l(t["$is_a?"](o(d,"Proc")))?u(c,"proc",[],((n=function(){var r,a=n.$$s||this,$=n.$$p,o=$||i;return $&&(n.$$p=null),r=e.slice.call(arguments,0,arguments.length),a.$Native(u(t,"call",e.to_a(r),o.$to_proc()))}).$$s=c,n.$$arity=-1,n)):t},a.$$arity=1),e.alias(p,"_Array","Array"),e.def(p,"$Array",c=function(t){var r,n=c.$$p,a=n||i,s=this;return n&&(c.$$p=null),n&&(c.$$p=null),r=e.slice.call(arguments,1,arguments.length),l(s["$native?"](t))?u($(o(d,"Native"),"Array"),"new",[t].concat(e.to_a(r)),a.$to_proc()).$to_a():s.$_Array(t)},c.$$arity=-2)}(a[0],a),function(r,$super,n){var a,o,s,p,_,f,h,y,m,g,b,v,w,k,x,E=d(r,$super,"Object");[E].concat(n);E.$$prototype.native=i,E.$include($($("::","Native"),"Wrapper")),e.def(E,"$==",a=function(e){return this.native===$("::","Native").$try_convert(e)},a.$$arity=1),e.def(E,"$has_key?",o=function(t){var r=this;return e.hasOwnProperty.call(r.native,t)},o.$$arity=1),e.alias(E,"key?","has_key?"),e.alias(E,"include?","has_key?"),e.alias(E,"member?","has_key?"),e.def(E,"$each",s=function(){var t,r=s.$$p,n=r||i,a=this;if(r&&(s.$$p=null),t=e.slice.call(arguments,0,arguments.length),n!==i){for(var $ in a.native)e.yieldX(n,[$,a.native[$]]);return a}return u(a,"method_missing",["each"].concat(e.to_a(t)))},s.$$arity=-1),e.def(E,"$[]",p=function(e){var t=this,r=t.native[e];return r instanceof Function?r:$("::","Native").$call(t.native,e)},p.$$arity=1),e.def(E,"$[]=",_=function(e,t){var r=this,n=i;return n=$("::","Native").$try_convert(t),l(n===i)?r.native[e]=t:r.native[e]=n},_.$$arity=2),e.def(E,"$merge!",f=function(e){var t=this;for(var r in e=$("::","Native").$convert(e))t.native[r]=e[r];return t},f.$$arity=1),e.def(E,"$respond_to?",h=function(e,t){var r=this;return null==t&&(t=!1),$("::","Kernel").$instance_method("respond_to?").$bind(r).$call(e,t)},h.$$arity=-2),e.def(E,"$respond_to_missing?",y=function(t,r){var n=this;return null==r&&(r=!1),e.hasOwnProperty.call(n.native,t)},y.$$arity=-2),e.def(E,"$method_missing",m=function(r){var n,a=m.$$p,o=a||i,s=this,l=i;return a&&(m.$$p=null),a&&(m.$$p=null),n=e.slice.call(arguments,1,arguments.length),"="===r.charAt(r.length-1)?(l=[r.$slice(0,t(r.$length(),1)),n["$[]"](0)],u(s,"[]=",e.to_a(l)),l[t(l.length,1)]):u($("::","Native"),"call",[s.native,r].concat(e.to_a(n)),o.$to_proc())},m.$$arity=-2),e.def(E,"$nil?",g=function(){return!1},g.$$arity=0),e.def(E,"$is_a?",b=function(t){var r=this;return e.is_a(r,t)},b.$$arity=1),e.alias(E,"kind_of?","is_a?"),e.def(E,"$instance_of?",v=function(e){return this.$$class===e},v.$$arity=1),e.def(E,"$class",w=function(){return this.$$class},w.$$arity=0),e.def(E,"$to_a",k=function(e){var t=k.$$p,r=t||i,n=this;return t&&(k.$$p=null),t&&(k.$$p=null),null==e&&(e=c([],{})),u($($("::","Native"),"Array"),"new",[n.native,e],r.$to_proc()).$to_a()},k.$$arity=-1),e.def(E,"$inspect",x=function(){return"#<Native:"+String(this.native)+">"},x.$$arity=0)}(o(a,"Native"),o(a,"BasicObject"),a),function(n,$super,a){var s,p,_,f,h,y,m,g=d(n,null,"Array"),b=[g].concat(a);g.$$prototype.named=g.$$prototype.native=g.$$prototype.get=g.$$prototype.block=g.$$prototype.set=g.$$prototype.length=i,g.$include($(o(b,"Native"),"Wrapper")),g.$include(o(b,"Enumerable")),e.def(g,"$initialize",s=function(t,r){var n,a=s.$$p,$=a||i,p=this;return a&&(s.$$p=null),a&&(s.$$p=null),null==r&&(r=c([],{})),u(p,e.find_super_dispatcher(p,"initialize",s,!1),[t],null),p.get=l(n=r["$[]"]("get"))?n:r["$[]"]("access"),p.named=r["$[]"]("named"),p.set=l(n=r["$[]"]("set"))?n:r["$[]"]("access"),p.length=l(n=r["$[]"]("length"))?n:"length",p.block=$,l(null==p.$length())?p.$raise(o(b,"ArgumentError"),"no length found on the array-like object"):i},s.$$arity=-2),e.def(g,"$each",p=function(){var t=p.$$p,r=t||i,n=this;if(t&&(p.$$p=null),t&&(p.$$p=null),!l(r))return n.$enum_for("each");for(var a=0,$=n.$length();a<$;a++)e.yield1(r,n["$[]"](a));return n},p.$$arity=0),e.def(g,"$[]",_=function(e){var t=this,r=i,n=i;return n=e,r=o(b,"String")["$==="](n)||o(b,"Symbol")["$==="](n)?l(t.named)?t.native[t.named](e):t.native[e]:o(b,"Integer")["$==="](n)?l(t.get)?t.native[t.get](e):t.native[e]:i,l(r)?l(t.block)?t.block.$call(r):t.$Native(r):i},_.$$arity=1),e.def(g,"$[]=",f=function(e,t){var r=this;return l(r.set)?r.native[r.set](e,o(b,"Native").$convert(t)):r.native[e]=o(b,"Native").$convert(t)},f.$$arity=2),e.def(g,"$last",h=function(e){var n=this,a=i,$=i;if(null==e&&(e=i),l(e)){for(a=t(n.$length(),1),$=[];l(r(a,0));)$["$<<"](n["$[]"](a)),a=t(a,1);return $}return n["$[]"](t(n.$length(),1))},h.$$arity=-1),e.def(g,"$length",y=function(){var e=this;return e.native[e.length]},y.$$arity=0),e.alias(g,"to_ary","to_a"),e.def(g,"$inspect",m=function(){return this.$to_a().$inspect()},m.$$arity=0)}(o(a,"Native"),0,a),function(t,$super,r){var n,a=d(t,null,"Numeric");[a].concat(r);e.def(a,"$to_n",n=function(){return this.valueOf()},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"Proc");[a].concat(r);e.def(a,"$to_n",n=function(){return this},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"String");[a].concat(r);e.def(a,"$to_n",n=function(){return this.valueOf()},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"Regexp");[a].concat(r);e.def(a,"$to_n",n=function(){return this.valueOf()},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"MatchData");[a].concat(r);a.$$prototype.matches=i,e.def(a,"$to_n",n=function(){return this.matches},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"Struct"),$=[a].concat(r);e.def(a,"$to_n",n=function(){var e,t=this,r=i;return r={},u(t,"each_pair",[],((e=function(t,n){e.$$s;return null==t&&(t=i),null==n&&(n=i),r[t]=o($,"Native").$try_convert(n,n)}).$$s=t,e.$$arity=2,e)),r},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"Array"),i=[a].concat(r);e.def(a,"$to_n",n=function(){for(var e=this,t=[],r=0,n=e.length;r<n;r++){var a=e[r];t.push(o(i,"Native").$try_convert(a,a))}return t},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"Boolean");[a].concat(r);e.def(a,"$to_n",n=function(){return this.valueOf()},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"Time");[a].concat(r);e.def(a,"$to_n",n=function(){return this},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"NilClass");[a].concat(r);e.def(a,"$to_n",n=function(){return null},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a,$=d(t,null,"Hash"),s=[$].concat(r);e.alias($,"_initialize","initialize"),e.def($,"$initialize",n=function(e){var t=n.$$p,r=t||i,a=this;if(t&&(n.$$p=null),t&&(n.$$p=null),null!=e&&(e.constructor===undefined||e.constructor===Object)){var $,l,c=a.$$smap,p=a.$$keys;for($ in e)!(l=e[$])||l.constructor!==undefined&&l.constructor!==Object?l&&l.$$is_array?(l=l.map(function(e){return!e||e.constructor!==undefined&&e.constructor!==Object?a.$Native(e):o(s,"Hash").$new(e)}),c[$]=l):c[$]=a.$Native(l):c[$]=o(s,"Hash").$new(l),p.push($);return a}return u(a,"_initialize",[e],r.$to_proc())},n.$$arity=-1),e.def($,"$to_n",a=function(){for(var e,t,r=this,n={},a=r.$$keys,i=r.$$smap,$=0,l=a.length;$<l;$++)t=(e=a[$]).$$is_string?i[e]:(e=e.key).value,n[e]=o(s,"Native").$try_convert(t,t);return n},a.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a=d(t,null,"Module");[a].concat(r);e.def(a,"$native_module",n=function(){var t=this;return e.global[t.$name()]=t},n.$$arity=0)}(a[0],0,a),function(t,$super,r){var n,a,i=d(t,null,"Class"),$=[i].concat(r);e.def(i,"$native_alias",n=function(e,t){var r=this,n=r.prototype["$"+t];n||r.$raise(o($,"NameError").$new("undefined method `"+t+"' for class `"+r.$inspect()+"'",t)),r.prototype[e]=n},n.$$arity=2),e.def(i,"$native_class",a=function(){var e=this;return e.$native_module(),e["new"]=e.$new},a.$$arity=0)}(a[0],0,a),_.$=_.global=n.$Native(e.global)},Opal.modules.json=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.send,l=e.hash2,u=e.truthy;return e.add_stubs(["$raise","$new","$push","$[]=","$-","$[]","$create_id","$json_create","$const_get","$attr_accessor","$create_id=","$===","$parse","$generate","$from_object","$merge","$to_json","$responds_to?","$to_io","$write","$to_s","$to_a","$strftime"]),function(r,c){function p(e){try{return JSON.parse(e)}catch(t){v.$raise(a(i(w,"JSON"),"ParserError"),t.message)}}function d(r,$){var o,l,u,c,p,_;switch(typeof r){case"string":case"number":return r;case"boolean":return!!r;case"null":return n;case"object":if(!r)return n;if(r.$$is_array){for(l=$.array_class.$new(),c=0,p=r.length;c<p;c++)l.$push(d(r[c],$));return l}for(_ in u=$.object_class.$new(),r)x.call(r,_)&&(k=[_,d(r[_],$)],s(u,"[]=",e.to_a(k)),k[t(k.length,1)]);return $.parse||(o=u["$[]"](i(w,"JSON").$create_id()))==n?u:a("::","Object").$const_get(o).$json_create(u)}}var _,f,h,y,m,g,b,v=$(r,"JSON"),w=[v].concat(c),k=n;!function(e,$super,t){[o(e,$super,"JSONError")].concat(t)}(w[0],i(w,"StandardError"),w),function(e,$super,t){[o(e,$super,"ParserError")].concat(t)}(w[0],i(w,"JSONError"),w);var x=e.hasOwnProperty;!function(e,t){[e].concat(t);e.$attr_accessor("create_id")}(e.get_singleton_class(v),w),k=["json_class"],s(v,"create_id=",e.to_a(k)),k[t(k.length,1)],e.defs(v,"$[]",_=function(e,t){var r=this;return null==t&&(t=l([],{})),u(i(w,"String")["$==="](e))?r.$parse(e,t):r.$generate(e,t)},_.$$arity=-2),e.defs(v,"$parse",f=function(e,t){var r=this;return null==t&&(t=l([],{})),r.$from_object(p(e),t.$merge(l(["parse"],{parse:!0})))},f.$$arity=-2),e.defs(v,"$parse!",h=function(e,t){var r=this;return null==t&&(t=l([],{})),r.$parse(e,t)},h.$$arity=-2),e.defs(v,"$load",y=function(e,t){var r=this;return null==t&&(t=l([],{})),r.$from_object(p(e),t)},y.$$arity=-2),e.defs(v,"$from_object",m=function(r,a){var $=n;return null==a&&(a=l([],{})),u(a["$[]"]("object_class"))||($=["object_class",i(w,"Hash")],s(a,"[]=",e.to_a($)),$[t($.length,1)]),u(a["$[]"]("array_class"))||($=["array_class",i(w,"Array")],s(a,"[]=",e.to_a($)),$[t($.length,1)]),d(r,a.$$smap)},m.$$arity=-2),e.defs(v,"$generate",g=function(e,t){return null==t&&(t=l([],{})),e.$to_json(t)},g.$$arity=-2),e.defs(v,"$dump",b=function(e,t,r){var a=n;return null==t&&(t=n),null==r&&(r=n),a=this.$generate(e),u(t)?(u(t["$responds_to?"]("to_io"))&&(t=t.$to_io()),t.$write(a),t):a},b.$$arity=-2)}(r[0],r),function(t,$super,r){var n,a=o(t,null,"Object");[a].concat(r);e.def(a,"$to_json",n=function(){return this.$to_s().$to_json()},n.$$arity=0)}(r[0],0,r),function(t,r){var n,a=$(t,"Enumerable");[a].concat(r);e.def(a,"$to_json",n=function(){return this.$to_a().$to_json()},n.$$arity=0)}(r[0],r),function(t,$super,r){var n,a=o(t,null,"Array");[a].concat(r);e.def(a,"$to_json",n=function(){for(var e=this,t=[],r=0,n=e.length;r<n;r++)t.push(e[r].$to_json());return"["+t.join(", ")+"]"},n.$$arity=0)}(r[0],0,r),function(t,$super,r){var n,a=o(t,null,"Boolean");[a].concat(r);e.def(a,"$to_json",n=function(){return 1==this?"true":"false"},n.$$arity=0)}(r[0],0,r),function(t,$super,r){var n,a=o(t,null,"Hash");[a].concat(r);e.def(a,"$to_json",n=function(){for(var e,t,r=this,n=[],a=0,i=r.$$keys,$=i.length;a<$;a++)(e=i[a]).$$is_string?t=r.$$smap[e]:(t=e.value,e=e.key),n.push(e.$to_s().$to_json()+":"+t.$to_json());return"{"+n.join(", ")+"}"},n.$$arity=0)}(r[0],0,r),function(t,$super,r){var n,a=o(t,null,"NilClass");[a].concat(r);e.def(a,"$to_json",n=function(){return"null"},n.$$arity=0)}(r[0],0,r),function(t,$super,r){var n,a=o(t,null,"Numeric");[a].concat(r);e.def(a,"$to_json",n=function(){return this.toString()},n.$$arity=0)}(r[0],0,r),function(t,$super,r){var n=o(t,null,"String");[n].concat(r);e.alias(n,"to_json","inspect")}(r[0],0,r),function(t,$super,r){var n,a=o(t,null,"Time");[a].concat(r);e.def(a,"$to_json",n=function(){return this.$strftime("%FT%T%z").$to_json()},n.$$arity=0)}(r[0],0,r),function(t,$super,r){var a,i,$=o(t,null,"Date");[$].concat(r);return e.def($,"$to_json",a=function(){return this.$to_s().$to_json()},a.$$arity=0),e.def($,"$as_json",i=function(){return this.$to_s()},i.$$arity=0),n&&"as_json"}(r[0],0,r)},function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).snabbdom=e()}}(function(){return function e(t,r,n){function a($,o){if(!r[$]){if(!t[$]){var s="function"==typeof require&&require;if(!o&&s)return s($,!0);if(i)return i($,!0);var l=new Error("Cannot find module '"+$+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[$]={exports:{}};t[$][0].call(u.exports,function(e){var r=t[$][1][e];return a(r||e)},u,u.exports,e,t,r,n)}return r[$].exports}for(var i="function"==typeof require&&require,$=0;$<n.length;$++)a(n[$]);return a}({1:[function(e,t,r){"use strict";function n(e,t,r){if(e.ns="http://www.w3.org/2000/svg","foreignObject"!==r&&t!==undefined)for(var a=0;a<t.length;++a){var i=t[a].data;i!==undefined&&n(i,t[a].children,t[a].sel)}}function a(e,t,r){var a,o,s,l={};if(r!==undefined?(l=t,$.array(r)?a=r:$.primitive(r)?o=r:r&&r.sel&&(a=[r])):t!==undefined&&($.array(t)?a=t:$.primitive(t)?o=t:t&&t.sel?a=[t]:l=t),$.array(a))for(s=0;s<a.length;++s)$.primitive(a[s])&&(a[s]=i.vnode(undefined,undefined,undefined,a[s]));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||n(l,a,e),i.vnode(e,l,a,o,undefined)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./vnode"),$=e("./is");r.h=a,r["default"]=a},{"./is":3,"./vnode":6}],2:[function(e,t,r){"use strict";function n(e){return document.createElement(e)}function a(e,t){return document.createElementNS(e,t)}function i(e){return document.createTextNode(e)}function $(e){return document.createComment(e)}function o(e,t,r){e.insertBefore(t,r)}function s(e,t){e.removeChild(t)}function l(e,t){e.appendChild(t)}function u(e){return e.parentNode}function c(e){return e.nextSibling}function p(e){return e.tagName}function d(e,t){e.textContent=t}function _(e){return e.textContent}function f(e){return 1===e.nodeType}function h(e){return 3===e.nodeType}function y(e){return 8===e.nodeType}Object.defineProperty(r,"__esModule",{value:!0}),r.htmlDomApi={createElement:n,createElementNS:a,createTextNode:i,createComment:$,insertBefore:o,removeChild:s,appendChild:l,parentNode:u,nextSibling:c,tagName:p,setTextContent:d,getTextContent:_,isElement:f,isText:h,isComment:y},r["default"]=r.htmlDomApi},{}],3:[function(e,t,r){"use strict";function n(e){return"string"==typeof e||"number"==typeof e}Object.defineProperty(r,"__esModule",{value:!0}),r.array=Array.isArray,r.primitive=n},{}],4:[function(e,t,r){"use strict";function n(e){return e===undefined}function a(e){return e!==undefined}function i(e,t){return e.key===t.key&&e.sel===t.sel}function $(e){return e.sel!==undefined}function o(e,t,r){var n,a,i,$={};for(n=t;n<=r;++n)null!=(i=e[n])&&(a=i.key)!==undefined&&($[a]=n);return $}function s(e,t){function r(e){var t=e.id?"#"+e.id:"",r=e.className?"."+e.className.split(" ").join("."):"";return l["default"](k.tagName(e).toLowerCase()+t+r,{},[],undefined,e)}function s(e,t){return function(){if(0==--t){var r=k.parentNode(e);k.removeChild(r,e)}}}function _(e,t){var r,i=e.data;i!==undefined&&a(r=i.hook)&&a(r=r.init)&&(r(e),i=e.data);var $=e.children,o=e.sel;if("!"===o)n(e.text)&&(e.text=""),e.elm=k.createComment(e.text);else if(o!==undefined){var s=o.indexOf("#"),l=o.indexOf(".",s),c=s>0?s:o.length,d=l>0?l:o.length,f=-1!==s||-1!==l?o.slice(0,Math.min(c,d)):o,h=e.elm=a(i)&&a(r=i.ns)?k.createElementNS(r,f):k.createElement(f);for(c<d&&h.setAttribute("id",o.slice(c+1,d)),l>0&&h.setAttribute("class",o.slice(d+1).replace(/\./g," ")),r=0;r<w.create.length;++r)w.create[r](p,e);if(u.array($))for(r=0;r<$.length;++r){var y=$[r];null!=y&&k.appendChild(h,_(y,t))}else u.primitive(e.text)&&k.appendChild(h,k.createTextNode(e.text));a(r=e.data.hook)&&(r.create&&r.create(p,e),r.insert&&t.push(e))}else e.elm=k.createTextNode(e.text);return e.elm}function f(e,t,r,n,a,i){for(;n<=a;++n){var $=r[n];null!=$&&k.insertBefore(e,_($,i),t)}}function h(e){var t,r,n=e.data;if(n!==undefined){for(a(t=n.hook)&&a(t=t.destroy)&&t(e),t=0;t<w.destroy.length;++t)w.destroy[t](e);if(e.children!==undefined)for(r=0;r<e.children.length;++r)null!=(t=e.children[r])&&"string"!=typeof t&&h(t)}}function y(e,t,r,n){for(;r<=n;++r){var i=void 0,$=void 0,o=void 0,l=t[r];if(null!=l)if(a(l.sel)){for(h(l),$=w.remove.length+1,o=s(l.elm,$),i=0;i<w.remove.length;++i)w.remove[i](l,o);a(i=l.data)&&a(i=i.hook)&&a(i=i.remove)?i(l,o):o()}else k.removeChild(e,l.elm)}}function m(e,t,r,a){for(var $,s,l,u=0,c=0,p=t.length-1,d=t[0],h=t[p],m=r.length-1,b=r[0],v=r[m];u<=p&&c<=m;)null==d?d=t[++u]:null==h?h=t[--p]:null==b?b=r[++c]:null==v?v=r[--m]:i(d,b)?(g(d,b,a),d=t[++u],b=r[++c]):i(h,v)?(g(h,v,a),h=t[--p],v=r[--m]):i(d,v)?(g(d,v,a),k.insertBefore(e,d.elm,k.nextSibling(h.elm)),d=t[++u],v=r[--m]):i(h,b)?(g(h,b,a),k.insertBefore(e,h.elm,d.elm),h=t[--p],b=r[++c]):($===undefined&&($=o(t,u,p)),n(s=$[b.key])?(k.insertBefore(e,_(b,a),d.elm),b=r[++c]):((l=t[s]).sel!==b.sel?k.insertBefore(e,_(b,a),d.elm):(g(l,b,a),t[s]=undefined,k.insertBefore(e,l.elm,d.elm)),b=r[++c]));u>p?f(e,null==r[m+1]?null:r[m+1].elm,r,c,m,a):c>m&&y(e,t,u,p)}function g(e,t,r){var i,$;a(i=t.data)&&a($=i.hook)&&a(i=$.prepatch)&&i(e,t);var o=t.elm=e.elm,s=e.children,l=t.children;if(e!==t){if(t.data!==undefined){for(i=0;i<w.update.length;++i)w.update[i](e,t);a(i=t.data.hook)&&a(i=i.update)&&i(e,t)}n(t.text)?a(s)&&a(l)?s!==l&&m(o,s,l,r):a(l)?(a(e.text)&&k.setTextContent(o,""),f(o,null,l,0,l.length-1,r)):a(s)?y(o,s,0,s.length-1):a(e.text)&&k.setTextContent(o,""):e.text!==t.text&&k.setTextContent(o,t.text),a($)&&a(i=$.postpatch)&&i(e,t)}}var b,v,w={},k=t!==undefined?t:c["default"];for(b=0;b<d.length;++b)for(w[d[b]]=[],v=0;v<e.length;++v){var x=e[v][d[b]];x!==undefined&&w[d[b]].push(x)}return function(e,t){var n,a,o,s=[];for(n=0;n<w.pre.length;++n)w.pre[n]();for($(e)||(e=r(e)),i(e,t)?g(e,t,s):(a=e.elm,o=k.parentNode(a),_(t,s),null!==o&&(k.insertBefore(o,t.elm,k.nextSibling(a)),y(o,[e],0,0))),n=0;n<s.length;++n)s[n].data.hook.insert(s[n]);for(n=0;n<w.post.length;++n)w.post[n]();return t}}Object.defineProperty(r,"__esModule",{value:!0});var l=e("./vnode"),u=e("./is"),c=e("./htmldomapi"),p=l["default"]("",{},[],undefined,undefined),d=["create","update","remove","destroy","pre","post"],_=e("./h");r.h=_.h;var f=e("./thunk");r.thunk=f.thunk,r.init=s},{"./h":1,"./htmldomapi":2,"./is":3,"./thunk":5,"./vnode":6}],5:[function(e,t,r){"use strict"
;function n(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}function a(e){var t=e.data;n(t.fn.apply(undefined,t.args),e)}function i(e,t){var r,a=e.data,i=t.data,$=a.args,o=i.args;if(a.fn===i.fn&&$.length===o.length){for(r=0;r<o.length;++r)if($[r]!==o[r])return void n(i.fn.apply(undefined,o),t);n(e,t)}else n(i.fn.apply(undefined,o),t)}Object.defineProperty(r,"__esModule",{value:!0});var $=e("./h");r.thunk=function(e,t,r,n){return n===undefined&&(n=r,r=t,t=undefined),$.h(e,{key:t,hook:{init:a,prepatch:i},fn:r,args:n})},r["default"]=r.thunk},{"./h":1}],6:[function(e,t,r){"use strict";function n(e,t,r,n,a){return{sel:e,data:t,children:r,text:n,elm:a,key:t===undefined?undefined:t.key}}Object.defineProperty(r,"__esModule",{value:!0}),r.vnode=n,r["default"]=n},{}]},{},[4])(4)}),Opal.loaded(["vendor/snabbdom.js"]),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).snabbdom_attributes=e()}}(function(){return function e(t,r,n){function a($,o){if(!r[$]){if(!t[$]){var s="function"==typeof require&&require;if(!o&&s)return s($,!0);if(i)return i($,!0);var l=new Error("Cannot find module '"+$+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[$]={exports:{}};t[$][0].call(u.exports,function(e){var r=t[$][1][e];return a(r||e)},u,u.exports,e,t,r,n)}return r[$].exports}for(var i="function"==typeof require&&require,$=0;$<n.length;$++)a(n[$]);return a}({1:[function(e,t,r){"use strict";function n(e,t){var r,n=t.elm,a=e.data.attrs,u=t.data.attrs;if((a||u)&&a!==u){for(r in a=a||{},u=u||{}){var c=u[r];a[r]!==c&&(l[r]?c?n.setAttribute(r,""):n.removeAttribute(r):r.charCodeAt(0)!==s?n.setAttribute(r,c):r.charCodeAt(3)===o?n.setAttributeNS($,r,c):r.charCodeAt(5)===o?n.setAttributeNS(i,r,c):n.setAttribute(r,c))}for(r in a)r in u||n.removeAttribute(r)}}Object.defineProperty(r,"__esModule",{value:!0});for(var a=["allowfullscreen","async","autofocus","autoplay","checked","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","defer","disabled","draggable","enabled","formnovalidate","hidden","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","selected","sortable","spellcheck","translate","truespeed","typemustmatch","visible"],i="http://www.w3.org/1999/xlink",$="http://www.w3.org/XML/1998/namespace",o=58,s=120,l=Object.create(null),u=0,c=a.length;u<c;u++)l[a[u]]=!0;r.attributesModule={create:n,update:n},r["default"]=r.attributesModule},{}]},{},[1])(1)}),Opal.loaded(["vendor/snabbdom-attributes.js"]),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).snabbdom_class=e()}}(function(){return function e(t,r,n){function a($,o){if(!r[$]){if(!t[$]){var s="function"==typeof require&&require;if(!o&&s)return s($,!0);if(i)return i($,!0);var l=new Error("Cannot find module '"+$+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[$]={exports:{}};t[$][0].call(u.exports,function(e){var r=t[$][1][e];return a(r||e)},u,u.exports,e,t,r,n)}return r[$].exports}for(var i="function"==typeof require&&require,$=0;$<n.length;$++)a(n[$]);return a}({1:[function(e,t,r){"use strict";function n(e,t){var r,n,a=t.elm,i=e.data["class"],$=t.data["class"];if((i||$)&&i!==$){for(n in $=$||{},i=i||{})$[n]||a.classList.remove(n);for(n in $)(r=$[n])!==i[n]&&a.classList[r?"add":"remove"](n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.classModule={create:n,update:n},r["default"]=r.classModule},{}]},{},[1])(1)}),Opal.loaded(["vendor/snabbdom-class.js"]),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).snabbdom_eventlisteners=e()}}(function(){return function e(t,r,n){function a($,o){if(!r[$]){if(!t[$]){var s="function"==typeof require&&require;if(!o&&s)return s($,!0);if(i)return i($,!0);var l=new Error("Cannot find module '"+$+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[$]={exports:{}};t[$][0].call(u.exports,function(e){var r=t[$][1][e];return a(r||e)},u,u.exports,e,t,r,n)}return r[$].exports}for(var i="function"==typeof require&&require,$=0;$<n.length;$++)a(n[$]);return a}({1:[function(e,t,r){"use strict";function n(e,t,r){if("function"==typeof e)e.call(t,r,t);else if("object"==typeof e)if("function"==typeof e[0])if(2===e.length)e[0].call(t,e[1],r,t);else{var a=e.slice(1);a.push(r),a.push(t),e[0].apply(t,a)}else for(var i=0;i<e.length;i++)n(e[i])}function a(e,t){var r=e.type,a=t.data.on;a&&a[r]&&n(a[r],t,e)}function i(){return function e(t){a(t,e.vnode)}}function $(e,t){var r,n=e.data.on,a=e.listener,$=e.elm,o=t&&t.data.on,s=t&&t.elm;if(n!==o){if(n&&a)if(o)for(r in n)o[r]||$.removeEventListener(r,a,!1);else for(r in n)$.removeEventListener(r,a,!1);if(o){var l=t.listener=e.listener||i();if(l.vnode=t,n)for(r in o)n[r]||s.addEventListener(r,l,!1);else for(r in o)s.addEventListener(r,l,!1)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.eventListenersModule={create:$,update:$,destroy:$},r["default"]=r.eventListenersModule},{}]},{},[1])(1)}),Opal.loaded(["vendor/snabbdom-eventlisteners.js"]),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).snabbdom_props=e()}}(function(){return function e(t,r,n){function a($,o){if(!r[$]){if(!t[$]){var s="function"==typeof require&&require;if(!o&&s)return s($,!0);if(i)return i($,!0);var l=new Error("Cannot find module '"+$+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[$]={exports:{}};t[$][0].call(u.exports,function(e){var r=t[$][1][e];return a(r||e)},u,u.exports,e,t,r,n)}return r[$].exports}for(var i="function"==typeof require&&require,$=0;$<n.length;$++)a(n[$]);return a}({1:[function(e,t,r){"use strict";function n(e,t){var r,n,a=t.elm,i=e.data.props,$=t.data.props;if((i||$)&&i!==$){for(r in $=$||{},i=i||{})$[r]||delete a[r];for(r in $)n=$[r],i[r]===n||"value"===r&&a[r]===n||(a[r]=n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.propsModule={create:n,update:n},r["default"]=r.propsModule},{}]},{},[1])(1)}),Opal.loaded(["vendor/snabbdom-props.js"]),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).snabbdom_style=e()}}(function(){return function e(t,r,n){function a($,o){if(!r[$]){if(!t[$]){var s="function"==typeof require&&require;if(!o&&s)return s($,!0);if(i)return i($,!0);var l=new Error("Cannot find module '"+$+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[$]={exports:{}};t[$][0].call(u.exports,function(e){var r=t[$][1][e];return a(r||e)},u,u.exports,e,t,r,n)}return r[$].exports}for(var i="function"==typeof require&&require,$=0;$<n.length;$++)a(n[$]);return a}({1:[function(e,t,r){"use strict";function n(e,t,r){s(function(){e[t]=r})}function a(e,t){var r,a,i=t.elm,$=e.data.style,o=t.data.style;if(($||o)&&$!==o){o=o||{};var s="delayed"in($=$||{});for(a in $)o[a]||("-"===a[0]&&"-"===a[1]?i.style.removeProperty(a):i.style[a]="");for(a in o)if(r=o[a],"delayed"===a&&o.delayed)for(var l in o.delayed)r=o.delayed[l],s&&r===$.delayed[l]||n(i.style,l,r);else"remove"!==a&&r!==$[a]&&("-"===a[0]&&"-"===a[1]?i.style.setProperty(a,r):i.style[a]=r)}}function i(e){var t,r,n=e.elm,a=e.data.style;if(a&&(t=a.destroy))for(r in t)n.style[r]=t[r]}function $(e,t){var r=e.data.style;if(r&&r.remove){var n,a=e.elm,i=0,$=r.remove,o=0,s=[];for(n in $)s.push(n),a.style[n]=$[n];for(var l=getComputedStyle(a)["transition-property"].split(", ");i<l.length;++i)-1!==s.indexOf(l[i])&&o++;a.addEventListener("transitionend",function(e){e.target===a&&--o,0===o&&t()})}else t()}Object.defineProperty(r,"__esModule",{value:!0});var o="undefined"!=typeof window&&window.requestAnimationFrame||setTimeout,s=function(e){o(function(){o(e)})};r.styleModule={create:a,update:a,destroy:i,remove:$},r["default"]=r.styleModule},{}]},{},[1])(1)}),Opal.loaded(["vendor/snabbdom-style.js"]),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).toHTML=e()}}(function(){return function(){function e(t,r,n){function a($,o){if(!r[$]){if(!t[$]){var s="function"==typeof require&&require;if(!o&&s)return s($,!0);if(i)return i($,!0);var l=new Error("Cannot find module '"+$+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[$]={exports:{}};t[$][0].call(u.exports,function(e){return a(t[$][1][e]||e)},u,u.exports,e,t,r,n)}return r[$].exports}for(var i="function"==typeof require&&require,$=0;$<n.length;$++)a(n[$]);return a}return e}()({1:[function(e,t){var r,n,a;
/*!
 * Cross-Browser Split 1.1.1
 * Copyright 2007-2012 Steven Levithan <stevenlevithan.com>
 * Available under the MIT License
 * ECMAScript compliant, uniform cross-browser split method
 */
t.exports=(n=String.prototype.split,a=/()??/.exec("")[1]===r,function(e,t,i){if("[object RegExp]"!==Object.prototype.toString.call(t))return n.call(e,t,i);var $,o,s,l,u=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),p=0;for(t=new RegExp(t.source,c+"g"),e+="",a||($=new RegExp("^"+t.source+"$(?!\\s)",c)),i=i===r?-1>>>0:i>>>0;(o=t.exec(e))&&!((s=o.index+o[0].length)>p&&(u.push(e.slice(p,o.index)),!a&&o.length>1&&o[0].replace($,function(){for(var e=1;e<arguments.length-2;e++)arguments[e]===r&&(o[e]=r)}),o.length>1&&o.index<e.length&&Array.prototype.push.apply(u,o.slice(1)),l=o[0].length,p=s,u.length>=i));)t.lastIndex===o.index&&t.lastIndex++;return p===e.length?!l&&t.test("")||u.push(""):u.push(e.slice(p)),u.length>i?u.slice(0,i):u})},{}],2:[function(e,t){(function(e){function r(e){return function(t){return null==e?undefined:e[t]}}function n(e){if("string"==typeof e)return e;if(i(e))return b?b.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}function a(e){return!!e&&"object"==typeof e}function i(e){return"symbol"==typeof e||a(e)&&y.call(e)==l}function $(e){return null==e?"":n(e)}function o(e){return(e=$(e))&&c.test(e)?e.replace(u,h):e}
/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var s=1/0,l="[object Symbol]",u=/[&<>"'`]/g,c=RegExp(u.source),p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},d="object"==typeof e&&e&&e.Object===Object&&e,_="object"==typeof self&&self&&self.Object===Object&&self,f=d||_||Function("return this")(),h=r(p),y=Object.prototype.toString,m=f.Symbol,g=m?m.prototype:undefined,b=g?g.toString:undefined;t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t){function r(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function n(e,t){return function(r){return e(t(r))}}function a(e,t){var n=R(e)||u(e)?r(e.length,String):[],a=n.length,i=!!a;for(var $ in e)!t&&!O.call(e,$)||i&&("length"==$||s($,a))||n.push($);return n}function i(e,t){return e&&I(e,t,m)}function $(e){if(!l(e))return S(e);var t=[];for(var r in Object(e))O.call(e,r)&&"constructor"!=r&&t.push(r);return t}function o(e){return function(t,r,n){for(var a=-1,i=Object(t),$=n(t),o=$.length;o--;){var s=$[e?o:++a];if(!1===r(i[s],s,i))break}return t}}function s(e,t){return!!(t=null==t?b:t)&&("number"==typeof e||x.test(e))&&e>-1&&e%1==0&&e<t}function l(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||E)}function u(e){return p(e)&&O.call(e,"callee")&&(!T.call(e,"callee")||A.call(e)==v)}function c(e){return null!=e&&_(e.length)&&!d(e)}function p(e){return h(e)&&c(e)}function d(e){var t=f(e)?A.call(e):"";return t==w||t==k}function _(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=b}function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function h(e){return!!e&&"object"==typeof e}function y(e,t){return e&&i(e,"function"==typeof t?t:g)}function m(e){return c(e)?a(e):$(e)}function g(e){return e}
/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var b=9007199254740991,v="[object Arguments]",w="[object Function]",k="[object GeneratorFunction]",x=/^(?:0|[1-9]\d*)$/,E=Object.prototype,O=E.hasOwnProperty,A=E.toString,T=E.propertyIsEnumerable,S=n(Object.keys,Object),I=o(),R=Array.isArray;t.exports=y},{}],4:[function(e,t){(function(e){function r(e,t,r,n){var a=-1,i=e?e.length:0;for(n&&i&&(r=e[++a]);++a<i;)r=t(r,e[a],a,e);return r}function n(e){return e.match(h)||[]}function a(e){return function(t){return null==e?undefined:e[t]}}function i(e){return F.test(e)}function $(e){return e.match(H)||[]}function o(e){if("string"==typeof e)return e;if(u(e))return Q?Q.call(e):"";var t=e+"";return"0"==t&&1/e==-_?"-0":t}function s(e){return function(t){return r(d(p(t).replace(D,"")),e,"")}}function l(e){return!!e&&"object"==typeof e}function u(e){return"symbol"==typeof e||l(e)&&J.call(e)==f}function c(e){return null==e?"":o(e)}function p(e){return(e=c(e))&&e.replace(y,W).replace(G,"")}function d(e,t,r){return e=c(e),(t=r?undefined:t)===undefined?i(e)?$(e):n(e):e.match(t)||[]}
/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var _=1/0,f="[object Symbol]",h=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,y=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,m="\\ud800-\\udfff",g="\\u2700-\\u27bf",b="a-z\\xdf-\\xf6\\xf8-\\xff",v="A-Z\\xc0-\\xd6\\xd8-\\xde",w="\\xac\\xb1\\xd7\\xf7"+"\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf"+"\\u2000-\\u206f"+" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",k="['\u2019]",x="["+w+"]",E="["+"\\u0300-\\u036f\\ufe20-\\ufe23"+"\\u20d0-\\u20f0"+"]",O="\\d+",A="["+g+"]",T="["+b+"]",S="[^"+m+w+O+g+b+v+"]",I="(?:\\ud83c[\\udde6-\\uddff]){2}",R="[\\ud800-\\udbff][\\udc00-\\udfff]",C="["+v+"]",q="(?:"+T+"|"+S+")",M="(?:"+C+"|"+S+")",z="(?:"+k+"(?:d|ll|m|re|s|t|ve))?",N="(?:"+k+"(?:D|LL|M|RE|S|T|VE))?",j="(?:"+E+"|"+"\\ud83c[\\udffb-\\udfff]"+")"+"?",P="["+"\\ufe0e\\ufe0f"+"]?",B=P+j+("(?:"+"\\u200d"+"(?:"+["[^"+m+"]",I,R].join("|")+")"+P+j+")*"),L="(?:"+[A,I,R].join("|")+")"+B,D=RegExp(k,"g"),G=RegExp(E,"g"),H=RegExp([C+"?"+T+"+"+z+"(?="+[x,C,"$"].join("|")+")",M+"+"+N+"(?="+[x,C+q,"$"].join("|")+")",C+"?"+q+"+"+z,C+"+"+N,O,L].join("|"),"g"),F=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,U={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"ss"},K="object"==typeof e&&e&&e.Object===Object&&e,Y="object"==typeof self&&self&&self.Object===Object&&self,V=K||Y||Function("return this")(),W=a(U),J=Object.prototype.toString,X=V.Symbol,Z=X?X.prototype:undefined,Q=Z?Z.toString:undefined,ee=s(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()});t.exports=ee}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,r){(function(e){function n(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}function a(e){return function(t){return null==t?undefined:t[e]}}function i(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function $(e){return function(t){return e(t)}}function o(e,t){return null==e?undefined:e[t]}function s(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(r){}return t}function l(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function u(e,t){return function(r){return e(t(r))}}function c(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}function p(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function d(){this.__data__=tr?tr(null):{}}function _(e){return this.has(e)&&delete this.__data__[e]}function f(e){var t=this.__data__;if(tr){var r=t[e];return r===De?undefined:r}return Gt.call(t,e)?t[e]:undefined}function h(e){var t=this.__data__;return tr?t[e]!==undefined:Gt.call(t,e)}function y(e,t){return this.__data__[e]=tr&&t===undefined?De:t,this}function m(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function g(){this.__data__=[]}function b(e){var t=this.__data__,r=L(t,e);return!(r<0)&&(r==t.length-1?t.pop():Vt.call(t,r,1),!0)}function v(e){var t=this.__data__,r=L(t,e);return r<0?undefined:t[r][1]}function w(e){return L(this.__data__,e)>-1}function k(e,t){var r=this.__data__,n=L(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}function x(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function E(){this.__data__={hash:new p,map:new(Xt||m),string:new p}}function O(e){return oe(this,e)["delete"](e)}function A(e){return oe(this,e).get(e)}function T(e){return oe(this,e).has(e)}function S(e,t){return oe(this,e).set(e,t),this}function I(e){var t=-1,r=e?e.length:0;for(this.__data__=new x;++t<r;)this.add(e[t])}function R(e){return this.__data__.set(e,De),this}function C(e){return this.__data__.has(e)}function q(e){this.__data__=new m(e)}function M(){this.__data__=new m}function z(e){return this.__data__["delete"](e)}function N(e){return this.__data__.get(e)}function j(e){return this.__data__.has(e)}function P(e,t){var r=this.__data__;if(r instanceof m){var n=r.__data__;if(!Xt||n.length<Be-1)return n.push([e,t]),this;r=this.__data__=new x(n)}return r.set(e,t),this}function B(e,t){var r=pr(e)||Ee(e)?i(e.length,String):[],n=r.length,a=!!n;for(var $ in e)!t&&!Gt.call(e,$)||a&&("length"==$||ce($,n))||r.push($);return r}function L(e,t){for(var r=e.length;r--;)if(xe(e[r][0],t))return r;return-1}function D(e,t){for(var r=0,n=(t=pe(t,e)?[t]:ne(t)).length;null!=e&&r<n;)e=e[ge(t[r++])];return r&&r==n?e:undefined}function G(e){return Ht.call(e)}function H(e,t){return null!=e&&t in Object(e)}function F(e,t,r,n,a){return e===t||(null==e||null==t||!Ie(e)&&!Re(t)?e!=e&&t!=t:U(e,t,F,r,n,a))}function U(e,t,r,n,a,i){var $=pr(e),o=pr(t),l=Ye,u=Ye;$||(l=(l=ur(e))==Ke?tt:l),o||(u=(u=ur(t))==Ke?tt:u);var c=l==tt&&!s(e),p=u==tt&&!s(t),d=l==u;if(d&&!c)return i||(i=new q),$||dr(e)?ae(e,t,r,n,a,i):ie(e,t,l,r,n,a,i);if(!(a&He)){var _=c&&Gt.call(e,"__wrapped__"),f=p&&Gt.call(t,"__wrapped__");if(_||f){var h=_?e.value():e,y=f?t.value():t;return i||(i=new q),r(h,y,n,a,i)}}return!!d&&(i||(i=new q),$e(e,t,r,n,a,i))}function K(e,t,r,n){var a=r.length,i=a,$=!n;if(null==e)return!i;for(e=Object(e);a--;){var o=r[a];if($&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<i;){var s=(o=r[a])[0],l=e[s],u=o[1];if($&&o[2]){if(l===undefined&&!(s in e))return!1}else{var c=new q;if(n)var p=n(l,u,s,e,t,c);if(!(p===undefined?F(u,l,n,Ge|He,c):p))return!1}}return!0}function Y(e){return!(!Ie(e)||_e(e))&&(Te(e)||s(e)?Ft:xt).test(be(e))}function V(e){return Re(e)&&Se(e.length)&&!!Ot[Ht.call(e)]}function W(e){return"function"==typeof e?e:null==e?je:"object"==typeof e?pr(e)?Z(e[0],e[1]):X(e):Pe(e)}function J(e){if(!fe(e))return Wt(e);var t=[];for(var r in Object(e))Gt.call(e,r)&&"constructor"!=r&&t.push(r);return t}function X(e){var t=se(e);return 1==t.length&&t[0][2]?ye(t[0][0],t[0][1]):function(r){return r===e||K(r,e,t)}}function Z(e,t){return pe(e)&&he(t)?ye(ge(e),t):function(r){var n=Me(r,e);return n===undefined&&n===t?ze(r,e):F(t,n,undefined,Ge|He)}}function Q(e){return function(t){return D(t,e)}}function ee(e,t){for(var r=e?t.length:0,n=r-1;r--;){var a=t[r];if(r==n||a!==i){var i=a;if(ce(a))Vt.call(e,a,1);else if(pe(a,e))delete e[ge(a)];else{var $=ne(a),o=me(e,$);null!=o&&delete o[ge(ve($))]}}}return e}function te(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(r=r>a?a:r)<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}function re(e){if("string"==typeof e)return e;if(Ce(e))return lr?lr.call(e):"";var t=e+"";return"0"==t&&1/e==-Fe?"-0":t}function ne(e){return pr(e)?e:cr(e)}function ae(e,t,r,a,i,$){var o=i&He,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=$.get(e);if(u&&$.get(t))return u==t;var c=-1,p=!0,d=i&Ge?new I:undefined;for($.set(e,t),$.set(t,e);++c<s;){var _=e[c],f=t[c];if(a)var h=o?a(f,_,c,t,e,$):a(_,f,c,e,t,$);if(h!==undefined){if(h)continue;p=!1;break}if(d){if(!n(t,function(e,t){if(!d.has(t)&&(_===e||r(_,e,a,i,$)))return d.add(t)})){p=!1;break}}else if(_!==f&&!r(_,f,a,i,$)){p=!1;break}}return $["delete"](e),$["delete"](t),p}function ie(e,t,r,n,a,i,$){switch(r){case lt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case st:return!(e.byteLength!=t.byteLength||!n(new Kt(e),new Kt(t)));case Ve:case We:case et:return xe(+e,+t);case Je:return e.name==t.name&&e.message==t.message;case nt:case it:return e==t+"";case Qe:var o=l;case at:var s=i&He;if(o||(o=c),e.size!=t.size&&!s)return!1;var u=$.get(e);if(u)return u==t;i|=Ge,$.set(e,t);var p=ae(o(e),o(t),n,a,i,$);return $["delete"](e),p;case $t:if(sr)return sr.call(e)==sr.call(t)}return!1}function $e(e,t,r,n,a,i){var $=a&He,o=Ne(e),s=o.length;if(s!=Ne(t).length&&!$)return!1;for(var l=s;l--;){var u=o[l];if(!($?u in t:Gt.call(t,u)))return!1}var c=i.get(e);if(c&&i.get(t))return c==t;var p=!0;i.set(e,t),i.set(t,e);for(var d=$;++l<s;){var _=e[u=o[l]],f=t[u];if(n)var h=$?n(f,_,u,t,e,i):n(_,f,u,e,t,i);if(!(h===undefined?_===f||r(_,f,n,a,i):h)){p=!1;break}d||(d="constructor"==u)}if(p&&!d){var y=e.constructor,m=t.constructor;y!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof m&&m instanceof m)&&(p=!1)}return i["delete"](e),i["delete"](t),p}function oe(e,t){var r=e.__data__;return de(t)?r["string"==typeof t?"string":"hash"]:r.map}function se(e){for(var t=Ne(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,he(a)]}return t}function le(e,t){var r=o(e,t);return Y(r)?r:undefined}function ue(e,t,r){for(var n,a=-1,i=(t=pe(t,e)?[t]:ne(t)).length;++a<i;){var $=ge(t[a]);if(!(n=null!=e&&r(e,$)))break;e=e[$]}return n||!!(i=e?e.length:0)&&Se(i)&&ce($,i)&&(pr(e)||Ee(e))}function ce(e,t){return!!(t=null==t?Ue:t)&&("number"==typeof e||Et.test(e))&&e>-1&&e%1==0&&e<t}function pe(e,t){if(pr(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Ce(e))||(gt.test(e)||!mt.test(e)||null!=t&&e in Object(t))}function de(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function _e(e){return!!Lt&&Lt in e}function fe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Pt)}function he(e){return e==e&&!Ie(e)}function ye(e,t){return function(r){return null!=r&&(r[e]===t&&(t!==undefined||e in Object(r)))}}function me(e,t){return 1==t.length?e:D(e,te(t,0,-1))}function ge(e){if("string"==typeof e||Ce(e))return e;var t=e+"";return"0"==t&&1/e==-Fe?"-0":t}function be(e){if(null!=e){try{return Dt.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function ve(e){var t=e?e.length:0;return t?e[t-1]:undefined}function we(e,t){var r=[];if(!e||!e.length)return r;var n=-1,a=[],i=e.length;for(t=W(t,3);++n<i;){var $=e[n];t($,n,e)&&(r.push($),a.push(n))}return ee(e,a),r}function ke(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(Le);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var $=e.apply(this,n);return r.cache=i.set(a,$),$};return r.cache=new(ke.Cache||x),r}function xe(e,t){return e===t||e!=e&&t!=t}function Ee(e){return Ae(e)&&Gt.call(e,"callee")&&(!Yt.call(e,"callee")||Ht.call(e)==Ke)}function Oe(e){return null!=e&&Se(e.length)&&!Te(e)}function Ae(e){return Re(e)&&Oe(e)}function Te(e){var t=Ie(e)?Ht.call(e):"";return t==Xe||t==Ze}function Se(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ue}function Ie(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Re(e){return!!e&&"object"==typeof e}function Ce(e){return"symbol"==typeof e||Re(e)&&Ht.call(e)==$t}function qe(e){return null==e?"":re(e)}function Me(e,t,r){var n=null==e?undefined:D(e,t);return n===undefined?r:n}function ze(e,t){return null!=e&&ue(e,t,H)}function Ne(e){return Oe(e)?B(e):J(e)}function je(e){return e}function Pe(e){return pe(e)?a(ge(e)):Q(e)}
/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var Be=200,Le="Expected a function",De="__lodash_hash_undefined__",Ge=1,He=2,Fe=1/0,Ue=9007199254740991,Ke="[object Arguments]",Ye="[object Array]",Ve="[object Boolean]",We="[object Date]",Je="[object Error]",Xe="[object Function]",Ze="[object GeneratorFunction]",Qe="[object Map]",et="[object Number]",tt="[object Object]",rt="[object Promise]",nt="[object RegExp]",at="[object Set]",it="[object String]",$t="[object Symbol]",ot="[object WeakMap]",st="[object ArrayBuffer]",lt="[object DataView]",ut="[object Float64Array]",ct="[object Int8Array]",pt="[object Int16Array]",dt="[object Int32Array]",_t="[object Uint8Array]",ft="[object Uint8ClampedArray]",ht="[object Uint16Array]",yt="[object Uint32Array]",mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gt=/^\w*$/,bt=/^\./,vt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wt=/[\\^$.*+?()[\]{}|]/g,kt=/\\(\\)?/g,xt=/^\[object .+?Constructor\]$/,Et=/^(?:0|[1-9]\d*)$/,Ot={};Ot["[object Float32Array]"]=Ot[ut]=Ot[ct]=Ot[pt]=Ot[dt]=Ot[_t]=Ot[ft]=Ot[ht]=Ot[yt]=!0,Ot[Ke]=Ot[Ye]=Ot[st]=Ot[Ve]=Ot[lt]=Ot[We]=Ot[Je]=Ot[Xe]=Ot[Qe]=Ot[et]=Ot[tt]=Ot[nt]=Ot[at]=Ot[it]=Ot[ot]=!1;var At,Tt="object"==typeof e&&e&&e.Object===Object&&e,St="object"==typeof self&&self&&self.Object===Object&&self,It=Tt||St||Function("return this")(),Rt="object"==typeof r&&r&&!r.nodeType&&r,Ct=Rt&&"object"==typeof t&&t&&!t.nodeType&&t,qt=Ct&&Ct.exports===Rt&&Tt.process,Mt=function(){try{return qt&&qt.binding("util")}catch(e){}}(),zt=Mt&&Mt.isTypedArray,Nt=Array.prototype,jt=Function.prototype,Pt=Object.prototype,Bt=It["__core-js_shared__"],Lt=(At=/[^.]+$/.exec(Bt&&Bt.keys&&Bt.keys.IE_PROTO||""))?"Symbol(src)_1."+At:"",Dt=jt.toString,Gt=Pt.hasOwnProperty,Ht=Pt.toString,Ft=RegExp("^"+Dt.call(Gt).replace(wt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=It.Symbol,Kt=It.Uint8Array,Yt=Pt.propertyIsEnumerable,Vt=Nt.splice,Wt=u(Object.keys,Object),Jt=le(It,"DataView"),Xt=le(It,"Map"),Zt=le(It,"Promise"),Qt=le(It,"Set"),er=le(It,"WeakMap"),tr=le(Object,"create"),rr=be(Jt),nr=be(Xt),ar=be(Zt),ir=be(Qt),$r=be(er),or=Ut?Ut.prototype:undefined,sr=or?or.valueOf:undefined,lr=or?or.toString:undefined;p.prototype.clear=d,p.prototype["delete"]=_,p.prototype.get=f,p.prototype.has=h,p.prototype.set=y,m.prototype.clear=g,m.prototype["delete"]=b,m.prototype.get=v,m.prototype.has=w,m.prototype.set=k,x.prototype.clear=E,x.prototype["delete"]=O,x.prototype.get=A,x.prototype.has=T,x.prototype.set=S,I.prototype.add=I.prototype.push=R,I.prototype.has=C,q.prototype.clear=M,q.prototype["delete"]=z,q.prototype.get=N,q.prototype.has=j,q.prototype.set=P;var ur=G;(Jt&&ur(new Jt(new ArrayBuffer(1)))!=lt||Xt&&ur(new Xt)!=Qe||Zt&&ur(Zt.resolve())!=rt||Qt&&ur(new Qt)!=at||er&&ur(new er)!=ot)&&(ur=function(e){var t=Ht.call(e),r=t==tt?e.constructor:undefined,n=r?be(r):undefined;if(n)switch(n){case rr:return lt;case nr:return Qe;case ar:return rt;case ir:return at;case $r:return ot}return t});var cr=ke(function(e){e=qe(e);var t=[];return bt.test(e)&&t.push(""),e.replace(vt,function(e,r,n,a){t.push(n?a.replace(kt,"$1"):r||e)}),t});ke.Cache=x;var pr=Array.isArray,dr=zt?$(zt):V;t.exports=we}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(e,t){(function(e){function r(e,t){return!!(e?e.length:0)&&i(e,t,0)>-1}function n(e,t,r){for(var n=-1,a=e?e.length:0;++n<a;)if(r(t,e[n]))return!0;return!1}function a(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}function i(e,t,r){if(t!=t)return a(e,$,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}function $(e){return e!=e}function o(e,t){return e.has(t)}function s(e,t){return null==e?undefined:e[t]}function l(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(r){}return t}function u(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}function c(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function p(){this.__data__=_e?_e(null):{}}function d(e){return this.has(e)&&delete this.__data__[e]}function _(e){var t=this.__data__;if(_e){var r=t[e];return r===Y?undefined:r}return se.call(t,e)?t[e]:undefined}function f(e){var t=this.__data__;return _e?t[e]!==undefined:se.call(t,e)}function h(e,t){return this.__data__[e]=_e&&t===undefined?Y:t,this}function y(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function m(){this.__data__=[]}function g(e){var t=this.__data__,r=C(t,e);return!(r<0)&&(r==t.length-1?t.pop():ce.call(t,r,1),!0)}function b(e){var t=this.__data__,r=C(t,e);return r<0?undefined:t[r][1]}function v(e){return C(this.__data__,e)>-1}function w(e,t){var r=this.__data__,n=C(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}function k(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function x(){this.__data__={hash:new c,map:new(pe||y),string:new c}}function E(e){return z(this,e)["delete"](e)}function O(e){return z(this,e).get(e)}function A(e){return z(this,e).has(e)}function T(e,t){return z(this,e).set(e,t),this}function S(e){var t=-1,r=e?e.length:0;for(this.__data__=new k;++t<r;)this.add(e[t])}function I(e){return this.__data__.set(e,Y),this}function R(e){return this.__data__.has(e)}function C(e,t){for(var r=e.length;r--;)if(D(e[r][0],t))return r;return-1}function q(e){return!(!H(e)||P(e))&&(G(e)||l(e)?ue:Z).test(B(e))}function M(e,t,a){var i=-1,$=r,s=e.length,l=!0,c=[],p=c;if(a)l=!1,$=n;else if(s>=K){var d=t?null:fe(e);if(d)return u(d);l=!1,$=o,p=new S}else p=t?[]:c;e:for(;++i<s;){var _=e[i],f=t?t(_):_;if(_=a||0!==_?_:0,l&&f==f){for(var h=p.length;h--;)if(p[h]===f)continue e;t&&p.push(f),c.push(_)}else $(p,f,a)||(p!==c&&p.push(f),c.push(_))}return c}function z(e,t){var r=e.__data__;return j(t)?r["string"==typeof t?"string":"hash"]:r.map}function N(e,t){var r=s(e,t);return q(r)?r:undefined}function j(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function P(e){return!!$e&&$e in e}function B(e){if(null!=e){try{return oe.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function L(e){return e&&e.length?M(e):[]}function D(e,t){return e===t||e!=e&&t!=t}function G(e){var t=H(e)?le.call(e):"";return t==W||t==J}function H(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function F(){}
/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var U,K=200,Y="__lodash_hash_undefined__",V=1/0,W="[object Function]",J="[object GeneratorFunction]",X=/[\\^$.*+?()[\]{}|]/g,Z=/^\[object .+?Constructor\]$/,Q="object"==typeof e&&e&&e.Object===Object&&e,ee="object"==typeof self&&self&&self.Object===Object&&self,te=Q||ee||Function("return this")(),re=Array.prototype,ne=Function.prototype,ae=Object.prototype,ie=te["__core-js_shared__"],$e=(U=/[^.]+$/.exec(ie&&ie.keys&&ie.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"",oe=ne.toString,se=ae.hasOwnProperty,le=ae.toString,ue=RegExp("^"+oe.call(se).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ce=re.splice,pe=N(te,"Map"),de=N(te,"Set"),_e=N(Object,"create");c.prototype.clear=p,c.prototype["delete"]=d,c.prototype.get=_,c.prototype.has=f,c.prototype.set=h,y.prototype.clear=m,y.prototype["delete"]=g,y.prototype.get=b,y.prototype.has=v,y.prototype.set=w,k.prototype.clear=x,k.prototype["delete"]=E,k.prototype.get=O,k.prototype.has=A,k.prototype.set=T,S.prototype.add=S.prototype.push=I,S.prototype.has=R;var fe=de&&1/u(new de([,-0]))[1]==V?function(e){return new de(e)}:F;t.exports=L}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t){"use strict";function r(e){if(null===e||e===undefined)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function n(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(a){return!1}}var a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;t.exports=n()?Object.assign:function(e){for(var t,n,o=r(e),s=1;s<arguments.length;s++){for(var l in t=Object(arguments[s]))i.call(t,l)&&(o[l]=t[l]);if(a){n=a(t);for(var u=0;u<n.length;u++)$.call(t,n[u])&&(o[n[u]]=t[n[u]])}}return o}},{}],8:[function(e,t){var r=e("browser-split"),n=/([\.#]?[a-zA-Z0-9\u007F-\uFFFF_:-]+)/,a=/^\.|#/;t.exports=function(e,t){var i,$,o,s,l="",u=[],c=r(e=e||"",n);for((a.test(c[1])||""===e)&&(i="div"),s=0;s<c.length;s++)($=c[s])&&(o=$.charAt(0),i?"."===o?u.push($.substring(1,$.length)):"#"===o&&(l=$.substring(1,$.length)):i=$);return{tagName:!0===t?i.toUpperCase():i,id:l,className:u.join(" ")}}},{"browser-split":1}],9:[function(e,t,r){r.CONTAINER={a:!0,defs:!0,glyph:!0,g:!0,marker:!0,mask:!0,"missing-glyph":!0,pattern:!0,svg:!0,"switch":!0,symbol:!0,text:!0,desc:!0,metadata:!0,title:!0},r.VOID={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},{}],10:[function(e,t){var r=e("./init"),n=e("./modules"),a=r([n.attributes,n.props,n["class"],n.style,n.dataset]);t.exports=a},{"./init":11,"./modules":15}],11:[function(e,t){var r=e("lodash.escape"),n=e("parse-sel"),a=e("./elements").VOID,i=e("./elements").CONTAINER;t.exports=function(e){function t(t,r){var n=[],a=new Map([["id",r.id],["class",r.className]]);return e.forEach(function(e){e(t,a)}),a.forEach(function(e,t){e&&""!==e&&n.push(t+'="'+e+'"')}),n.join(" ")}return function $(e){if(null==e)return"";if(!e.sel&&"string"==typeof e.text)return r(e.text);e.data=e.data||{},e.data.hook&&"function"==typeof e.data.hook.init&&"function"==typeof e.data.fn&&e.data.hook.init(e);var o=n(e.sel),s=o.tagName,l=t(e,o),u="http://www.w3.org/2000/svg"===e.data.ns,c=[];return"!"===s?"<!--"+e.text+"-->":(c.push("<"+s),l.length&&c.push(" "+l),u&&!0!==i[s]&&c.push(" /"),c.push(">"),(!0!==a[s]&&!u||u&&!0===i[s])&&(e.data.props&&e.data.props.innerHTML?c.push(e.data.props.innerHTML):e.text?c.push(r(e.text)):e.children&&e.children.forEach(function(e){c.push($(e))}),c.push("</"+s+">")),c.join(""))}}},{"./elements":9,"lodash.escape":2,"parse-sel":8}],12:[function(e,t){var r=e("lodash.forown"),n=e("lodash.escape");t.exports=function(e,t){var a=e.data.attrs||{};r(a,function(e,r){t.set(r,n(e))})}},{"lodash.escape":2,"lodash.forown":3}],13:[function(e,t){var r=e("lodash.forown"),n=e("lodash.remove"),a=e("lodash.uniq");t.exports=function(e,t){var i,$=[],o=[],s=e.data["class"]||{},l=t.get("class");l=l.length>0?l.split(" "):[],r(s,function(e,t){!0===e?$.push(t):o.push(t)}),(i=n(a(l.concat($)),function(e){return o.indexOf(e)<0})).length&&t.set("class",i.join(" "))}},{"lodash.forown":3,"lodash.remove":5,"lodash.uniq":6}],14:[function(e,t){var r=e("lodash.forown"),n=e("lodash.escape");t.exports=function(e,t){var a=e.data.dataset||{};r(a,function(e,r){t.set(`data-${r}`,n(e))})}},{"lodash.escape":2,"lodash.forown":3}],15:[function(e,t){t.exports={"class":e("./class"),props:e("./props"),attributes:e("./attributes"),style:e("./style"),dataset:e("./dataset")}},{"./attributes":12,"./class":13,"./dataset":14,"./props":16,"./style":17}],16:[function(e,t){var r=e("lodash.forown"),n=e("lodash.escape"),a=["attributes","childElementCount","children","classList","clientHeight","clientLeft","clientTop","clientWidth","currentStyle","firstElementChild","innerHTML","lastElementChild","nextElementSibling","ongotpointercapture","onlostpointercapture","onwheel","outerHTML","previousElementSibling","runtimeStyle","scrollHeight","scrollLeft","scrollLeftMax","scrollTop","scrollTopMax","scrollWidth","tabStop","tagName"];t.exports=function(e,t){var i=e.data.props||{};r(i,function(e,r){a.indexOf(r)>-1||("htmlFor"===r&&(r="for"),"className"===r&&(r="class"),t.set(r.toLowerCase(),n(e)))})}},{"lodash.escape":2,"lodash.forown":3}],17:[function(e,t){var r=e("object-assign"),n=e("lodash.forown"),a=e("lodash.escape"),i=e("lodash.kebabcase");t.exports=function(e,t){var $=[],o=e.data.style||{};o.delayed&&r(o,o.delayed),n(o,function(e,t){if("string"==typeof e||"number"==typeof e){var r=i(t);$.push((t.match(/^--.*/)?"--"+r:r)+": "+a(e))}}),$.length&&t.set("style",$.join("; "))}},{"lodash.escape":2,"lodash.forown":3,"lodash.kebabcase":4,"object-assign":7}]},{},[10])(10)}),Opal.loaded(["vendor/snabbdom-to-html.js"]),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).tovnode=e()}}(function(){return function e(t,r,n){function a($,o){if(!r[$]){if(!t[$]){var s="function"==typeof require&&require;if(!o&&s)return s($,!0);if(i)return i($,!0);var l=new Error("Cannot find module '"+$+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[$]={exports:{}};t[$][0].call(u.exports,function(e){var r=t[$][1][e];return a(r||e)},u,u.exports,e,t,r,n)}return r[$].exports}for(var i="function"==typeof require&&require,$=0;$<n.length;$++)a(n[$]);return a}({1:[function(e,t,r){"use strict";function n(e){return document.createElement(e)}function a(e,t){return document.createElementNS(e,t)}function i(e){return document.createTextNode(e)}function $(e){return document.createComment(e)}function o(e,t,r){e.insertBefore(t,r)}function s(e,t){e.removeChild(t)}function l(e,t){e.appendChild(t)}function u(e){return e.parentNode}function c(e){return e.nextSibling}function p(e){return e.tagName}function d(e,t){e.textContent=t}function _(e){return e.textContent}function f(e){return 1===e.nodeType}function h(e){return 3===e.nodeType}function y(e){return 8===e.nodeType}Object.defineProperty(r,"__esModule",{value:!0}),r.htmlDomApi={createElement:n,createElementNS:a,createTextNode:i,createComment:$,insertBefore:o,removeChild:s,appendChild:l,parentNode:u,nextSibling:c,tagName:p,setTextContent:d,getTextContent:_,isElement:f,isText:h,isComment:y},r["default"]=r.htmlDomApi},{}],2:[function(e,t,r){"use strict";function n(e,t){var r,$=t!==undefined?t:i["default"];if($.isElement(e)){var o,s=e.id?"#"+e.id:"",l=e.getAttribute("class"),u=l?"."+l.split(" ").join("."):"",c=$.tagName(e).toLowerCase()+s+u,p={},d=[],_=void 0,f=void 0,h=e.attributes,y=e.childNodes;for(_=0,f=h.length;_<f;_++)"id"!==(o=h[_].nodeName)&&"class"!==o&&(p[o]=h[_].nodeValue);for(_=0,f=y.length;_<f;_++)d.push(n(y[_]));return a["default"](c,{attrs:p},d,undefined,e)}return $.isText(e)?(r=$.getTextContent(e),a["default"](undefined,undefined,undefined,r,e)):$.isComment(e)?(r=$.getTextContent(e),a["default"]("!",{},[],r,e)):a["default"]("",{},[],undefined,undefined)}Object.defineProperty(r,"__esModule",{value:!0});var a=e("./vnode"),i=e("./htmldomapi");r.toVNode=n,r["default"]=n},{"./htmldomapi":1,"./vnode":3}],3:[function(e,t,r){"use strict";function n(e,t,r,n,a){return{sel:e,data:t,children:r,text:n,elm:a,key:t===undefined?undefined:t.key}}Object.defineProperty(r,"__esModule",{value:!0}),r.vnode=n,r["default"]=n},{}]},{},[2])(2)}),Opal.loaded(["vendor/tovnode.js"]),Opal.modules["snabberb/component"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}e.top;var n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash2,u=e.send,c=e.truthy;e.hash;return e.add_stubs(["$attr_accessor","$attr_reader","$[]=","$class_needs","$-","$respond_to?","$superclass","$clone","$new","$node=","$update","$html","$root?","$store","$keys","$empty?","$raise","$init_needs","$==","$render","$is_a?","$<=","$class","$!","$convert","$<<","$request_ids","$update!","$shift","$call","$node","$nil?","$stores?","$instance_variable_set","$dig","$private","$each","$key?","$[]","$needs"]),function(n,p){var d=[o(n,"Snabberb")].concat(p);!function(n,$super,i){var o,p,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A=s(n,null,"Component"),T=[A].concat(i);A.$$prototype.root=A.$$prototype.store=A.$$prototype.request_ids=a,A.$attr_accessor("node"),A.$attr_reader("root"),e.defs(A,"$needs",o=function(r,n){var i=this,$=a;if(null==n)n=l([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return $=[r,e.kwrestargs(n,{})],u(i.$class_needs(),"[]=",e.to_a($)),$[t($.length,1)]},o.$$arity=-2),e.defs(A,"$class_needs",p=function(){var e,t=this;return null==t.class_needs&&(t.class_needs=a),t.class_needs=c(e=t.class_needs)?e:c(t.$superclass()["$respond_to?"]("class_needs"))?t.$superclass().$class_needs().$clone():l([],{})},p.$$arity=0),e.defs(A,"$attach",d=function(r,n){var i,$=this,o=a,s=a;if(null==n)n=l([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return i=e.kwrestargs(n,{}),o=$.$new(a,i),s=[document.getElementById(r)],u(o,"node=",e.to_a(s)),s[t(s.length,1)],o.$update()},d.$$arity=-2),e.defs(A,"$html",_=function(t){var r,n=this;if(null==t)t=l([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return r=e.kwrestargs(t,{}),n.$new(a,r).$html()},_.$$arity=-1),e.def(A,"$initialize",f=function(e,r){var n,i=this,$=a;return i.root=c(n=e)?n:i,i.store=c(i["$root?"]())?l([],{}):i.root.$store(),$=t(r.$keys(),i.$class_needs().$keys()),c($["$empty?"]())||i.$raise("Unused needs passed to component: "+$+"."),i.$init_needs(r)},f.$$arity=2),e.def(A,"$root?",h=function(){var e=this;return e["$=="](e.root)},h.$$arity=0),e.def(A,"$render",y=function(){return this.$raise($(T,"NotImplementedError"))},y.$$arity=0),e.def(A,"$html",m=function(){return toHTML(this.$render())},m.$$arity=0),e.def(A,"$h",g=function(t,n,i){var o,s=this,u=a;return null==n&&(n=l([],{})),null==i&&(i=a),c(t["$is_a?"]($(T,"Class")))?(c(r(t,$(T,"Component")))||s.$raise("Element '"+t+"' must be a subclass of "+s.$class()),t.$new(s.root,e.to_hash(n)).$render()):(u=n["$is_a?"]($(T,"Hash")),c(c(o=i["$!"]())?u["$!"]():o)&&(i=n),c(u)||(n=l([],{})),snabbdom.h(t,$(T,"Native").$convert(n),i))},g.$$arity=-2),e.def(A,"$update",b=function(){var e=this;return e.$request_ids()["$<<"](window.requestAnimationFrame(function(){e["$update!"]()}))},b.$$arity=0),e.def(A,"$update!",v=function(){var r,n,i=this,$=a,o=a;return i.$request_ids().$shift(),c(i.$request_ids()["$empty?"]())?(e.class_variable_set(T[0],"@@patcher",c(r=null==(n=T[0].$$cvars["@@patcher"])?a:n)?r:snabbdom.init([snabbdom_attributes["default"],snabbdom_class["default"],snabbdom_eventlisteners["default"],snabbdom_props["default"],snabbdom_style["default"]])),$=i.root.$render(),(null==(r=T[0].$$cvars["@@patcher"])?a:r).$call(i.root.$node(),$),o=[$],u(i.root,"node=",e.to_a(o)),o[t(o.length,1)]):a},v.$$arity=0),e.def(A,"$store",w=function(){var r,n,i,$,o,s,p=this,d=a,_=a;if(r=e.slice.call(arguments,0,arguments.length),null==(n=e.extract_kwargs(r)))n=l([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return r.length>0&&(i=r[0],r.splice(0,1)),null==i&&(i=a),r.length>0&&($=r[0],r.splice(0,1)),null==$&&($=a),null==(o=n.$$smap.skip)&&(o=!1),c(i["$nil?"]())?p.store:(c(p["$stores?"](i))||p.$raise("Cannot store key '"+i+"' since it is not a stored need of "+p.$class()+"."),d=[i,$],u(p.store,"[]=",e.to_a(d)),d[t(d.length,1)],_="@"+i,p.$instance_variable_set(_,$),c(c(s=p["$root?"]()["$!"]())?p.root["$stores?"](i):s)&&p.root.$instance_variable_set(_,$),c(o)?a:p.$update())},w.$$arity=-1),e.def(A,"$class_needs",k=function(){return this.$class().$class_needs()},k.$$arity=0),e.def(A,"$stores?",x=function(e){return this.$class_needs().$dig(e,"store")},x.$$arity=1),e.def(A,"$request_ids",E=function(){var e,t=this;return c(t["$root?"]())?t.request_ids=c(e=t.request_ids)?e:[]:t.root.$request_ids()},E.$$arity=0),A.$private(),e.def(A,"$init_needs",O=function(r){var n,i=this;return u(i.$class_needs(),"each",[],((n=function(i,$){var o,s=n.$$s||this,l=a,p=a;return null==s.store&&(s.store=a),null==i&&(i=a),null==$&&($=a),l="@"+i,c(c(o=s.store["$key?"](i))?$["$[]"]("store"):o)?s.$instance_variable_set(l,s.store["$[]"](i)):c(r["$key?"](i))?(c(c(o=$["$[]"]("store"))?s.store["$key?"](i)["$!"]():o)&&(p=[i,r["$[]"](i)],u(s.store,"[]=",e.to_a(p)),p[t(p.length,1)]),s.$instance_variable_set(l,r["$[]"](i))):c((o=$)===a||null==o?a:u(o,"key?",["default"]))?s.$instance_variable_set(l,$["$[]"]("default")):s.$raise("Needs '"+i+"' required but not provided.")}).$$s=i,n.$$arity=2,n))},O.$$arity=1)}(d[0],0,d),function(e,$super,t){var r=s(e,$super,"Layout");[r].concat(t);r.$needs("application"),r.$needs("attach_func"),r.$needs("javascript_include_tags")}(d[0],i($(d,"Snabberb"),"Component"),d)}(n[0],n)},Opal.modules.snabberb=function(e){var t,r,n=e.top,a=[],i=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module);return e.add_stubs(["$require"]),n.$require("native"),n.$require("vendor/snabbdom"),n.$require("vendor/snabbdom-attributes"),n.$require("vendor/snabbdom-class"),n.$require("vendor/snabbdom-eventlisteners"),n.$require("vendor/snabbdom-props"),n.$require("vendor/snabbdom-style"),n.$require("vendor/snabbdom-to-html"),n.$require("vendor/tovnode"),n.$require("snabberb/component"),t=a[0],r=a,void[i(t,"Snabberb")].concat(r)},void 0===setTimeout)var setTimeout=function(){};if("undefined"==typeof window&&(window={requestAnimationFrame:function(){},scrollTo:function(){},addEventListener:function(){},location:{pathname:"",hash:"",search:""},history:{pushState:function(){}}}),"undefined"==typeof localStorage&&(localStorage={getItem:function(){},setItem:function(){}}),"undefined"==typeof document&&(document={}),void 0===XMLHttpRequest)var XMLHttpRequest=function(){};Opal.loaded(["vendor/polyfill.js"]),function(e,t,r){"use strict";e.MessageBus;var n,a,i,$,o,s,l,u,c,p,d,_,f,h,y,m,g=!1;a=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t;return t=16*Math.random()|0,("x"===e?t:3&t|8).toString(16)})}(),n=[],i=0,o="/",d=!1,_=[],h=0,f=e.jQuery,function(){for(var e=["","webkit","ms","moz"],n=0;n<e.length;n++){var a=e[n],i=a+(""===a?"hidden":"Hidden");t[i]!==r&&(m=i)}}();var b=function(){return m!==r?t[m]:!t.hasFocus},v=function(){try{return localStorage.setItem("mbTestLocalStorage",Date.now()),localStorage.removeItem("mbTestLocalStorage"),!0}catch(e){return!1}}(),w=function(){v&&localStorage.setItem("__mbLastAjax",Date.now())},k=function(){if(v&&b()){var e=parseInt(localStorage.getItem("__mbLastAjax"),10),t=Date.now()-e;return t>=0&&t<s.minHiddenPollInterval}return!1},x=null===(new XMLHttpRequest).onprogress,E=function(){return s.enableChunkedEncoding&&x};$=function(){return s.alwaysLongPoll||(s.shouldLongPollCallback?s.shouldLongPollCallback():!b())};var O,A=0,T=0,S=function(e){var t=!1;if(!e)return!1;for(var a=0;a<e.length;a++){var i=e[a];t=!0;for(var $=0;$<n.length;$++){var o=n[$];if(o.channel===i.channel){o.last_id=i.message_id;try{o.func(i.data,i.global_id,i.message_id)}catch(s){console.log&&console.log("MESSAGE BUS FAIL: callback "+o.channel+" caused exception "+s.stack)}}"/__status"===i.channel&&i.data[o.channel]!==r&&(o.last_id=i.data[o.channel])}}return t},I=function(e){if(i=0,!d)return S(e);if(e)for(var t=0;t<e.length;t++)_.push(e[t]);return!1};c=function(e,t){if(!g){var r,n=!1,a=!1,o=!1;O=new Date,T+=1,t.__seq=T;var u=$()&&s.enableLongPolling,c=u&&E();h>0&&(h--,c=!1);var d={"X-SILENCE-LOGGER":"true"};for(var _ in s.headers)d[_]=s.headers[_];c||(d["Dont-Chunk"]="true");var y=c?"text":"json",m=function(e,r){var n="\r\n|\r\n",a=e.indexOf(n,r);if(-1===a)return r;var i=e.substring(r,a);i=i.replace(/\r\n\|\|\r\n/g,n);try{I(JSON.parse(i))}catch($){console.log&&(console.log("FAILED TO PARSE CHUNKED REPLY"),console.log(t))}return m(e,a+n.length)},b=function(){s.longPoll&&(s.longPoll.abort(),h=30)};if(!s.ajax)throw new Error("Either jQuery or the ajax adapter must be loaded");return w(),g=!0,s.ajax({url:s.baseUrl+"message-bus/"+s.clientId+"/poll"+(u?"":"?dlp=t"),data:t,cache:!1,async:!0,dataType:y,type:"POST",headers:d,messageBus:{chunked:c,onProgressListener:function(e){var t=0,r=setTimeout(b,3e3);return e.onprogress=function(){clearTimeout(r),"application/json; charset=utf-8"===e.getResponseHeader("Content-Type")?c=!1:t=m(e.responseText,t)}}},xhr:function(){var e=f.ajaxSettings.xhr();return c?(this.messageBus.onProgressListener(e),e):e},success:function(e){c||("string"==typeof e&&(e=JSON.parse(e)),n=I(e))},error:function(e,t){if(429===e.status){var n=parseInt(e.getResponseHeader&&e.getResponseHeader("Retry-After"))||0;(n=n||0)<15&&(n=15),r=n,o=!0}else"abort"===t?a=!0:(i+=1,A+=1)},complete:function(){var t;g=!1;try{o?t=Math.max(s.minPollInterval,1e3*r):n||a?t=s.minPollInterval:(t=s.callbackInterval,i>2?t*=i:$()||(t=s.backgroundCallbackInterval),t>s.maxPollInterval&&(t=s.maxPollInterval),(t-=new Date-O)<100&&(t=100))}catch(u){console.log&&u.message&&console.log("MESSAGE BUS FAIL: "+u.message)}p&&(clearTimeout(p),p=null),l&&(p=setTimeout(function(){p=null,e()},t)),s.longPoll=null}})}},s={minHiddenPollInterval:1500,enableChunkedEncoding:!0,enableLongPolling:!0,callbackInterval:15e3,backgroundCallbackInterval:6e4,minPollInterval:100,maxPollInterval:18e4,callbacks:n,clientId:a,alwaysLongPoll:!1,shouldLongPollCallback:r,baseUrl:o,headers:{},ajax:f&&f.ajax,noConflict:function(){return e.MessageBus=e.MessageBus.previousMessageBus,this},diagnostics:function(){console.log("Stopped: "+u+" Started: "+l),console.log("Current callbacks"),console.log(n),console.log("Total ajax calls: "+T+" Recent failure count: "+i+" Total failures: "+A),console.log("Last ajax call: "+(new Date-O)/1e3+" seconds ago")},pause:function(){d=!0},resume:function(){d=!1,S(_),_=[]},stop:function(){u=!0,l=!1,y&&(clearTimeout(y),y=null),s.longPoll&&s.longPoll.abort()},start:function(){var r;l||(l=!0,u=!1,r=function(){var e;if(!u)if(0===n.length||k())y||(y=setTimeout(function(){y=null,r()},parseInt(500+500*Math.random())));else{e={};for(var t=0;t<n.length;t++)e[n[t].channel]=n[t].last_id;s.longPoll||(s.longPoll=c(r,e))}},t.addEventListener&&"hidden"in t&&(s.visibilityEvent=e.document.addEventListener("visibilitychange",function(){t.hidden||s.longPoll||!p||(clearTimeout(p),clearTimeout(y),y=null,p=null,r())})),r())},status:function(){if(d)return"paused";if(l)return"started";if(u)return"stopped";throw"Cannot determine current status"},subscribe:function(e,t,r){if(l||u||s.start(),"number"!=typeof r&&(r=-1),"string"!=typeof e)throw"Channel name must be a string!";return n.push({channel:e,func:t,last_id:r}),s.longPoll&&s.longPoll.abort(),t},unsubscribe:function(e,t){var r;-1!==e.indexOf("*",e.length-1)&&(e=e.substr(0,e.length-1),r=!0);for(var a=!1,i=n.length-1;i>=0;i--){var $,o=n[i];!($=r?o.channel.substr(0,e.length)!==e:o.channel!==e)&&t&&o.func!==t&&($=!0),$||(n.splice(i,1),a=!0)}return a&&s.longPoll&&s.longPoll.abort(),a}},e.MessageBus=s}(window,document),Opal.loaded(["vendor/message-bus.js"]),function(e){"use strict";if(!e.MessageBus)throw new Error("MessageBus must be loaded before the ajax adapter");var t=1e4*Math.random()|0;e.MessageBus.ajax=function(r){var n=new(e.MessageBus&&e.MessageBus.xhrImplementation||e.XMLHttpRequest);n.dataType=r.dataType;var a=r.url;for(var i in r.cache||(a+=(-1==a.indexOf("?")?"?":"&")+"_="+t++),n.open("POST",a),r.headers)n.setRequestHeader(i,r.headers[i]);return n.setRequestHeader("Content-Type","application/json"),r.messageBus.chunked&&r.messageBus.onProgressListener(n),n.onreadystatechange=function(){if(4===n.readyState){var e=n.status;e>=200&&e<300||304===e?r.success(n.responseText):r.error(n,n.statusText),r.complete()}},n.send(JSON.stringify(r.data)),n}}(window),Opal.loaded(["vendor/message-bus-ajax.js"]),function(e){var t=e.top;e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice;e.add_stubs(["$require"]),t.$require("native"),t.$require("json"),t.$require("snabberb"),t.$require("vendor/polyfill"),t.$require("vendor/message-bus"),t.$require("vendor/message-bus-ajax")}(Opal),Opal.modules["engine/phase"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var a=e.top,i=[],$=e.nil,o=e.const_get_qualified,s=e.const_get_relative,l=(e.breaker,e.slice,e.module),u=e.klass,c=e.hash2,p=e.truthy,d=e.send;return e.add_stubs(["$attr_reader","$freeze","$log","$setup_phase!","$===","$==","$name","$train","$next!","$[]","$<=","$find_index","$!","$Array","$dig","$+","$<<","$capitalize","$join","$map","$to_proc","$trigger_events!","$each","$close_companies!","$companies","$owner","$select","$all_abilities","$to_s","$revenue=","$-","$abilities","$close!"]),a.$require("engine/phase.rb/../action/buy_train"),function(a,i){var _=[l(a,"Engine")].concat(i);!function(a,$super,i){var l,_,f,h,y,m,g,b,v=u(a,null,"Phase"),w=[v].concat(i);v.$$prototype.game=v.$$prototype.next_on=v.$$prototype.phases=v.$$prototype.index=v.$$prototype.log=v.$$prototype.name=v.$$prototype.operating_rounds=v.$$prototype.train_limit=v.$$prototype.tiles=v.$$prototype.events=$,v.$attr_reader("buy_companies","name","operating_rounds","train_limit","tiles","phases"),e.const_set(w[0],"TWO",c(["name","operating_rounds","train_limit","tiles"],{name:"2",operating_rounds:1,train_limit:4,tiles:"yellow"}).$freeze()),e.const_set(w[0],"THREE",c(["name","operating_rounds","train_limit","tiles","buy_companies","on"],{name:"3",operating_rounds:2,train_limit:4,tiles:["yellow","green"].$freeze(),buy_companies:!0,on:"3"}).$freeze()),e.const_set(w[0],"FOUR",c(["name","operating_rounds","train_limit","tiles","buy_companies","on"],{name:"4",operating_rounds:2,train_limit:3,tiles:["yellow","green"].$freeze(),buy_companies:!0,on:"4"}).$freeze()),e.const_set(w[0],"FIVE",c(["name","operating_rounds","train_limit","tiles","on","events"],{name:"5",operating_rounds:3,train_limit:2,tiles:["yellow","green","brown"].$freeze(),on:"5",events:c(["close_companies"],{close_companies:!0})}).$freeze()),e.const_set(w[0],"SIX",c(["name","operating_rounds","train_limit","tiles","on"],{name:"6",operating_rounds:3,train_limit:2,tiles:["yellow","green","brown"].$freeze(),on:"6"}).$freeze()),e.const_set(w[0],"D",c(["name","operating_rounds","train_limit","tiles","on"],{name:"D",operating_rounds:3,train_limit:2,tiles:["yellow","green","brown"].$freeze(),on:"D"}).$freeze()),e.def(v,"$initialize",l=function(e,t){var r=this;return r.index=0,r.phases=e,r.game=t,r.log=r.game.$log(),r["$setup_phase!"]()},l.$$arity=2),e.def(v,"$process_action",_=function(e){var t=this,r=$;return r=e,o(s(w,"Action"),"BuyTrain")["$==="](r)&&e.$train().$name()["$=="](t.next_on)?t["$next!"]():$},_.$$arity=1),e.def(v,"$current",f=function(){var e=this;return e.phases["$[]"](e.index)},f.$$arity=0),e.def(v,"$available?",h=function(e){var r,n=this;return!!p(e)&&t(d(n.phases,"find_index",[],((r=function(t){r.$$s;return null==t&&(t=$),t["$[]"]("name")["$=="](e)}).$$s=n,r.$$arity=1,r)),n.index)},h.$$arity=1),e.def(v,"$setup_phase!",y=function(){var e,t=this,n=$;return n=t.phases["$[]"](t.index),t.name=n["$[]"]("name"),t.operating_rounds=n["$[]"]("operating_rounds"),t.buy_companies=n["$[]"]("buy_companies")["$!"]()["$!"](),t.train_limit=n["$[]"]("train_limit"),t.tiles=t.$Array(n["$[]"]("tiles")),t.events=p(e=n["$[]"]("events"))?e:[],t.next_on=(e=t.phases["$[]"](r(t.index,1)))===$||null==e?$:d(e,"dig",["on"]),t.log["$<<"]("-- Phase "+t.name.$capitalize()+" (Operating Rounds: "+t.operating_rounds+", Train Limit: "+t.train_limit+", Available Tiles: "+d(t.tiles,"map",[],"capitalize".$to_proc()).$join(", ")+" ) --"),t["$trigger_events!"]()},y.$$arity=0),e.def(v,"$trigger_events!",m=function(){var t,r,a=this;return d(a.events,"each",[],((t=function(e,r){var n=t.$$s||this,a=$;return null==e&&(e=$),null==r&&(r=$),a=e,"close_companies"["$==="](a)?n["$close_companies!"]():$}).$$s=a,t.$$arity=2,t)),d(a.game.$companies(),"each",[],((r=function(t){var a,i,o=r.$$s||this,s=$;return null==t&&(t=$),p(t.$owner())?(s=d(t.$all_abilities(),"select",[],((a=function(e){var t,r=a.$$s||this;return null==r.name&&(r.name=$),null==e&&(e=$),(t=e["$[]"]("when"),t===$||null==t?$:d(t,"to_s",[]))["$=="](r.name)}).$$s=o,a.$$arity=1,a)),d(s,"each",[],((i=function(r){i.$$s;var a=$,o=$;return null==r&&(r=$),a=r["$[]"]("type"),"revenue_change"["$==="](a)?(o=[r["$[]"]("revenue")],d(t,"revenue=",e.to_a(o)),o[n(o.length,1)]):$}).$$s=o,i.$$arity=1,i))):$}).$$s=a,r.$$arity=1,r))},m.$$arity=0),e.def(v,"$close_companies!",g=function(){var e,t=this;return t.log["$<<"]("-- Event: Private companies close --"),d(t.game.$companies(),"each",[],((e=function(t){e.$$s;return null==t&&(t=$),p(t.$abilities("never_closes"))?$:t["$close!"]()}).$$s=t,e.$$arity=1,e))},g.$$arity=0),e.def(v,"$next!",b=function(){var e=this;return e.index=r(e.index,1),e["$setup_phase!"]()},b.$$arity=0)}(_[0],0,_)}(i[0],i)},Opal.modules["engine/depot"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}e.top;var n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module),$=e.klass,o=e.send,s=e.truthy;return e.add_stubs(["$attr_reader","$each","$owner=","$-","$dup","$bank","$owner","$remove_train","$find_index","$==","$name","$insert","$<<","$min","$map","$available","$to_proc","$min_by","$depot_trains","$price","$min_depot_train","$delete","$uniq","$first","$select","$available?","$phase","$available_on","$flat_map","$trains","$compact","$reject","$include?","$+","$cash","$cash="]),function(n,l){var u=[i(n,"Engine")].concat(l);!function(n,$super,i){var l,u,c,p,d,_,f,h,y,m,g,b,v=$(n,null,"Depot");[v].concat(i);v.$$prototype.trains=v.$$prototype.game=v.$$prototype.upcoming=v.$$prototype.discarded=v.$$prototype.bank=a,v.$attr_reader("trains","upcoming","discarded"),e.def(v,"$initialize",l=function(r,n){var i,$=this;return $.game=n,$.trains=r,o($.trains,"each",[],((i=function(r){var n=i.$$s||this,$=a;return null==r&&(r=a),$=[n],o(r,"owner=",e.to_a($)),$[t($.length,1)]}).$$s=$,i.$$arity=1,i)),$.upcoming=$.trains.$dup(),$.discarded=[],$.bank=$.game.$bank()},l.$$arity=2),e.def(v,"$reclaim_train",u=function(r){var n,i=this,$=a,l=a;return s(r.$owner())?(r.$owner().$remove_train(r),$=[i],o(r,"owner=",e.to_a($)),$[t($.length,1)],s(l=o(i.upcoming,"find_index",[],((n=function(e){n.$$s;return null==e&&(e=a),e.$name()["$=="](r.$name())}).$$s=i,n.$$arity=1,n)))?i.upcoming.$insert(l,r):i.discarded["$<<"](r)):a},u.$$arity=1),e.def(v,"$min_price",c=function(e){return o(this.$available(e),"map",[],"min_price".$to_proc()).$min()},c.$$arity=1),e.def(v,"$min_depot_train",p=function(){return o(this.$depot_trains(),"min_by",[],"price".$to_proc())},p.$$arity=0),e.def(v,"$min_depot_price",d=function(){return this.$min_depot_train().$price()},d.$$arity=0),e.def(v,"$remove_train",_=function(e){var t=this;return t.upcoming.$delete(e),t.discarded.$delete(e)},_.$$arity=1),e.def(v,"$depot_trains",f=function(){var t,r=this;return o([r.upcoming.$first()].concat(e.to_a(o(r.upcoming,"select",[],(t=function(e){var r=t.$$s||this;return null==r.game&&(r.game=a),null==e&&(e=a),r.game.$phase()["$available?"](e.$available_on())},t.$$s=r,t.$$arity=1,t)))).concat(e.to_a(r.discarded)),"uniq",[],"name".$to_proc())},f.$$arity=0),e.def(v,"$discountable_trains_for",h=function(e){var t,r=this,n=a;return n=o(r.$depot_trains(),"select",[],"discount".$to_proc()),o(e.$trains(),"flat_map",[],((t=function(e){var r,i=t.$$s||this;return null==e&&(e=a),o(n,"map",[],(r=function(t){r.$$s;var n=a;return null==t&&(t=a),n=t.$price(e),t.$price()["$=="](n)?a:[e,t,n]},r.$$s=i,r.$$arity=1,r)).$compact()}).$$s=r,t.$$arity=1,t))},h.$$arity=1),e.def(v,"$available",y=function(e){var t,n=this,i=a;return i=o(n.trains,"reject",[],((t=function(r){var n=t.$$s||this;return null==r&&(r=a),[e,n,a]["$include?"](r.$owner())}).$$s=n,t.$$arity=1,t)),r(n.$depot_trains(),i)},y.$$arity=1),e.def(v,"$cash",m=function(){return this.bank.$cash()},m.$$arity=0),e.def(v,"$cash=",g=function(r){var n=a;return n=[r],o(this.bank,"cash=",e.to_a(n)),n[t(n.length,1)]},g.$$arity=1),e.def(v,"$name",b=function(){return"The Depot"},b.$$arity=0)}(u[0],0,u)}(n[0],n)},Opal.modules["engine/game_error"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative),n=(e.breaker,e.slice,e.module),a=e.klass;return function(e,t){var i=[n(e,"Engine")].concat(t);!function(e,$super,t){[a(e,$super,"GameError")].concat(t)}(i[0],r(i,"RuntimeError"),i)}(t[0],t)},Opal.modules["engine/share_pool"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var $=e.top,o=[],s=e.nil,l=(e.const_get_qualified,e.const_get_relative),u=(e.breaker,e.slice,e.module),c=e.klass,p=e.hash2,d=e.truthy,_=e.send;return e.add_stubs(["$include","$attr_reader","$corporations","$bank","$log","$player?","$owner","$raise","$new","$corporation","$ipoed","$floated?","$presidents_share","$ipoed=","$-","$price","$!=","$<<","$name","$format_currency","$par_price","$transfer_shares","$percent","$corporation?","$==","$spend","$*","$cash","$coordinates","$num_shares","$>","$private","$!","$entities","$round","$find_index","$<","$size","$president","$share_holders","$[]","$[]=","$+","$each","$shares","$move_share","$max","$values","$keys","$select","$any?","$min_by","$num_shares_of","$distance","$owner=","$find","$shares_of","$to_proc","$percent_of","$take","$partial?","$first","$delete","$shares_by_corporation"]),$.$require("engine/share_pool.rb/../corporation"),$.$require("engine/share_pool.rb/../share_bundle"),$.$require("engine/share_pool.rb/../share_holder"),function($,o){var f=[u($,"Engine")].concat(o);!function($,$super,o){var u,f,h,y,m,g,b,v,w,k,x=c($,null,"SharePool"),E=[x].concat(o);x.$$prototype.log=x.$$prototype.game=x.$$prototype.bank=s,x.$include(l(E,"ShareHolder")),x.$attr_reader("corporations"),e.def(x,"$initialize",u=function(e){var t=this;return t.game=e,t.corporations=e.$corporations(),t.bank=e.$bank(),t.log=e.$log()},u.$$arity=1),e.def(x,"$name",f=function(){return"Sharepool"},f.$$arity=0),e.def(x,"$buy_share",h=function(n,a,i){var $,o=this,u=s,c=s,f=s,h=s,y=s;if(null==i)i=p([],{});else if(!i.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==($=i.$$smap.exchange)&&($=s),d(a.$owner()["$player?"]())&&o.$raise(l(E,"GameError"),"Cannot buy share from player"),c=(u=(a=l(E,"ShareBundle").$new(a)).$corporation()).$ipoed(),f=u["$floated?"](),d(a.$presidents_share())&&(h=[!0],_(u,"ipoed=",e.to_a(h)),h[t(h.length,1)]),y=a.$price(),d(c["$!="](u.$ipoed()))&&o.log["$<<"](n.$name()+" pars "+u.$name()+" at "+o.game.$format_currency(u.$par_price().$price())),
d($)?(o.log["$<<"](n.$name()+" exchanges "+$.$name()+" for a share of "+u.$name()),o.$transfer_shares(a,n)):(o.log["$<<"](n.$name()+" buys a "+a.$percent()+"% share of "+u.$name()+" from "+(d(a.$owner()["$corporation?"]())?"the IPO":"the market")+" for "+o.game.$format_currency(y)),o.$transfer_shares(a,n,p(["spender","receiver"],{spender:n,receiver:o.bank}))),f["$=="](u["$floated?"]())?s:(o.bank.$spend(r(y,10),u),o.log["$<<"](u.$name()+" floats with "+o.game.$format_currency(u.$cash())+" and tokens "+u.$coordinates()))},h.$$arity=-3),e.def(x,"$sell_shares",y=function(e){var t=this,r=s,a=s;return r=e.$owner(),a=e.$num_shares(),t.log["$<<"](r.$name()+" sells "+a+" share"+(d(n(a,1))?"s":"")+" "+e.$corporation().$name()+" and receives "+t.game.$format_currency(e.$price())),t.$transfer_shares(e,t,p(["spender","receiver"],{spender:t.bank,receiver:r}))},y.$$arity=1),e.def(x,"$player?",m=function(){return!1},m.$$arity=0),e.def(x,"$corporation?",g=function(){return!1},g.$$arity=0),e.def(x,"$company?",b=function(){return!1},b.$$arity=0),x.$private(),e.def(x,"$distance",v=function(e,r){var n,i=this,$=s,o=s,l=s;return d(d(n=e["$!"]())?n:r["$!"]())?0:(o=($=i.game.$round().$entities()).$find_index(e),l=$.$find_index(r),d(a(o,l))?t(l,o):t(l,t(o,$.$size())))},v.$$arity=2),e.def(x,"$transfer_shares",w=function(r,a,$){var o,l,u,c,f,h,y,m,g,b=this,v=s,w=s,k=s,x=s,E=s,O=s,A=s,T=s,S=s,I=s,R=s,C=s;if(null==$)$=p([],{});else if(!$.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(o=$.$$smap.spender)&&(o=s),null==(l=$.$$smap.receiver)&&(l=s),v=r.$corporation(),w=r.$owner(),k=r.$president(),x=r.$percent(),d(w["$player?"]())&&(O=[w,t((E=v.$share_holders())["$[]"](w),x)],_(E,"[]=",e.to_a(O)),O[t(O.length,1)]),d(a["$player?"]())&&(A=v.$share_holders(),O=[a,i(A["$[]"](a),x)],_(A,"[]=",e.to_a(O)),O[t(O.length,1)]),d(d(u=o)?l:u)&&o.$spend(r.$price(),l),_(r.$shares(),"each",[],((c=function(e){var t=c.$$s||this;return null==e&&(e=s),t.$move_share(e,a)}).$$s=b,c.$$arity=1,c)),T=v.$share_holders().$values().$max(),S=_(v.$share_holders(),"select",[],(f=function(e,t){f.$$s;return null==e&&(e=s),null==t&&(t=s),t["$=="](T)},f.$$s=b,f.$$arity=2,f)).$keys(),d(_(S,"any?",[],((h=function(e){h.$$s;return null==e&&(e=s),e["$=="](k)}).$$s=b,h.$$arity=1,h)))?s:(I=_(_(S,"select",[],((y=function(e){y.$$s;return null==e&&(e=s),n(e.$num_shares_of(v),1)}).$$s=b,y.$$arity=1,y)),"min_by",[],((m=function(e){var t=m.$$s||this;return null==e&&(e=s),t.$distance(k,e)}).$$s=b,m.$$arity=1,m)),d(I)?(O=[I],_(v,"owner=",e.to_a(O)),O[t(O.length,1)],b.log["$<<"](I.$name()+" becomes the president of "+v.$name()),d(d(u=w["$=="](I))?u:k["$!"]())?s:(R=d(u=r.$presidents_share())?u:_(k.$shares_of(v),"find",[],"president".$to_proc()),C=d(n(k.$percent_of(v),10))?k:b,_(I.$shares_of(v).$take(2),"each",[],((g=function(e){var t=g.$$s||this;return null==e&&(e=s),t.$move_share(e,C)}).$$s=b,g.$$arity=1,g)),b.$move_share(R,I),d(r["$partial?"]())?b.$move_share(b.$shares_of(v).$first(),w):s)):s)},w.$$arity=-3),e.def(x,"$move_share",k=function(r,n){var a=s,i=s;return a=r.$corporation(),r.$owner().$shares_by_corporation()["$[]"](a).$delete(r),n.$shares_by_corporation()["$[]"](a)["$<<"](r),i=[n],_(r,"owner=",e.to_a(i)),i[t(i.length,1)]},k.$$arity=2)}(f[0],0,f)}(o[0],o)},Opal.modules["engine/token"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass,$=e.hash2;return e.add_stubs(["$attr_reader","$==","$class","$name","$corporation"]),function(t,o){var s=[a(t,"Engine")].concat(o);!function(t,$super,a){var o,s,l,u,c=i(t,null,"Token"),p=[c].concat(a);c.$$prototype.used=c.$$prototype.corporation=r,c.$attr_reader("corporation","price"),e.def(c,"$initialize",o=function(t,r){var n,a=this;if(null==r)r=$([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(n=r.$$smap.price)&&(n=0),a.corporation=t,a.price=n,a.used=!1},o.$$arity=-2),e.def(c,"$used?",s=function(){return this.used},s.$$arity=0),e.def(c,"$use!",l=function(){return this.used=!0},l.$$arity=0),e.def(c,"$==",u=function(e){var t=this;return e.$class()["$=="](n(p,"Token"))?t.corporation.$name()["$=="](e.$corporation().$name()):e.$class()["$=="](n(p,"Token"))},u.$$arity=1)}(s[0],0,s)}(t[0],t)},Opal.modules["engine/stock_market"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var i=e.top,$=[],o=e.nil,s=(e.const_get_qualified,e.const_get_relative),l=(e.breaker,e.slice,e.module),u=e.klass,c=e.send,p=e.truthy;return e.add_stubs(["$attr_reader","$with_index","$map","$from_code","$can_par","$<<","$corporations","$share_price=","$-","$par_price=","$coordinates","$share_price","$<","$+","$size","$[]","$move","$move_up","$>=","$move_down","$private","$==","$delete"]),i.$require("engine/stock_market.rb/../share_price"),function(i,$){var d=[l(i,"Engine")].concat($);!function(i,$super,$){var l,d,_,f,h,y,m,g,b=u(i,null,"StockMarket"),v=[b].concat($);b.$$prototype.market=o,b.$attr_reader("market","par_prices"),e.def(b,"$initialize",l=function(e,t){var r,n=this;return n.par_prices=[],n.market=c(e.$map(),"with_index",[],((r=function(e,n){var a,i=r.$$s||this;return null==e&&(e=o),null==n&&(n=o),c(e.$map(),"with_index",[],((a=function(e,r){var i,$=a.$$s||this,l=o;return null==$.par_prices&&($.par_prices=o),null==e&&(e=o),null==r&&(r=o),l=s(v,"SharePrice").$from_code(e,n,r,t),p((i=l)===o||null==i?o:c(i,"can_par",[]))&&$.par_prices["$<<"](l),l}).$$s=i,a.$$arity=2,a))}).$$s=n,r.$$arity=2,r))},l.$$arity=2),e.def(b,"$set_par",d=function(r,n){var a=o;return n.$corporations()["$<<"](r),a=[n],c(r,"share_price=",e.to_a(a)),a[t(a.length,1)],a=[n],c(r,"par_price=",e.to_a(a)),a[t(a.length,1)]},d.$$arity=2),e.def(b,"$move_right",_=function(t){var a,i,$=this,s=o,l=o;return i=t.$share_price().$coordinates(),s=null==(a=e.to_ary(i))[0]?o:a[0],l=null==a[1]?o:a[1],p(r(n(l,1),$.market["$[]"](s).$size()))?(l=n(l,1),$.$move(t,s,l)):$.$move_up(t)},_.$$arity=1),e.def(b,"$move_up",f=function(r){var n,i,$=this,s=o,l=o;return i=r.$share_price().$coordinates(),s=null==(n=e.to_ary(i))[0]?o:n[0],l=null==n[1]?o:n[1],p(a(t(s,1),0))&&(s=t(s,1)),$.$move(r,s,l)},f.$$arity=1),e.def(b,"$move_down",h=function(t){var a,i,$=this,s=o,l=o;return i=t.$share_price().$coordinates(),s=null==(a=e.to_ary(i))[0]?o:a[0],l=null==a[1]?o:a[1],p(p(a=r(n(s,1),$.market.$size()))?$.$share_price(n(s,1),l):a)&&(s=n(s,1)),$.$move(t,s,l)},h.$$arity=1),e.def(b,"$move_left",y=function(r){var n,i,$=this,s=o,l=o;return i=r.$share_price().$coordinates(),s=null==(n=e.to_ary(i))[0]?o:n[0],l=null==n[1]?o:n[1],p(p(n=a(t(l,1),0))?$.$share_price(s,t(l,1)):n)?(l=t(l,1),$.$move(r,s,l)):$.$move_down(r)},y.$$arity=1),b.$private(),e.def(b,"$move",m=function(r,n,a){var i=o,$=o;return(i=this.$share_price(n,a))["$=="](r.$share_price())?o:(r.$share_price().$corporations().$delete(r),$=[i],c(r,"share_price=",e.to_a($)),$[t($.length,1)],i.$corporations()["$<<"](r))},m.$$arity=3),e.def(b,"$share_price",g=function(e,t){return this.market["$[]"](e)["$[]"](t)},g.$$arity=2)}(d[0],0,d)}($[0],$)},Opal.modules["engine/game"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module);return function(e,t){var n=[r(e,"Engine")].concat(t);!function(e,t){[r(e,"Game")].concat(t)}(n[0],n)}(t[0],t)},Opal.modules["engine/player"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.send;return e.add_stubs(["$include","$attr_reader","$+","$sum","$shares","$to_proc","$==","$name","$count","$companies","$counts_for_limit","$corporation","$class"]),r.$require("engine/player.rb/../passer"),r.$require("engine/player.rb/../share_holder"),r.$require("engine/player.rb/../spender"),function(r,n){var l=[$(r,"Engine")].concat(n);!function(r,$super,n){var $,l,u,c,p,d,_,f,h,y,m,g=o(r,null,"Player"),b=[g].concat(n);g.$$prototype.cash=g.$$prototype.companies=g.$$prototype.name=a,g.$include(i(b,"Passer")),g.$include(i(b,"ShareHolder")),g.$include(i(b,"Spender")),g.$attr_reader("name","companies"),e.def(g,"$initialize",$=function(e){var t=this;return t.name=e,t.cash=0,t.companies=[]},$.$$arity=1),e.def(g,"$value",l=function(){var e=this;return t(t(e.cash,s(e.$shares(),"sum",[],"price".$to_proc())),s(e.companies,"sum",[],"value".$to_proc()))},l.$$arity=0),e.def(g,"$id",u=function(){return this.name},u.$$arity=0),e.def(g,"$owner",c=function(){return this},c.$$arity=0),e.def(g,"$player",p=function(){return this},p.$$arity=0),e.def(g,"$==",d=function(e){var t;return this.name["$=="]((t=e)===a||null==t?a:s(t,"name",[]))},d.$$arity=1),e.def(g,"$player?",_=function(){return!0},_.$$arity=0),e.def(g,"$company?",f=function(){return!1},f.$$arity=0),e.def(g,"$corporation?",h=function(){return!1},h.$$arity=0),e.def(g,"$num_certs",y=function(){var e,r=this;return t(r.$companies().$count(),s(r.$shares(),"count",[],((e=function(t){e.$$s;return null==t&&(t=a),t.$corporation().$counts_for_limit()}).$$s=r,e.$$arity=1,e)))},y.$$arity=0),e.def(g,"$to_s",m=function(){var e=this;return e.$class().$name()+" - "+e.name},m.$$arity=0)}(l[0],0,l)}(n[0],n)},Opal.modules["engine/hex"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.hash,u=e.range,c=e.send,p=e.truthy;return e.add_stubs(["$attr_reader","$freeze","$to_a","$%","$+","$for","$to_i","$index","$[]","$-","$location_name=","$hex=","$each_with_index","$cities","$dup","$reservations","$reservations=","$each","$tokens","$exchange_token","$remove_tokens!","$clear","$x","$y","$connected_paths","$neighbor_direction","$partition","$paths","$include?","$exits","$compact","$map","$to_proc","$select","$branch","$!","$blocks?","$uniq","$flatten","$targeting?","$invert","$class","$==","$coordinates","$name"]),function(n,d){var _=[$(n,"Engine")].concat(d);!function(n,$super,$){var d,_,f,h,y,m,g,b,v,w,k,x,E,O,A=o(n,null,"Hex"),T=[A].concat($);A.$$prototype.coordinates=A.$$prototype.tile=A.$$prototype.location_name=A.$$prototype.layout=A.$$prototype.x=A.$$prototype.y=a,A.$attr_reader("coordinates","layout","neighbors","tile","x","y","location_name"),e.const_set(T[0],"DIRECTIONS",s(["flat","pointy"],{flat:l([0,2],0,[-1,1],1,[-1,-1],2,[0,-2],3,[1,-1],4,[1,1],5),pointy:l([1,1],0,[-1,1],1,[-2,0],2,[-1,-1],3,[1,-1],4,[2,0],5)}).$freeze()),e.const_set(T[0],"LETTERS",u("A","Z",!1).$to_a()),e.defs(A,"$invert",d=function(e){return t(e,3)["$%"](6)},d.$$arity=1),e.def(A,"$initialize",_=function(t,n){var $,o,l,p=this,d=a;if(null==n)n=s([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==($=n.$$smap.layout)&&($="pointy"),null==(o=n.$$smap.tile)&&(o=i(T,"Tile").$for("blank")),null==(l=n.$$smap.location_name)&&(l=a),p.coordinates=t,p.layout=$,p.x=i(T,"LETTERS").$index(p.coordinates["$[]"](0)).$to_i(),p.y=r(p.coordinates["$[]"](u(1,-1,!1)).$to_i(),1),p.neighbors=s([],{}),p.location_name=l,d=[l],c(o,"location_name=",e.to_a(d)),d[r(d.length,1)],p.tile=o,d=[p],c(p.tile,"hex=",e.to_a(d)),d[r(d.length,1)]},_.$$arity=-2),e.def(A,"$id",f=function(){return this.coordinates},f.$$arity=0),e.def(A,"$name",h=function(){return this.coordinates},h.$$arity=0),e.def(A,"$lay",y=function(t){var n,i=this,$=a;return c(i.tile.$cities(),"each_with_index",[],((n=function(i,$){var o,s=n.$$s||this,l=a;return null==i&&(i=a),null==$&&($=a),l=[i.$reservations().$dup()],c(t.$cities()["$[]"]($),"reservations=",e.to_a(l)),l[r(l.length,1)],c(i.$tokens(),"each",[],((o=function(e){o.$$s;return null==e&&(e=a),p(e)?t.$cities()["$[]"]($).$exchange_token(e):a}).$$s=s,o.$$arity=1,o)),i["$remove_tokens!"](),i.$reservations().$clear()}).$$s=i,n.$$arity=2,n)),$=[a],c(i.tile,"hex=",e.to_a($)),$[r($.length,1)],$=[i],c(t,"hex=",e.to_a($)),$[r($.length,1)],$=[i.location_name],c(t,"location_name=",e.to_a($)),$[r($.length,1)],$=[a],c(i.tile,"location_name=",e.to_a($)),$[r($.length,1)],i.tile=t},y.$$arity=1),e.def(A,"$neighbor_direction",m=function(e){var t=this;return i(T,"DIRECTIONS")["$[]"](t.layout)["$[]"]([r(e.$x(),t.x),r(e.$y(),t.y)])},m.$$arity=1),e.def(A,"$connections",g=function(r,n){var i,$,o=this;if(null==n)n=s([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.direct)&&(i=!1),null==($=n.$$smap.corporation)&&($=a),t(o.$connected_paths(r,s(["direct","corporation"],{direct:i,corporation:$})),r.$connected_paths(o,s(["direct","corporation"],{direct:i,corporation:$})))},g.$$arity=-2),e.def(A,"$connected_paths",b=function(r,n){var i,$,o,l,u,d,_=this,f=a,h=a,y=a,m=a;if(null==n)n=s([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.direct)&&(i=!1),null==($=n.$$smap.corporation)&&($=a),f=_.$neighbor_direction(r),l=c(_.tile.$paths(),"partition",[],((u=function(e){u.$$s;return null==e&&(e=a),e.$exits()["$include?"](f)}).$$s=_,u.$$arity=1,u)),h=null==(o=e.to_ary(l))[0]?a:o[0],y=null==o[1]?a:o[1],p(i)?h:(m=c(h,"map",[],"branch".$to_proc()).$compact(),t(h,c(y,"select",[],((d=function(e){d.$$s;var t,r=a;return null==e&&(e=a),r=e.$branch(),p(t=m["$include?"](r))?r["$blocks?"]($)["$!"]():t}).$$s=_,d.$$arity=1,d))))},b.$$arity=-2),e.def(A,"$connected_exits",v=function(t,r){var n,i,$=this;if(null==r)r=s([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(n=r.$$smap.direct)&&(n=!1),null==(i=r.$$smap.corporation)&&(i=a),c($.$connected_paths(t,s(["direct","corporation"],{direct:n,corporation:i})),"map",[],"exits".$to_proc()).$flatten().$uniq()},v.$$arity=-2),e.def(A,"$connected?",w=function(e){var t,r=this;return p(t=r["$targeting?"](e))?e["$targeting?"](r):t},w.$$arity=1),e.def(A,"$targeting?",k=function(e){var t=this,r=a;return r=t.$neighbor_direction(e),t.tile.$exits()["$include?"](r)},k.$$arity=1),e.def(A,"$invert",x=function(e){return this.$class().$invert(e)},x.$$arity=1),e.def(A,"$==",E=function(e){var t;return this.coordinates["$=="]((t=e)===a||null==t?a:c(t,"coordinates",[]))},E.$$arity=1),e.def(A,"$inspect",O=function(){var e=this;return"<"+e.$class().$name()+": "+e.$name()+", tile: "+e.tile.$name()+">"},O.$$arity=0)}(_[0],0,_)}(n[0],n)},Opal.modules["engine/share_price"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass,$=e.truthy,o=e.hash2;return e.add_stubs(["$attr_reader","$!","$==","$to_i","$join","$scan","$include?","$new","$name","$class"]),function(t,s){var l=[a(t,"Engine")].concat(s);!function(t,$super,a){var s,l,u,c,p,d=i(t,null,"SharePrice"),_=[d].concat(a);d.$$prototype.price=d.$$prototype.coordinates=d.$$prototype.unlimited_colors=d.$$prototype.color=r,d.$attr_reader("coordinates","price","color","corporations","can_par"),e.defs(d,"$from_code",s=function(e,t,a,i){var s,l=r,u=r,c=r;return $($(s=e["$!"]())?s:e["$=="](""))?r:(l=e.$scan(/\d/).$join("").$to_i(),u=e["$include?"]("p"),c=$(u)?"red":$(e["$include?"]("b"))?"brown":$(e["$include?"]("o"))?"orange":$(e["$include?"]("y"))?"yellow":r,n(_,"SharePrice").$new([t,a],o(["price","can_par","color","unlimited_colors"],{price:l,can_par:u,color:c,unlimited_colors:i})))},s.$$arity=4),e.def(d,"$initialize",l=function(t,n){var a,i,$,s,l=this;if(null==n)n=o([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(n.$$smap,"price"))throw e.ArgumentError.$new("missing keyword: price");return a=n.$$smap.price,null==(i=n.$$smap.can_par)&&(i=!1),null==($=n.$$smap.color)&&($=r),null==(s=n.$$smap.unlimited_colors)&&(s=[]),l.coordinates=t,l.price=a,l.color=$,l.can_par=i,l.corporations=[],l.unlimited_colors=s},l.$$arity=2),e.def(d,"$id",u=function(){var e=this;return e.price+","+e.coordinates.$join(",")},u.$$arity=0),e.def(d,"$counts_for_limit",c=function(){var e=this;return e.unlimited_colors["$include?"](e.color)["$!"]()},c.$$arity=0),e.def(d,"$to_s",p=function(){var e=this;return e.$class().$name()+" - "+e.price+" "+e.coordinates},p.$$arity=0)}(l[0],0,l)}(t[0],t)},Opal.modules["engine/config/tile"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module),n=e.hash2;return e.add_stubs(["$freeze"]),function(t,a){var i=[r(t,"Engine")].concat(a);!function(t,a){var i=[r(t,"Config")].concat(a);!function(t,a){var i=[r(t,"Tile")].concat(a);e.const_set(i[0],"WHITE",n(["blank","town","city"],{blank:"",town:"t=r:0",city:"c=r:0"}).$freeze()),e.const_set(i[0],"RED",n([],{}).$freeze()),e.const_set(i[0],"YELLOW",n(["1","2","3","4","5","6","7","8","9","55","56","57","58","69","72","73","74","75","76","77","78","79","113","115","128","201","202","235","291","292","293","437","438","445","470","472","621","630","631","632","633","644","645","657","658","659","679","746","790","956","441a"],{1:"t=r:10;t=r:10;p=a:1,b:_0;p=a:_0,b:3;p=a:0,b:_1;p=a:_1,b:4",2:"t=r:10;t=r:10;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_1;p=a:_1,b:2",3:"t=r:10;p=a:0,b:_0;p=a:_0,b:1",4:"t=r:10;p=a:0,b:_0;p=a:_0,b:3",5:"c=r:20;p=a:0,b:_0;p=a:1,b:_0",6:"c=r:20;p=a:0,b:_0;p=a:2,b:_0",7:"p=a:0,b:1",8:"p=a:0,b:2",9:"p=a:0,b:3",55:"t=r:10;t=r:10;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_1;p=a:_1,b:4",56:"t=r:10;t=r:10;p=a:0,b:_0;p=a:_0,b:2;p=a:1,b:_1;p=a:_1,b:3",57:"c=r:20;p=a:0,b:_0;p=a:_0,b:3",58:"t=r:10;p=a:0,b:_0;p=a:_0,b:2",69:"t=r:10;t=r:10;p=a:0,b:_0;p=a:_0,b:3;p=a:2,b:_1;p=a:_1,b:4",72:"t=r:10;p=a:0,b:_0,t:n;p=a:_0,b:1,t:n",73:"t=r:10;p=a:0,b:_0,t:n;p=a:_0,b:2,t:n",74:"t=r:10;p=a:0,b:_0,t:n;p=a:_0,b:3,t:n",75:"c=r:20;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n",76:"c=r:20;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n",77:"p=a:0,b:1,t:n",78:"p=a:0,b:2,t:n",79:"p=a:0,b:3,t:n",113:"c=r:20;p=a:0,b:_0,t:n",115:"c=r:20;p=a:0,b:_0",128:"c=r:40;c=r:40;p=a:0,b:_0;p=a:2,b:_1;l=C",201:"c=r:30;p=a:0,b:_0;p=a:1,b:_0;l=Y",202:"c=r:30;p=a:0,b:_0;p=a:2,b:_0;l=Y",235:"c=r:30;c=r:30;p=a:0,b:_0;l=OO",291:"c=r:40;p=a:0,b:_0;p=a:1,b:_0;l=Z",292:"c=r:40;p=a:0,b:_0;p=a:2,b:_0;l=Z",293:"c=r:40;p=a:0,b:_0;p=a:3,b:_0;l=Z",437:"t=r:30;p=a:0,b:_0;p=a:_0,b:2;l=P",438:"c=r:40;p=a:0,b:_0;p=a:2,b:_0;l=H;u=c:80",445:"t=r:10;p=a:0,b:_0;p=a:_0,b:2",470:"t=r:20;p=a:0,b:_0;p=a:_0,b:3;p=a:0,b:_0;p=a:_0,b:1;p=a:1,b:_0;p=a:_0,b:3",472:"c=r:20;t=r:20;p=a:0,b:_0;p=a:1,b:_1;p=a:2,b:_0;p=a:4,b:_1",621:"c=r:30;p=a:0,b:_0;p=a:_0,b:3;l=Y",630:"t=r:10;t=r:10;p=a:2,b:_0;p=a:_0,b:3;p=a:0,b:_1;p=a:_1,b:4",631:"t=r:10;t=r:10;p=a:3,b:_0;p=a:_0,b:4;p=a:0,b:_1;p=a:_1,b:2",632:"t=r:10;t=r:10;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3",633:"t=r:10;t=r:10;p=a:0,b:_0;p=a:_0,b:1;p=a:3,b:_1;p=a:_1,b:4",644:"c=r:20;p=a:0,b:_0,t:n;p=a:1,b:_0",645:"c=r:20;p=a:0,b:_0,t:n;p=a:2,b:_0",657:"c=r:20;p=a:3,b:_0,t:n;p=a:0,b:_0",658:"c=r:20;p=a:0,b:_0;p=a:2,b:_0,t:n",659:"c=r:20;p=a:0,b:_0;p=a:1,b:_0,t:n",679:"t=r:10;p=a:0,b:_0,t:n;p=a:_0,b:1,t:n",746:"c=r:20;p=a:0,b:_0;p=a:_0,b:3;l=B",790:"c=r:40,s:2;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:4;l=N",956:"c=r:20;p=a:0,b:_0,t:n;p=a:3,b:_0,t:n","441a":"c=r:10;p=a:0,b:_0;l=B"}).$freeze()),e.const_set(i[0],"GREEN",n(["10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","52","53","54","59","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","116","117","120","121","129","141","142","143","144","190","203","204","205","206","207","208","233","234","236","237","238","294","295","296","298","433","439","440","441","442","443","444","457","458","459","460","461","462","463","464","474","475","476","477","514","576","577","578","579","580","581","590","592","602","604","606","612","613","614","615","619","622","624","625","626","637","650","651","653","655","660","661","662","663","664","665","666","667","668","669","670","671","675","677","678","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","747","748","750","751","752","753","756","757","758","759","760","762","763","791","792","793","800","802","887","888","901","904","907","908","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","981","991","53Y","442a","443a"],{10:"c=r:30;c=r:30;p=a:0,b:_0;p=a:3,b:_1",11:"t=r:10;p=a:0,b:_0;p=a:_0,b:2;p=a:2,b:_0;p=a:_0,b:4;p=a:0,b:_0;p=a:_0,b:4;l=HALT",12:"c=r:30;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0",13:"c=r:30;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0",14:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0",15:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",16:"p=a:0,b:2;p=a:1,b:3",17:"p=a:1,b:3;p=a:0,b:4",18:"p=a:0,b:3;p=a:1,b:2",19:"p=a:0,b:3;p=a:2,b:4",20:"p=a:0,b:3;p=a:1,b:4",21:"p=a:0,b:2;p=a:3,b:4",22:"p=a:0,b:4;p=a:2,b:3",23:"p=a:0,b:3;p=a:0,b:4",24:"p=a:0,b:3;p=a:0,b:2",25:"p=a:0,b:2;p=a:0,b:4",26:"p=a:0,b:3;p=a:0,b:5",27:"p=a:0,b:3;p=a:0,b:1",28:"p=a:0,b:4;p=a:0,b:5",29:"p=a:0,b:2;p=a:0,b:1",30:"p=a:0,b:4;p=a:0,b:1",31:"p=a:0,b:2;p=a:0,b:5",52:"c=r:40;c=r:40;p=a:0,b:_0;p=a:2,b:_1",53:"c=r:50;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0;l=B",54:"c=r:60;c=r:60;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3;l=NY",59:"c=r:40;c=r:40;p=a:0,b:_0;p=a:2,b:_1;l=OO",80:"p=a:0,b:j;p=a:1,b:j;p=a:2,b:j",81:"p=a:0,b:j;p=a:2,b:j;p=a:4,b:j",82:"p=a:0,b:j;p=a:1,b:j;p=a:3,b:j",83:"p=a:0,b:j;p=a:5,b:j;p=a:3,b:j",84:"p=a:0,b:1,t:n;p=a:1,b:2,t:n;p=a:0,b:2,t:n",85:"p=a:3,b:5,t:n;p=a:0,b:5,t:n;p=a:0,b:3,t:n",86:"p=a:0,b:1,t:n;p=a:1,b:3,t:n;p=a:0,b:3,t:n",87:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",88:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0",89:"t=r:10;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n",90:"c=r:20,s:2;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",91:"c=r:20,s:2;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0;p=a:4,b:_0,t:n;p=a:5,b:_0,t:n",92:"c=r:20,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0;p=a:5,b:_0",93:"c=r:20,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0,t:n;p=a:4,b:_0;p=a:5,b:_0",94:"c=r:20,s:2;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:2,b:_0;p=a:3,b:_0,t:n",95:"c=r:20,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0;p=a:2,b:_0,t:n;p=a:3,b:_0",96:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n",97:"c=r:30,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0;p=a:3,b:_0",98:"c=r:30,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0,t:n;p=a:4,b:_0",99:"c=r:30,s:2;p=a:0,b:_0,t:n;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",100:"c=r:30;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n",101:"c=r:30;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n;p=a:4,b:_0,t:n",116:"t=r:10;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n",117:"t=r:10;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n",120:"c=r:60;c=r:60;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3;l=T",121:"c=r:50,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0;l=B-L",129:"c=r:60,s:2;c=r:60;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3;l=C",141:"t=r:10;p=a:0,b:_0;p=a:3,b:_0;p=a:1,b:_0",142:"t=r:10;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0",143:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0",144:"t=r:10;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0",190:"c=r:40;c=r:40;c=r:40;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:4;p=a:2,b:_0;p=a:_0,b:5;l=A",203:"t=r:10;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0",204:"t=r:10;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",205:"c=r:30;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0",206:"c=r:30;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0",207:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=Y",208:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Y",233:"p=a:0,b:3,t:d",234:"p=a:0,b:1,t:d",236:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=K",237:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;l=K",238:"c=r:40,s:2;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0;l=K",294:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Z",295:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=Z",296:"c=r:50,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Z",298:"c=r:40;c=r:40;c=r:40;c=r:40;p=a:0,b:_0;p=a:_0,b:1;p=a:0,b:_0;p=a:_0,b:2;p=a:0,b:_0;p=a:_0,b:3;p=a:0,b:_0;p=a:_0,b:4;l=Chi",433:"c=r:50;c=r:50;c=r:50;c=r:50;c=r:50;l=W",439:"c=r:60,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0;l=H;u=c:80",440:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=T",441:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0",442:"c=r:30,s:2;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0",443:"c=r:30,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0",444:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0",457:"c=r:20;c=r:20;p=a:0,b:_0;p=a:_0,b:1;p=a:1,b:_1;p=a:_1,b:3;p=a:0,b:_0;p=a:_0,b:2;p=a:2,b:_1;p=a:_1,b:3",458:"c=r:20;c=r:20;p=a:1,b:_0;p=a:_0,b:4;p=a:0,b:_0;p=a:_0,b:3;p=a:0,b:_0;p=a:_0,b:1;p=a:3,b:_0;p=a:_0,b:4",459:"c=r:20;c=r:20;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:4;p=a:0,b:_0;p=a:_0,b:1;p=a:3,b:_0;p=a:_0,b:4",460:"c=r:20;c=r:20;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:4;p=a:0,b:_0;p=a:_0,b:4;p=a:1,b:_0;p=a:_0,b:3",461:"c=r:20;c=r:20;p=a:0,b:_0;p=a:_0,b:3;p=a:0,b:_0;p=a:_0,b:2;p=a:1,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:2",462:"c=r:20;c=r:20;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:3;p=a:0,b:_0;p=a:_0,b:2;p=a:1,b:_0;p=a:_0,b:2",463:"c=r:20;c=r:20;p=a:0,b:_0;p=a:_0,b:3;p=a:2,b:_0;p=a:_0,b:4;p=a:0,b:_0;p=a:_0,b:4;p=a:2,b:_0;p=a:_0,b:3",464:"c=r:20;c=r:20;p=a:0,b:_0;p=a:_0,b:3;p=a:2,b:_0;p=a:_0,b:4;p=a:0,b:_0;p=a:_0,b:2;p=a:3,b:_0;p=a:_0,b:4",474:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",475:"c=r:30;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0",476:"c=r:30;t=r:30;p=a:4.5,b:_0;p=a:0,b:_1;p=a:2,b:_0;p=a:3,b:_1",477:"c=r:30;t=r:30;p=a:4.5,b:_0;p=a:0,b:_1;p=a:1,b:_0;p=a:2,b:_1;p=a:3,b:_0",514:"c=r:70;c=r:70;c=r:70;c=r:70;c=r:70;c=r:70;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=P",576:"c=r:40;p=a:0,b:_0;p=a:3,b:_0;p=a:1,b:_0;l=Y",577:"c=r:40;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0;l=Y",578:"c=r:40;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=Y",579:"c=r:40;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0;l=Y",580:"c=r:60;c=r:60;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3;l=P",581:"c=r:50;c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_0;p=a:_0,b:3;p=a:4,b:_0;p=a:_0,b:5;l=B-V",590:"c=r:60;c=r:60;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_0;p=a:_0,b:3;p=a:3,b:_0;p=a:_0,b:4;l=Chi",592:"c=r:50,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0;l=B",602:"c=r:30;t=r:30;p=a:0,b:_0;p=a:2,b:_1;p=a:3,b:_0;p=a:4,b:_1;l=V",604:"c=r:100,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=M",606:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=T",612:"c=r:40;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=G",613:"c=r:0;p=a:0,b:_0;p=a:3,b:_0",614:"c=r:0;p=a:0,b:_0;p=a:2,b:_0",615:"c=r:0;p=a:0,b:_0;p=a:1,b:_0",619:"c=r:30,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",622:"c=r:40,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Y",624:"p=a:0,b:1;p=a:1,b:2",625:"p=a:0,b:1;p=a:2,b:3",626:"p=a:0,b:1;p=a:3,b:4",637:"c=r:50;c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:1;p=a:4,b:_0;p=a:_0,b:5;p=a:2,b:_0;p=a:_0,b:3;l=M",650:"p=a:0,b:1,t:n;p=a:1,b:2,t:n",651:"c=r:90,s:2;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0;p=a:4,b:_0;p=a:0,b:_0;l=P",653:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:3,b:_0;l=C",655:"c=r:50,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0;l=M",660:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:3,b:_0;p=a:4,b:_0,t:n",661:"c=r:30,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0;p=a:3,b:_0,t:n;p=a:4,b:_0",662:"c=r:30,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:3,b:_0;p=a:4,b:_0",663:"c=r:30,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0,t:n",664:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0",665:"c=r:30,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0,t:n",666:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:2,b:_0;p=a:3,b:_0,t:n",667:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n",668:"c=r:30,s:2;p=a:0,b:_0;p=a:3,b:_0;p=a:2,b:_0,t:n;p=a:4,b:_0,t:n",669:"c=r:30,s:2;p=a:2,b:_0;p=a:4,b:_0;p=a:0,b:_0,t:n;p=a:3,b:_0,t:n",670:"c=r:30,s:2;p=a:2,b:_0;p=a:3,b:_0;p=a:0,b:_0,t:n;p=a:4,b:_0,t:n",671:"c=r:30,s:2;p=a:3,b:_0;p=a:4,b:_0;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n",675:"c=r:20;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:2,b:_0;l=S",677:"p=a:0,b:3,t:n;p=a:0,b:4,t:n",678:"p=a:0,b:3,t:n;p=a:0,b:2,t:n",680:"t=r:10;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0;p=a:3,b:_0",681:"t=r:10;p=a:0,b:_0,t:n;p=a:1,b:_0;p=a:2,b:_0,t:n;p=a:3,b:_0",682:"t=r:10;p=a:0,b:_0,t:n;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0,t:n",683:"t=r:10;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0",684:"t=r:10;p=a:3,b:_0;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n;p=a:4,b:_0",685:"t=r:10;p=a:2,b:_0;p=a:0,b:_0,t:n;p=a:4,b:_0,t:n;p=a:3,b:_0",686:"t=r:10;p=a:2,b:_0;p=a:0,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0",687:"t=r:10;p=a:0,b:_0;p=a:2,b:_0,t:n;p=a:4,b:_0,t:n;p=a:3,b:_0",688:"t=r:10;p=a:1,b:_0;p=a:0,b:_0,t:n;p=a:4,b:_0,t:n;p=a:3,b:_0",689:"t=r:10;p=a:4,b:_0;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:3,b:_0",690:"t=r:10;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:4,b:_0,t:n;p=a:3,b:_0",691:"t=r:10;p=a:1,b:_0;p=a:0,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0",692:"p=a:0,b:3,t:n;p=a:0,b:5,t:n",693:"p=a:0,b:3,t:n;p=a:0,b:1,t:n",694:"p=a:0,b:4,t:n;p=a:0,b:5,t:n",695:"p=a:0,b:2,t:n;p=a:0,b:1,t:n",699:"p=a:0,b:2,t:n;p=a:0,b:4,t:n",700:"t=r:10;p=a:1,b:_0,t:n;p=a:3,b:_0,t:n;p=a:0,b:_0;p=a:2,b:_0",701:"t=r:10;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:0,b:_0;p=a:1,b:_0",702:"t=r:10;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:0,b:_0;p=a:4,b:_0",703:"t=r:10;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n;p=a:0,b:_0;p=a:2,b:_0",704:"c=r:30,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n",705:"c=r:30,s:2;p=a:0,b:_0;p=a:4,b:_0;p=a:3,b:_0,t:n;p=a:2,b:_0,t:n",706:"c=r:30,s:2;p=a:2,b:_0;p=a:3,b:_0;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n",707:"c=r:30,s:2;p=a:1,b:_0;p=a:3,b:_0;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n",708:"p=a:0,b:4,t:n;p=a:0,b:1,t:n",709:"p=a:0,b:2,t:n;p=a:0,b:5,t:n",710:"p=a:0,b:2,t:n;p=a:1,b:3",711:"p=a:0,b:3,t:n;p=a:2,b:4",712:"p=a:0,b:2;p=a:1,b:3,t:n",713:"p=a:0,b:3;p=a:2,b:4,t:n",714:"p=a:0,b:3;p=a:1,b:4,t:n",715:"p=a:0,b:3,t:n;p=a:1,b:4",747:"t=r:10;p=a:0,b:_0;p=a:_0,b:1",748:"t=r:10;p=a:0,b:_0;p=a:_0,b:2",750:"t=r:0;p=a:0,b:j;p=a:1,b:j;p=a:2,b:j;l=\xa3",751:"t=r:0;p=a:0,b:j;p=a:5,b:j;p=a:3,b:j;l=\xa3",752:"t=r:0;p=a:0,b:j;p=a:1,b:j;p=a:3,b:j;l=\xa3",753:"t=r:0;p=a:0,b:j;p=a:2,b:j;p=a:4,b:j;l=\xa3",756:"c=r:30;p=a:0,b:_0;p=a:1,b:_0",757:"c=r:20;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B",758:"c=r:50;p=a:0,b:_0;p=a:1,b:_0;l=R",759:"c=r:30;p=a:0,b:_0",760:"c=r:40;c=r:40;p=a:0,b:_0;p=a:1,b:_1;l=V",762:"c=r:20;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=B",763:"c=r:50;c=r:30;p=a:1,b:_0;p=a:2,b:_1;p=a:3,b:_0;p=a:4,b:_1;p=a:0,b:_0;l=N",791:"c=r:60,s:3;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:4;p=a:2,b:_0;l=N",792:"c=r:50,s:2;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0;l=Y",793:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;l=Y",800:"t=r:30;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=D&SL",802:"c=r:40,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=D",887:"t=r:20;p=a:1,b:_0;p=a:3,b:_0;p=a:0,b:_0;p=a:2,b:_0",888:"t=r:20;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0",901:"c=r:40;c=r:40;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_0;p=a:_0,b:3",904:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B",907:"c=r:40,s:2;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0;l=Z",908:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;l=Z",957:"p=a:0,b:2,t:n;p=a:1,b:3,t:n",958:"p=a:1,b:3,t:n;p=a:0,b:4,t:n",959:"p=a:0,b:3,t:n;p=a:1,b:2,t:n",960:"p=a:0,b:3,t:n;p=a:2,b:4,t:n",961:"p=a:0,b:3,t:n;p=a:1,b:4,t:n",962:"c=r:30;p=a:0,b:_0,t:n;p=a:5,b:_0,t:n;p=a:3,b:_0,t:n",963:"c=r:30;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:3,b:_0,t:n",964:"c=r:20;c=r:20;p=a:0,b:_0,t:n;p=a:_0,b:1,t:n;p=a:3,b:_0,t:n;p=a:_0,b:4,t:n",965:"c=r:20;c=r:20;p=a:1,b:_0,t:n;p=a:_0,b:3,t:n;p=a:0,b:_0,t:n;p=a:_0,b:4,t:n",966:"c=r:20;c=r:20;p=a:0,b:_0,t:n;p=a:_0,b:2,t:n;p=a:1,b:_0,t:n;p=a:_0,b:3,t:n",967:"c=r:20;c=r:20;p=a:0,b:_0,t:n;p=a:_0,b:2,t:n;p=a:3,b:_0,t:n;p=a:_0,b:4,t:n",968:"c=r:20;c=r:20;p=a:0,b:_0,t:n;p=a:_0,b:3,t:n;p=a:1,b:_0,t:n;p=a:_0,b:2,t:n",969:"c=r:20;c=r:20;p=a:0,b:_0,t:n;p=a:_0,b:3,t:n;p=a:2,b:_0,t:n;p=a:_0,b:4,t:n",970:"c=r:20;c=r:20;p=a:0,b:_0,t:n;p=a:_0,b:3,t:n;p=a:1,b:_0,t:n;p=a:_0,b:4,t:n",971:"c=r:40;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n",972:"c=r:40;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n",973:"c=r:40;p=a:0,b:_0,t:n;p=a:3,b:_0,t:n",974:"c=r:60,s:2;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n;l=B",981:"t=r:10;t=r:10;p=a:0,b:_0;p=a:_0,b:3;p=a:0,b:_1;p=a:_1,b:2",991:"t=r:10;t=r:10;p=a:0,b:_0;p=a:_0,b:3;p=a:0,b:_1;p=a:_1,b:4","53Y":"c=r:50,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0;l=Y","442a":"c=r:30,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B","443a":"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=M"}).$freeze()),
e.const_set(i[0],"BROWN",n(["32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","61","62","63","64","65","66","67","68","70","102","103","104","105","106","107","118","122","125","126","127","130","132","133","135","145","146","147","148","168","169","170","191","193","216","217","239","297","299","448","449","450","451","465","466","480","481","482","483","484","492","515","544","545","546","582","583","584","591","593","603","605","607","609","610","611","616","617","618","623","627","628","629","646","647","648","649","652","654","656","672","673","674","676","696","697","698","764","765","766","767","768","769","770","771","772","773","774","776","777","778","779","780","781","786","794","796","798","801","803","804","902","905","909","911","975","976","977","978","979","980","985","986","987","1064","1065","1066","1067","1068","61Y","444a","891Y"],{32:"c=r:70;c=r:70;c=r:70;c=r:70;c=r:70;c=r:70",33:"c=r:50;c=r:50;c=r:50;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=L",34:"c=r:50;c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:3;p=a:2,b:_0;p=a:4,b:_0;l=BGM",35:"c=r:40;c=r:40;p=a:0,b:_0;p=a:_0,b:2;p=a:1,b:_1;p=a:_1,b:3",36:"c=r:40;c=r:40;p=a:1,b:_0;p=a:_0,b:3;p=a:0,b:_1;p=a:_1,b:4",37:"c=r:40;c=r:40;p=a:0,b:_0;p=a:_0,b:3;p=a:3,b:_1;p=a:0,b:_0",38:"c=r:40,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",39:"p=a:0,b:2;p=a:0,b:1;p=a:1,b:2",40:"p=a:0,b:2;p=a:2,b:4;p=a:0,b:4",41:"p=a:0,b:3;p=a:0,b:1;p=a:1,b:3",42:"p=a:0,b:3;p=a:3,b:5;p=a:0,b:5",43:"p=a:0,b:3;p=a:0,b:2;p=a:1,b:3;p=a:1,b:2",44:"p=a:0,b:3;p=a:1,b:4;p=a:0,b:1;p=a:3,b:4",45:"p=a:0,b:3;p=a:2,b:4;p=a:0,b:4;p=a:2,b:3",46:"p=a:0,b:3;p=a:2,b:4;p=a:3,b:4;p=a:0,b:2",47:"p=a:0,b:3;p=a:1,b:4;p=a:1,b:3;p=a:0,b:4",61:"c=r:60;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B",62:"c=r:80,s:2;c=r:80,s:2;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_0;p=a:_0,b:3;l=NY",63:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",64:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:2;p=a:3,b:_1;p=a:_1,b:4;l=OO",65:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:4;p=a:2,b:_1;p=a:_1,b:3;l=OO",66:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_1;p=a:_1,b:2;l=OO",67:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:3;p=a:2,b:_1;p=a:_1,b:4;l=OO",68:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_1;p=a:_1,b:4;l=OO",70:"p=a:0,b:1;p=a:0,b:2;p=a:1,b:3;p=a:2,b:3",102:"c=r:30,s:2;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d;p=a:5,b:_0,t:d",103:"c=r:40,s:2;p=a:0,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d",104:"c=r:70;c=r:70;c=r:70;c=r:70;c=r:70;c=r:70;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d;p=a:5,b:_0,t:d;l=CP",105:"c=r:40,s:3;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;l=BM",106:"p=a:0,b:j,t:d;p=a:2,b:j,t:d;p=a:4,b:j,t:d;p=a:3,b:j,t:d",107:"p=a:0,b:j,t:d;p=a:1,b:j,t:d;p=a:3,b:j,t:d;p=a:4,b:j,t:d",118:"c=r:40;c=r:40;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3",122:"c=r:80,s:2;c=r:80,s:2;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_0;p=a:_0,b:3;l=T",125:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",126:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=L",127:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B",130:"c=r:100,s:4;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=C",132:"c=r:70;c=r:70;c=r:70;c=r:70;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=C",133:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=M",135:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=KC;l=SL;l=MSP",145:"t=r:20;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0",146:"t=r:20;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",147:"t=r:20;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",148:"t=r:20;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",168:"c=r:30;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0;l=Y",169:"c=r:30;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;l=Y",170:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=P",191:"c=r:60,s:4;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=A",193:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=S",216:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Y",217:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",239:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=K",297:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Z",299:"c=r:70;c=r:70;c=r:70;c=r:70;p=a:0,b:_0;p=a:_0,b:1;p=a:0,b:_0;p=a:_0,b:2;p=a:0,b:_0;p=a:_0,b:3;p=a:0,b:_0;p=a:_0,b:4;l=Chi",448:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",449:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0",450:"c=r:40,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",451:"c=r:60;c=r:60,s:2;c=r:60,s:2;p=a:1,b:_0;p=a:_0,b:4;p=a:2,b:_0;p=a:_0,b:3;p=a:0,b:_0;p=a:_0,b:5",465:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=K",466:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=T",480:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",481:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0",482:"c=r:40,s:2;t=r:40;p=a:4.5,b:_0;p=a:0,b:_1;p=a:1,b:_0;p=a:2,b:_1;p=a:3,b:_0",483:"c=r:40;t=r:40;p=a:4.5,b:_0;p=a:0,b:_1;p=a:1,b:_0;p=a:2,b:_1;p=a:3,b:_0",484:"c=r:40,s:2;t=r:40;p=a:4.5,b:_0;p=a:0,b:_1;p=a:1,b:_0;p=a:2,b:_1",492:"c=r:80,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=H",515:"c=r:90;c=r:90;c=r:90;c=r:90;c=r:90;c=r:90;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=P",544:"p=a:0,b:j;p=a:1,b:j;p=a:3,b:j;p=a:4,b:j",545:"p=a:0,b:j;p=a:1,b:j;p=a:2,b:j;p=a:3,b:j",546:"p=a:0,b:j;p=a:2,b:j;p=a:3,b:j;p=a:4,b:j",582:"c=r:50,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Y",583:"c=r:80,s:2;c=r:80,s:2;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_0;p=a:_0,b:3;l=P",584:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=B-V",591:"c=r:80,s:2;c=r:80,s:2;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_0;p=a:_0,b:3;p=a:3,b:_0;p=a:_0,b:4;l=Chi",593:"c=r:60,s:3;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B",603:"c=r:30;t=r:30;p=a:0,b:_0;p=a:1,b:_1;p=a:2,b:_0;p=a:3,b:_1;p=a:4,b:_0;p=a:5,b:_1;l=V",605:"c=r:150,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=M",607:"c=r:90,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=T",609:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=G",610:"c=r:0;p=a:0,b:_0;p=a:3,b:_0",611:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",616:"c=r:0,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0",617:"c=r:0,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",618:"c=r:0,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",623:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=Y",627:"p=a:0,b:3;p=a:0,b:1;p=a:1,b:2;p=a:2,b:3",628:"p=a:1,b:3;p=a:3,b:4;p=a:0,b:4;p=a:0,b:1",629:"p=a:0,b:2;p=a:2,b:3;p=a:3,b:4;p=a:0,b:4",646:"p=a:0,b:2,t:n;p=a:2,b:4,t:n;p=a:0,b:4,t:n",647:"p=a:0,b:2,t:n;p=a:0,b:1,t:n;p=a:1,b:2,t:n",648:"p=a:0,b:3,t:n;p=a:0,b:1,t:n;p=a:1,b:3,t:n",649:"p=a:0,b:3,t:n;p=a:3,b:5,t:n;p=a:0,b:5,t:n",652:"c=r:130,s:2;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0;l=P",654:"c=r:90,s:2;p=a:2,b:_0,t:d;p=a:0,b:_0;p=a:4,b:_0,t:d;p=a:3,b:_0;l=C",656:"c=r:80,s:2;p=a:2,b:_0;p=a:3,b:_0,t:n;p=a:4,b:_0;p=a:0,b:_0,t:d;l=M",672:"c=r:40,s:2;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d",673:"c=r:40,s:2;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d",674:"c=r:40,s:2;p=a:0,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d",676:"c=r:30,s:2;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0;l=S",696:"t=r:20;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d",697:"t=r:20;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d",698:"t=r:20;p=a:0,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d",764:"t=r:20;p=a:0,b:_0;p=a:_0,b:1",765:"t=r:20;p=a:0,b:_0;p=a:_0,b:3",766:"t=r:20;p=a:0,b:_0;p=a:_0,b:2",767:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",768:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0",769:"t=r:10;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",770:"c=r:30,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B",771:"c=r:50;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0",772:"c=r:40;p=a:0,b:_0;p=a:1,b:_0",773:"c=r:60,s:2;c=r:20;p=a:5,b:_0;p=a:0,b:_1;p=a:1,b:_0;p=a:2,b:_1;p=a:3,b:_0;p=a:4,b:_1;p=a:_1,b:5;l=N",774:"c=r:50;c=r:50;p=a:1,b:_0;p=a:2,b:_1;l=V",776:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",777:"c=r:60;p=a:0,b:_0",778:"p=a:0,b:3;p=a:1,b:5;p=a:2,b:4",779:"p=a:4,b:5;p=a:1,b:3;p=a:0,b:2",780:"p=a:1,b:2;p=a:4,b:5;p=a:0,b:3",781:"p=a:0,b:1;p=a:2,b:3;p=a:4,b:5",786:"c=r:60;p=a:0,b:_0;p=a:1,b:_0;l=R",794:"c=r:80,s:4;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:4;p=a:2,b:_0;p=a:_0,b:5;l=N",796:"c=r:60,s:2;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:4;l=Y",798:"p=a:0,b:3;p=a:1,b:4;p=a:2,b:5",801:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=Y",803:"c=r:50,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=D",804:"c=r:40;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0",902:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=L",905:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=B",909:"c=r:50,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Z",911:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",975:"c=r:40,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n",976:"c=r:40,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n",977:"c=r:40,s:2;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n",978:"c=r:60,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n",979:"c=r:60,s:2;p=a:0,b:_0,t:n;p=a:2,b:_0,t:n;p=a:4,b:_0,t:n",980:"c=r:60,s:2;p=a:0,b:_0,t:n;p=a:5,b:_0,t:n;p=a:3,b:_0,t:n",985:"c=r:60,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:3,b:_0,t:n",986:"c=r:80,s:2;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n;l=B",987:"c=r:90,s:2;p=a:0,b:_0;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0;l=HQG",1064:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:2;p=a:3,b:_1;p=a:_1,b:4",1065:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:4;p=a:2,b:_1;p=a:_1,b:3",1066:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_1;p=a:_1,b:2",1067:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:3;p=a:2,b:_1;p=a:_1,b:4",1068:"c=r:50;c=r:50;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_1;p=a:_1,b:4","61Y":"c=r:60,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Y","444a":"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B\xb7M","891Y":"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=Y"}).$freeze()),e.const_set(i[0],"GRAY",n(["48","49","50","51","60","109","110","111","112","114","123","124","131","134","136","167","171","172","232","240","290","300","446","452","453","454","455","456","513","516","596","597","639","805","806","807","808","895","903","906","910","912","915","988","989","990","1167","1168"],{48:"c=r:100;c=r:100;c=r:100;c=r:100;c=r:100;c=r:100",49:"c=r:70,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=L",50:"c=r:70;c=r:70;c=r:70;p=a:0,b:_0;p=a:_0,b:3;p=a:1,b:_0;p=a:_0,b:2;p=a:4,b:_0;p=a:_0,b:5;l=BGM",51:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",60:"p=a:0,b:j;p=a:1,b:j;p=a:2,b:j;p=a:3,b:j;p=a:4,b:j;p=a:5,b:j",109:"c=r:50,s:2;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d",110:"c=r:100;c=r:100;c=r:100;c=r:100;c=r:100;c=r:100;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;p=a:3,b:_0,t:d;p=a:4,b:_0,t:d;p=a:5,b:_0,t:d;l=CP",111:"c=r:70,s:3;p=a:0,b:_0,t:d;p=a:1,b:_0,t:d;p=a:2,b:_0,t:d;l=BM",112:"p=a:0,b:j,t:d;p=a:1,b:j,t:d;p=a:2,b:j,t:d;p=a:3,b:j,t:d;p=a:4,b:j,t:d",114:"p=a:0,b:2;p=a:2,b:4;p=a:0,b:4;p=a:1,b:3;p=a:3,b:5;p=a:1,b:5",123:"c=r:100,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=H",124:"c=r:100,s:4;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=T",131:"c=r:100,s:4;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=C",134:"c=r:100,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=M",136:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=KC;l=SL;l=MSP",167:"c=r:70;c=r:70;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3;p=a:4,b:_0;p=a:5,b:_1",171:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",172:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",232:"c=r:100;c=r:100;c=r:100;c=r:100;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=C",240:"c=r:80,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=K",290:"c=r:70,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Z",300:"c=r:90;c=r:90;c=r:90;c=r:90;p=a:0,b:_0;p=a:_0,b:1;p=a:0,b:_0;p=a:_0,b:2;p=a:0,b:_0;p=a:_0,b:3;p=a:0,b:_0;p=a:_0,b:4;l=Chi",446:"c=r:70,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=B",452:"p=a:0,b:3;p=a:2,b:4;p=a:0,b:4;p=a:0,b:2;p=a:2,b:3;p=a:3,b:4",453:"p=a:0,b:3;p=a:1,b:4;p=a:1,b:3;p=a:0,b:4;p=a:0,b:1;p=a:3,b:4",454:"p=a:0,b:3;p=a:1,b:3;p=a:0,b:2;p=a:0,b:1;p=a:1,b:2;p=a:2,b:3",455:"c=r:50,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",456:"c=r:70,s:5;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",513:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",516:"c=r:120;c=r:120;c=r:120;c=r:120;c=r:120;c=r:120;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=P",596:"c=r:60,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=L",597:"c=r:80,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=B",639:"c=r:100,s:4;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=M",805:"c=r:60,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=D",806:"t=r:10;p=a:0,b:_0;p=a:5,b:_0;p=a:3,b:_0",807:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0",808:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0",895:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",903:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;l=L",906:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=B",910:"c=r:60,s:4;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=Z",912:"t=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0",915:"c=r:50,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",988:"c=r:50,s:3;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n",989:"c=r:70,s:3;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n",990:"c=r:100,s:3;p=a:0,b:_0,t:n;p=a:1,b:_0,t:n;p=a:2,b:_0,t:n;p=a:3,b:_0,t:n;p=a:4,b:_0,t:n;p=a:5,b:_0,t:n;l=B",1167:"c=r:70;c=r:70;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3;p=a:4,b:_0;p=a:5,b:_1",1168:"c=r:60,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0"}).$freeze()),e.const_set(i[0],"GREENBROWN",n(["119"],{119:"c=r:30,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0"}).$freeze()),e.const_set(i[0],"BROWNGRAY",n(["166","1200"],{166:"c=r:40,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",1200:"c=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:4,b:_0;p=a:5,b:_0"}).$freeze()),e.const_set(i[0],"BLUE",n(["241"],{241:"p=a:2,b:_0;p=a:3,b:_0"}).$freeze()),e.const_set(i[0],"NONE",n(["467","468","469"],{467:"p=a:0,b:3,t:n",468:"p=a:0,b:2,t:n",469:"p=a:0,b:1,t:n"}).$freeze()),e.const_set(i[0],"COLORS",["white","yellow","green","brown","gray","greenbrown","browngray","blue","none","red"].$freeze())}(i[0],i)}(i[0],i)}(t[0],t)},Opal.modules["engine/config/game/g_1889"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified),a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.hash,o=e.hash2;return e.add_stubs(["$extend","$freeze","$load_phases","$load_companies"]),t.$require("engine/config/game/g_1889.rb/../load"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Config")].concat(r);!function(t,r){var s=[i(t,"Game")].concat(r);!function(t,r){var s=i(t,"G1889"),l=[s].concat(r);s.$extend(n(a(l,"Game"),"Load")),e.const_set(l[0],"CURRENCY_FORMAT_STR","\xa5%d"),e.const_set(l[0],"BANK_CASH",7e3),e.const_set(l[0],"CERT_LIMIT",$(2,25,3,19,4,14,5,12,6,11).$freeze()),e.const_set(l[0],"STARTING_CASH",$(2,420,3,420,4,420,5,390,6,390).$freeze()),e.const_set(l[0],"HEXES",o(["white","yellow","gray","red","green"],{white:$(["D3","H3","J3","B5","C8","E8","I8","D9","I10"],"blank",["F3","G4","H7","A10","J11","G12","E2","I2","K8","C10"],"city",["J5","G10","J9","I12","B11"],"town",["K6"],"u=c:80,t:water",["H5","I6"],"u=c:80,t:water+mountain",["E4","D5","F5","C6","E6","G6","D7","F7","A8","G8","B9","H9","H11","H13"],"u=c:80,t:mountain",["I4"],"c=r:0;l=H;u=c:80"),yellow:$(["C4"],"c=r:20;p=a:2,b:_0",["K4"],"c=r:30;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;l=T"),gray:$(["B7"],"c=r:40,s:2;p=a:1,b:_0;p=a:3,b:_0;p=a:5,b:_0",["B3"],"t=r:20;p=a:0,b:_0;p=a:_0,b:5",["G14"],"t=r:20;p=a:3,b:_0;p=a:_0,b:4",["J7"],"p=a:1,b:5"),red:$(["F1"],"o=r:yellow_30|brown_60|diesel_100;p=a:0,b:_0;p=a:1,b:_0",["J1"],"o=r:yellow_20|brown_40|diesel_80;p=a:0,b:_0;p=a:1,b:_0",["L7"],"o=r:yellow_20|brown_40|diesel_80;p=a:1,b:_0;p=a:2,b:_0"),green:$(["F9"],"c=r:30,s:2;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=K;u=c:80,t:water")}).$freeze()),e.const_set(l[0],"TILES",o(["3","5","6","7","8","9","12","13","14","15","16","19","20","23","24","25","26","27","28","29","39","40","41","42","45","46","47","57","58","205","206","437","438","439","440","448","465","466","492","611"],{3:2,5:2,6:2,7:2,8:5,9:5,12:1,13:1,14:1,15:3,16:1,19:1,20:1,23:2,24:2,25:1,26:1,27:1,28:1,29:1,39:1,40:1,41:1,42:1,45:1,46:1,47:1,57:2,58:3,205:1,206:1,437:1,438:1,439:1,440:1,448:4,465:1,466:1,492:1,611:2}).$freeze()),e.const_set(l[0],"LOCATION_NAMES",o(["F3","G4","H7","A10","J11","G12","E2","I2","K8","C10","J5","G10","J9","I12","B11","I4","C4","K4","B7","B3","G14","F1","J1","L7","F9"],{F3:"Saijou",G4:"Niihama",H7:"Ikeda",A10:"Sukumo",J11:"Anan",G12:"Nahari",E2:"Matsuyama",I2:"Marugame",K8:"Tokushima",C10:"Kubokawa",J5:"Ritsurin Kouen",G10:"Nangoku",J9:"Komatsujima",I12:"Muki",B11:"Nakamura",I4:"Kotohira",C4:"Ohzu",K4:"Takamatsu",B7:"Uwajima",B3:"Yawatahama",G14:"Muroto",F1:"Imabari",J1:"Sakaide & Okayama",L7:"Naruto & Awaji",F9:"Kouchi"}).$freeze()),e.const_set(l[0],"MARKET",[["75","80","90","100p","110","125","140","155","175","200","225","255","285","315","350"],["70","75","80","90p","100","110","125","140","155","175","200","225","255","285","315"],["65","70","75","80p","90","100","110","125","140","155","175","200"],["60","65","70","75p","80","90","100","110","125","140"],["55","60","65","70p","75","80","90","100"],["50y","55","60","65p","70","75","80"],["45y","50y","55","60","65","70"],["40y","45y","50y","55","60"],["30o","40y","45y","50y"],["20o","30o","40y","45y"],["10o","20o","30o","40y"]].$freeze()),e.const_set(l[0],"PHASES",s.$load_phases('[\n  {\n    "name": "2",\n    "train_limit": 4,\n    "tiles": [\n      "yellow"\n    ],\n    "operating_rounds": 1\n  },\n  {\n    "name": "3",\n    "on": "3",\n    "train_limit": 4,\n    "tiles": [\n      "yellow",\n      "green"\n    ],\n    "operating_rounds": 2,\n    "buy_companies": true\n  },\n  {\n    "name": "4",\n    "on": "4",\n    "train_limit": 3,\n    "tiles": [\n      "yellow",\n      "green"\n    ],\n    "operating_rounds": 2,\n    "buy_companies": true\n  },\n  {\n    "name": "5",\n    "on": "5",\n    "train_limit": 2,\n    "tiles": [\n      "yellow",\n      "green",\n      "brown"\n    ],\n    "operating_rounds": 3,\n    "events": {\n      "close_companies": true\n    }\n  },\n  {\n    "name": "6",\n    "on": "6",\n    "train_limit": 2,\n    "tiles": [\n      "yellow",\n      "green",\n      "brown"\n    ],\n    "operating_rounds": 3\n  },\n  {\n    "name": "D",\n    "on": "D",\n    "train_limit": 2,\n    "tiles": [\n      "yellow",\n      "green",\n      "brown"\n    ],\n    "operating_rounds": 3\n  }\n]\n')),e.const_set(l[0],"TRAINS",[o(["name","distance","price","rusts_on","num"],{name:"2",distance:2,price:80,rusts_on:"4",num:6}),o(["name","distance","price","rusts_on","num"],{name:"3",distance:3,price:180,rusts_on:"6",num:5}),o(["name","distance","price","rusts_on","num"],{name:"4",distance:4,price:300,rusts_on:"D",num:4}),o(["name","distance","price","num"],{name:"5",distance:5,price:450,num:3}),o(["name","distance","price","num"],{name:"6",distance:6,price:630,num:2}),o(["name","distance","price","num","available_on","discount"],{name:"D",distance:999,price:1100,num:99,available_on:"6",discount:o(["4","5","6"],{4:300,5:300,6:300})})].$freeze()),e.const_set(l[0],"COMPANIES",s.$load_companies('[\n  {\n    "name": "Takamatsu E-Railroad",\n    "value": 20,\n    "revenue": 5,\n    "desc": "Blocks Takamatsu (K4).",\n    "sym": "TR",\n    "abilities": [\n      {\n        "type": "blocks_hexes",\n        "hexes": [\n          "K4"\n        ]\n      }\n    ]\n  },\n  {\n    "name": "Mitsubishi Ferry",\n    "value": 30,\n    "revenue": 5,\n    "desc": "Player owner may place the port tile on a coastal town (B11, G10, I12, or J9) without a tile on it already, outside of the operating rounds of a company controller by another player. The player need not control a company or have connectivity to the placed tile from one of their companies. This does not close the company.",\n    "sym": "MF",\n    "abilities": [\n      {\n        "type": "tile_lay",\n        "hexes": [\n          "B11",\n          "G10",\n          "I12",\n          "J9"\n        ],\n        "tiles": [\n          "437"\n        ],\n        "owner_type": "player"\n      }\n    ]\n  },\n  {\n    "name": "Ehime Railway",\n    "value": 40,\n    "revenue": 10,\n    "desc": "When this company is sold to a corporation, the selling player may immediately place a green tile on Ohzu (C4), in addition to any tile which it may lay during the same operating round. This does not close the company.",\n    "sym": "ER",\n    "abilities": [\n      {\n        "type": "blocks_hexes",\n        "hexes": [\n          "C4"\n        ]\n      },\n      {\n        "type": "tile_lay",\n        "hexes": [\n          "C4"\n        ],\n        "tiles": [\n          "12",\n          "13",\n          "14",\n          "15",\n          "205",\n          "206"\n        ],\n        "when": "sold",\n        "owner_type": "corporation"\n      }\n    ]\n  },\n  {\n    "name": "Sumitomo Mines Railway",\n    "value": 50,\n    "revenue": 15,\n    "desc": "Owning corporation may ignore building cost for mountain hexes which do not also contain rivers. This does not close the company.",\n    "abilities": [\n      {\n        "type": "ignore_terrain",\n        "terrain": "mountain",\n        "owner_type": "corporation"\n      }\n    ]\n  },\n  {\n    "name": "Dougo Railway",\n    "value": 60,\n    "revenue": 15,\n    "desc": "Owning player may exchange this private company for a 10% share of Iyo Railway from the initial offering.",\n    "abilities": [\n      {\n        "type": "exchange",\n        "corporation": "IR",\n        "owner_type": "player"\n      }\n    ]\n  },\n  {\n    "name": "South Iyo Railway",\n    "value": 80,\n    "revenue": 20,\n    "desc": "",\n    "min_players": 3\n  },\n  {\n    "name": "Uno-Takamatsu Ferry",\n    "value": 150,\n    "revenue": 30,\n    "desc": "Does not close while owned by a player. If owned by a player when the first 5-train is purchased it may no longer be sold to a public company and the revenue is increased to 50.",\n    "min_players": 4,\n    "abilities": [\n      {\n        "type": "never_closes",\n        "owner_type": "player"\n      },\n      {\n        "type": "revenue_change",\n        "revenue": 50,\n        "when": "5",\n        "owner_type": "player"\n      }\n    ]\n  }\n]\n')),e.const_set(l[0],"CORPORATIONS",[o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"AR",logo:"1889/AR",name:"Awa Railroad",tokens:[0,40],float_percent:50,coordinates:"K8",color:"#37383a"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"IR",logo:"1889/IR",name:"Iyo Railway",tokens:[0,40],float_percent:50,coordinates:"E2",color:"#f48221"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"SR",logo:"1889/SR",name:"Sanuki Railway",tokens:[0,40],float_percent:50,coordinates:"I2",color:"#76a042"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"KO",logo:"1889/KO",name:"Takamatsu & Kotohira Electric Railway",tokens:[0,40],float_percent:50,coordinates:"K4",color:"#d81e3e"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"TR",logo:"1889/TR",name:"Tosa Electric Railway",tokens:[0,40,40],float_percent:50,coordinates:"F9",color:"#00a99e"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"KU",logo:"1889/KU",name:"Tosa Kuroshio Railway",tokens:[0],float_percent:50,coordinates:"C10",color:"#0189d1"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"UR",logo:"1889/UR",name:"Uwajima Railway",tokens:[0,40,40],float_percent:50,coordinates:"B7",color:"#7b352a"})].$freeze())}(s[0],s)}(s[0],s)}(s[0],s)}(r[0],r)},Opal.modules["engine/config/game/load"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.hash2,o=e.send,s=e.truthy;return e.add_stubs(["$parse","$map","$[]","$to_proc","$[]=","$-","$freeze","$transform_values","$respond_to?","$to_sym"]),function(r,l){var u=[i(r,"Engine")].concat(l);!function(r,l){var u=[i(r,"Config")].concat(l);!function(r,l){var u=[i(r,"Game")].concat(l);!function(r,l){var u,c,p=i(r,"Load"),d=[p].concat(l);e.def(p,"$load_phases",u=function(r){var i,s=this,l=n;return l=a(d,"JSON").$parse(r,$(["symbolize_names"],{symbolize_names:!0})),o(l,"map",[],((i=function(r){i.$$s;var a=n;return null==r&&(r=n),a=["tiles",o(r["$[]"]("tiles"),"map",[],"to_sym".$to_proc())],o(r,"[]=",e.to_a(a)),a[t(a.length,1)]}).$$s=s,i.$$arity=1,i)),l.$freeze()},u.$$arity=1),e.def(p,"$load_companies",c=function(r){var i,l=this,u=n;return u=a(d,"JSON").$parse(r,$(["symbolize_names"],{symbolize_names:!0})),o(u,"map",[],((i=function(r){var a,$,l=i.$$s||this,u=n;return null==r&&(r=n),u=["abilities",o(s(a=r["$[]"]("abilities"))?a:[],"map",[],($=function(e){var t,r=$.$$s||this;return null==e&&(e=n),o(e,"transform_values",[],((t=function(e){t.$$s;return null==e&&(e=n),s(e["$respond_to?"]("to_sym"))?e.$to_sym():e}).$$s=r,t.$$arity=1,t))},$.$$s=l,$.$$arity=1,$))],o(r,"[]=",e.to_a(u)),u[t(u.length,1)],r}).$$s=l,i.$$arity=1,i)),u.$freeze()},c.$$arity=1)}(u[0],u)}(u[0],u)}(u[0],u)}(r[0],r)},Opal.modules["engine/config/game/g_18_chesapeake"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified),a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.hash,o=e.hash2;return e.add_stubs(["$extend","$freeze","$load_phases","$load_companies"]),t.$require("engine/config/game/g_18_chesapeake.rb/../load"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Config")].concat(r);!function(t,r){var s=[i(t,"Game")].concat(r);!function(t,r){var s=i(t,"G18Chesapeake"),l=[s].concat(r);s.$extend(n(a(l,"Game"),"Load")),e.const_set(l[0],"CURRENCY_FORMAT_STR","$%d"),e.const_set(l[0],"BANK_CASH",8e3),e.const_set(l[0],"CERT_LIMIT",$(2,20,3,20,4,16,5,13,6,11).$freeze()),e.const_set(l[0],"STARTING_CASH",$(2,1200,3,800,4,600,5,480,6,400).$freeze()),e.const_set(l[0],"HEXES",o(["white","red","gray","yellow"],{white:$(["B6","B8","B10","C3","C7","C9","C11","E7","E9","E13","F6","F12","G7","I7","J8","J10","L4","F4","G5","H2","I3"],"blank",["B12","D4","D6","D10","E5"],"u=c:80,t:mountain",["F10","G9","G11","H12"],"u=c:40,t:water",["B4","K3","K5"],"t=r:0;t=r:0",["C5","D12","E3","F2","G13","J2"],"city",["C13","D2","D8"],"c=r:0;u=c:80,t:mountain",["E11"],"town",["F8"],"c=r:0;l=DC",["G3","I5"],"t=r:0;u=c:40,t:water",["H4","J6"],"c=r:0;u=c:40,t:water"),red:$(["A1","A15"],"blank",["A3"],"c=r:0;p=a:5,b:j",["B2"],"o=r:yellow_40|green_50|brown_60|gray_80;p=a:0,b:_0",["A7"],"o=r:yellow_40|green_60|brown_80|gray_100;p=a:4,b:_0;p=a:5,b:_0",["A13"],"p=a:4,b:j",["B14"],"o=r:yellow_40|green_50|brown_60|gray_80;p=a:3,b:_0;p=a:4,b:_0",["H14"],"o=r:yellow_20|green_40|brown_50|gray_60;p=a:2,b:_0",["L2"],"o=r:yellow_40|green_60|brown_80|gray_100;p=a:0,b:_0;p=a:1,b:_0"),gray:$(["E1"],"p=a:1,b:5",["F14"],"p=a:3,b:4",["G1"],"p=a:1,b:5;p=a:0,b:1",["I9"],"t=r:30;p=a:3,b:_0;p=a:_0,b:5",["K1"],"t=r:30;p=a:0,b:_0;p=a:_0,b:1",["K7"],"p=a:2,b:3"),yellow:$(["H6"],"c=r:30;c=r:30;p=a:1,b:_0;p=a:4,b:_1;l=OO;u=c:40,t:water",["J4"],"c=r:30;c=r:30;p=a:0,b:_0;p=a:3,b:_1;l=OO")}).$freeze()),e.const_set(l[0],"TILES",o(["1","2","3","4","7","8","9","14","15","16","19","20","23","24","25","26","27","28","29","39","40","41","42","43","44","45","46","47","55","56","57","58","69","70","611","915","X1","X2","X3","X4","X5","X6","X7","X8","X9"],{1:1,2:1,3:2,4:2,7:2,8:12,9:9,14:5,15:6,16:1,19:1,20:1,23:3,24:3,25:2,26:1,27:1,28:1,29:1,39:1,40:1,41:1,42:1,43:2,44:1,45:1,46:1,47:2,55:1,56:1,57:7,58:2,69:1,70:1,611:5,915:1,X1:o(["count","color","code"],{count:1,color:"yellow",code:"c=r:30;p=a:0,b:_0;p=a:4,b:_0;l=DC"}),X2:o(["count","color","code"],{count:1,color:"green",code:"c=r:40,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:1,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=DC"}),X3:o(["count","color","code"],{count:1,color:"green",code:"c=r:40;c=r:40;p=a:0,b:_0;p=a:_0,b:2;p=a:3,b:_1;p=a:_1,b:5;l=OO"}),X4:o(["count","color","code"],{count:1,color:"green",code:"c=r:40;c=r:40;p=a:0,b:_0;p=a:_0,b:1;p=a:2,b:_1;p=a:_1,b:3;l=OO"}),X5:o(["count","color","code"],{count:1,color:"green",code:"c=r:40;c=r:40;p=a:3,b:_0;p=a:_0,b:5;p=a:0,b:_1;p=a:_1,b:4;l=OO"}),X6:o(["count","color","code"],{count:1,color:"brown",code:"c=r:70,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=DC"}),X7:o(["count","color","code"],{count:2,color:"brown",code:"c=r:50,s:2;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:5,b:_0;p=a:4,b:_0;l=OO"}),X8:o(["count","color","code"],{count:1,color:"gray",code:"c=r:100,s:4;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=DC"}),X9:o(["count","color","code"],{count:1,color:"gray",code:"c=r:70,s:3;p=a:0,b:_0;p=a:1,b:_0;p=a:2,b:_0;p=a:4,b:_0;p=a:5,b:_0;l=OO"})}).$freeze()),e.const_set(l[0],"LOCATION_NAMES",o(["B2","A7","B14","B4","C5","C13","D2","D8","D12","E3","E11","F2","F8","G3","G13","H4","H6","H14","I5","J2","J4","J6","K3","K5","L2"],{B2:"Pittsburgh",A7:"Ohio",B14:"West Virginia Coal",B4:"Charleroi & Connellsville",C5:"Green Spring",C13:"Lynchburg",D2:"Berlin",D8:"Leesburg",D12:"Charlottesville",E3:"Hagerstown",E11:"Fredericksburg",F2:"Harrisburg",F8:"Washington DC",G3:"Columbia",G13:"Richmond",H4:"Strasburg",H6:"Baltimore",H14:"Norfolk",I5:"Wilmington",J2:"Allentown",J4:"Philadelphia",J6:"Camden",K3:"Trenton & Amboy",K5:"Burlington & Princeton",L2:"New York"}).$freeze()),e.const_set(l[0],"MARKET",[["80","85","90","100","110","125","140","160","180","200","225","250","275","300","325","350","375"],["75","80","85","90","100","110","125","140","160","180","200","225","250","275","300","325","350"],["70","75","80","85","95p","105","115","130","145","160","180","185","200"],["65","70","75","80p","85","95","105","115","130","145"],["60","65","70p","75","80","85","90","95","105"],["55y","60","65","70","75","80"],["50y","55y","60","65"],["40y","45y","50y"]].$freeze()),e.const_set(l[0],"PHASES",s.$load_phases('[\n  {\n    "name": "2",\n    "train_limit": 4,\n    "tiles": [\n      "yellow"\n    ],\n    "operating_rounds": 1\n  },\n  {\n    "name": "3",\n    "on": "3",\n    "train_limit": 4,\n    "tiles": [\n      "yellow",\n      "green"\n    ],\n    "operating_rounds": 2,\n    "buy_companies": true\n  },\n  {\n    "name": "4",\n    "on": "4",\n    "train_limit": 3,\n    "tiles": [\n      "yellow",\n      "green"\n    ],\n    "operating_rounds": 2,\n    "buy_companies": true\n  },\n  {\n    "name": "5",\n    "on": "5",\n    "train_limit": 2,\n    "tiles": [\n      "yellow",\n      "green",\n      "brown"\n    ],\n    "operating_rounds": 3,\n    "events": {\n      "close_companies": true\n    }\n  },\n  {\n    "name": "6",\n    "on": "6",\n    "train_limit": 2,\n    "tiles": [\n      "yellow",\n      "green",\n      "brown"\n    ],\n    "operating_rounds": 3\n  },\n  {\n    "name": "D",\n    "on": "D",\n    "train_limit": 2,\n    "tiles": [\n      "yellow",\n      "green",\n      "brown"\n    ],\n    "operating_rounds": 3\n  }\n]\n')),e.const_set(l[0],"TRAINS",[o(["name","distance","price","rusts_on","num"],{name:"2",distance:2,price:80,rusts_on:"4",num:7}),o(["name","distance","price","rusts_on","num"],{name:"3",distance:3,price:180,rusts_on:"6",num:6}),o(["name","distance","price","rusts_on","num"],{name:"4",distance:4,price:300,rusts_on:"D",num:5}),o(["name","distance","price","num"],{name:"5",distance:5,price:500,num:3}),o(["name","distance","price","num"],{name:"6",distance:6,price:630,num:2}),o(["name","distance","price","num","available_on","discount"],{name:"D",distance:999,price:900,num:99,available_on:"6",discount:o(["4","5","6"],{
4:200,5:200,6:200})})].$freeze()),e.const_set(l[0],"COMPANIES",s.$load_companies('[\n  {\n    "name": "Delaware and Raritan Canal",\n    "value": 20,\n    "revenue": 5,\n    "description": "No special ability. Blocks hex K3 while owned by a player. Companies may purchase P1 - P5 from a player for half to double the face value.",\n    "sym": "D&R",\n    "abilities": [\n      {\n        "type": "blocks_hexes",\n        "hexes": [\n          "K3"\n        ]\n      }\n    ]\n  },\n  {\n    "name": "Columbia - Philadelphia Railroad",\n    "value": 40,\n    "revenue": 10,\n    "description": "Blocks hexes H2 and I3 while owned by a player. The owning company may lay two connected tiles in hexes H2 and I3. Only #8 and #9 tiles may be used. If any tiles are played in these hexes other than by using this ability, the ability is forfeit. These tiles may be placed even if the owning company does not have a route to the hexes. These tiles are laid during the tile laying step and are in addition to the company\u2019s tile placement action.",\n    "sym": "C-P",\n    "abilities": [\n      {\n        "type": "blocks_hexes",\n        "hexes": [\n          "H2",\n          "I3"\n        ]\n      }\n    ]\n  },\n  {\n    "name": "Baltimore and Susquehanna Railroad",\n    "value": 50,\n    "revenue": 10,\n    "description": "Blocks hexes F4 and G5 while owned by a player. The owning company may lay two connected tiles in hexes F4 and G5. Only #8 and #9 tiles may be used. If any tiles are played in these hexes other than by using this ability, the ability is forfeit. These tiles may be placed even if the owning company does not have a route to the hexes. These tiles are laid during the tile laying step and are in addition to the company\u2019s tile placement action.",\n    "sym": "B&S",\n    "abilities": [\n      {\n        "type": "blocks_hexes",\n        "hexes": [\n          "F4",\n          "G5"\n        ]\n      }\n    ]\n  },\n  {\n    "name": "Chesapeake and Ohio Canal",\n    "value": 80,\n    "revenue": 15,\n    "description": "Blocks hex D2 while owned by a player.Owning company may place a tile in hex D2.The company does not need to have a route to this hex.The tile placed counts as the company\u2019 s tile lay action and the company must pay the terrain cost.The company may then immediately place a station token free of charge.",\n    "sym": "C&OC",\n    "abilities": [\n      {\n        "type": "blocks_hexes",\n        "hexes": [\n          "D2"\n        ]\n      }\n    ]\n  },\n  {\n    "name": "Baltimore & Ohio Railroad",\n    "value": 100,\n    "revenue": 0,\n    "description": "During game setup place one share of the Baltimore & Ohio public company with this certificate.The player purchasing this private immediately takes both the private company and the B & O share.This private company has no other special ability."\n  },\n  {\n    "name": "Cornelius Vanderbilt",\n    "value": 200,\n    "revenue": 30,\n    "description": "During game setup select a random president\u2019s certificate and place it with this certificate.The player purchasing this private company takes both this certificate and the randomly selected president\u2019 s certificate.The player immediately sets the par value of the public company.This private closes when the associated public company buys it\u2019s first train."\n  }\n]\n')),e.const_set(l[0],"CORPORATIONS",[o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"PRR",logo:"18_chesapeake/PRR",name:"Pennsylvania Railroad",tokens:[0,40,60,80],float_percent:60,coordinates:"F2",color:"#237333"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"PLE",logo:"18_chesapeake/PLE",name:"Pittsburgh and Lake Erie Railroad",tokens:[0,40,60],float_percent:60,coordinates:"A3",color:"#9a9a9d"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"SRR",logo:"18_chesapeake/SRR",name:"Strasburg Rail Road",tokens:[0,40,60],float_percent:60,coordinates:"H4",color:"#d81e3e"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"B&O",logo:"18_chesapeake/BO",name:"Baltimore & Ohio Railroad",tokens:[0,40,60],float_percent:60,coordinates:"H6",color:"#0189d1"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"C&O",logo:"18_chesapeake/CO",name:"Chesapeake & Ohio Railroad",tokens:[0,40,60,80],float_percent:60,coordinates:"G13",color:"#37b2e2"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"LV",logo:"18_chesapeake/LV",name:"Lehigh Valley Railroad",tokens:[0,40],float_percent:60,coordinates:"J2",color:"#f8c200"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"C&A",logo:"18_chesapeake/CA",name:"Camden & Amboy Railroad",tokens:[0,40],float_percent:60,coordinates:"J6",color:"#f48221"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"NW",logo:"18_chesapeake/NW",name:"Norfolk & Western Railway",tokens:[0,40,60],float_percent:60,coordinates:"C13",color:"#7b352a"})].$freeze())}(s[0],s)}(s[0],s)}(s[0],s)}(r[0],r)},Opal.modules["engine/route"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.truthy,l=e.hash2,u=e.send;return e.add_stubs(["$attr_reader","$clear","$last","$!","$connected?","$raise","$name","$<<","$concat","$connections","$&","$uniq","$compact","$map","$to_proc","$stops","$<","$size","$distance","$sum","$route_revenue"]),r.$require("engine/route.rb/../game_error"),function(r,n){var c=[$(r,"Engine")].concat(n);!function(r,$super,n){var $,c,p,d,_,f,h=o(r,null,"Route"),y=[h].concat(n);h.$$prototype.hexes=h.$$prototype.paths=h.$$prototype.train=a,h.$attr_reader("hexes","paths","phase","train"),e.def(h,"$initialize",$=function(e,t){var r=this;return r.hexes=[],r.paths=[],r.phase=e,r.train=t},$.$$arity=2),e.def(h,"$reset!",c=function(){var e=this;return e.hexes.$clear(),e.paths.$clear()},c.$$arity=0),e.def(h,"$add_hex",p=function(e){var t,r=this,n=a;return s(s(t=n=r.hexes.$last())?e["$connected?"](n)["$!"]():t)&&r.$raise(i(y,"GameError"),"Cannot use "+e.$name()+" in route because it is not connected"),r.hexes["$<<"](e),s(n)?r.paths.$concat(e.$connections(n,l(["direct"],{direct:!0}))):a},p.$$arity=1),e.def(h,"$paths_for",d=function(e){return this.paths["$&"](e)},d.$$arity=1),e.def(h,"$stops",_=function(){return u(this.paths,"map",[],"stop".$to_proc()).$compact().$uniq()},_.$$arity=0),e.def(h,"$revenue",f=function(){var e,r=this,n=a;return n=r.$stops(),s(t(n.$size(),2))&&r.$raise(i(y,"GameError"),"Route must have at least 2 stops"),s(t(r.train.$distance(),n.$size()))&&r.$raise(i(y,"GameError"),n.$size()+" is too many stops for "+r.train.$distance()+" train"),u(n,"map",[],(e=function(t){var r=e.$$s||this;return null==r.phase&&(r.phase=a),null==r.train&&(r.train=a),null==t&&(t=a),t.$route_revenue(r.phase,r.train)},e.$$s=r,e.$$arity=1,e)).$sum()},f.$$arity=0)}(c[0],0,c)}(n[0],n)},Opal.modules["engine/share_bundle"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}e.top;var n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module),$=e.klass,o=e.send,s=e.truthy;return e.add_stubs(["$attr_reader","$Array","$==","$size","$uniq","$map","$to_proc","$raise","$sum","$/","$!=","$corporation","$first","$owner","$find","$price_per_share","$*","$num_shares"]),function(n,l){var u=[i(n,"Engine")].concat(l);!function(n,$super,i){var l,u,c,p,d,_,f,h,y,m=$(n,null,"ShareBundle");[m].concat(i);m.$$prototype.shares=m.$$prototype.percent=a,m.$attr_reader("shares","percent"),e.def(m,"$initialize",l=function(e,t){var r,n=this;return null==t&&(t=a),e=n.$Array(e),o(e,"map",[],"corporation".$to_proc()).$uniq().$size()["$=="](1)||n.$raise("All shares must be from the same corporation"),n.shares=e,n.percent=s(r=t)?r:o(n.shares,"sum",[],"percent".$to_proc())},l.$$arity=-2),e.def(m,"$num_shares",u=function(){return t(this.percent,10)},u.$$arity=0),e.def(m,"$partial?",c=function(){var e=this;return e.percent["$!="](o(e.shares,"sum",[],"percent".$to_proc()))},c.$$arity=0),e.def(m,"$corporation",p=function(){return this.shares.$first().$corporation()},p.$$arity=0),e.def(m,"$owner",d=function(){return this.shares.$first().$owner()},d.$$arity=0),e.def(m,"$president",_=function(){return this.$corporation().$owner()},_.$$arity=0),e.def(m,"$presidents_share",f=function(){return o(this.shares,"find",[],"president".$to_proc())},f.$$arity=0),e.def(m,"$price_per_share",h=function(){return this.shares.$first().$price_per_share()},h.$$arity=0),e.def(m,"$price",y=function(){var e=this;return r(e.$price_per_share(),e.$num_shares())},y.$$arity=0)}(u[0],0,u)}(n[0],n)},Opal.modules["engine/passer"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module);return e.add_stubs(["$attr_reader","$!"]),function(t,a){var i=[n(t,"Engine")].concat(a);!function(t,a){var i,$,o,s,l=n(t,"Passer");[l].concat(a);l.$attr_reader("passed"),e.def(l,"$passed?",i=function(){var e=this;return null==e.passed&&(e.passed=r),e.passed},i.$$arity=0),e.def(l,"$active?",$=function(){var e=this;return null==e.passed&&(e.passed=r),e.passed["$!"]()},$.$$arity=0),e.def(l,"$pass!",o=function(){return this.passed=!0},o.$$arity=0),e.def(l,"$unpass!",s=function(){return this.passed=!1},s.$$arity=0)}(i[0],i)}(t[0],t)},Opal.modules["engine/train"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy,u=e.send;return e.add_stubs(["$include","$attr_reader","$[]","$-","$dig","$name","$remove_train","$owner","$from_depot?","$is_a?","$id"]),r.$require("engine/train.rb/../ownable"),r.$require("engine/train.rb/../depot"),function(r,n){var c=[$(r,"Engine")].concat(n);!function(r,$super,n){var $,c,p,d,_,f,h,y=o(r,null,"Train"),m=[y].concat(n);y.$$prototype.price=y.$$prototype.discount=y.$$prototype.name=y.$$prototype.index=a,y.$include(i(m,"Ownable")),y.$attr_reader("available_on","name","distance","discount","rusts_on"),e.def(y,"$initialize",$=function(t){var r,n,a,i,$,o=this;if(null==t)t=s([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(t.$$smap,"name"))throw e.ArgumentError.$new("missing keyword: name");if(r=t.$$smap.name,!e.hasOwnProperty.call(t.$$smap,"distance"))throw e.ArgumentError.$new("missing keyword: distance");if(n=t.$$smap.distance,!e.hasOwnProperty.call(t.$$smap,"price"))throw e.ArgumentError.$new("missing keyword: price");return a=t.$$smap.price,null==(i=t.$$smap.index)&&(i=0),$=e.kwrestargs(t,{name:!0,distance:!0,price:!0,index:!0}),o.name=r,o.distance=n,o.price=a,o.index=i,o.rusts_on=$["$[]"]("rusts_on"),o.available_on=$["$[]"]("available_on"),o.discount=$["$[]"]("discount")},$.$$arity=1),e.def(y,"$price",c=function(e){var r,n,i,$=this;return null==e&&(e=a),t($.price,l(r=(n=$.discount)===a||null==n?a:u(n,"dig",[(i=e,i===a||null==i?a:u(i,"name",[]))]))?r:0)},c.$$arity=-1),e.def(y,"$id",p=function(){var e=this;return e.name+"-"+e.index},p.$$arity=0),e.def(y,"$rust!",d=function(){var e,t=this;return(e=t.$owner())===a||null==e||u(e,"remove_train",[t]),t.owner=a},d.$$arity=0),e.def(y,"$min_price",_=function(){var e=this;return l(e["$from_depot?"]())?e.price:1},_.$$arity=0),e.def(y,"$from_depot?",f=function(){return this.$owner()["$is_a?"](i(m,"Depot"))},f.$$arity=0),e.def(y,"$inspect",h=function(){return"<Train: "+this.$id()+">"},h.$$arity=0)}(c[0],0,c)}(n[0],n)},Opal.modules["engine/share_holder"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}e.top;var n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.truthy,s=e.send;return e.add_stubs(["$flatten","$values","$shares_by_corporation","$new","$[]=","$-","$[]","$sum","$to_proc","$/","$percent_of"]),function(n,l){var u=[$(n,"Engine")].concat(l);!function(n,l){var u,c,p,d,_,f=$(n,"ShareHolder"),h=[f].concat(l);e.def(f,"$shares",u=function(){return this.$shares_by_corporation().$values().$flatten()},u.$$arity=0),e.def(f,"$shares_by_corporation",c=function(){var r,n,$=this;return null==$.shares_by_corporation&&($.shares_by_corporation=a),$.shares_by_corporation=o(r=$.shares_by_corporation)?r:s(i(h,"Hash"),"new",[],((n=function(r,i){n.$$s;var $=a;return null==r&&(r=a),null==i&&(i=a),$=[i,[]],s(r,"[]=",e.to_a($)),$[t($.length,1)]}).$$s=$,n.$$arity=2,n))},c.$$arity=0),e.def(f,"$shares_of",p=function(e){var t=this;return o(e)?t.$shares_by_corporation()["$[]"](e):[]},p.$$arity=1),e.def(f,"$percent_of",d=function(e){var t=this;return o(e)?s(t.$shares_by_corporation()["$[]"](e),"sum",[],"percent".$to_proc()):0},d.$$arity=1),e.def(f,"$num_shares_of",_=function(e){return r(this.$percent_of(e),10)},_.$$arity=1)}(u[0],u)}(n[0],n)},Opal.modules["engine/action"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module);return function(e,t){var n=[r(e,"Engine")].concat(t);!function(e,t){[r(e,"Action")].concat(t)}(n[0],n)}(t[0],t)},Opal.modules["engine/company"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var a=e.top,i=[],$=e.nil,o=(e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.send,p=e.truthy;return e.add_stubs(["$include","$attr_accessor","$attr_reader","$transform_values","$group_by","$[]","$to_proc","$===","$player?","$owner","$corporation?","$delete","$each","$dup","$==","$remove_ability","$compact","$map","$abilities","$-","$/","$*","$companies","$empty?","$join","$split","$gsub","$name","$class","$id"]),a.$require("engine/company.rb/../ownable"),function(a,i){var d=[s(a,"Engine")].concat(i);!function(a,$super,i){var s,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T=l(a,null,"Company"),S=[T].concat(i);T.$$prototype.abilities=T.$$prototype.name=T.$$prototype.value=T.$$prototype.discount=T.$$prototype.closed=T.$$prototype.sym=$,T.$include(o(S,"Ownable")),T.$attr_accessor("revenue","discount"),T.$attr_reader("desc","name","sym","value"),e.def(T,"$initialize",s=function(t){var r,n,a,i,o,s,l,p=this;if(null==t)t=u([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(t.$$smap,"name"))throw e.ArgumentError.$new("missing keyword: name");if(r=t.$$smap.name,!e.hasOwnProperty.call(t.$$smap,"value"))throw e.ArgumentError.$new("missing keyword: value");return n=t.$$smap.value,null==(a=t.$$smap.revenue)&&(a=0),null==(i=t.$$smap.desc)&&(i=""),null==(o=t.$$smap.sym)&&(o=""),null==(s=t.$$smap.abilities)&&(s=[]),e.kwrestargs(t,{name:!0,value:!0,revenue:!0,desc:!0,sym:!0,abilities:!0}),p.name=r,p.value=n,p.desc=i,p.revenue=a,p.sym=o,p.discount=0,p.closed=!1,p.abilities=c(c(s,"group_by",[],((l=function(e){l.$$s;return null==e&&(e=$),e["$[]"]("type")}).$$s=p,l.$$arity=1,l)),"transform_values",[],"first".$to_proc())},s.$$arity=1),e.def(T,"$abilities",d=function(e){var t,r,n=this,a=$,i=$,o=$;return p(a=n.abilities["$[]"](e))?(o=a["$[]"]("owner_type"),i="player"["$==="](o)?(t=n.$owner())===$||null==t?$:c(t,"player?",[]):"corporation"["$==="](o)?(r=n.$owner())===$||null==r?$:c(r,"corporation?",[]):!!$["$==="](o)||$,p(i)?a:$):$},d.$$arity=1),e.def(T,"$remove_ability",_=function(e){return this.abilities.$delete(e)},_.$$arity=1),e.def(T,"$remove_ability_when",f=function(e){var t,r=this;return c(r.abilities.$dup(),"each",[],((t=function(r,n){var a=t.$$s||this;return null==r&&(r=$),null==n&&(n=$),n["$[]"]("when")["$=="](e)?a.$remove_ability(r):$}).$$s=r,t.$$arity=2,t))},f.$$arity=1),e.def(T,"$all_abilities",h=function(){var e,t=this;return c(t.abilities,"map",[],(e=function(t,r){var n=e.$$s||this;return null==t&&(t=$),null==r&&(r=$),n.$abilities(t)},e.$$s=t,e.$$arity=2,e)).$compact()},h.$$arity=0),e.def(T,"$id",y=function(){return this.name},y.$$arity=0),e.def(T,"$min_bid",m=function(){var e=this;return t(e.value,e.discount)},m.$$arity=0),e.def(T,"$min_price",g=function(){return r(this.value,2)},g.$$arity=0),e.def(T,"$max_price",b=function(){return n(this.value,2)},b.$$arity=0),e.def(T,"$close!",v=function(){var e=this;return e.closed=!0,p(e.$owner())?(e.$owner().$companies().$delete(e),e.owner=$):$},v.$$arity=0),e.def(T,"$closed?",w=function(){return this.closed},w.$$arity=0),e.def(T,"$player?",k=function(){return!1},k.$$arity=0),e.def(T,"$company?",x=function(){return!0},x.$$arity=0),e.def(T,"$corporation?",E=function(){return!1},E.$$arity=0),e.def(T,"$short_name",O=function(){var e,t=this;return p(t.sym["$empty?"]())?c(t.name.$gsub("-"," ").$split(" "),"map",[],(e=function(t){e.$$s;return null==t&&(t=$),t["$[]"](0)},e.$$s=t,e.$$arity=1,e)).$join():t.sym},O.$$arity=0),e.def(T,"$inspect",A=function(){var e=this;return"<"+e.$class().$name()+": "+e.$id()+">"},A.$$arity=0)}(d[0],0,d)}(i[0],i)},Opal.modules["engine/tile"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var i=e.top,$=[],o=e.nil,s=e.const_get_qualified,l=e.const_get_relative,u=(e.breaker,e.slice,e.module),c=e.klass,p=e.hash2,d=e.truthy,_=(e.hash,e.send),f=e.range;return e.add_stubs(["$include","$attr_accessor","$attr_reader","$[]","$raise","$from_code","$map","$split","$include?","$to_h","$part","$new","$decode","$===","$to_i","$fetch","$<<","$tag_parts","$separate_parts","$<=>","$index","$color","$name","$find","$>","$first","$%","$+","$rotate","$uniq","$num","$any?","$==","$size","$cities","$towns","$!","$exits","$parts","$sum","$cost","$terrains","$select","$to_proc","$upgrades_to?","$label","$paths_are_subset_of?","$paths","$all?","$<=","$class","$private","$each","$values","$group_by","$with_index","$index=","$-","$tile=","$city?","$label?","$path?","$town?","$upgrade?","$offboard?","$flat_map"]),i.$require("engine/tile.rb/../game_error"),i.$require("engine/tile.rb/../part/city"),i.$require("engine/tile.rb/../part/town"),i.$require("engine/tile.rb/../part/edge"),i.$require("engine/tile.rb/../part/junction"),i.$require("engine/tile.rb/../part/label"),i.$require("engine/tile.rb/../part/offboard"),i.$require("engine/tile.rb/../part/path"),i.$require("engine/tile.rb/../part/upgrade"),i.$require("engine/tile.rb/../config/tile"),function(i,$){var h=[u(i,"Engine")].concat($);!function(i,$super,$){var u,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N=c(i,null,"Tile"),j=[N].concat($);N.$$prototype.name=N.$$prototype.index=N.$$prototype.color=N.$$prototype.legal_rotations=N.$$prototype.rotation=N.$$prototype._paths=N.$$prototype.paths=N.$$prototype._exits=N.$$prototype.edges=N.$$prototype.lawson=N.$$prototype.junctions=N.$$prototype.parts=N.$$prototype.upgrades=N.$$prototype.towns=N.$$prototype.cities=N.$$prototype.blockers=o,N.$include(s(l(j,"Config"),"Tile")),N.$attr_accessor("hex","legal_rotations","location_name","name","index"),N.$attr_reader("cities","color","edges","junctions","label","parts","preprinted","rotation","towns","upgrades","offboards","blockers"),e.defs(N,"$for",u=function(t,r){var n,a=this,i=o,$=o;if(null==r)r=p([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return n=e.kwrestargs(r,{}),d(i=l(j,"WHITE")["$[]"](t))?$="white":d(i=l(j,"YELLOW")["$[]"](t))?$="yellow":d(i=l(j,"GREEN")["$[]"](t))?$="green":d(i=l(j,"BROWN")["$[]"](t))?$="brown":d(i=l(j,"GRAY")["$[]"](t))?$="gray":d(i=l(j,"RED")["$[]"](t))?$="red":a.$raise(s(l(j,"Engine"),"GameError"),"Tile '"+t+"' not found"),a.$from_code(t,$,i,e.to_hash(n))},u.$$arity=-2),e.defs(N,"$decode",h=function(t){var r,n=this,a=o;return a=[],_(t.$split(";"),"map",[],((r=function(t){var n,i,$,s=r.$$s||this,l=o,u=o;return null==t&&(t=o),i=t.$split("="),l=null==(n=e.to_ary(i))[0]?o:n[0],u=null==n[1]?o:n[1],d(u["$include?"](":"))&&(u=_(u.$split(","),"map",[],($=function(e){$.$$s;return null==e&&(e=o),e.$split(":")},$.$$s=s,$.$$arity=1,$)).$to_h()),s.$part(l,u,a)}).$$s=n,r.$$arity=1,r))},h.$$arity=1),e.defs(N,"$from_code",y=function(t,r,n,a){var i,$=this;if(null==a)a=p([],{});else if(!a.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return i=e.kwrestargs(a,{}),l(j,"Tile").$new(t,p(["color","parts"],{color:r,parts:$.$decode(n)}).$merge(e.to_hash(i)))},y.$$arity=-4),e.defs(N,"$part",m=function(e,t,r){var n,a,i=this,$=o,u=o,c=o,p=o,d=o,h=o;return $=e,"p"["$==="]($)?(t=_(t,"map",[],(n=function(e,t){return n.$$s,null==e&&(e=o),null==t&&(t=o),$=t["$[]"](0),"_"["$==="]($)?[e,r["$[]"](t["$[]"](f(1,-1,!1)).$to_i())]:"j"["$==="]($)?[e,s(l(j,"Part"),"Junction").$new()]:[e,s(l(j,"Part"),"Edge").$new(t)]},n.$$s=i,n.$$arity=2,n)).$to_h(),s(l(j,"Part"),"Path").$new(t["$[]"]("a"),t["$[]"]("b"))):"c"["$==="]($)?(u=s(l(j,"Part"),"City").$new(t["$[]"]("r"),t.$fetch("s",1)),r["$<<"](u),u):"t"["$==="]($)?(c=s(l(j,"Part"),"Town").$new(t["$[]"]("r")),r["$<<"](c),c):"l"["$==="]($)?(p=s(l(j,"Part"),"Label").$new(t),r["$<<"](p),p):"u"["$==="]($)?(d=s(l(j,"Part"),"Upgrade").$new(t["$[]"]("c"),(a=t["$[]"]("t"))===o||null==a?o:_(a,"split",["+"])),r["$<<"](d),d):"o"["$==="]($)?(h=s(l(j,"Part"),"Offboard").$new(t["$[]"]("r")),r["$<<"](h),h):o},m.$$arity=3),e.def(N,"$initialize",g=function(t,r){var n,a,i,$,s,l,u=this;if(null==r)r=p([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(r.$$smap,"color"))throw e.ArgumentError.$new("missing keyword: color");if(n=r.$$smap.color,!e.hasOwnProperty.call(r.$$smap,"parts"))throw e.ArgumentError.$new("missing keyword: parts");return a=r.$$smap.parts,null==(i=r.$$smap.rotation)&&(i=0),null==($=r.$$smap.preprinted)&&($=!1),null==(s=r.$$smap.index)&&(s=0),null==(l=r.$$smap.location_name)&&(l=o),u.name=t,u.color=n,u.parts=a,u.rotation=i,u.cities=[],u.paths=[],u.towns=[],u.edges=o,u.junctions=o,u.upgrades=[],u.location_name=l,u.offboards=[],u.legal_rotations=[],u.blockers=[],u.preprinted=$,u.index=s,u.$tag_parts(),u.$separate_parts()},g.$$arity=2),e.def(N,"$id",b=function(){var e=this;return e.name+"-"+e.index},b.$$arity=0),e.def(N,"$<=>",v=function(e){var t=this;return[l(j,"COLORS").$index(t.color),t.name.$to_i()]["$<=>"]([l(j,"COLORS").$index(e.$color()),e.$name().$to_i()])},v.$$arity=1),e.def(N,"$rotate!",w=function(e){var r,n,a,i,$=this,s=o;return null==e&&(e=o),s=d(r=d(n=d(a=e)?a:_($.legal_rotations,"find",[],((i=function(e){var r=i.$$s||this;return null==r.rotation&&(r.rotation=o),null==e&&(e=o),t(e,r.rotation)}).$$s=$,i.$$arity=1,i)))?n:$.legal_rotations.$first())?r:$.rotation,$.rotation=s,$._paths=o,$._exits=o},w.$$arity=-1),e.def(N,"$rotate",k=function(e,t){return null==t&&(t=1),r(e,t)["$%"](6)},k.$$arity=-2),e.def(N,"$paths",x=function(){var e,t,r=this;return r._paths=d(e=r._paths)?e:_(r.paths,"map",[],((t=function(e){var r=t.$$s||this;return null==r.rotation&&(r.rotation=o),null==e&&(e=o),e.$rotate(r.rotation)}).$$s=r,t.$$arity=1,t))},x.$$arity=0),e.def(N,"$exits",E=function(){var e,t,r=this;return r._exits=d(e=r._exits)?e:_(r.edges,"map",[],(t=function(e){var r=t.$$s||this;return null==r.rotation&&(r.rotation=o),null==e&&(e=o),r.$rotate(e.$num(),r.rotation)},t.$$s=r,t.$$arity=1,t)).$uniq()},E.$$arity=0),e.def(N,"$lawson?",O=function(){var e,t,r=this;return r.lawson=d(e=r.lawson)?e:[r.junctions["$any?"](),[r.$cities().$size(),r.$towns().$size()]["$=="]([1,0]),d(t=[r.$cities().$size(),r.$towns().$size()]["$=="]([0,1]))?[1,2]["$include?"](r.$exits().$size())["$!"]():t]["$any?"]()},O.$$arity=0),e.def(N,"$==",A=function(e){var t,r=this;return d(t=r.name["$=="](e.$name())?r.color["$=="](e.$color()):r.name["$=="](e.$name()))?r.parts["$=="](e.$parts()):t},A.$$arity=1),e.def(N,"$upgrade_cost",T=function(e){var t,r,n=this,a=o;return a=_(e,"find",[],((t=function(e){t.$$s;return null==e&&(e=o),e["$[]"]("type")["$=="]("ignore_terrain")}).$$s=n,t.$$arity=1,t)),_(n.upgrades,"sum",[],((r=function(e){r.$$s;var t,n=o;return null==e&&(e=o),n=e.$cost(),d(d(t=a)?e.$terrains().$uniq()["$=="]([a["$[]"]("terrain")]):t)&&(n=0),n}).$$s=n,r.$$arity=1,r))},T.$$arity=1),e.def(N,"$upgrade_tiles",S=function(e){var t,r=this;return _(_(e,"uniq",[],"name".$to_proc()),"select",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=o),r["$upgrades_to?"](e)}).$$s=r,t.$$arity=1,t))},S.$$arity=1),e.def(N,"$upgrades_to?",I=function(e){var t=this;return!!l(j,"COLORS").$index(e.$color())["$=="](r(l(j,"COLORS").$index(t.color),1))&&(!!t.$label()["$=="](e.$label())&&(!!t.towns.$size()["$=="](e.$towns().$size())&&(!!t.cities.$size()["$=="](e.$cities().$size())&&!!d(t["$paths_are_subset_of?"](e.$paths())))))},I.$$arity=1),e.def(N,"$paths_are_subset_of?",R=function(e){var t,r=this;return _(f(0,5,!1),"any?",[],((t=function(r){var a,i=t.$$s||this;return null==i.paths&&(i.paths=o),null==r&&(r=o),_(i.paths,"all?",[],((a=function(t){var i,$=a.$$s||this;return null==t&&(t=o),t=t.$rotate(r),_(e,"any?",[],((i=function(e){i.$$s;return null==e&&(e=o),n(t,e)}).$$s=$,i.$$arity=1,i))}).$$s=i,a.$$arity=1,a))}).$$s=r,t.$$arity=1,t))},R.$$arity=1),e.def(N,"$add_blocker!",C=function(e){var t=this;return t.parts["$<<"](e),t.blockers["$<<"](e)},C.$$arity=1),e.def(N,"$to_s",q=function(){var e=this;return e.$class().$name()+" - "+e.name},q.$$arity=0),N.$private(),e.def(N,"$tag_parts",M=function(){var t,r=this;return _(_(r.parts.$each(),"group_by",[],"class".$to_proc()).$values(),"each",[],((t=function(r){var n,i=t.$$s||this;return null==r&&(r=o),_(r.$each(),"with_index",[],((n=function(t,r){var i=n.$$s||this,$=o;return null==t&&(t=o),null==r&&(r=o),$=[r],_(t,"index=",e.to_a($)),$[a($.length,1)],$=[i],_(t,"tile=",e.to_a($)),$[a($.length,1)]}).$$s=i,n.$$arity=2,n))}).$$s=r,t.$$arity=1,t))},M.$$arity=0),e.def(N,"$separate_parts",z=function(){var e,t=this;return _(t.parts,"each",[],((e=function(t){var r=e.$$s||this;return null==r.cities&&(r.cities=o),null==r.paths&&(r.paths=o),null==r.towns&&(r.towns=o),null==r.upgrades&&(r.upgrades=o),null==r.offboards&&(r.offboards=o),null==t&&(t=o),d(t["$city?"]())?r.cities["$<<"](t):d(t["$label?"]())?r.label=t:d(t["$path?"]())?r.paths["$<<"](t):d(t["$town?"]())?r.towns["$<<"](t):d(t["$upgrade?"]())?r.upgrades["$<<"](t):d(t["$offboard?"]())?r.offboards["$<<"](t):r.$raise("Part "+t+" not separated.")}).$$s=t,e.$$arity=1,e)),t.junctions=_(t.paths,"map",[],"junction".$to_proc()),t.edges=_(t.paths,"flat_map",[],"edges".$to_proc())},z.$$arity=0)}(h[0],0,h)}($[0],$)},Opal.modules["engine/round/special"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.truthy,l=e.send,u=e.hash2,c=e.range;return e.add_stubs(["$abilities","$!","$tile_laying_ability","$to_h","$map","$[]","$hex_by_id","$keys","$neighbors","$exits","$tile","$select","$rotate","$==","$size","$&","$all?","$private","$entity","$===","$lay_tile","$remove_ability","$operating?","$round","$clear_route_cache","$owner","$share","$can_gain?","$raise","$buy_share","$share_pool","$close!","$compact","$find","$tiles","$name"]),t.$require("engine/round/special.rb/../../action/lay_tile"),t.$require("engine/round/special.rb/../../corporation"),t.$require("engine/round/special.rb/../../player"),t.$require("engine/round/special.rb/../base"),function(t,r){var p=[$(t,"Engine")].concat(r);!function(t,r){var p=[$(t,"Round")].concat(r);!function(t,$super,r){var $,p,d,_,f,h,y,m,g=o(t,$super,"Special"),b=[g].concat(r);g.$$prototype.entities=g.$$prototype.current_entity=g.$$prototype.layable_hexes=g.$$prototype.game=n,e.def(g,"$active_entities",$=function(){return this.entities},$.$$arity=0),e.def(g,"$current_entity=",p=function(e){var t=this;return t.current_entity=e,t.layable_hexes=n},p.$$arity=1),e.def(g,"$tile_laying_ability",d=function(){var e,t=n;return s(t=(e=this.current_entity)===n||null==e?n:l(e,"abilities",["tile_lay"]))?t:u([],{})},d.$$arity=0),e.def(g,"$can_lay_track?",_=function(){return this.$tile_laying_ability()["$!"]()["$!"]()},_.$$arity=0),e.def(g,"$layable_hexes",f=function(){var e,t,r,a=this;return a.layable_hexes=s(e=a.layable_hexes)?e:(t=a.$tile_laying_ability()["$[]"]("hexes"),t===n||null==t?n:l(t,"map",[],(r=function(e){var t=r.$$s||this,a=n;return null==t.game&&(t.game=n),null==e&&(e=n),[a=t.game.$hex_by_id(e),a.$neighbors().$keys()]},r.$$s=a,r.$$arity=1,r))).$to_h()},f.$$arity=0),e.def(g,"$legal_rotations",h=function(e,t){var r,a=this,i=n;return i=e.$tile().$exits(),l(c(0,5,!1),"select",[],((r=function(a){var $,o,u,c=r.$$s||this,p=n;return null==a&&(a=n),p=l(t.$exits(),"map",[],(($=function(e){$.$$s;return null==e&&(e=n),t.$rotate(e,a)}).$$s=c,$.$$arity=1,$)),s(o=i["$&"](p).$size()["$=="](i.$size()))?l(p,"all?",[],((u=function(t){u.$$s;return null==t&&(t=n),e.$neighbors()["$[]"](t)}).$$s=c,u.$$arity=1,u)):o}).$$s=a,r.$$arity=1,r))},h.$$arity=2),g.$private(),e.def(g,"$_process_action",y=function(e){var t=this,r=n,$=n,o=n,l=n;return r=e.$entity(),$=e,a(i(b,"Action"),"LayTile")["$==="]($)?(t.$lay_tile(e),r.$remove_ability("tile_lay"),s(t.game.$round()["$operating?"]())?t.game.$round().$clear_route_cache():n):a(i(b,"Action"),"BuyShare")["$==="]($)?(o=r.$owner(),l=e.$share(),s(t["$can_gain?"](l,o))||t.$raise(i(b,"GameError"),"Exchanging company would exceed limits"),t.game.$share_pool().$buy_share(o,l,u(["exchange"],{exchange:r})),r["$close!"]()):n},y.$$arity=1),e.def(g,"$potential_tiles",m=function(){var e,t=this,r=n;return s(r=t.$tile_laying_ability()["$[]"]("tiles"))?l(r,"map",[],(e=function(t){var r,a=e.$$s||this;return null==a.game&&(a.game=n),null==t&&(t=n),l(a.game.$tiles(),"find",[],((r=function(e){r.$$s;return null==e&&(e=n),e.$name()["$=="](t)}).$$s=a,r.$$arity=1,r))},e.$$s=t,e.$$arity=1,e)).$compact():[]},m.$$arity=0)}(p[0],i(p,"Base"),p)}(p[0],p)}(r[0],r)},Opal.modules["engine/round/operating"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function s(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var l=e.top,u=[],c=e.nil,p=e.const_get_qualified,d=e.const_get_relative,_=(e.breaker,e.slice,e.module),f=e.klass,h=e.hash2,y=e.send,m=e.truthy,g=e.range
;return e.add_stubs(["$==","$require_tree","$attr_reader","$freeze","$hexes","$phase","$bank","$depot","$players","$stock_market","$share_pool","$first","$class","$last","$payout_companies","$place_home_stations","$log_operation","$<<","$name","$round_num","$[]","$+","$next_step!","$buy_companies","$purchasable_companies","$any?","$<=","$min","$map","$to_proc","$cash","$empty?","$trains","$>","$count","$keys","$reachable_hexes","$paths","$tile","$crowded_corps","$select","$size","$train_limit","$<","$corp_has_room?","$>=","$min_price","$discountable_trains_for","$include?","$active_entities","$presidents_share","$owner","$price","$min_depot_price","$price_per_share","$corporation","$president?","$share_holders","$-","$percent","$max","$values","$reject","$percent_of","$find_index","$===","$none?","$tokens","$city","$&","$exits","$tokenable?","$withhold","$!","$can_buy_train?","$must_buy_train?","$can_buy_companies?","$clear_route_cache","$pass!","$each","$find","$coordinates","$cities","$reserved_by?","$place_token","$new","$[]=","$tokened_cities","$uniq","$flat_map","$pop","$neighbors","$connected_exits","$|","$invert","$default=","$layable_hexes","$tokened_by?","$rotate","$all?","$private","$entity","$lay_tile","$routes","$join","$train","$format_currency","$revenue","$sum","$kind","$payout","$raise","$buy_train","$exchange","$reclaim_train","$sell_shares","$shares","$buy_company","$company","$liquidate","$passed?","$next_entity","$finished?","$is_a?","$remove_just_sold_company_abilities","$ignore_action?","$!=","$add_revenue!","$turn","$-@","$positive?","$spend","$change_share_price","$/","$payout_entity","$zero?","$*","$share_price","$move_left","$move_right","$log_share_price","$from_depot?","$min_depot_train","$rust_trains!","$sell_and_change_price","$recalculate_order","$max_price","$between?","$owner=","$delete","$companies","$hex","$next_token","$remove_ability_when","$shares_by_corporation","$max_by","$sellable_bundles","$rusts_on","$rust!","$sort"]),d(u,"RUBY_ENGINE")["$=="]("opal")&&l.$require_tree("engine/action"),l.$require("engine/round/operating.rb/../../corporation"),l.$require("engine/round/operating.rb/../base"),function(l,u){var b=[_(l,"Engine")].concat(u);!function(l,u){var b=[_(l,"Round")].concat(u);!function(l,$super,u){var _,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q,ee,te,re,ne,ae,ie,$e,oe,se=f(l,$super,"Operating"),le=[se].concat(u);se.$$prototype.current_entity=se.$$prototype.log=se.$$prototype.turn=se.$$prototype.step=se.$$prototype.last_action_step=se.$$prototype.end_game=se.$$prototype.bankrupt=se.$$prototype.phase=se.$$prototype.game=se.$$prototype.entities=se.$$prototype.depot=se.$$prototype.share_pool=se.$$prototype.current_routes=se.$$prototype.layable_hexes=se.$$prototype.hexes=se.$$prototype.reachable_hexes=se.$$prototype.round_num=se.$$prototype.bank=se.$$prototype.players=se.$$prototype.stock_market=se.$$prototype.just_sold_company=c,se.$attr_reader("bankrupt","depot","phase","round_num","step"),e.const_set(le[0],"STEPS",["track","token","route","dividend","train","company"].$freeze()),e.const_set(le[0],"STEP_DESCRIPTION",h(["track","token","route","dividend","train","company"],{track:"Lay Track",token:"Place a Token",route:"Run Routes",dividend:"Pay or Withold Dividends",train:"Buy Trains",company:"Purchase Companies"}).$freeze()),e.const_set(le[0],"SHORT_STEP_DESCRIPTION",h(["track","token","train","company"],{track:"Track",token:"Token",train:"Trains",company:"Companies"}).$freeze()),e.def(se,"$initialize",_=function(t,r){var n,a,i=_.$$p,$=this,o=c,s=c,l=c;for(i&&(_.$$p=null),s=0,l=arguments.length,o=new Array(l);s<l;s++)o[s]=arguments[s];if(null==r)r=h([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(r.$$smap,"game"))throw e.ArgumentError.$new("missing keyword: game");return n=r.$$smap.game,null==(a=r.$$smap.round_num)&&(a=1),y($,e.find_super_dispatcher($,"initialize",_,!1),o,i),$.round_num=a,$.hexes=n.$hexes(),$.phase=n.$phase(),$.bank=n.$bank(),$.depot=n.$depot(),$.players=n.$players(),$.stock_market=n.$stock_market(),$.share_pool=n.$share_pool(),$.just_sold_company=c,$.bankrupt=!1,$.step=p($.$class(),"STEPS").$first(),$.last_action_step=p($.$class(),"STEPS").$last(),$.current_routes=[],$.$payout_companies(),$.$place_home_stations(),$.$log_operation($.current_entity)},_.$$arity=2),e.def(se,"$log_new_round",b=function(){var e=this;return e.log["$<<"]("-- "+e.$name()+" "+e.turn+"."+e.$round_num()+" --")},b.$$arity=0),e.def(se,"$name",v=function(){return"Operating Round"},v.$$arity=0),e.def(se,"$description",w=function(){var e=this;return p(e.$class(),"STEP_DESCRIPTION")["$[]"](e.step)},w.$$arity=0),e.def(se,"$pass_description",k=function(){var e=this;return t(t(t(e.step["$=="](e.last_action_step)?"Done":"Skip"," ("),p(e.$class(),"SHORT_STEP_DESCRIPTION")["$[]"](e.step)),")")},k.$$arity=0),e.def(se,"$pass",x=function(){return this["$next_step!"]()},x.$$arity=1),e.def(se,"$finished?",E=function(){var t,r,n=E.$$p,a=this,i=c,$=c,o=c;for(n&&(E.$$p=null),$=0,o=arguments.length,i=new Array(o);$<o;$++)i[$]=arguments[$];return m(t=m(r=a.end_game)?r:a.bankrupt)?t:y(a,e.find_super_dispatcher(a,"finished?",E,!1),i,n)},E.$$arity=0),e.def(se,"$can_buy_companies?",O=function(){var e,t=this,n=c;return!!m(t.phase.$buy_companies())&&(n=t.game.$purchasable_companies(),m(e=n["$any?"]())?r(y(n,"map",[],"min_price".$to_proc()).$min(),t.current_entity.$cash()):e)},O.$$arity=0),e.def(se,"$must_buy_train?",A=function(){var e,t,r=this;return m(e=r.current_entity.$trains()["$empty?"]())?n(y(r.$reachable_hexes().$keys(),"count",[],((t=function(e){t.$$s;return null==e&&(e=c),y(e.$tile().$paths(),"any?",[],"stop".$to_proc())}).$$s=r,t.$$arity=1,t)),1):e},A.$$arity=0),e.def(se,"$active_entities",T=function(){var r=T.$$p,n=this,a=c,i=c,$=c;for(r&&(T.$$p=null),i=0,$=arguments.length,a=new Array($);i<$;i++)a[i]=arguments[i];return t(y(n,e.find_super_dispatcher(n,"active_entities",T,!1),a,r),n.$crowded_corps())},T.$$arity=0),e.def(se,"$crowded_corps",S=function(){var e,t=this;return y(t.entities,"select",[],((e=function(t){var r=e.$$s||this;return null==r.phase&&(r.phase=c),null==t&&(t=c),n(t.$trains().$size(),r.phase.$train_limit())}).$$s=t,e.$$arity=1,e))},S.$$arity=0),e.def(se,"$corp_has_room?",I=function(){var e=this;return a(e.current_entity.$trains().$size(),e.phase.$train_limit())},I.$$arity=0),e.def(se,"$can_buy_train?",R=function(){var e,t,r=this,n=c;return n=m(e=r["$corp_has_room?"]())?i(r.current_entity.$cash(),r.depot.$min_price(r.current_entity)):e,m(e=n)?e:y(r.depot.$discountable_trains_for(r.current_entity),"any?",[],((t=function(e,r,n){var a=t.$$s||this;return null==a.current_entity&&(a.current_entity=c),null==e&&(e=c),null==e&&(e=c),null==n&&(n=c),i(a.current_entity.$cash(),n)}).$$s=r,t.$$arity=3,t))},R.$$arity=0),e.def(se,"$can_act?",C=function(e){var t=this;return!!m(t.step["$=="]("train")?y(t.$active_entities(),"map",[],"owner".$to_proc())["$include?"](e):t.step["$=="]("train"))||t.$active_entities()["$include?"](e)},C.$$arity=1),e.def(se,"$can_sell?",q=function(e){var r,o,s=this,l=c,u=c,p=c,d=c,_=c,f=c;return!m(e.$presidents_share())&&(l=e.$owner(),u=t(t(e.$price(),l.$cash()),s.current_entity.$cash()),!m(i(u,t(s.depot.$min_depot_price(),e.$price_per_share())))&&(p=e.$corporation(),(!m(p["$president?"](l))||(_=$((d=p.$share_holders())["$[]"](l),e.$percent()),f=m(r=y(d,"reject",[],(o=function(e,t){o.$$s;return null==e&&(e=c),null==t&&(t=c),e["$=="](l)},o.$$s=s,o.$$arity=2,o)).$values().$max())?r:0,!m(a(_,f))))&&!m(n(t(e.$percent(),s.share_pool.$percent_of(p)),50))))},q.$$arity=1),e.def(se,"$can_lay_track?",M=function(){return this.step["$=="]("track")},M.$$arity=0),e.def(se,"$can_place_token?",z=function(){return this.step["$=="]("token")},z.$$arity=0),e.def(se,"$next_step!",N=function(){var e,r,n=this,i=c,o=c;return i=p(n.$class(),"STEPS").$find_index(n.step),m(a(i,$(p(n.$class(),"STEPS").$size(),1)))?(o=n.step=p(n.$class(),"STEPS")["$[]"](t(i,1)),"token"["$==="](o)?m(n.current_entity.$tokens()["$none?"]())?n["$next_step!"]():m(y(n.$reachable_hexes(),"any?",[],((e=function(t,r){var n,a=e.$$s||this;return null==t&&(t=c),null==r&&(r=c),y(t.$tile().$paths(),"any?",[],((n=function(e){var t,a,i=n.$$s||this;return null==i.current_entity&&(i.current_entity=c),null==e&&(e=c),m(t=m(a=e.$city())?e.$exits()["$&"](r)["$any?"]():a)?e.$city()["$tokenable?"](i.current_entity):t}).$$s=a,n.$$arity=1,n))}).$$s=n,e.$$arity=2,e)))?c:n["$next_step!"]():"route"["$==="](o)?m(n.current_entity.$trains()["$any?"]())?c:n["$next_step!"]():"dividend"["$==="](o)?m(n.current_routes["$empty?"]())?(n.$withhold(),n["$next_step!"]()):c:"train"["$==="](o)?m(m(r=n["$can_buy_train?"]()["$!"]())?n["$must_buy_train?"]()["$!"]():r)?n["$next_step!"]():c:"company"["$==="](o)?m(n["$can_buy_companies?"]())?c:n["$next_step!"]():c):(n.$clear_route_cache(),n.step=p(n.$class(),"STEPS").$first(),n.current_entity["$pass!"]())},N.$$arity=0),e.def(se,"$place_home_stations",j=function(){var e,t=this;return y(t.entities,"each",[],((e=function(t){var r,n,a,i=e.$$s||this,$=c,o=c;return null==i.hexes&&(i.hexes=c),null==t&&(t=c),$=y(i.hexes,"find",[],((r=function(e){r.$$s;return null==e&&(e=c),e.$coordinates()["$=="](t.$coordinates())}).$$s=i,r.$$arity=1,r)),o=m(n=y($.$tile().$cities(),"find",[],((a=function(e){a.$$s;return null==e&&(e=c),e["$reserved_by?"](t)}).$$s=i,a.$$arity=1,a)))?n:$.$tile().$cities().$first(),m(o["$tokenable?"](t))?o.$place_token(t):c}).$$s=t,e.$$arity=1,e))},j.$$arity=0),e.def(se,"$layable_hexes",P=function(){var t,r,a,i,o,s=this,l=c,u=c,p=c,_=c,f=c;return s.layable_hexes=m(t=s.layable_hexes)?t:(l=y(d(le,"Hash"),"new",[],((r=function(t,n){r.$$s;var a=c;return null==t&&(t=c),null==n&&(n=c),a=[n,[]],y(t,"[]=",e.to_a(a)),a[$(a.length,1)]}).$$s=s,r.$$arity=2,r)),u=[],p=[],y(s.hexes,"each",[],((a=function(t){var r,n=a.$$s||this,i=c,o=c;return null==t&&(t=c),i=n.$tokened_cities(t),m(i["$any?"]())?(u["$<<"](t),p["$<<"](t),o=[t,y(y(t.$tile().$paths(),"select",[],(r=function(e){return r.$$s,null==e&&(e=c),i["$include?"](e.$city())},r.$$s=n,r.$$arity=1,r)),"flat_map",[],"exits".$to_proc()).$uniq()],y(l,"[]=",e.to_a(o)),o[$(o.length,1)]):c}).$$s=s,a.$$arity=1,a)),function(){for(;!m(u["$empty?"]());)_=u.$pop(),y(l["$[]"](_),"each",[],((i=function(t){var r=i.$$s||this,a=c,o=c,s=c,p=c;return null==r.current_entity&&(r.current_entity=c),null==t&&(t=c),m(a=_.$neighbors()["$[]"](t))?(o=a.$connected_exits(_,h(["corporation"],{corporation:r.current_entity})),s=l["$[]"](a),m(n(s["$|"](o).$size(),s.$size()))&&u["$<<"](a),p=[a,l["$[]"](a)["$|"](o["$|"]([d(le,"Hex").$invert(t)]))],y(l,"[]=",e.to_a(p)),p[$(p.length,1)]):c}).$$s=s,i.$$arity=1,i))}(),y(p,"each",[],((o=function(t){o.$$s;var r=c;return null==t&&(t=c),r=[t,l["$[]"](t)["$|"](t.$neighbors().$keys())],y(l,"[]=",e.to_a(r)),r[$(r.length,1)]}).$$s=s,o.$$arity=1,o)),f=[c],y(l,"default=",e.to_a(f)),f[$(f.length,1)],l)},P.$$arity=0),e.def(se,"$reachable_hexes",B=function(){var e,t,r=this;return r.reachable_hexes=m(e=r.reachable_hexes)?e:y(r.$layable_hexes(),"select",[],((t=function(e,r){t.$$s;return null==e&&(e=c),null==r&&(r=c),e.$tile().$exits()["$&"](r)["$any?"]()}).$$s=r,t.$$arity=2,t))},B.$$arity=0),e.def(se,"$tokened_cities",L=function(e){var t,r=this;return y(e.$tile().$cities(),"select",[],((t=function(e){var r=t.$$s||this;return null==r.current_entity&&(r.current_entity=c),null==e&&(e=c),e["$tokened_by?"](r.current_entity)}).$$s=r,t.$$arity=1,t))},L.$$arity=1),e.def(se,"$legal_rotations",D=function(e,t){var r,n=this,a=c;return a=e.$tile().$exits(),y(g(0,5,!1),"select",[],((r=function(n){var i,$,o,s,l=r.$$s||this,u=c;return null==n&&(n=c),u=y(t.$exits(),"map",[],((i=function(e){i.$$s;return null==e&&(e=c),t.$rotate(e,n)}).$$s=l,i.$$arity=1,i)),m($=m(o=u["$&"](l.$layable_hexes()["$[]"](e))["$any?"]())?a["$&"](u).$size()["$=="](a.$size()):o)?y(u,"all?",[],((s=function(t){s.$$s;return null==t&&(t=c),e.$neighbors()["$[]"](t)}).$$s=l,s.$$arity=1,s)):$}).$$s=n,r.$$arity=1,r))},D.$$arity=2),e.def(se,"$operating?",G=function(){return!0},G.$$arity=0),e.def(se,"$clear_route_cache",H=function(){var e=this;return e.layable_hexes=c,e.reachable_hexes=c},H.$$arity=0),se.$private(),e.def(se,"$_process_action",F=function(e){var t,r=this,n=c,a=c,i=c,$=c;return n=e.$entity(),a=e,p(d(le,"Action"),"LayTile")["$==="](a)?(r.$lay_tile(e),r.$clear_route_cache()):p(d(le,"Action"),"PlaceToken")["$==="](a)?r.$place_token(e):p(d(le,"Action"),"RunRoutes")["$==="](a)?(r.current_routes=e.$routes(),y(r.current_routes,"each",[],((t=function(e){var r=t.$$s||this,a=c;return null==r.log&&(r.log=c),null==r.game&&(r.game=c),null==e&&(e=c),a=y(e.$hexes(),"map",[],"name".$to_proc()).$join(", "),r.log["$<<"](n.$name()+" runs a "+e.$train().$name()+" train for "+r.game.$format_currency(e.$revenue())+" ("+a+")")}).$$s=r,t.$$arity=1,t))):p(d(le,"Action"),"Dividend")["$==="](a)?(i=y(r.current_routes,"sum",[],"revenue".$to_proc()),r.current_routes=[],a=e.$kind(),"payout"["$==="](a)?r.$payout(i):"withhold"["$==="](a)?r.$withhold(i):r.$raise(d(le,"GameError"),"Unknown dividend type "+e.$kind())):p(d(le,"Action"),"BuyTrain")["$==="](a)?r.$buy_train(n,e.$train(),e.$price(),e.$exchange()):p(d(le,"Action"),"DiscardTrain")["$==="](a)?($=e.$train(),r.depot.$reclaim_train($),r.log["$<<"](n.$name()+" discards "+$.$name())):p(d(le,"Action"),"SellShares")["$==="](a)?r.$sell_shares(e.$shares()):p(d(le,"Action"),"BuyCompany")["$==="](a)?r.$buy_company(e.$company(),e.$price()):p(d(le,"Action"),"Bankrupt")["$==="](a)?r.$liquidate(n.$owner()):c},F.$$arity=1),e.def(se,"$change_entity",U=function(){var e=this;return m(e.current_entity["$passed?"]())?(e.current_entity=e.$next_entity(),m(e["$finished?"]())?c:e.$log_operation(e.current_entity)):c},U.$$arity=1),e.def(se,"$action_processed",K=function(e){var t,r=this;return r.last_action_step=r.step,m(e["$is_a?"](p(d(le,"Action"),"BuyCompany")))||r.$remove_just_sold_company_abilities(),m(r.bankrupt)?c:m(r["$ignore_action?"](e))?c:m(e["$is_a?"](p(d(le,"Action"),"SellShares")))?c:m(m(t=e["$is_a?"](p(d(le,"Action"),"BuyTrain")))?r["$can_buy_train?"]():t)?c:m(r.$crowded_corps()["$any?"]())?c:r["$next_step!"]()},K.$$arity=1),e.def(se,"$ignore_action?",Y=function(e){var t,r,n=this;return m(t=e["$is_a?"](p(d(le,"Action"),"BuyCompany")))?m(r=n.step["$!="]("company"))?r:n["$can_buy_companies?"]():t},Y.$$arity=1),e.def(se,"$withhold",V=function(e){var t=this,r=c;return null==e&&(e=0),t.current_entity["$add_revenue!"](t.game.$turn(),t.round_num,e["$-@"]()),r=t.current_entity.$name(),m(e["$positive?"]())?(t.log["$<<"](r+" withholds "+t.game.$format_currency(e)),t.bank.$spend(e,t.current_entity)):t.log["$<<"](r+" does not run"),t.$change_share_price("left")},V.$$arity=-1),e.def(se,"$payout",W=function(e){var t,r=this,n=c,a=c;return r.current_entity["$add_revenue!"](r.game.$turn(),r.round_num,e),a=o(e,n=10),r.log["$<<"](r.current_entity.$name()+" pays out "+r.game.$format_currency(e)+" = "+r.game.$format_currency(a)+" x "+n+" shares"),y(r.players,"each",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=c),r.$payout_entity(e,a)}).$$s=r,t.$$arity=1,t)),r.$payout_entity(r.share_pool,a,r.current_entity),r.$change_share_price("right")},W.$$arity=1),e.def(se,"$payout_entity",J=function(e,t,r){var n,a=this,i=c,$=c,l=c;return null==r&&(r=c),m((i=e.$percent_of(a.current_entity))["$zero?"]())?c:(r=m(n=r)?n:e,l=s($=o(i,o(100,10)),t),a.log["$<<"](r.$name()+" receives "+a.game.$format_currency(l)+" = "+a.game.$format_currency(t)+" x "+$+" shares"),a.bank.$spend(l,r))},J.$$arity=-3),e.def(se,"$change_share_price",X=function(e){var t=this,r=c,n=c;return r=t.current_entity.$share_price().$price(),n=e,"left"["$==="](n)?t.stock_market.$move_left(t.current_entity):"right"["$==="](n)?t.stock_market.$move_right(t.current_entity):t.$raise(d(le,"GameError"),"Don't know how to move direction "+e),t.$log_share_price(t.current_entity,r)},X.$$arity=1),e.def(se,"$buy_train",Z=function(e,t,r,n){var a,i,o,s=this,l=c,u=c,p=c;return l=$(r,e.$cash()),m(m(a=m(i=m(o=t["$from_depot?"]())?l["$positive?"]():o)?t.$name()["$=="](s.depot.$min_depot_train().$name()):i)?s["$must_buy_train?"]():a)&&((u=e.$owner()).$spend(l,e),s.log["$<<"](u.$name()+" contributes "+s.game.$format_currency(l))),m(n)?(p="exchanges a "+n.$name()+" for",s.depot.$reclaim_train(n)):p="buys",s.log["$<<"](e.$name()+" "+p+" a "+t.$name()+" train for "+s.game.$format_currency(r)+" from "+t.$owner().$name()),e.$buy_train(t,r),s["$rust_trains!"](t)},Z.$$arity=4),e.def(se,"$sell_shares",Q=function(e){var t=this;return t.$sell_and_change_price(e,t.share_pool,t.stock_market),t.$recalculate_order()},Q.$$arity=1),e.def(se,"$buy_company",ee=function(t,r){var n=this,a=c,i=c,o=c,s=c;return a=t.$owner(),m(a["$is_a?"](d(le,"Corporation")))&&n.$raise(d(le,"GameError"),"Cannot buy "+t.$name()+" from "+a.$name()),i=t.$min_price(),o=t.$max_price(),m(r["$between?"](i,o))||n.$raise(d(le,"GameError"),"Price must be between "+n.game.$format_currency(i)+" and "+n.game.$format_currency(o)),s=[n.current_entity],y(t,"owner=",e.to_a(s)),s[$(s.length,1)],a.$companies().$delete(t),n.$remove_just_sold_company_abilities(),n.just_sold_company=t,n.current_entity.$companies()["$<<"](t),n.current_entity.$spend(r,a),n.log["$<<"](n.current_entity.$name()+" buys "+t.$name()+" from "+a.$name()+" for "+n.game.$format_currency(r))},ee.$$arity=2),e.def(se,"$place_token",te=function(e){var t,r,n=this,a=c,i=c,$=c,o=c;return a=e.$entity(),i=e.$city().$hex(),m(n.$reachable_hexes()["$[]"](e.$city().$hex()))||n.$raise(d(le,"GameError"),"Cannot place token on "+i.$name()+" because it is not connected"),$=m(t=(r=a.$next_token())===c||null==r?c:y(r,"price",[]))?t:0,e.$city().$place_token(a),m($["$positive?"]())&&(a.$spend($,n.bank),o=" for "+n.game.$format_currency($)),n.log["$<<"](a.$name()+" places a token on "+e.$city().$hex().$name()+o),n.$clear_route_cache()},te.$$arity=1),e.def(se,"$remove_just_sold_company_abilities",re=function(){var e=this;return m(e.just_sold_company)?(e.just_sold_company.$remove_ability_when("sold"),e.just_sold_company=c):c},re.$$arity=0),e.def(se,"$log_pass",ne=function(t){var r=ne.$$p,n=this,a=c,i=c,$=c,o=c,s=c;for(r&&(ne.$$p=null),o=0,s=arguments.length,$=new Array(s);o<s;o++)$[o]=arguments[o];return a=n.step["$=="](n.last_action_step)?"finishes":"skips",i=n.step,"track"["$==="](i)?n.log["$<<"](t.$name()+" "+a+" laying track"):"token"["$==="](i)?n.log["$<<"](t.$name()+" "+a+" placing a token"):"train"["$==="](i)?n.log["$<<"](t.$name()+" "+a+" buying trains"):"company"["$==="](i)?n.log["$<<"](t.$name()+" "+a+" buying companies"):y(n,e.find_super_dispatcher(n,"log_pass",ne,!1),$,r)},ne.$$arity=1),e.def(se,"$log_operation",ae=function(e){var t=this;return m(e)?t.log["$<<"](e.$owner().$name()+" operates "+e.$name()):c},ae.$$arity=1),e.def(se,"$liquidate",ie=function(e){var t,r=this;return r.log["$<<"](e.$name()+" goes bankrupt and sells remaining shares"),y(e.$shares_by_corporation(),"each",[],((t=function(r,n){var a=t.$$s||this,i=c;return null==r&&(r=c),null==n&&(n=c),m(i=y(a.$sellable_bundles(e,r),"max_by",[],"price".$to_proc()))?a.$sell_shares(i):c}).$$s=r,t.$$arity=2,t)),e.$spend(e.$cash(),r.bank),r.bankrupt=!0},ie.$$arity=1),e.def(se,"$rust_trains!",$e=function(e){var t,r=this,n=c;return n=[],y(r.game.$trains(),"each",[],((t=function(r){var a;t.$$s;return null==r&&(r=c),m(m(a=r.$owner())?r.$rusts_on()["$=="](e.$name()):a)?(n["$<<"](r.$name()),r["$rust!"]()):c}).$$s=r,t.$$arity=1,t)),m(n["$any?"]())?r.log["$<<"]("-- Event: "+n.$uniq().$join(", ")+" trains rust --"):c},$e.$$arity=1),e.def(se,"$recalculate_order",oe=function(){var r=this,n=c,i=c;return n=t(r.entities.$find_index(r.current_entity),1),m(a(n,$(r.entities.$size(),1)))?(i=[e.Range.$new(n,-1,!1),r.entities["$[]"](e.Range.$new(n,-1,!1)).$sort()],y(r.entities,"[]=",e.to_a(i)),i[$(i.length,1)]):c},oe.$$arity=0)}(b[0],d(b,"Base"),b)}(b[0],b)}(u[0],u)},Opal.modules["engine/round/stock"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var o=e.top,s=[],l=e.nil,u=e.const_get_qualified,c=e.const_get_relative,p=(e.breaker,e.slice,e.module),d=e.klass,_=e.hash2,f=e.send,h=e.truthy;return e.add_stubs(["$attr_reader","$freeze","$share_pool","$stock_market","$corporations","$>","$turn","$new","$[]=","$-","$empty?","$corporation","$>=","$cash","$price","$can_gain?","$!","$[]","$none?","$&","$class","$num_certs","$cert_limit","$all?","$holding_ok?","$!=","$<=","$+","$percent","$percent_of","$==","$size","$uniq","$include?","$last","$presidents_share","$max","$values","$reject","$share_holders","$private","$entity","$===","$buy_share","$share","$sell_shares","$shares","$share_price","$set_par","$first","$<<","$unpass!","$map","$id","$president","$can_sell?","$can_buy?","$must_sell?","$passed?","$nothing_to_do?","$any?","$clear","$each","$next_entity","$finished?","$pass!","$name","$select","$sum","$sort","$move_up","$log_share_price","$raise","$owner","$sell_and_change_price","$find_index","$<"]),o.$require("engine/round/stock.rb/../base"),o.$require("engine/round/stock.rb/../../action/buy_share"),o.$require("engine/round/stock.rb/../../action/par"),o.$require("engine/round/stock.rb/../../action/sell_shares"),function(o,s){var y=[p(o,"Engine")].concat(s);!function(o,s){var y=[p(o,"Round")].concat(s);!function(o,$super,s){var p,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M=d(o,$super,"Stock"),z=[M].concat(s);M.$$prototype.current_actions=M.$$prototype.current_entity=M.$$prototype.players_sold=M.$$prototype.game=M.$$prototype.corporations=M.$$prototype.can_sell=M.$$prototype.share_pool=M.$$prototype.stock_market=M.$$prototype.log=M.$$prototype.entities=l,M.$attr_reader("last_to_act","share_pool","stock_market"),e.const_set(z[0],"PURCHASE_ACTIONS",[u(c(z,"Action"),"BuyShare"),u(c(z,"Action"),"Par")].$freeze()),e.def(M,"$initialize",p=function(n,a){var i,$,o=p.$$p,s=this,u=l,d=l,h=l;for(o&&(p.$$p=null),d=0,h=arguments.length,u=new Array(h);d<h;d++)u[d]=arguments[d];if(null==a)a=_([],{});else if(!a.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(a.$$smap,"game"))throw e.ArgumentError.$new("missing keyword: game");return i=a.$$smap.game,f(s,e.find_super_dispatcher(s,"initialize",p,!1),u,o),s.share_pool=i.$share_pool(),s.stock_market=i.$stock_market(),s.corporations=i.$corporations(),s.can_sell=t(i.$turn(),1),s.players_sold=f(c(z,"Hash"),"new",[],(($=function(t,n){$.$$s;var a=l;return null==t&&(t=l),null==n&&(n=l),a=[n,_([],{})],f(t,"[]=",e.to_a(a)),a[r(a.length,1)]}).$$s=s,$.$$arity=2,$)),s.current_actions=[],s.last_to_act=l},p.$$arity=2),e.def(M,"$name",y=function(){return"Stock Round"},y.$$arity=0),e.def(M,"$description",m=function(){return"Buy and Sell Shares"},m.$$arity=0),e.def(M,"$pass_description",g=function(){return h(this.current_actions["$empty?"]())?"Pass (Share)":"Done (Share)"},g.$$arity=0),e.def(M,"$stock?",b=function(){return!0},b.$$arity=0),e.def(M,"$can_buy?",v=function(e){var t,r,a,i=this,$=l;return h(e)?($=e.$corporation(),h(t=h(r=h(a=n(i.current_entity.$cash(),e.$price()))?i["$can_gain?"](e,i.current_entity):a)?i.players_sold["$[]"](i.current_entity)["$[]"]($)["$!"]():r)?i.current_actions["$&"](u(i.$class(),"PURCHASE_ACTIONS"))["$none?"]():t):l},v.$$arity=1),e.def(M,"$must_sell?",w=function(){var e,r,n=this;return h(e=t(n.current_entity.$num_certs(),n.game.$cert_limit()))?e:f(n.corporations,"all?",[],(r=function(e){var t=r.$$s||this;return null==t.current_entity&&(t.current_entity=l),null==e&&(e=l),e["$holding_ok?"](t.current_entity)},r.$$s=n,r.$$arity=1,r))["$!"]()},w.$$arity=0),e.def(M,"$can_sell?",k=function(e){var r,n,$,o,s=this,c=l;return!!h(s.can_sell)&&(c=e.$corporation(),h(r=h(n=h($=s.players_sold["$[]"](s.current_entity)["$[]"](c)["$!="]("now"))?a(i(e.$percent(),s.share_pool.$percent_of(c)),50):$)?(($=s.current_actions.$uniq().$size()["$=="](2))?u(s.$class(),"PURCHASE_ACTIONS")["$include?"](s.current_actions.$last()):s.current_actions.$uniq().$size()["$=="](2))["$!"]():n)?h(n=e.$presidents_share()["$!"]())?n:t(h($=f(c.$share_holders(),"reject",[],(o=function(e,t){var r=o.$$s||this;return null==r.current_entity&&(r.current_entity=l),null==e&&(e=l),null==t&&(t=l),e["$=="](r.current_entity)},o.$$s=s,o.$$arity=2,o)).$values().$max())?$:0,10):r)},k.$$arity=1),e.def(M,"$did_sell?",x=function(e,t){return this.players_sold["$[]"](t)["$[]"](e)},x.$$arity=2),M.$private(),e.def(M,"$_process_action",E=function(e){var t=this,r=l,n=l,a=l,i=l,$=l;return r=e.$entity(),n=e,u(c(z,"Action"),"BuyShare")["$==="](n)?t.$buy_share(r,e.$share()):u(c(z,"Action"),"SellShares")["$==="](n)?t.$sell_shares(e.$shares()):u(c(z,"Action"),"Par")["$==="](n)?(a=e.$share_price(),i=e.$corporation(),t.stock_market.$set_par(i,a),$=i.$shares().$first(),t.$buy_share(r,$)):l},E.$$arity=1),e.def(M,"$action_processed",O=function(e){var t=this,r=l;return r=e.$entity(),t.current_actions["$<<"](e.$class()),t.last_to_act=r,r["$unpass!"]()},O.$$arity=1),e.def(M,"$nothing_to_do?",A=function(){var e,t,r,n,a,i,$,o,s=this,u=l;return u=f(f(s.current_entity.$shares(),"uniq",[],((e=function(t){e.$$s;return null==t&&(t=l),[t.$corporation().$id(),t.$president()]}).$$s=s,e.$$arity=1,e)),"map",[],((t=function(e){t.$$s;return null==e&&(e=l),c(z,"ShareBundle").$new(e,10)}).$$s=s,t.$$arity=1,t)),h(r=h(n=h(a=f(u,"none?",[],((i=function(e){var t=i.$$s||this;return null==e&&(e=l),t["$can_sell?"](e)}).$$s=s,i.$$arity=1,i)))?f(s.share_pool.$shares(),"none?",[],(($=function(e){var t=$.$$s||this;return null==e&&(e=l),t["$can_buy?"](e)}).$$s=s,$.$$arity=1,$)):a)?f(s.corporations,"none?",[],((o=function(e){var t=o.$$s||this;return null==e&&(e=l),t["$can_buy?"](e.$shares().$first())}).$$s=s,o.$$arity=1,o)):n)?s["$must_sell?"]()["$!"]():r},A.$$arity=0),e.def(M,"$change_entity",T=function(){var t,n,a=this;return h(h(t=a.current_entity["$passed?"]()["$!"]())?a["$nothing_to_do?"]()["$!"]():t)?l:(h(a.current_actions["$any?"]())&&a.current_entity["$unpass!"](),a.current_actions.$clear(),f(a.players_sold["$[]"](a.current_entity),"each",[],((n=function(t,a){var i=n.$$s||this,$=l;return null==i.players_sold&&(i.players_sold=l),null==i.current_entity&&(i.current_entity=l),null==t&&(t=l),null==a&&(a=l),$=[t,"prev"],f(i.players_sold["$[]"](i.current_entity),"[]=",e.to_a($)),$[r($.length,1)]}).$$s=a,n.$$arity=2,n)),a.current_entity=a.$next_entity())},T.$$arity=1),e.def(M,"$action_finalized",S=function(){for(var e,t,r,n=this,a=l;h(h(e=n["$finished?"]()["$!"]())?n["$nothing_to_do?"]():e);)n.current_entity["$pass!"](),n.log["$<<"](n.current_entity.$name()+" has no valid actions and passes"),n.current_entity=n.$next_entity();return h(n["$finished?"]())?(a=f(n.corporations,"select",[],((t=function(e){t.$$s;return null==e&&(e=l),e.$share_holders().$values().$sum()["$=="](100)}).$$s=n,t.$$arity=1,t)),f(a.$sort(),"each",[],((r=function(e){var t=r.$$s||this,n=l;return null==t.stock_market&&(t.stock_market=l),null==e&&(e=l),n=e.$share_price().$price(),t.stock_market.$move_up(e),t.$log_share_price(e,n)}).$$s=n,r.$$arity=1,r))):l},S.$$arity=1),e.def(M,"$sell_shares",I=function(t){var n=this,a=l;return h(n["$can_sell?"](t))||n.$raise(c(z,"GameError"),"Cannot sell shares of "+t.$corporation().$name()),a=[t.$corporation(),"now"],f(n.players_sold["$[]"](t.$owner()),"[]=",e.to_a(a)),a[r(a.length,1)],n.$sell_and_change_price(t,n.share_pool,n.stock_market)},I.$$arity=1),e.def(M,"$buy_share",R=function(e,t){var r,n,a=this;return h(a["$can_buy?"](t))||a.$raise(c(z,"GameError"),"Cannot buy a share of "+((n=(r=t)===l||null==r?l:f(r,"corporation",[]))===l||null==n?l:f(n,"name",[]))),a.share_pool.$buy_share(e,t)},R.$$arity=2),e.def(M,"$distance",C=function(e,t){var n=this,a=l,i=l;return a=n.entities.$find_index(e),i=n.entities.$find_index(t),h($(a,i))?r(i,a):r(i,r(a,n.entities.$size()))},C.$$arity=2),e.def(M,"$log_pass",q=function(t){var r=q.$$p,n=this,a=l,i=l,$=l,o=l;for(r&&(q.$$p=null),$=0,o=arguments.length,i=new Array(o);$<o;$++)i[$]=arguments[$];return h(n.current_actions["$empty?"]())?f(n,e.find_super_dispatcher(n,"log_pass",q,!1),i,r):(a=h(n.current_actions["$include?"](u(c(z,"Action"),"SellShares")))?"buying":"selling",n.log["$<<"](t.$name()+" passes "+a+" shares"))},q.$$arity=1)}(y[0],c(y,"Base"),y)}(y[0],y)}(s[0],s)},Opal.modules["engine/round/auction"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var $=e.top,o=[],s=e.nil,l=e.const_get_qualified,u=e.const_get_relative,c=(e.breaker,e.slice,e.module),p=e.klass,d=e.hash2,_=e.send,f=e.truthy;return e.add_stubs(["$attr_reader","$sort_by","$companies","$to_proc","$first","$bank","$new","$[]=","$-","$empty?","$may_purchase?","$min_bid","$max_by","$[]","$+","$price","$!","$==","$private","$all?","$add_bid","$placement_bid","$each","$any?","$entity","$min_by","$loop","$next_entity","$passed?","$all_passed?","$finished?","$include?","$discount","$discount=","$<<","$name","$format_currency","$<=","$buy_company","$resolve_bids","$change_entity","$payout_companies","$reject!","$unpass!","$company","$accept_bid","$size","$!=","$delete","$<","$raise","$>","$sum","$bids_for_player","$cash","$|","$owner=","$spend","$===","$compact","$map","$values","$find"]),$.$require("engine/round/auction.rb/../../game_error"),$.$require("engine/round/auction.rb/../base"),function($,o){var h=[c($,"Engine")].concat(o);!function($,o){var h=[c($,"Round")].concat(o);!function($,$super,o){var c,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N=p($,$super,"Auction"),j=[N].concat(o);N.$$prototype.companies=N.$$prototype.end_game=N.$$prototype.bids=N.$$prototype.min_increment=N.$$prototype.auctioning_company=N.$$prototype.entities=N.$$prototype.current_entity=N.$$prototype.auction_triggerer=N.$$prototype.cheapest=N.$$prototype.log=N.$$prototype.game=N.$$prototype.bidders=N.$$prototype.bank=s,N.$attr_reader("bids","companies","last_to_act","min_increment"),e.def(N,"$initialize",c=function(r,n){var a,i,$,o,l=c.$$p,p=this,f=s,h=s,y=s;for(l&&(c.$$p=null),h=0,y=arguments.length,f=new Array(y);h<y;h++)f[h]=arguments[h];if(null==n)n=d([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(n.$$smap,"game"))throw e.ArgumentError.$new("missing keyword: game");return a=n.$$smap.game,null==(i=n.$$smap.min_increment)&&(i=5),_(p,e.find_super_dispatcher(p,"initialize",c,!1),f,l),p.companies=_(a.$companies(),"sort_by",[],"value".$to_proc()),p.cheapest=p.companies.$first(),p.bank=a.$bank(),p.min_increment=i,p.bids=_(u(j,"Hash"),"new",[],(($=function(r,n){$.$$s;var a=s;return null==r&&(r=s),null==n&&(n=s),a=[n,[]],_(r,"[]=",e.to_a(a)),a[t(a.length,1)]}).$$s=p,$.$$arity=2,$)),p.bidders=_(u(j,"Hash"),"new",[],((o=function(r,n){o.$$s;var a=s;return null==r&&(r=s),null==n&&(n=s),a=[n,[]],_(r,"[]=",e.to_a(a)),a[t(a.length,1)]}).$$s=p,o.$$arity=2,o)),p.last_to_act=s,p.auctioning_company=s,p.auction_triggerer=s},c.$$arity=2),e.def(N,"$name",h=function(){return"Auction Round"},h.$$arity=0),e.def(N,"$description",y=function(){return"Bid on Companies"},y.$$arity=0),e.def(N,"$pass_description",m=function(){return"Pass (Bidding)"},m.$$arity=0),e.def(N,"$finished?",g=function(){var e,t=this;return f(e=t.end_game)?e:t.companies["$empty?"]()},g.$$arity=0),e.def(N,"$min_bid",b=function(e){var t=this,n=s;return f(e)?f(t["$may_purchase?"](e))?e.$min_bid():(n=_(t.bids["$[]"](e),"max_by",[],"price".$to_proc()),r(f(n)?n.$price():e.$min_bid(),t.min_increment)):s},b.$$arity=1),e.def(N,"$auction?",v=function(){return!0},v.$$arity=0),e.def(N,"$may_purchase?",w=function(e){var t,r=this;return f(t=r.auctioning_company["$!"]())?e["$=="](r.$companies().$first()):t},w.$$arity=1),e.def(N,"$may_bid?",k=function(e){var t,r=this;return f(t=r.auctioning_company["$!"]())?t:e["$=="](r.auctioning_company)},k.$$arity=1),N.$private(),e.def(N,"$all_passed?",x=function(){return _(this.entities,"all?",[],"passed?".$to_proc())},x.$$arity=0),e.def(N,"$_process_action",E=function(e){var t=this;return f(t.auctioning_company)?t.$add_bid(e):(t.last_to_act=t.current_entity,t.$placement_bid(e))},E.$$arity=1),e.def(N,"$action_processed",O=function(){return _(this.entities,"each",[],"unpass!".$to_proc())},O.$$arity=1),
e.def(N,"$change_entity",A=function(){var t,r=this,n=s;return f((n=r.bids["$[]"](r.auctioning_company))["$any?"]())?r.current_entity=_(n,"min_by",[],"price".$to_proc()).$entity():(f(r.auction_triggerer)&&(r.current_entity=r.auction_triggerer),function(){var n=e.new_brk();try{return _(r,"loop",[],((t=function(){var r,a=t.$$s||this;if(null==a.current_entity&&(a.current_entity=s),a.current_entity=a.$next_entity(),!f(f(r=a.current_entity["$passed?"]()["$!"]())?r:a["$all_passed?"]()))return s;e.brk(s,n)}).$$s=r,t.$$brk=n,t.$$arity=0,t))}catch(a){if(a===n)return a.$v;throw a}}())},A.$$arity=1),e.def(N,"$action_finalized",T=function(){var a,i=this,$=s,o=s,l=s;return f(f(a=i.bids["$[]"](i.companies.$first())["$empty?"]())?i["$finished?"]()["$!"]():a)&&(i.auction_triggerer=s),f(f(a=i["$all_passed?"]()["$!"]())?a:i["$finished?"]())?s:(f(i.companies["$include?"](i.cheapest))?($=i.cheapest.$min_bid(),o=[r(i.cheapest.$discount(),5)],_(i.cheapest,"discount=",e.to_a(o)),o[t(o.length,1)],l=i.cheapest.$min_bid(),i.log["$<<"](i.cheapest.$name()+" minimum bid decreases from "+i.game.$format_currency($)+" to "+i.game.$format_currency(l)),f(n(l,0))&&(i.$buy_company(i.current_entity,i.cheapest,0),i.$resolve_bids(),i.$change_entity(s))):i.$payout_companies(),_(i.entities,"each",[],"unpass!".$to_proc()))},T.$$arity=1),e.def(N,"$pass_processed",S=function(){var e,t,r=this;return f(r.auctioning_company)?((e=r.bids["$[]"](r.auctioning_company))===s||null==e||_(e,"reject!",[],((t=function(e){var r=t.$$s||this;return null==r.current_entity&&(r.current_entity=s),null==e&&(e=s),r.current_entity["$unpass!"](),e.$entity()["$=="](r.current_entity)}).$$s=r,t.$$arity=1,t)),r.$resolve_bids()):s},S.$$arity=1),e.def(N,"$placement_bid",I=function(e){var t=this;return t.companies.$first()["$=="](e.$company())?(t.auction_triggerer=e.$entity(),t.$accept_bid(e),t.$resolve_bids()):t.$add_bid(e)},I.$$arity=1),e.def(N,"$resolve_bids",R=function(){for(var e=this,t=s;f(t=e.bids["$[]"](e.companies.$first()))&&!f(t["$empty?"]());){if(!t.$size()["$=="](1)){f(e.auctioning_company["$!="](e.companies.$first()))&&(e.auctioning_company=e.companies.$first(),e.log["$<<"](e.auctioning_company.$name()+" goes up for auction"));break}e.$accept_bid(t.$first())}},R.$$arity=0),e.def(N,"$accept_bid",C=function(e){var t=this,r=s,n=s,a=s;return r=e.$price(),n=e.$company(),a=e.$entity(),t.$buy_company(a,n,r),t.bids.$delete(n),t.auctioning_company=s},C.$$arity=1),e.def(N,"$add_bid",q=function(r){var n,$=this,o=s,c=s,p=s,d=s,h=s,y=s;return o=r.$company(),c=r.$entity(),p=r.$price(),d=$.$min_bid(o),f(a(r.$price(),d))&&$.$raise(l(u(j,"Engine"),"GameError"),"Minimum bid is "+d+" "+$.current_entity.$name()+" "+o.$name()),f(i(_($.$bids_for_player(c),"sum",[],"price".$to_proc()),c.$cash()))&&$.$raise(u(j,"GameError"),"Cannot afford bid"),h=$.bids["$[]"](o),_(h,"reject!",[],((n=function(e){n.$$s;return null==e&&(e=s),e.$entity()["$=="](c)}).$$s=$,n.$$arity=1,n)),h["$<<"](r),y=[o,$.bidders["$[]"](o)["$|"]([c])],_($.bidders,"[]=",e.to_a(y)),y[t(y.length,1)],$.log["$<<"](c.$name()+" bids "+$.game.$format_currency(p)+" for "+r.$company().$name())},q.$$arity=1),e.def(N,"$buy_company",M=function(r,n,a){var i=this,$=s,o=s;return $=[r],_(n,"owner=",e.to_a($)),$[t($.length,1)],r.$companies()["$<<"](n),r.$spend(a,i.bank),i.companies.$delete(n),i.log["$<<"]((o=i.bidders["$[]"](n).$size(),(0)["$==="](o)?r.$name()+" buys "+n.$name()+" for "+i.game.$format_currency(a):1["$==="](o)?r.$name()+" wins the auction for "+n.$name()+" with the only bid of "+i.game.$format_currency(a):r.$name()+" wins the auction for "+n.$name()+" with a bid of "+i.game.$format_currency(a)))},M.$$arity=3),e.def(N,"$bids_for_player",z=function(e){var t,r=this;return _(r.bids.$values(),"map",[],(t=function(r){var n,a=t.$$s||this;return null==r&&(r=s),_(r,"find",[],((n=function(t){n.$$s;return null==t&&(t=s),t.$entity()["$=="](e)}).$$s=a,n.$$arity=1,n))},t.$$s=r,t.$$arity=1,t)).$compact()},z.$$arity=1)}(h[0],u(h,"Base"),h)}(h[0],h)}(o[0],o)},Opal.modules["engine/round/base"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var a=e.top,i=[],$=e.nil,o=e.const_get_qualified,s=e.const_get_relative,l=(e.breaker,e.slice,e.module),u=e.klass,c=e.hash2,p=e.truthy,d=e.send;return e.add_stubs(["$attr_reader","$log","$first","$<<","$name","$turn","$game","$raise","$player","$+","$find_index","$<","$size","$[]","$pass!","$entity","$is_a?","$can_act?","$pass?","$log_pass","$pass","$pass_processed","$_process_action","$action_processed","$change_entity","$action_finalized","$all?","$to_proc","$include?","$active_entities","$compact","$map","$potential_tiles","$rotate!","$legal_rotations","$legal_rotations=","$-","$empty?","$sort_by","$shares_of","$with_index","$flat_map","$take","$sum","$new","$president","$insert","$select","$can_sell?","$private","$tiles","$phase","$color","$upgrade_tiles","$tile","$sell_shares","$corporation","$price","$share_price","$times","$num_shares","$move_down","$log_share_price","$hex","$rotation","$reject!","$equal?","$preprinted","$lay","$respond_to?","$companies","$upgrade_cost","$zero?","$spend","$bank","$format_currency","$each","$owner","$revenue","$!=","$next_entity","$holding_ok?","$percent","$!","$counts_for_limit","$num_certs","$cert_limit"]),a.$require("engine/round/base.rb/../../action/message"),a.$require("engine/round/base.rb/../../game_error"),a.$require("engine/round/base.rb/../../share_bundle"),function(a,i){var _=[l(a,"Engine")].concat(i);!function(a,i){var _=[l(a,"Round")].concat(i);!function(a,$super,i){var l,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K=u(a,null,"Base"),Y=[K].concat(i);K.$$prototype.entities=K.$$prototype.log=K.$$prototype.current_entity=K.$$prototype.end_game=K.$$prototype.game=$,K.$attr_reader("entities","current_entity","end_game"),e.def(K,"$initialize",l=function(t,r){var n,a=this;if(null==r)r=c([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(r.$$smap,"game"))throw e.ArgumentError.$new("missing keyword: game");return n=r.$$smap.game,e.kwrestargs(r,{game:!0}),a.game=n,a.entities=t,a.log=n.$log(),a.current_entity=a.entities.$first(),a.end_game=!1},l.$$arity=2),e.def(K,"$log_new_round",_=function(){var e=this;return e.log["$<<"]("-- "+e.$name()+" "+e.$game().$turn()+" --")},_.$$arity=0),e.def(K,"$name",f=function(){return this.$raise(s(Y,"NotImplementedError"))},f.$$arity=0),e.def(K,"$description",h=function(){return this.$raise(s(Y,"NotImplementedError"))},h.$$arity=0),e.def(K,"$pass_description",y=function(){return this.$raise(s(Y,"NotImplementedError"))},y.$$arity=0),e.def(K,"$current_player",m=function(){return this.current_entity.$player()},m.$$arity=0),e.def(K,"$active_entities",g=function(){return[this.current_entity]},g.$$arity=0),e.def(K,"$next_entity",b=function(){var e=this,n=$;return n=t(e.entities.$find_index(e.current_entity),1),p(r(n,e.entities.$size()))?e.entities["$[]"](n):e.entities["$[]"](0)},b.$$arity=0),e.def(K,"$pass",v=function(e){return e.$entity()["$pass!"]()},v.$$arity=1),e.def(K,"$process_action",w=function(e){var t=this,r=$;return r=e.$entity(),p(e["$is_a?"](o(s(Y,"Action"),"EndGame")))?(t.end_game=!0,t.log["$<<"]("-- Game ended by owner --"),$):p(e["$is_a?"](o(s(Y,"Action"),"Message")))?t.log["$<<"](e):(p(t["$can_act?"](r))||t.$raise(s(Y,"GameError"),"It is not "+r.$name()+"'s turn"),p(e["$pass?"]())?(t.$log_pass(r),t.$pass(e),t.$pass_processed(e)):(t.$_process_action(e),t.$action_processed(e)),t.$change_entity(e),t.$action_finalized(e))},w.$$arity=1),e.def(K,"$finished?",k=function(){var e,t=this;return p(e=t.end_game)?e:d(t.entities,"all?",[],"passed?".$to_proc())},k.$$arity=0),e.def(K,"$can_act?",x=function(e){return this.$active_entities()["$include?"](e)},x.$$arity=1),e.def(K,"$auction?",E=function(){return!1},E.$$arity=0),e.def(K,"$stock?",O=function(){return!1},O.$$arity=0),e.def(K,"$operating?",A=function(){return!1},A.$$arity=0),e.def(K,"$can_lay_track?",T=function(){return!1},T.$$arity=0),e.def(K,"$can_place_token?",S=function(){return!1},S.$$arity=0),e.def(K,"$layable_hexes",I=function(){return c([],{})},I.$$arity=0),e.def(K,"$upgradeable_tiles",R=function(t){var r,a=this;return d(a.$potential_tiles(t),"map",[],(r=function(a){var i=r.$$s||this,o=$;return null==a&&(a=$),a["$rotate!"](0),o=[i.$legal_rotations(t,a)],d(a,"legal_rotations=",e.to_a(o)),o[n(o.length,1)],p(a.$legal_rotations()["$empty?"]())?$:(a["$rotate!"](),a)},r.$$s=a,r.$$arity=1,r)).$compact()},R.$$arity=1),e.def(K,"$sellable_bundles",C=function(e,r){var a,i,l=this,u=$,c=$;return u=d(e.$shares_of(r),"sort_by",[],"price".$to_proc()),c=d(u.$flat_map(),"with_index",[],((a=function(e,r){a.$$s;var i=$,l=$;return null==e&&(e=$),null==r&&(r=$),i=u.$take(t(r,1)),l=d(i,"sum",[],"percent".$to_proc()),c=[o(s(Y,"Engine"),"ShareBundle").$new(i,l)],p(e.$president())&&c.$insert(0,o(s(Y,"Engine"),"ShareBundle").$new(i,n(l,10))),c}).$$s=l,a.$$arity=2,a)),d(c,"select",[],((i=function(e){var t=i.$$s||this;return null==e&&(e=$),t["$can_sell?"](e)}).$$s=l,i.$$arity=1,i))},C.$$arity=2),e.def(K,"$did_sell?",q=function(){return!1},q.$$arity=2),K.$private(),e.def(K,"$potential_tiles",M=function(e){var t,r=this,n=$,a=$;return n=r.game.$phase().$tiles(),a=d(r.game.$tiles(),"select",[],((t=function(e){t.$$s;return null==e&&(e=$),n["$include?"](e.$color())}).$$s=r,t.$$arity=1,t)),e.$tile().$upgrade_tiles(a)},M.$$arity=1),e.def(K,"$sell_and_change_price",z=function(e,t,r){var n,a=this,i=$,o=$;return t.$sell_shares(e),o=(i=e.$corporation()).$share_price().$price(),d(e.$num_shares(),"times",[],((n=function(){n.$$s;return r.$move_down(i)}).$$s=a,n.$$arity=0,n)),a.$log_share_price(i,o)},z.$$arity=3),e.def(K,"$lay_tile",N=function(e){var t,r=this,n=$,a=$,i=$,o=$,s=$,l=$,u=$;return n=e.$entity(),a=e.$tile(),i=e.$hex(),o=e.$rotation(),s=i.$tile(),d(r.game.$tiles(),"reject!",[],((t=function(e){t.$$s;return null==e&&(e=$),a["$equal?"](e)}).$$s=r,t.$$arity=1,t)),p(s.$preprinted())||r.game.$tiles()["$<<"](s),a["$rotate!"](o),i.$lay(a),l=p(n["$respond_to?"]("companies"))?d(n.$companies(),"flat_map",[],"all_abilities".$to_proc()):[],u=s.$upgrade_cost(l),p(u["$zero?"]())||n.$spend(u,r.game.$bank()),r.log["$<<"](e.$entity().$name()+(p(u["$zero?"]())?"":" spends "+r.game.$format_currency(u)+" and")+" lays tile "+a.$name()+" with rotation "+o+" on "+i.$name())},N.$$arity=1),e.def(K,"$payout_companies",j=function(){var e,t=this;return d(d(t.game.$companies(),"select",[],"owner".$to_proc()),"each",[],((e=function(t){var r=e.$$s||this,n=$,a=$;return null==r.game&&(r.game=$),null==r.log&&(r.log=$),null==t&&(t=$),n=t.$owner(),a=t.$revenue(),r.game.$bank().$spend(a,n),r.log["$<<"](n.$name()+" collects "+r.game.$format_currency(a)+" from "+t.$name())}).$$s=t,e.$$arity=1,e))},j.$$arity=0),e.def(K,"$log_share_price",P=function(e,t){var r=this,n=$;return n=e.$share_price().$price(),p(t["$!="](n))?r.log["$<<"](e.$name()+"'s share price changes from "+r.game.$format_currency(t)+" to "+r.game.$format_currency(n)):$},P.$$arity=2),e.def(K,"$log_pass",B=function(e){return this.log["$<<"](e.$name()+" passes")},B.$$arity=1),e.def(K,"$_process",L=function(){return this.$raise(s(Y,"NotImplementedError"))},L.$$arity=1),e.def(K,"$change_entity",D=function(){var e=this;return e.current_entity=e.$next_entity()},D.$$arity=1),e.def(K,"$pass_processed",G=function(){return $},G.$$arity=1),e.def(K,"$action_processed",H=function(){return $},H.$$arity=1),e.def(K,"$action_finalized",F=function(){return $},F.$$arity=1),e.def(K,"$can_gain?",U=function(e,t){var n,a,i=this,o=$;return p(e)?(o=e.$corporation(),p(n=o["$holding_ok?"](t,e.$percent()))?p(a=o.$counts_for_limit()["$!"]())?a:r(t.$num_certs(),i.game.$cert_limit()):n):$},U.$$arity=2)}(_[0],0,_)}(_[0],_)}(i[0],i)},Opal.modules["engine/corporation"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}var a=e.top,i=[],$=e.nil,o=(e.const_get_qualified,e.const_get_relative),s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.send,p=e.truthy;return e.add_stubs(["$include","$attr_accessor","$attr_reader","$map","$new","$each","$times","$+","$<<","$[]","$shares_by_corporation","$share_price","$<=>","$price","$last","$coordinates","$-@","$find_index","$corporations","$counts_for_limit","$find","$!","$used?","$spend","$owner","$remove_train","$owner=","$-","$delete","$==","$<=","$percent_of","$[]=","$name","$class","$id","$include?","$color"]),a.$require("engine/corporation.rb/../ownable"),a.$require("engine/corporation.rb/../passer"),a.$require("engine/corporation.rb/../share"),a.$require("engine/corporation.rb/../share_holder"),a.$require("engine/corporation.rb/../spender"),a.$require("engine/corporation.rb/../token"),function(a,i){var d=[s(a,"Engine")].concat(i);!function(a,$super,i){var s,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T=l(a,null,"Corporation"),S=[T].concat(i);T.$$prototype.share_price=T.$$prototype.tokens=T.$$prototype.share_holders=T.$$prototype.name=T.$$prototype.trains=T.$$prototype.float_percent=T.$$prototype.revenue_history=$,T.$include(o(S,"Ownable")),T.$include(o(S,"Passer")),T.$include(o(S,"ShareHolder")),T.$include(o(S,"Spender")),T.$attr_accessor("ipoed","par_price","share_price","tokens"),T.$attr_reader("companies","coordinates","min_price","name","full_name","logo","trains","color","revenue_history"),e.def(T,"$initialize",s=function(r){var n,a,i,s,l,d,_,f,h=this;if(null==r)r=u([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(r.$$smap,"sym"))throw e.ArgumentError.$new("missing keyword: sym");if(n=r.$$smap.sym,!e.hasOwnProperty.call(r.$$smap,"name"))throw e.ArgumentError.$new("missing keyword: name");if(a=r.$$smap.name,!e.hasOwnProperty.call(r.$$smap,"tokens"))throw e.ArgumentError.$new("missing keyword: tokens");return i=r.$$smap.tokens,s=e.kwrestargs(r,{sym:!0,name:!0,tokens:!0}),h.name=n,h.full_name=a,h.tokens=c(i,"map",[],((l=function(e){var t=l.$$s||this;return null==e&&(e=$),o(S,"Token").$new(t,u(["price"],{price:e}))}).$$s=h,l.$$arity=1,l)),c([o(S,"Share").$new(h,u(["president","percent"],{president:!0,percent:20}))].concat(e.to_a(c(8..$times(),"map",[],((d=function(e){var r=d.$$s||this;return null==e&&(e=$),o(S,"Share").$new(r,u(["percent","index"],{percent:10,index:t(e,1)}))}).$$s=h,d.$$arity=1,d)))),"each",[],((_=function(e){var t=_.$$s||this;return null==e&&(e=$),t.$shares_by_corporation()["$[]"](t)["$<<"](e)}).$$s=h,_.$$arity=1,_)),h.share_price=$,h.par_price=$,h.ipoed=!1,h.trains=[],h.companies=[],h.revenue_history=u([],{}),h.cash=0,h.float_percent=p(f=s["$[]"]("float_percent"))?f:60,h.coordinates=s["$[]"]("coordinates"),h.min_price=s["$[]"]("min_price"),h.logo="/logos/"+s["$[]"]("logo")+".svg",h.color=s["$[]"]("color")},s.$$arity=1),e.def(T,"$<=>",d=function(e){var t,r=this,n=$,a=$;return n=r.$share_price(),[(a=e.$share_price()).$price(),(t=a.$coordinates(),t===$||null==t?$:c(t,"last",[])),a.$corporations().$find_index(e)["$-@"]()]["$<=>"]([n.$price(),n.$coordinates().$last(),n.$corporations().$find_index(r)["$-@"]()])},d.$$arity=1),e.def(T,"$counts_for_limit",_=function(){var e=this;return!p(e.share_price)||e.share_price.$counts_for_limit()},_.$$arity=0),e.def(T,"$next_token",f=function(){var e,t=this;return c(t.tokens,"find",[],((e=function(t){e.$$s;return null==t&&(t=$),t["$used?"]()["$!"]()}).$$s=t,e.$$arity=1,e))},f.$$arity=0),e.def(T,"$share_holders",h=function(){var e,t=this;return t.share_holders=p(e=t.share_holders)?e:o(S,"Hash").$new(0)},h.$$arity=0),e.def(T,"$id",y=function(){return this.name},y.$$arity=0),e.def(T,"$buy_train",m=function(t,n){var a,i=this,o=$;return null==n&&(n=$),i.$spend(p(a=n)?a:t.$price(),t.$owner()),t.$owner().$remove_train(t),o=[i],c(t,"owner=",e.to_a(o)),o[r(o.length,1)],i.trains["$<<"](t)},m.$$arity=-2),e.def(T,"$remove_train",g=function(e){return this.trains.$delete(e)},g.$$arity=1),e.def(T,"$president?",b=function(e){var t=this;return!!p(e)&&t.$owner()["$=="](e)},b.$$arity=1),e.def(T,"$floated?",v=function(){var e=this;return n(e.$percent_of(e),r(100,e.float_percent))},v.$$arity=0),e.def(T,"$player?",w=function(){return!1},w.$$arity=0),e.def(T,"$company?",k=function(){return!1},k.$$arity=0),e.def(T,"$corporation?",x=function(){return!0},x.$$arity=0),e.def(T,"$add_revenue!",E=function(t,n,a){var i=$;return i=[[t,n],a],c(this.revenue_history,"[]=",e.to_a(i)),i[r(i.length,1)]},E.$$arity=3),e.def(T,"$inspect",O=function(){var e=this;return"<"+e.$class().$name()+": "+e.$id()+">"},O.$$arity=0),e.def(T,"$holding_ok?",A=function(e,r){var a,i,o=this,s=$;return null==r&&(r=0),s=t(e.$percent_of(o),r),p(a=["orange","brown"]["$include?"]((i=o.share_price)===$||null==i?$:c(i,"color",[])))?a:n(s,60)},A.$$arity=-2)}(d[0],0,d)}(i[0],i)},Opal.modules["engine/action/lay_tile"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$tile_by_id","$[]","$hex_by_id","$id"]),t.$require("engine/action/lay_tile.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l=$(t,$super,"LayTile");[l].concat(r);l.$$prototype.hex=l.$$prototype.tile=l.$$prototype.rotation=n,l.$attr_reader("hex","tile","rotation"),e.def(l,"$initialize",a=function(e,t,r,n){var a=this;return a.entity=e,a.hex=r,a.tile=t,a.rotation=n},a.$$arity=4),e.defs(l,"$h_to_args",i=function(e,t){return[t.$tile_by_id(e["$[]"]("tile")),t.$hex_by_id(e["$[]"]("hex")),e["$[]"]("rotation")]},i.$$arity=2),e.def(l,"$args_to_h",s=function(){var e=this;return o(["hex","tile","rotation"],{hex:e.hex.$id(),tile:e.tile.$id(),rotation:e.rotation})},s.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/dividend"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$[]"]),t.$require("engine/action/dividend.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l=$(t,$super,"Dividend");[l].concat(r);l.$$prototype.kind=n,l.$attr_reader("kind"),e.def(l,"$initialize",a=function(e,t){var r=this;return r.entity=e,r.kind=t},a.$$arity=2),e.defs(l,"$h_to_args",i=function(e){return[e["$[]"]("kind")]},i.$$arity=2),e.def(l,"$args_to_h",s=function(){return o(["kind"],{kind:this.kind})},s.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/par"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$corporation_by_id","$[]","$share_price_by_id","$id"]),t.$require("engine/action/par.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l=$(t,$super,"Par");[l].concat(r);l.$$prototype.corporation=l.$$prototype.share_price=n,l.$attr_reader("corporation","share_price"),e.def(l,"$initialize",a=function(e,t,r){var n=this;return n.entity=e,n.corporation=t,n.share_price=r},a.$$arity=3),e.defs(l,"$h_to_args",i=function(e,t){return[t.$corporation_by_id(e["$[]"]("corporation")),t.$share_price_by_id(e["$[]"]("share_price"))]},i.$$arity=2),e.def(l,"$args_to_h",s=function(){var e=this;return o(["corporation","share_price"],{corporation:e.corporation.$id(),share_price:e.share_price.$id()})},s.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/bankrupt"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass;return t.$require("engine/action/bankrupt.rb/../base"),function(t,r){var $=[a(t,"Engine")].concat(r);!function(t,r){var $=[a(t,"Action")].concat(r);!function(t,$super,r){var n,a=i(t,$super,"Bankrupt");[a].concat(r);e.def(a,"$initialize",n=function(e){return this.entity=e},n.$$arity=1)}($[0],n($,"Base"),$)}($[0],$)}(r[0],r)},Opal.modules["engine/action/end_game"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass;return t.$require("engine/action/end_game.rb/../base"),function(e,t){var r=[a(e,"Engine")].concat(t);!function(e,t){var r=[a(e,"Action")].concat(t);!function(e,$super,t){[i(e,$super,"EndGame")].concat(t)}(r[0],n(r,"Base"),r)}(r[0],r)}(r[0],r)},Opal.modules["engine/action/run_routes"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.send,s=e.hash2;return e.add_stubs(["$attr_reader","$map","$[]","$new","$phase","$train_by_id","$each","$add_hex","$hex_by_id","$id","$train","$hexes","$to_proc"]),t.$require("engine/action/run_routes.rb/../base"),t.$require("engine/action/run_routes.rb/../../route"),function(t,r){var l=[i(t,"Engine")].concat(r);!function(t,r){var l=[i(t,"Action")].concat(r);!function(t,$super,r){var i,l,u,c=$(t,$super,"RunRoutes"),p=[c].concat(r);c.$$prototype.routes=n,c.$attr_reader("routes"),e.def(c,"$initialize",i=function(e,t){var r=this;return r.entity=e,r.routes=t},i.$$arity=2),e.defs(c,"$h_to_args",l=function(e,t){var r,i=this;return[o(e["$[]"]("routes"),"map",[],((r=function(e){var i,$=r.$$s||this,s=n;return null==e&&(e=n),s=a(p,"Route").$new(t.$phase(),t.$train_by_id(e["$[]"]("train"))),o(e["$[]"]("hexes"),"each",[],((i=function(e){i.$$s;return null==e&&(e=n),s.$add_hex(t.$hex_by_id(e))}).$$s=$,i.$$arity=1,i)),s}).$$s=i,r.$$arity=1,r))]},l.$$arity=2),e.def(c,"$args_to_h",u=function(){var e,t=this,r=n;return r=o(t.routes,"map",[],((e=function(t){e.$$s;return null==t&&(t=n),s(["train","hexes"],{train:t.$train().$id(),hexes:o(t.$hexes(),"map",[],"id".$to_proc())})}).$$s=t,e.$$arity=1,e)),s(["routes"],{routes:r})},u.$$arity=0)}(l[0],a(l,"Base"),l)}(l[0],l)}(r[0],r)},Opal.modules["engine/action/buy_train"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy,u=e.send;return e.add_stubs(["$attr_reader","$train_by_id","$[]","$id","$[]=","$-"]),r.$require("engine/action/buy_train.rb/../base"),function(r,n){var c=[$(r,"Engine")].concat(n);!function(r,n){var c=[$(r,"Action")].concat(n);!function(r,$super,n){var i,$,c,p=o(r,$super,"BuyTrain");[p].concat(n);p.$$prototype.train=p.$$prototype.price=p.$$prototype.exchange=a,p.$attr_reader("train","price","exchange"),e.def(p,"$initialize",i=function(e,t,r,n){var i=this;return null==n&&(n=a),i.entity=e,i.train=t,i.price=r,i.exchange=n},i.$$arity=-4),e.defs(p,"$h_to_args",$=function(e,t){return[t.$train_by_id(e["$[]"]("train")),e["$[]"]("price"),t.$train_by_id(e["$[]"]("exchange"))]},$.$$arity=2),e.def(p,"$args_to_h",c=function(){var r=this,n=a,i=a;return n=s(["train","price"],{train:r.train.$id(),price:r.price}),l(r.exchange)&&(i=["exchange",r.exchange.$id()],u(n,"[]=",e.to_a(i)),i[t(i.length,1)]),n},c.$$arity=0)}(c[0],i(c,"Base"),c)}(c[0],c)}(n[0],n)},Opal.modules["engine/action/buy_company"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$company_by_id","$[]","$id"]),t.$require("engine/action/buy_company.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l=$(t,$super,"BuyCompany");[l].concat(r);l.$$prototype.company=l.$$prototype.price=n,l.$attr_reader("entity","company","price"),e.def(l,"$initialize",a=function(e,t,r){var n=this;return n.entity=e,n.company=t,n.price=r},a.$$arity=3),e.defs(l,"$h_to_args",i=function(e,t){return[t.$company_by_id(e["$[]"]("company")),e["$[]"]("price")]},i.$$arity=2),e.def(l,"$args_to_h",s=function(){var e=this;return o(["company","price"],{company:e.company.$id(),price:e.price})},s.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/pass"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass;return t.$require("engine/action/pass.rb/../base"),function(t,r){var $=[a(t,"Engine")].concat(r);!function(t,r){var $=[a(t,"Action")].concat(r);!function(t,$super,r){var n,a=i(t,$super,"Pass");[a].concat(r);e.def(a,"$pass?",n=function(){return!0},n.$$arity=0)}($[0],n($,"Base"),$)}($[0],$)}(r[0],r)},Opal.modules["engine/action/discard_train"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$train_by_id","$[]","$id"]),t.$require("engine/action/discard_train.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l=$(t,$super,"DiscardTrain");[l].concat(r);l.$$prototype.train=n,l.$attr_reader("train"),e.def(l,"$initialize",a=function(e,t){var r=this;return r.entity=e,r.train=t},a.$$arity=2),e.defs(l,"$h_to_args",i=function(e,t){return[t.$train_by_id(e["$[]"]("train"))]},i.$$arity=2),e.def(l,"$args_to_h",s=function(){return o(["train"],{train:this.train.$id()})},s.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/buy_share"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$corporation","$share_by_id","$[]","$id"]),t.$require("engine/action/buy_share.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l,u=$(t,$super,"BuyShare");[u].concat(r);u.$$prototype.share=n,u.$attr_reader("entity","share"),e.def(u,"$initialize",a=function(e,t){var r=this;return r.entity=e,r.share=t},a.$$arity=2),e.def(u,"$corporation",i=function(){return this.share.$corporation()},i.$$arity=0),e.defs(u,"$h_to_args",s=function(e,t){return[t.$share_by_id(e["$[]"]("share"))]},s.$$arity=2),e.def(u,"$args_to_h",l=function(){return o(["share"],{share:this.share.$id()})},l.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/redo"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass;return t.$require("engine/action/redo.rb/../base"),function(e,t){var r=[a(e,"Engine")].concat(t);!function(e,t){var r=[a(e,"Action")].concat(t);!function(e,$super,t){[i(e,$super,"Redo")].concat(t)}(r[0],n(r,"Base"),r)}(r[0],r)}(r[0],r)},Opal.modules["engine/action/bid"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$company_by_id","$[]","$id"]),t.$require("engine/action/bid.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l=$(t,$super,"Bid");[l].concat(r);l.$$prototype.company=l.$$prototype.price=n,l.$attr_reader("company","price"),e.def(l,"$initialize",a=function(e,t,r){var n=this;return n.entity=e,n.company=t,n.price=r},a.$$arity=3),e.defs(l,"$h_to_args",i=function(e,t){return[t.$company_by_id(e["$[]"]("company")),e["$[]"]("price")]},i.$$arity=2),e.def(l,"$args_to_h",s=function(){var e=this;return o(["company","price"],{company:e.company.$id(),price:e.price})},s.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/undo"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass;return t.$require("engine/action/undo.rb/../base"),function(e,t){var r=[a(e,"Engine")].concat(t);!function(e,t){var r=[a(e,"Action")].concat(t);!function(e,$super,t){[i(e,$super,"Undo")].concat(t)}(r[0],n(r,"Base"),r)}(r[0],r)}(r[0],r)},Opal.modules["engine/action/place_token"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$city_by_id","$[]","$id"]),t.$require("engine/action/place_token.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l=$(t,$super,"PlaceToken");[l].concat(r);l.$$prototype.city=l.$$prototype.slot=n,l.$attr_reader("city","slot"),e.def(l,"$initialize",a=function(e,t,r){var n=this;return n.entity=e,n.city=t,n.slot=r},a.$$arity=3),e.defs(l,"$h_to_args",i=function(e,t){return[t.$city_by_id(e["$[]"]("city")),e["$[]"]("slot")]},i.$$arity=2),e.def(l,"$args_to_h",s=function(){var e=this;return o(["city","slot"],{city:e.city.$id(),slot:e.slot})},s.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/sell_shares"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.truthy,s=e.send,l=e.hash2;return e.add_stubs(["$attr_reader","$new","$sum","$to_proc","$map","$[]","$share_by_id","$shares","$percent"]),t.$require("engine/action/sell_shares.rb/../base"),t.$require("engine/action/sell_shares.rb/../../share_bundle"),function(t,r){var u=[i(t,"Engine")].concat(r);!function(t,r){var u=[i(t,"Action")].concat(r);!function(t,$super,r){var i,u,c,p=$(t,$super,"SellShares"),d=[p].concat(r);p.$$prototype.shares=n,p.$attr_reader("entity","shares"),e.def(p,"$initialize",i=function(e,t,r){var i,$=this;return null==r&&(r=n),$.entity=e,$.shares=a(d,"ShareBundle").$new(t,o(i=r)?i:s(t,"sum",[],"percent".$to_proc()))},i.$$arity=-3),e.defs(p,"$h_to_args",u=function(e,t){var r,a=this;return[s(e["$[]"]("shares"),"map",[],(r=function(e){r.$$s;return null==e&&(e=n),t.$share_by_id(e)},r.$$s=a,r.$$arity=1,r)),e["$[]"]("percent")]},u.$$arity=2),e.def(p,"$args_to_h",c=function(){var e=this;return l(["shares","percent"],{shares:s(e.shares.$shares(),"map",[],"id".$to_proc()),percent:e.shares.$percent()})},c.$$arity=0)}(u[0],a(u,"Base"),u)}(u[0],u)}(r[0],r)},Opal.modules["engine/action/message"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$attr_reader","$[]"]),t.$require("engine/action/message.rb/../base"),function(t,r){var s=[i(t,"Engine")].concat(r);!function(t,r){var s=[i(t,"Action")].concat(r);!function(t,$super,r){var a,i,s,l=$(t,$super,"Message");[l].concat(r);l.$$prototype.message=n,l.$attr_reader("message"),e.def(l,"$initialize",a=function(e,t){var r=this;return r.entity=e,r.message=t},a.$$arity=2),e.defs(l,"$h_to_args",i=function(e){return[e["$[]"]("message")]},i.$$arity=2),e.def(l,"$args_to_h",s=function(){return o(["message"],{message:this.message})},s.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/action/base"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module),a=e.klass,i=e.send,$=(e.hash,e.hash2);return e.add_stubs(["$attr_reader","$attr_accessor","$join","$map","$split","$to_proc","$send","$[]","$new","$h_to_args","$name","$to_h","$type_s","$id","$entity","$args_to_h","$from_h","$class","$private","$downcase","$gsub","$last"]),function(t,o){var s=[n(t,"Engine")].concat(o);!function(t,o){var s=[n(t,"Action")].concat(o);!function(t,$super,n){var o,s,l,u,c,p,d,_,f,h,y,m=a(t,null,"Base");[m].concat(n);m.$$prototype.id=r,m.$attr_reader("entity"),m.$attr_accessor("id"),e.defs(m,"$type",o=function(e){return i(e.$split("_"),"map",[],"capitalize".$to_proc()).$join()},o.$$arity=1),e.defs(m,"$from_h",s=function(t,n){var a=this,$=r;return $=n.$send(t["$[]"]("entity_type")+"_by_id",t["$[]"]("entity")),i(a,"new",[$].concat(e.to_a(a.$h_to_args(t,n))))},s.$$arity=2),e.defs(m,"$h_to_args",l=function(){return[]},l.$$arity=2),e.defs(m,"$split",u=function(e){return e.$name().$split("::")},u.$$arity=1),e.def(m,"$initialize",c=function(e){return this.entity=e},c.$$arity=1),e.def(m,"$[]",p=function(e){return this.$to_h()["$[]"](e)},p.$$arity=1),e.def(m,"$to_h",d=function(){var t=this;return $(["type","entity","entity_type","id"],{type:t.$type_s(t),entity:t.$entity().$id(),entity_type:t.$type_s(t.$entity()),id:t.id}).$merge(e.to_hash(t.$args_to_h()))},d.$$arity=0),e.def(m,"$args_to_h",_=function(){return $([],{})},_.$$arity=0),e.def(m,"$pass?",f=function(){return!1},f.$$arity=0),e.def(m,"$copy",h=function(e){var t=this
;return t.$class().$from_h(t.$to_h(),e)},h.$$arity=1),m.$private(),e.def(m,"$type_s",y=function(e){return this.$class().$split(e.$class()).$last().$gsub(/(.)([A-Z])/,"\\1_\\2").$downcase()},y.$$arity=1)}(s[0],0,s)}(s[0],s)}(t[0],t)},Opal.modules["engine/part/offboard"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.truthy;return e.add_stubs(["$include","$parse_revenue","$offboard?","$==","$revenue"]),t.$require("engine/part/offboard.rb/../base"),t.$require("engine/part/offboard.rb/../revenue_center"),function(t,r){var l=[$(t,"Engine")].concat(r);!function(t,r){var l=[$(t,"Part")].concat(r);!function(t,$super,r){var $,l,u,c=o(t,$super,"Offboard"),p=[c].concat(r);c.$$prototype.revenue=n,c.$include(a(i(p,"Part"),"RevenueCenter")),e.def(c,"$initialize",$=function(e){var t=this;return t.revenue=t.$parse_revenue(e)},$.$$arity=1),e.def(c,"$offboard?",l=function(){return!0},l.$$arity=0),e.def(c,"$==",u=function(e){var t,r=this;return s(t=e["$offboard?"]())?r.revenue["$=="](e.$revenue()):t},u.$$arity=1)}(l[0],i(l,"Base"),l)}(l[0],l)}(r[0],r)},Opal.modules["engine/part/town"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.truthy;return e.add_stubs(["$include","$attr_reader","$parse_revenue","$town?","$==","$revenue"]),t.$require("engine/part/town.rb/../base"),t.$require("engine/part/town.rb/../revenue_center"),function(t,r){var l=[$(t,"Engine")].concat(r);!function(t,r){var l=[$(t,"Part")].concat(r);!function(t,$super,r){var $,l,u,c,p=o(t,$super,"Town"),d=[p].concat(r);p.$$prototype.revenue=n,p.$include(a(i(d,"Part"),"RevenueCenter")),p.$attr_reader("revenue"),e.def(p,"$initialize",$=function(e){var t=this;return t.revenue=t.$parse_revenue(e)},$.$$arity=1),e.def(p,"$==",l=function(e){var t,r=this;return s(t=e["$town?"]())?r.revenue["$=="](e.$revenue()):t},l.$$arity=1),e.def(p,"$<=",u=function(e){return e["$town?"]()},u.$$arity=1),e.def(p,"$town?",c=function(){return!0},c.$$arity=0)}(l[0],i(l,"Base"),l)}(l[0],l)}(r[0],r)},Opal.modules["engine/part/upgrade"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.truthy,s=e.send;return e.add_stubs(["$attr_reader","$to_i","$map","$to_proc","$upgrade?","$==","$cost","$terrains","$include?"]),t.$require("engine/part/upgrade.rb/../base"),function(t,r){var l=[i(t,"Engine")].concat(r);!function(t,r){var l=[i(t,"Part")].concat(r);!function(t,$super,r){var a,i,l,u,c,p=$(t,$super,"Upgrade");[p].concat(r);p.$$prototype.cost=p.$$prototype.terrains=p.$$prototype.mountain=p.$$prototype.water=n,p.$attr_reader("cost","terrains"),e.def(p,"$initialize",a=function(e,t){var r,a,i=this;return null==t&&(t=n),i.cost=e.$to_i(),i.terrains=o(r=(a=t)===n||null==a?n:s(a,"map",[],"to_sym".$to_proc()))?r:[]},a.$$arity=-2),e.def(p,"$==",i=function(e){var t,r,n=this;return o(t=o(r=e["$upgrade?"]())?n.cost["$=="](e.$cost()):r)?n.terrains["$=="](e.$terrains()):t},i.$$arity=1),e.def(p,"$upgrade?",l=function(){return!0},l.$$arity=0),e.def(p,"$mountain?",u=function(){var e,t=this;return t.mountain=o(e=t.mountain)?e:t.terrains["$include?"]("mountain")},u.$$arity=0),e.def(p,"$water?",c=function(){var e,t=this;return t.water=o(e=t.water)?e:t.terrains["$include?"]("water")},c.$$arity=0)}(l[0],a(l,"Base"),l)}(l[0],l)}(r[0],r)},Opal.modules["engine/part/junction"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass;return e.add_stubs(["$junction?"]),t.$require("engine/part/junction.rb/../base"),function(t,r){var $=[a(t,"Engine")].concat(r);!function(t,r){var $=[a(t,"Part")].concat(r);!function(t,$super,r){var n,a,$=i(t,$super,"Junction");[$].concat(r);e.def($,"$==",n=function(e){return e["$junction?"]()},n.$$arity=1),e.def($,"$junction?",a=function(){return!0},a.$$arity=0)}($[0],n($,"Base"),$)}($[0],$)}(r[0],r)},Opal.modules["engine/part/city"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.truthy,c=e.send;return e.add_stubs(["$include","$attr_accessor","$attr_reader","$parse_revenue","$to_i","$new","$city?","$==","$revenue","$slots","$tokens","$reservations","$map!","$tokened_by?","$include?","$hex","$any?","$corporation","$name","$<<","$get_slot","$next_token","$<=","$price","$cash","$index","$with_index","$find_index","$nil?","$[]","$tokenable?","$raise","$use!","$exchange_token","$[]=","$-"]),n.$require("engine/part/city.rb/../../game_error"),n.$require("engine/part/city.rb/../base"),n.$require("engine/part/city.rb/../revenue_center"),function(n,a){var p=[s(n,"Engine")].concat(a);!function(n,a){var p=[s(n,"Part")].concat(a);!function(n,$super,a){var s,p,d,_,f,h,y,m,g,b,v,w,k,x,E=l(n,$super,"City"),O=[E].concat(a);E.$$prototype.slots=E.$$prototype.revenue=E.$$prototype.tokens=E.$$prototype.reservations=E.$$prototype.tile=i,E.$include($(o(O,"Part"),"RevenueCenter")),E.$attr_accessor("reservations"),E.$attr_reader("slots","tokens","revenue"),e.def(E,"$initialize",s=function(e,t){var r=this;return null==t&&(t=1),r.revenue=r.$parse_revenue(e),r.slots=t.$to_i(),r.tokens=o(O,"Array").$new(r.slots),r.reservations=[]},s.$$arity=-2),e.def(E,"$==",p=function(e){var t,r,n,a,i=this;return u(t=u(r=u(n=u(a=e["$city?"]())?i.revenue["$=="](e.$revenue()):a)?i.slots["$=="](e.$slots()):n)?i.tokens["$=="](e.$tokens()):r)?i.reservations["$=="](e.$reservations()):t},p.$$arity=1),e.def(E,"$remove_tokens!",d=function(){var e,t=this;return c(t.tokens,"map!",[],((e=function(){e.$$s;return i}).$$s=t,e.$$arity=0,e))},d.$$arity=0),e.def(E,"$blocks?",_=function(e){var t=this;return!!u(e)&&(!u(t["$tokened_by?"](e))&&!u(t.tokens["$include?"](i)))},_.$$arity=1),e.def(E,"$hex",f=function(){var e;return(e=this.tile)===i||null==e?i:c(e,"hex",[])},f.$$arity=0),e.def(E,"$<=",h=function(e){return e["$city?"]()},h.$$arity=1),e.def(E,"$tokened_by?",y=function(e){var t,r=this;return c(r.tokens,"any?",[],((t=function(r){var n;t.$$s;return null==r&&(r=i),(n=r,n===i||null==n?i:c(n,"corporation",[]))["$=="](e)}).$$s=r,t.$$arity=1,t))},y.$$arity=1),e.def(E,"$reserved_by?",m=function(e){var t,r=this;return c(r.reservations,"any?",[],((t=function(r){t.$$s;return null==r&&(r=i),r["$=="](e.$name())}).$$s=r,t.$$arity=1,t))},m.$$arity=1),e.def(E,"$add_reservation!",g=function(e){return this.reservations["$<<"](e)},g.$$arity=1),e.def(E,"$city?",b=function(){return!0},b.$$arity=0),e.def(E,"$tokenable?",v=function(e){var r=this,n=i;return!!u(r.$get_slot(e))&&(!!u(n=e.$next_token())&&(!!u(t(n.$price(),e.$cash()))&&!u(r["$tokened_by?"](e))))},v.$$arity=1),e.def(E,"$get_slot",w=function(e){var t,r,n=this;return u(t=n.reservations.$index(e.$name()))?t:c(n.tokens.$find_index(),"with_index",[],((r=function(e,t){var n,a=r.$$s||this;return null==a.reservations&&(a.reservations=i),null==e&&(e=i),null==t&&(t=i),u(n=e["$nil?"]())?a.reservations["$[]"](t)["$nil?"]():n}).$$s=n,r.$$arity=2,r))},w.$$arity=1),e.def(E,"$place_token",k=function(e){var t=this,r=i;return u(t["$tokenable?"](e))||t.$raise(o(O,"GameError"),"Cannot lay token"),(r=e.$next_token())["$use!"](),t.$exchange_token(r)},k.$$arity=1),e.def(E,"$exchange_token",x=function(t){var n=this,a=i;return a=[n.$get_slot(t.$corporation()),t],c(n.tokens,"[]=",e.to_a(a)),a[r(a.length,1)]},x.$$arity=1)}(p[0],o(p,"Base"),p)}(p[0],p)}(a[0],a)},Opal.modules["engine/part/label"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.truthy,s=e.send;return e.add_stubs(["$to_s","$label?","$=="]),t.$require("engine/part/label.rb/../base"),function(t,r){var l=[i(t,"Engine")].concat(r);!function(t,r){var l=[i(t,"Part")].concat(r);!function(t,$super,r){var a,i,l,u,c=$(t,$super,"Label");[c].concat(r);c.$$prototype.label=n,e.def(c,"$initialize",a=function(e){return null==e&&(e=n),this.label=e},a.$$arity=-1),e.def(c,"$to_s",i=function(){return this.label.$to_s()},i.$$arity=0),e.def(c,"$==",l=function(e){var t,r,a=this;return!!o(o((r=e,t=r===n||null==r?n:s(r,"label?",[])))?a.label["$=="](e.$to_s()):t)},l.$$arity=1),e.def(c,"$label?",u=function(){return!0},u.$$arity=0)}(l[0],a(l,"Base"),l)}(l[0],l)}(r[0],r)},Opal.modules["engine/part/path"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.truthy,l=e.send;return e.add_stubs(["$attr_reader","$separate_parts","$path?","$==","$a","$b","$<=","$map","$to_proc","$new","$rotate","$private","$each","$edge?","$<<","$offboard?","$city?","$junction?","$town?"]),r.$require("engine/part/path.rb/../base"),function(r,n){var u=[$(r,"Engine")].concat(n);!function(r,n){var u=[$(r,"Part")].concat(n);!function(r,$super,n){var $,u,c,p,d,_,f,h=o(r,$super,"Path"),y=[h].concat(n);h.$$prototype.a=h.$$prototype.b=h.$$prototype.edges=a,h.$attr_reader("a","b","branch","city","edges","junction","offboard","stop","town"),e.def(h,"$initialize",$=function(e,t){var r=this;return r.a=e,r.b=t,r.edges=[],r.$separate_parts()},$.$$arity=2),e.def(h,"$==",u=function(e){var t,r,n,i=this;return s(t=(r=e)===a||null==r?a:l(r,"path?",[]))?s(n=i.a["$=="](e.$a())?i.b["$=="](e.$b()):i.a["$=="](e.$a()))?n:i.a["$=="](e.$b())?i.b["$=="](e.$a()):i.a["$=="](e.$b()):t},u.$$arity=1),e.def(h,"$<=",c=function(e){var r,n,a=this;return s(r=s(n=t(a.a,e.$a()))?t(a.b,e.$b()):n)?r:s(n=t(a.a,e.$b()))?t(a.b,e.$a()):n},c.$$arity=1),e.def(h,"$path?",p=function(){return!0},p.$$arity=0),e.def(h,"$exits",d=function(){return l(this.edges,"map",[],"num".$to_proc())},d.$$arity=0),e.def(h,"$rotate",_=function(e){var t=this;return i(y,"Path").$new(t.a.$rotate(e),t.b.$rotate(e))},_.$$arity=1),h.$private(),e.def(h,"$separate_parts",f=function(){var e,t=this;return l([t.a,t.b],"each",[],((e=function(t){var r=e.$$s||this;return null==r.edges&&(r.edges=a),null==t&&(t=a),s(t["$edge?"]())?r.edges["$<<"](t):s(t["$offboard?"]())?(r.offboard=t,r.stop=t):s(t["$city?"]())?(r.city=t,r.branch=t,r.stop=t):s(t["$junction?"]())?(r.junction=t,r.branch=t):s(t["$town?"]())?(r.town=t,r.branch=t,r.stop=t):a}).$$s=t,e.$$arity=1,e))},f.$$arity=0)}(u[0],i(u,"Base"),u)}(u[0],u)}(n[0],n)},Opal.modules["engine/part/edge"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.truthy;return e.add_stubs(["$attr_accessor","$to_i","$edge?","$==","$num","$new","$%","$+"]),r.$require("engine/part/edge.rb/../base"),function(r,n){var l=[$(r,"Engine")].concat(n);!function(r,n){var l=[$(r,"Part")].concat(n);!function(r,$super,n){var $,l,u,c,p=o(r,$super,"Edge"),d=[p].concat(n);p.$$prototype.num=a,p.$attr_accessor("num"),e.def(p,"$initialize",$=function(e){return this.num=e.$to_i()},$.$$arity=1),e.def(p,"$==",l=function(e){var t,r=this;return s(t=e["$edge?"]())?r.num["$=="](e.$num()):t},l.$$arity=1),e.def(p,"$edge?",u=function(){return!0},u.$$arity=0),e.def(p,"$rotate",c=function(e){var r=this;return i(d,"Edge").$new(t(r.num,e)["$%"](6))},c.$$arity=1)}(l[0],i(l,"Base"),l)}(l[0],l)}(n[0],n)},Opal.modules["engine/part/revenue_center"]=function(e){e.top;var t=[],r=e.nil,n=e.const_get_qualified,a=(e.const_get_relative,e.breaker,e.slice,e.module),i=e.truthy,$=e.send;return e.add_stubs(["$attr_reader","$freeze","$include?","$to_h","$map","$split","$to_sym","$to_i","$class","$==","$upcase","$name","$[]","$each","$reverse","$tiles"]),function(t,o){var s=[a(t,"Engine")].concat(o);!function(t,o){var s=[a(t,"Part")].concat(o);!function(t,o){var s,l,u=a(t,"RevenueCenter"),c=[u].concat(o);u.$attr_reader("revenue"),e.const_set(c[0],"PHASES",["yellow","green","brown","gray","diesel"].$freeze()),e.def(u,"$parse_revenue",s=function(e){var t,a,o,s=this;return s.revenue=i(e["$include?"]("|"))?$($(e.$split("|"),"map",[],(t=function(e){return t.$$s,null==e&&(e=r),e.$split("_")},t.$$s=s,t.$$arity=1,t)),"map",[],(a=function(e,t){return a.$$s,null==e&&(e=r),null==t&&(t=r),[e.$to_sym(),t.$to_i()]},a.$$s=s,a.$$arity=2,a)).$to_h():$(n(s.$class(),"PHASES"),"map",[],(o=function(t){return o.$$s,null==t&&(t=r),[t,e.$to_i()]},o.$$s=s,o.$$arity=1,o)).$to_h()},s.$$arity=1),e.def(u,"$route_revenue",l=function(t,n){try{var a,o=this;return null==o.revenue&&(o.revenue=r),n.$name().$upcase()["$=="]("D")?o.revenue["$[]"]("diesel"):$(t.$tiles().$reverse(),"each",[],((a=function(t){var n=a.$$s||this;if(null==n.revenue&&(n.revenue=r),null==t&&(t=r),!i(n.revenue["$[]"](t)))return r;e.ret(n.revenue["$[]"](t))}).$$s=o,a.$$arity=1,a))}catch(s){if(s===e.returner)return s.$v;throw s}},l.$$arity=2)}(s[0],s)}(s[0],s)}(t[0],t)},Opal.modules["engine/part/base"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module),n=e.klass,a=e.truthy;return e.add_stubs(["$attr_accessor","$id","$tile","$index","$edge?","$<=>","$num","$=="]),function(t,i){var $=[r(t,"Engine")].concat(i);!function(t,i){var $=[r(t,"Part")].concat(i);!function(t,$super,r){var i,$,o,s,l,u,c,p,d,_,f,h,y,m=n(t,null,"Base");[m].concat(r);m.$attr_accessor("index","tile"),e.def(m,"$id",i=function(){var e=this;return e.$tile().$id()+"-"+e.$index()},i.$$arity=0),e.def(m,"$<=>",$=function(e){var t,r=this;return a(a(t=r["$edge?"]())?e["$edge?"]():t)?r.$num()["$<=>"](e.$num()):a(r["$edge?"]())?-1:a(e["$edge?"]())?1:0},$.$$arity=1),e.def(m,"$<=",o=function(e){return this["$=="](e)},o.$$arity=1),e.def(m,"$rotate",s=function(){return this},s.$$arity=1),e.def(m,"$blocks?",l=function(){return!1},l.$$arity=1),e.def(m,"$city?",u=function(){return!1},u.$$arity=0),e.def(m,"$edge?",c=function(){return!1},c.$$arity=0),e.def(m,"$junction?",p=function(){return!1},p.$$arity=0),e.def(m,"$label?",d=function(){return!1},d.$$arity=0),e.def(m,"$path?",_=function(){return!1},_.$$arity=0),e.def(m,"$town?",f=function(){return!1},f.$$arity=0),e.def(m,"$upgrade?",h=function(){return!1},h.$$arity=0),e.def(m,"$offboard?",y=function(){return!1},y.$$arity=0)}($[0],0,$)}($[0],$)}(t[0],t)},Opal.modules["engine/bank"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy;return e.add_stubs(["$include","$negative?","$-","$<<"]),r.$require("engine/bank.rb/../spender"),function(r,n){var u=[$(r,"Engine")].concat(n);!function(r,$super,n){var $,u,c,p,d=o(r,null,"Bank"),_=[d].concat(n);d.$$prototype.cash=d.$$prototype.broken=d.$$prototype.log=a,d.$include(i(_,"Spender")),e.def(d,"$initialize",$=function(t,r){var n,a=this;if(null==r)r=s([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(n=r.$$smap.log)&&(n=[]),a.cash=t,a.log=n,a.broken=!1},$.$$arity=-2),e.def(d,"$check_cash",u=function(e){var r=this;return l(t(r.cash,e)["$negative?"]())?(l(r.broken)||r.log["$<<"]("-- The bank has broken --"),r.broken=!0):a},u.$$arity=1),e.def(d,"$broken?",c=function(){return this.broken},c.$$arity=0),e.def(d,"$name",p=function(){return"The Bank"},p.$$arity=0)}(u[0],0,u)}(n[0],n)},Opal.modules["engine/spender"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,$=(e.const_get_qualified,e.const_get_relative),o=(e.breaker,e.slice,e.module),s=e.truthy,l=e.send;return e.add_stubs(["$attr_accessor","$negative?","$-","$raise","$name","$check_cash","$+","$cash","$cash="]),n.$require("engine/spender.rb/../game_error"),function(n,a){var u=[o(n,"Engine")].concat(a);!function(n,a){var u,c,p=o(n,"Spender"),d=[p].concat(a);p.$attr_accessor("cash"),e.def(p,"$check_cash",u=function(e){var r=this;return null==r.cash&&(r.cash=i),s(t(r.cash,e)["$negative?"]())?r.$raise($(d,"GameError"),r.$name()+" has "+r.cash+" and cannot spend "+e):i},u.$$arity=1),e.def(p,"$spend",c=function(n,a){var $=this,o=i;return null==$.cash&&($.cash=i),$.$check_cash(n),$.cash=t($.cash,n),o=[r(a.$cash(),n)],l(a,"cash=",e.to_a(o)),o[t(o.length,1)]},c.$$arity=2)}(u[0],u)}(a[0],a)},Opal.modules["engine/part"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module);return function(e,t){var n=[r(e,"Engine")].concat(t);!function(e,t){[r(e,"Part")].concat(t)}(n[0],n)}(t[0],t)},Opal.modules["engine/game/g_1846"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass,$=e.hash,o=e.hash2;return e.add_stubs(["$freeze"]),t.$require("engine/game/g_1846.rb/../base"),function(t,r){var s=[a(t,"Engine")].concat(r);!function(t,r){var s=[a(t,"Game")].concat(r);!function(t,$super,r){var n=[i(t,$super,"G1846")].concat(r);e.const_set(n[0],"BANK_CASH",$(2,7e3,3,6500,4,7500,5,9e3).$freeze()),e.const_set(n[0],"CURRENCY_FORMAT_STR","$%d"),e.const_set(n[0],"CERT_LIMIT",$(2,19,3,14,4,12,5,11).$freeze()),e.const_set(n[0],"HEXES",o(["white","gray","red","yellow","blue"],{white:$(["E5","F6","G5","H6","J4","B14","C11","C13","D8","D10","D12","E7","E9","E13","E15","E19","F4","F8","F10","F12","G11","H2","H4","H8","H10","I3","I7","I9","J8","D18","B10","B12","F14","F16","I11","J6"],"blank",["B16","C9","D14","E11","G3","G7","G9","G13","G15"],"city",["E17","H12"],"c=r:0;l=Z",["F18","G17","H16"],"u=c:40,t:mountain",["H14"],"u=c:60,t:mountain"),gray:$(["A15","C7"],"p=a:4,b:5",["F20"],"c=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0;p=a:4,b:_0",["I5"],"c=r:10,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:5,b:_0",["I15"],"c=r:20;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0",["K3"],"c=r:20;p=a:2,b:_0"),red:$(["B8"],"o=r:yellow_40|brown_10;p=a:3,b:_0",["B18"],"o=r:yellow_30|brown_50;p=a:0,b:_0;l=E",["C5"],"o=r:yellow_20|brown_40;p=a:4,b:_0;l=W",["C17"],"o=r:yellow_40|brown_60;p=a:0,b:_0;l=E",["C21"],"o=r:yellow_30|brown_60;p=a:5,b:_0;l=E",["D22"],"o=r:yellow_30|brown_60;p=a:0,b:_0;l=E",["E23","I17"],"o=r:yellow_20|brown_50;p=a:0,b:_0;l=E",["F22"],"o=r:yellow_30|brown_70;p=a:0,b:_0;l=E",["G21"],"o=r:yellow_30|brown_70;p=a:0,b:_0;p=a:1,b:_0;l=E",["H20"],"o=r:yellow_20|brown_40;p=a:1,b:_0;l=E",["I1"],"o=r:yellow_50|brown_70;p=a:2,b:_0;p=a:3,b:_0;l=W",["J10"],"o=r:yellow_50|brown_70;p=a:1,b:_0;p=a:2,b:_0"),yellow:$(["C15"],"c=r:40,s:2;p=a:0,b:_0;p=a:2,b:_0;l=Z;u=c:40,t:water",["D6"],"c=r:10;c=r:10;c=r:10;c=r:10;p=a:2,b:_0;p=a:3,b:_1;p=a:4,b:_2;p=a:5,b:_3;l=Chi",["D20"],"c=r:10,s:2;p=a:0,b:_0;p=a:2,b:_0;p=a:5,b:_0",["E21"],"c=r:10;p=a:0,b:_0;p=a:1,b:_0;p=a:3,b:_0",["G19"],"c=r:10;p=a:4,b:_0"),blue:$(["C19","D16"],"blank")}).$freeze()),e.const_set(n[0],"TILES",o(["5","6","7","8","9","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","39","40","41","42","43","44","45","46","47","51","57","70","290","291","292","293","294","295","296","297","298","299","300","611","619"],{5:3,6:4,7:5,8:16,9:16,14:4,15:5,16:2,17:1,18:1,19:2,20:2,21:1,22:1,23:4,24:4,25:2,26:1,27:1,28:1,29:1,30:1,31:1,39:1,40:1,41:2,42:2,43:2,44:1,45:2,46:2,47:2,51:2,57:4,70:1,290:1,291:1,292:1,293:1,294:2,295:2,296:1,297:2,298:1,299:1,300:1,611:4,619:3}).$freeze()),e.const_set(n[0],"LOCATION_NAMES",o(["B8","B16","B18","C5","C9","C15","C17","C21","D14","D20","D22","E11","E17","E21","E23","F22","G3","G7","G9","G13","G15","G19","G21","H12","H20","I1","I5","I15","I17","J10","K3"],{B8:"Holland",B16:"Port Huron",B18:"Sarnia",C5:"Chicago Connections",C9:"South Bend",C15:"Detroit",C17:"Windsor",C21:"Buffalo",D14:"Toledo",D20:"Erie",D22:"Buffalo",E11:"Fort Wayne",E17:"Cleveland",E21:"Salamanca",E23:"Binghamton",F22:"Pittsburgh",G3:"Springfield",G7:"Terre Haute",G9:"Indianapolis",G13:"Dayton",G15:"Columbus",G19:"Wheeling",G21:"Pittsburgh",H12:"Cincinnati",H20:"Cumberland",I1:"St. Louis",I5:"Centralia",I15:"Huntington",I17:"Charleston",J10:"Louisville",K3:"Cairo"}).$freeze()),e.const_set(n[0],"MARKET",[["Closed","10","20","30","40p","50p","60p","70p","80p","90p","100p","112p","124p","137p","150p","165","180","195","212","230","250","270","295","320","345","375","405","440","475","510","550"]].$freeze()),e.const_set(n[0],"STARTING_CASH",$(2,600,3,400,4,400,5,400).$freeze()),e.const_set(n[0],"PHASES",[o(["name","operating_rounds","train_limit","tiles","buy_companies"],{name:"Yellow",operating_rounds:2,train_limit:4,tiles:"yellow",buy_companies:!0}),o(["name","operating_rounds","train_limit","tiles","buy_companies","on"],{name:"Green",operating_rounds:2,train_limit:3,tiles:["yellow","green"].$freeze(),buy_companies:!0,on:["3/5","4"]}),o(["name","operating_rounds","train_limit","tiles","on","events"],{name:"Brown",operating_rounds:2,train_limit:2,tiles:["yellow","green","brown"].$freeze(),on:["4/6","5"],events:o(["close_companies"],{close_companies:!0})}),o(["name","operating_rounds","train_limit","tiles","on","events"],{name:"Brown",operating_rounds:2,train_limit:2,tiles:["yellow","green","brown","gray"].$freeze(),on:["6","7/8"],events:o(["remove_tokens"],{remove_tokens:!0})})].$freeze()),e.const_set(n[0],"TRAINS",[o(["name","distance","price","num"],{name:"2",distance:2,price:80,num:7}),o(["name","distance","price","num"],{name:"3/5",distance:3,price:160,num:6}),o(["name","distance","price","num"],{name:"4",distance:4,price:180,num:6}),o(["name","distance","price","num"],{name:"4/6",distance:4,price:450,num:5}),o(["name","distance","price","num"],{name:"5",distance:5,price:500,num:5}),o(["name","distance","price","num"],{name:"6",distance:6,price:800,num:9}),o(["name","distance","price","num"],{name:"7/8",distance:7,price:900,num:9})].$freeze()),e.const_set(n[0],"COMPANIES",[o(["name","value","revenue","sym","desc","abilities"],{name:"Michigan Southern",value:"$60 + $80 Debt",revenue:0,sym:"MS",desc:"Starts with $60 in treasury, a 2 train, and a token in Detroit (C15). Splits revenue evenly with owner.",abilities:[]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Big 4",value:"$40 + $60 Debt",revenue:0,sym:"B4",desc:"Starts with $60 in treasury, a 2 train, and a token in Indianapolis (G9). Splits revenue evenly with owner.",abilities:[]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Chicago and Western Indiana",value:60,revenue:10,sym:"CWI",desc:"Reserves a token slot in Chicago (D6), in which the owning corporation may place an extra token at no cost.",abilities:[]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Mail Contract",value:80,revenue:0,sym:"MC",desc:"Adds $10 per location visited by any one train of the owning corporation. Never closes once purchased by a corporation.",abilities:[]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Tunnel Blasting Company",value:60,revenue:20,sym:"TBC",desc:"Reduces, for the owning corporation, the cost of laying all mountain tiles and tunnel/pass hexsides by $20.",abilities:[]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Meat Packing Company",value:60,revenue:15,sym:"MPC",desc:"The owning corporation may place a $30 marker in either St. Louis (I1) or Chicago (D6), to add $30 to all routes run to this location.",abilities:[]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Steamboat Company",value:40,revenue:10,sym:"SC",desc:"Place or shift the port marker among port locations (B8, C5, D14, G19, I1). Add $20 per port symbol to all routes run to this location by the owning (or assigned) company.",abilities:[]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Lake Shore Line",value:40,revenue:15,sym:"LSL",desc:"The owning corporation may make an extra $0 cost tile upgrade of either Cleveland (E17) or Toledo (D14), but not both.",abilities:[]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Michigan Central",value:40,revenue:15,sym:"MC",desc:"The owning corporation may lay up to two extra $0 cost yellow tiles in the MC's reserved hexes (B10, B12).",abilities:[o(["type","hexes"],{type:"blocks_hexes",hexes:["B10","B12"]})]}),o(["name","value","revenue","sym","desc","abilities"],{name:"Ohio & Indiana",value:40,revenue:15,sym:"O&I",desc:"The owning corporation may lay up to two extra $0 cost yellow tiles in the O&I's reserved hexes (F14, F16).",abilities:[o(["type","hexes"],{type:"blocks_hexes",hexes:["F14","F16"]})]})].$freeze()),e.const_set(n[0],"CORPORATIONS",[o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"PRR",logo:"",name:"Pennsylvania",tokens:[0,80,80,80,0],float_percent:20,coordinates:"F20",color:"#d1232a"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"NYC",logo:"",name:"New York Central",tokens:[0,80,80,80],float_percent:20,coordinates:"D20",color:"#110a0c"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"B&O",logo:"1846/BO",name:"Baltimore & Ohio",tokens:[0,80,80,0],float_percent:20,coordinates:"G19",color:"#025aaa"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"C&O",logo:"1846/CO",name:"Chesapeake & Ohio",tokens:[0,80,80,80],float_percent:20,coordinates:"I15",color:""}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"ERIE",logo:"",name:"Erie",tokens:[0,80,80,0],float_percent:20,coordinates:"E21",color:"#ffe600"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"GT",logo:"",name:"Grand Trunk",tokens:[0,80,80],float_percent:20,coordinates:"B16",color:"#f58121"}),o(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"IC",logo:"",name:"Illinois Central",tokens:[0,80,80,0],float_percent:20,coordinates:"K3",color:"#32763f"})].$freeze())}(s[0],n(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/game/g_1889"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified),a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.klass;return e.add_stubs(["$include"]),t.$require("engine/game/g_1889.rb/../../config/game/g_1889"),t.$require("engine/game/g_1889.rb/../base"),function(e,t){var r=[i(e,"Engine")].concat(t);!function(e,t){var r=[i(e,"Game")].concat(t);!function(e,$super,t){var r=$(e,$super,"G1889"),i=[r].concat(t);r.$include(n(n(a(i,"Config"),"Game"),"G1889"))}(r[0],a(r,"Base"),r)}(r[0],r)}(r[0],r)},Opal.modules["engine/game/g_18_chesapeake"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified),a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.klass;return e.add_stubs(["$include"]),t.$require("engine/game/g_18_chesapeake.rb/../../config/game/g_18_chesapeake"),t.$require("engine/game/g_18_chesapeake.rb/../base"),function(e,t){var r=[i(e,"Engine")].concat(t);!function(e,t){var r=[i(e,"Game")].concat(t);!function(e,$super,t){var r=$(e,$super,"G18Chesapeake"),i=[r].concat(t);r.$include(n(n(a(i,"Config"),"Game"),"G18Chesapeake"))}(r[0],a(r,"Base"),r)}(r[0],r)}(r[0],r)},Opal.modules["engine/game/base"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var a=e.top,i=[],$=e.nil,o=e.const_get_qualified,s=e.const_get_relative,l=(e.breaker,e.slice,e.module),u=e.klass,c=e.hash,p=e.hash2,d=e.range,_=e.send,f=e.truthy;return e.add_stubs(["$==","$require_tree","$attr_reader","$freeze","$slice","$last","$split","$name","$map","$new","$init_companies","$init_stock_market","$init_corporations","$init_bank","$init_tiles","$init_cert_limit","$init_train_handler","$init_starting_cash","$init_hexes","$flatten","$+","$to_proc","$init_phase","$operating_rounds","$init_round","$cache_objects","$connect_hexes","$initialize_actions","$<<","$class","$title","$to_h","$reverse","$sort_by","$value","$current_entity","$active_entities","$size","$with_index","$each","$[]","$===","$rindex","$!=","$[]=","$-","$pop","$!","$nil?","$is_a?","$copy","$process_action","$any?","$action_from_h","$current_action_id","$id=","$clone","$entity","$finished?","$next_round!","$from_h","$const_get","$type","$trains","$flat_map","$par_prices","$%","$select","$player?","$owner","$private","$players","$new_auction_round","$compact","$<","$times","$min","$for","$from_code","$find","$include?","$dig","$abilities","$add_blocker!","$coordinates","$add_reservation!","$first","$cities","$layout","$spend","$x","$y","$color","$tile","$targeting?","$neighbors","$entities","$end_game","$reorder_players","$new_stock_round","$new_operating_round","$bankrupt","$round_num","$broken?","$raise","$result","$format_currency","$join","$last_to_act","$find_index","$rotate_players","$rotate!","$sort","$instance_variable_set","$send","$id","$define_method","$instance_variable_get"]),s(i,"RUBY_ENGINE")["$=="]("opal")&&(a.$require_tree("engine/action"),a.$require_tree("engine/round")),a.$require("engine/game/base.rb/../../bank"),a.$require("engine/game/base.rb/../../company"),a.$require("engine/game/base.rb/../../corporation"),a.$require("engine/game/base.rb/../../depot"),a.$require("engine/game/base.rb/../../hex"),a.$require("engine/game/base.rb/../../phase"),a.$require("engine/game/base.rb/../../player"),a.$require("engine/game/base.rb/../../share_pool"),a.$require("engine/game/base.rb/../../stock_market"),a.$require("engine/game/base.rb/../../tile"),a.$require("engine/game/base.rb/../../train"),function(a,i){var h=[l(a,"Engine")].concat(i);!function(a,i){var h=[l(a,"Game")].concat(i);!function(a,$super,i){var l,h,y,m,g,b,v,w,k,x,E,O,A,T,S,I,R,C,q,M,z,N,j,P,B,L,D,G,H,F,U,K,Y,V,W,J,X,Z,Q=u(a,null,"Base"),ee=[Q].concat(i);Q.$$prototype.names=Q.$$prototype.players=Q.$$prototype.stock_market=Q.$$prototype.bank=Q.$$prototype.companies=Q.$$prototype.corporations=Q.$$prototype.hexes=Q.$$prototype.tiles=Q.$$prototype.phase=Q.$$prototype.log=Q.$$prototype.round=Q.$$prototype.actions=Q.$$prototype.finished=Q.$$prototype.special=Q.$$prototype.id=Q.$$prototype.pin=Q.$$prototype.depot=Q.$$prototype.operating_rounds=Q.$$prototype.turn=$,Q.$attr_reader("actions","bank","cert_limit","cities","companies","corporations","depot","finished","hexes","id","log","phase","players","round","share_pool","special","stock_market","tiles","turn","undo_possible","redo_possible"),e.const_set(ee[0],"BANK_CASH",12e3),e.const_set(ee[0],"CURRENCY_FORMAT_STR","$%d"),e.const_set(ee[0],"STARTING_CASH",c(2,1200,3,800,4,600,5,480,6,400).$freeze()),e.const_set(ee[0],"HEXES",p([],{}).$freeze()),e.const_set(ee[0],"TRAINS",[p(["name","distance","price","rusts_on","num"],{name:"2",distance:2,price:80,rusts_on:"4",num:6}),p(["name","distance","price","rusts_on","num"],{name:"3",distance:3,price:180,rusts_on:"6",num:5}),p(["name","distance","price","rusts_on","num"],{name:"4",distance:4,price:300,rusts_on:"D",num:4}),p(["name","distance","price","num"],{name:"5",distance:5,price:450,num:3}),p(["name","distance","price","num"],{name:"6",distance:6,price:630,num:2}),p(["name","distance","price","available_on","discount","num"],{name:"D",distance:999,price:1100,available_on:"6",discount:p(["4","5","6"],{4:300,5:300,6:300}),num:20})].$freeze()),e.const_set(ee[0],"CERT_LIMIT",c(2,28,3,20,4,16,5,13,6,11).$freeze()),e.const_set(ee[0],"CERT_LIMIT_COLORS",["brown","orange","yellow"].$freeze()),e.const_set(ee[0],"COMPANIES",[].$freeze()),e.const_set(ee[0],"CORPORATIONS",[].$freeze()),e.const_set(ee[0],"PHASES",[o(s(ee,"Phase"),"TWO"),o(s(ee,"Phase"),"THREE"),o(s(ee,"Phase"),"FOUR"),o(s(ee,"Phase"),"FIVE"),o(s(ee,"Phase"),"SIX"),o(s(ee,"Phase"),"D")].$freeze()),e.const_set(ee[0],"LOCATION_NAMES",p([],{}).$freeze()),e.const_set(ee[0],"CACHABLE",[["players","player"],["corporations","corporation"],["companies","company"],["trains","train"],["hexes","hex"],["tiles","tile"],["shares","share"],["share_prices","share_price"],["cities","city"]].$freeze()),e.defs(Q,"$title",l=function(){return this.$name().$split("::").$last().$slice(d(1,-1,!1))},l.$$arity=0),e.def(Q,"$initialize",h=function(r,n){var a,i,l,u,c=this;if(null==n)n=p([],{});else if(!n.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(a=n.$$smap.id)&&(a=0),null==(i=n.$$smap.actions)&&(i=[]),null==(l=n.$$smap.pin)&&(l=$),c.id=a,c.turn=1,c.finished=!1,c.log=[],c.actions=[],c.names=r.$freeze(),c.players=_(c.names,"map",[],((u=function(e){u.$$s;return null==e&&(e=$),s(ee,"Player").$new(e)}).$$s=c,u.$$arity=1,u)),c.companies=c.$init_companies(c.players),c.stock_market=c.$init_stock_market(),c.corporations=c.$init_corporations(c.stock_market),c.bank=c.$init_bank(),c.tiles=c.$init_tiles(),c.cert_limit=c.$init_cert_limit(),c.depot=c.$init_train_handler(),c.$init_starting_cash(c.players,c.bank),
c.share_pool=s(ee,"SharePool").$new(c),c.hexes=c.$init_hexes(c.companies,c.corporations),c.cities=_(t(_(c.hexes,"map",[],"tile".$to_proc()),c.tiles),"map",[],"cities".$to_proc()).$flatten(),c.phase=c.$init_phase(),c.operating_rounds=c.phase.$operating_rounds(),c.round=c.$init_round(),c.special=o(s(ee,"Round"),"Special").$new(c.companies,p(["game"],{game:c})),c.$cache_objects(),c.$connect_hexes(),c.$initialize_actions(i),f(l)?(c.log["$<<"]("----"),c.log["$<<"]("Your game was unable to be upgraded to the latest version of 18xx.games."),c.log["$<<"]("It is pinned to version "+l+", if any bugs are raised please include this version number"),c.log["$<<"]("----")):$},h.$$arity=-2),e.def(Q,"$inspect",y=function(){var e=this;return e.$class().$name()+" - "+e.$class().$title()+" "+_(e.players,"map",[],"name".$to_proc())},y.$$arity=0),e.def(Q,"$result",m=function(){var e,t=this;return _(_(t.players,"sort_by",[],"value".$to_proc()).$reverse(),"map",[],(e=function(t){e.$$s;return null==t&&(t=$),[t.$name(),t.$value()]},e.$$s=t,e.$$arity=1,e)).$to_h()},m.$$arity=0),e.def(Q,"$current_entity",g=function(){return this.round.$current_entity()},g.$$arity=0),e.def(Q,"$active_players",b=function(){return _(this.round.$active_entities(),"map",[],"owner".$to_proc())},b.$$arity=0),e.def(Q,"$initialize_actions",v=function(t){var n,a,i=this,l=$,u=$;return l=[],u=s(ee,"Array").$new(t.$size()),_(t.$each(),"with_index",[],((n=function(t,a){var i,o,s,c=n.$$s||this,p=$,d=$,h=$,y=$;return null==t&&(t=$),null==a&&(a=$),p=t["$[]"]("type"),"undo"["$==="](p)?(d=_(u,"rindex",[],((i=function(e){var t;return i.$$s,null==e&&(e=$),f(t=e)?e["$[]"]("type")["$!="]("message"):t}).$$s=c,i.$$arity=1,i)),l["$<<"]([u["$[]"](d),d]),h=[d,$],_(u,"[]=",e.to_a(h)),h[r(h.length,1)]):"redo"["$==="](p)?(s=l.$pop(),o=e.to_ary(s),y=null==o[0]?$:o[0],d=null==o[1]?$:o[1],h=[d,y],_(u,"[]=",e.to_a(h)),h[r(h.length,1)]):"message"["$==="](p)?(h=[a,t],_(u,"[]=",e.to_a(h)),h[r(h.length,1)]):(l=[],h=[a,t],_(u,"[]=",e.to_a(h)),h[r(h.length,1)])}).$$s=i,n.$$arity=2,n)),i.undo_possible=!1,_(u.$each(),"with_index",[],((a=function(e,r){var n=a.$$s||this;return null==n.actions&&(n.actions=$),null==e&&(e=$),null==r&&(r=$),f(e["$nil?"]()["$!"]())?(f(e["$is_a?"](o(s(ee,"Action"),"Base")))&&(e=e.$copy(n)),n.$process_action(e)):n.actions["$<<"](t["$[]"](r))}).$$s=i,a.$$arity=2,a)),i.redo_possible=l["$any?"]()},v.$$arity=1),e.def(Q,"$process_action",w=function(t){var n,a,i=this,l=$;if(f(t["$is_a?"](s(ee,"Hash")))&&(t=i.$action_from_h(t)),l=[i.$current_action_id()],_(t,"id=",e.to_a(l)),l[r(l.length,1)],f(f(n=t["$is_a?"](o(s(ee,"Action"),"Undo")))?n:t["$is_a?"](o(s(ee,"Action"),"Redo"))))return i.actions["$<<"](t),i.$clone(i.actions);if(f(f(n=i.finished)?t["$is_a?"](o(s(ee,"Action"),"Message"))["$!"]():n))return i;for(i.phase.$process_action(t),f(t.$entity()["$is_a?"](s(ee,"Company")))?i.special.$process_action(t):i.round.$process_action(t),f(t["$is_a?"](o(s(ee,"Action"),"Message")))||(i.redo_possible=!1,i.undo_possible=!0),i.actions["$<<"](t);f(f(a=i.round["$finished?"]())?i.finished["$!"]():a);)i["$next_round!"]();return i},w.$$arity=1),e.def(Q,"$current_action_id",k=function(){return t(this.actions.$size(),1)},k.$$arity=0),e.def(Q,"$action_from_h",x=function(e){var t=this;return s(ee,"Object").$const_get("Engine::Action::"+o(s(ee,"Action"),"Base").$type(e["$[]"]("type"))).$from_h(e,t)},x.$$arity=1),e.def(Q,"$clone",E=function(e){var t=this;return t.$class().$new(t.names,p(["id","pin","actions"],{id:t.id,pin:t.pin,actions:e}))},E.$$arity=1),e.def(Q,"$trains",O=function(){return this.depot.$trains()},O.$$arity=0),e.def(Q,"$shares",A=function(){return _(this.corporations,"flat_map",[],"shares".$to_proc())},A.$$arity=0),e.def(Q,"$share_prices",T=function(){return this.stock_market.$par_prices()},T.$$arity=0),e.def(Q,"$layout",S=function(){return"flat"},S.$$arity=0),e.def(Q,"$format_currency",I=function(e){return o(this.$class(),"CURRENCY_FORMAT_STR")["$%"](e)},I.$$arity=1),e.def(Q,"$purchasable_companies",R=function(){var e,t=this;return _(t.companies,"select",[],((e=function(t){var r;e.$$s;return null==t&&(t=$),(r=t.$owner())===$||null==r?$:_(r,"player?",[])}).$$s=t,e.$$arity=1,e))},R.$$arity=0),Q.$private(),e.def(Q,"$init_bank",C=function(){var e=this,t=$;return t=o(e.$class(),"BANK_CASH"),f(t["$is_a?"](s(ee,"Hash")))&&(t=t["$[]"](e.$players().$size())),s(ee,"Bank").$new(t,p(["log"],{log:e.log}))},C.$$arity=0),e.def(Q,"$init_cert_limit",q=function(){var e=this,t=$;return t=o(e.$class(),"CERT_LIMIT"),f(t["$is_a?"](s(ee,"Hash")))?t["$[]"](e.$players().$size()):t},q.$$arity=0),e.def(Q,"$init_phase",M=function(){var e=this;return s(ee,"Phase").$new(o(e.$class(),"PHASES"),e)},M.$$arity=0),e.def(Q,"$init_round",z=function(){return this.$new_auction_round()},z.$$arity=0),e.def(Q,"$init_stock_market",N=function(){var e=this;return s(ee,"StockMarket").$new(o(e.$class(),"MARKET"),o(e.$class(),"CERT_LIMIT_COLORS"))},N.$$arity=0),e.def(Q,"$init_companies",j=function(t){var r,a=this;return _(o(a.$class(),"COMPANIES"),"map",[],(r=function(a){var i;r.$$s;return null==a&&(a=$),f(n(t.$size(),f(i=a["$[]"]("min_players"))?i:0))?$:s(ee,"Company").$new(e.to_hash(a))},r.$$s=a,r.$$arity=1,r)).$compact()},j.$$arity=1),e.def(Q,"$init_train_handler",P=function(){var t,r=this,n=$;return n=_(o(r.$class(),"TRAINS"),"flat_map",[],((t=function(r){var n,a=t.$$s||this;return null==r&&(r=$),_(r["$[]"]("num").$times(),"map",[],((n=function(t){n.$$s;return null==t&&(t=$),s(ee,"Train").$new(e.to_hash(r).$merge(p(["index"],{index:t})))}).$$s=a,n.$$arity=1,n))}).$$s=r,t.$$arity=1,t)),s(ee,"Depot").$new(n,r)},P.$$arity=0),e.def(Q,"$init_corporations",B=function(t){var r,n=this,a=$;return a=_(t.$par_prices(),"map",[],"price".$to_proc()).$min(),_(o(n.$class(),"CORPORATIONS"),"map",[],((r=function(t){r.$$s;return null==t&&(t=$),s(ee,"Corporation").$new(p(["min_price"],{min_price:a}).$merge(e.to_hash(t)))}).$$s=n,r.$$arity=1,r))},B.$$arity=1),e.def(Q,"$init_hexes",L=function(t,r){var n,a=this;return _(o(a.$class(),"HEXES"),"map",[],(n=function(a,i){var l,u=n.$$s||this;return null==a&&(a=$),null==i&&(i=$),_(i,"map",[],((l=function(n,i){var u,c=l.$$s||this;return null==n&&(n=$),null==i&&(i=$),_(n.$map(),"with_index",[],((u=function(n,l){var c,d,h,y=u.$$s||this,m=$,g=$,b=$;return null==n&&(n=$),null==l&&(l=$),m=function(){try{return s(ee,"Tile").$for(i,p(["preprinted","index"],{preprinted:!0,index:l}))}catch(t){if(!e.rescue(t,[o(s(ee,"Engine"),"GameError")]))throw t;try{return s(ee,"Tile").$from_code(n,a,i,p(["preprinted","index"],{preprinted:!0,index:l}))}finally{e.pop_exception()}}}(),g=_(t,"find",[],((c=function(e){var t,r;c.$$s;return null==e&&(e=$),(r=(t=e.$abilities("blocks_hexes"))===$||null==t?$:_(t,"dig",["hexes"]))===$||null==r?$:_(r,"include?",[n])}).$$s=y,c.$$arity=1,c)),f(g["$nil?"]())||m["$add_blocker!"](g),_(_(r,"select",[],((d=function(e){d.$$s;return null==e&&(e=$),e.$coordinates()["$=="](n)}).$$s=y,d.$$arity=1,d)),"each",[],((h=function(e){h.$$s;return null==e&&(e=$),m.$cities().$first()["$add_reservation!"](e.$name())}).$$s=y,h.$$arity=1,h)),b=o(y.$class(),"LOCATION_NAMES")["$[]"](n),s(ee,"Hex").$new(n,p(["layout","tile","location_name"],{layout:y.$layout(),tile:m,location_name:b}))}).$$s=c,u.$$arity=2,u))}).$$s=u,l.$$arity=2,l))},n.$$s=a,n.$$arity=2,n)).$flatten()},L.$$arity=2),e.def(Q,"$init_tiles",D=function(){var e,t=this;return _(o(t.$class(),"TILES"),"flat_map",[],((e=function(t,r){var n,a,i=e.$$s||this,o=$,l=$,u=$;return null==t&&(t=$),null==r&&(r=$),f(r["$is_a?"](s(ee,"Integer")))?_((o=r).$times(),"map",[],((n=function(e){n.$$s;return null==e&&(e=$),s(ee,"Tile").$for(t,p(["index"],{index:e}))}).$$s=i,n.$$arity=1,n)):(o=r["$[]"]("count"),l=r["$[]"]("color"),u=r["$[]"]("code"),_(o.$times(),"map",[],((a=function(e){a.$$s;return null==e&&(e=$),s(ee,"Tile").$from_code(t,l,u,p(["index"],{index:e}))}).$$s=i,a.$$arity=1,a)))}).$$s=t,e.$$arity=2,e))},D.$$arity=0),e.def(Q,"$init_starting_cash",G=function(e,t){var r,n=this,a=$;return a=o(n.$class(),"STARTING_CASH"),f(a["$is_a?"](s(ee,"Hash")))&&(a=a["$[]"](e.$size())),_(e,"each",[],((r=function(e){r.$$s;return null==e&&(e=$),t.$spend(a,e)}).$$s=n,r.$$arity=1,r))},G.$$arity=2),e.def(Q,"$connect_hexes",H=function(){var n,a,i=this,l=$;return l=_(i.hexes,"map",[],(n=function(e){n.$$s;return null==e&&(e=$),[[e.$x(),e.$y()],e]},n.$$s=i,n.$$arity=1,n)).$to_h(),_(i.hexes,"each",[],((a=function(n){var i,u=a.$$s||this;return null==n&&(n=$),_(o(s(ee,"Hex"),"DIRECTIONS")["$[]"](n.$layout()),"each",[],((i=function(a,o){i.$$s;var s,u,c=$,p=$,d=$,h=$;return null==a&&(a=$),null==o&&(o=$),u=a,c=null==(s=e.to_ary(u))[0]?$:s[0],p=null==s[1]?$:s[1],d=l["$[]"]([t(n.$x(),c),t(n.$y(),p)]),f(d)?f((s=d.$tile().$color()["$=="]("gray"))?d["$targeting?"](n)["$!"]():d.$tile().$color()["$=="]("gray"))?$:(h=[o,d],_(n.$neighbors(),"[]=",e.to_a(h)),h[r(h.length,1)]):$}).$$s=u,i.$$arity=2,i))}).$$s=i,a.$$arity=1,a))},H.$$arity=0),e.def(Q,"$next_round!",F=function(){var e=this,r=$;return _(e.round.$entities(),"each",[],"unpass!".$to_proc()),f(e.round.$end_game())?e.$end_game():e.round=(r=e.round,o(s(ee,"Round"),"Auction")["$==="](r)?(e.$reorder_players(),e.$new_stock_round()):o(s(ee,"Round"),"Stock")["$==="](r)?(e.$reorder_players(),e.$new_operating_round()):o(s(ee,"Round"),"Operating")["$==="](r)?f(e.round.$bankrupt())?e.$end_game():f(n(e.round.$round_num(),e.operating_rounds))?e.$new_operating_round(t(e.round.$round_num(),1)):f(e.bank["$broken?"]())?e.$end_game():(e.turn=t(e.turn,1),e.operating_rounds=e.phase.$operating_rounds(),e.$new_stock_round()):e.$raise("Unexected round type "+e.round))},F.$$arity=0),e.def(Q,"$end_game",U=function(){var e,t=this,r=$;return t.finished=!0,r=_(t.$result(),"map",[],((e=function(t,r){var n=e.$$s||this;return null==t&&(t=$),null==r&&(r=$),t+" ("+n.$format_currency(r)+")"}).$$s=t,e.$$arity=2,e)),t.log["$<<"]("Game over: "+r.$join(", ")),t.round},U.$$arity=0),e.def(Q,"$priority_deal_player",K=function(){var e=this,r=$,n=$;return f(e.round.$current_entity()["$player?"]())?(r=e.round.$last_to_act(),n=f(r)?t(e.players.$find_index(r),1)["$%"](e.players.$size()):0,e.players["$[]"](n)):e.players["$[]"](0)},K.$$arity=0),e.def(Q,"$reorder_players",Y=function(){var e=this;return e.$rotate_players(e.round.$last_to_act()),e.log["$<<"](e.$current_entity().$name()+" has priority deal")},Y.$$arity=0),e.def(Q,"$rotate_players",V=function(e){var r=this;return f(e)?r.players["$rotate!"](t(r.players.$find_index(e),1)):$},V.$$arity=1),e.def(Q,"$new_auction_round",W=function(){var e=this;return o(s(ee,"Round"),"Auction").$new(e.players,p(["game"],{game:e}))},W.$$arity=0),e.def(Q,"$new_stock_round",J=function(){var e=this;return e.log["$<<"]("-- Stock Round "+e.turn+" --"),o(s(ee,"Round"),"Stock").$new(e.players,p(["game"],{game:e}))},J.$$arity=0),e.def(Q,"$new_operating_round",X=function(e){var t=this;return null==e&&(e=1),t.log["$<<"]("-- Operating Round "+t.turn+"."+e+" --"),o(s(ee,"Round"),"Operating").$new(_(t.corporations,"select",[],"floated?".$to_proc()).$sort(),p(["game","round_num"],{game:t,round_num:e}))},X.$$arity=-1),e.def(Q,"$cache_objects",Z=function(){var e,t=this;return _(s(ee,"CACHABLE"),"each",[],((e=function(t,r){var n,a,i=e.$$s||this,o=$;return null==t&&(t=$),null==r&&(r=$),o="@_"+t,i.$instance_variable_set(o,_(i.$send(t),"map",[],(n=function(e){n.$$s;return null==e&&(e=$),[e.$id(),e]},n.$$s=i,n.$$arity=1,n)).$to_h()),_(i.$class(),"define_method",[r+"_by_id"],((a=function(e){var t=a.$$s||this;return null==e&&(e=$),t.$instance_variable_get(o)["$[]"](e)}).$$s=i,a.$$arity=1,a))}).$$s=t,e.$$arity=2,e))},Z.$$arity=0)}(h[0],0,h)}(h[0],h)}(i[0],i)},Opal.modules["engine/game/g_1830"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash,l=e.hash2;return e.add_stubs(["$freeze"]),t.$require("engine/game/g_1830.rb/../base"),function(t,r){var u=[$(t,"Engine")].concat(r);!function(t,r){var u=[$(t,"Game")].concat(r);!function(t,$super,r){var $=[o(t,$super,"G1830")].concat(r);e.const_set($[0],"BANK_CASH",12e3),e.const_set($[0],"CURRENCY_FORMAT_STR","$%d"),e.const_set($[0],"CERT_LIMIT",s(3,20,4,16,5,13,6,11).$freeze()),e.const_set($[0],"HEXES",l(["red","gray","white","yellow"],{red:s(["F2"],"o=r:yellow_40|brown_70;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",["J2"],"o=r:yellow_30|brown_60;p=a:2,b:_0;p=a:3,b:_0",["I1"],"o=r:yellow_30|brown_60;p=a:3,b:_0",["A9"],"o=r:yellow_30|brown_50;p=a:4,b:_0",["A11"],"o=r:yellow_30|brown_50;p=a:4,b:_0;p=a:5,b:_0",["K13"],"o=r:yellow_30|brown_40;p=a:1,b:_0;p=a:2,b:_0",["B24"],"o=r:yellow_20|brown_30;p=a:0,b:_0;p=a:5,b:_0"),gray:s(["D2"],"c=r:20;p=a:3,b:_0;p=a:4,b:_0",["F6"],"c=r:30;p=a:4,b:_0;p=a:5,b:_0",["E9"],"p=a:1,b:2",["H12"],"c=r:10;p=a:0,b:_0;p=a:3,b:_0;p=a:0,b:3",["D14"],"c=r:20;p=a:0,b:_0;p=a:3,b:_0;p=a:5,b:_0",["C15"],"t=r:10;p=a:0,b:_0;p=a:2,b:_0",["K15"],"c=r:20;p=a:1,b:_0",["A17"],"p=a:4,b:5",["A19"],"c=r:40;p=a:4,b:_0;p=a:5,b:_0",["I19","F24"],"t=r:10;p=a:0,b:_0;p=a:1,b:_0",["D24"],"p=a:0,b:5"),white:s(["F4","J14","F22"],"c=r:0;u=c:80,t:water",["E7","B20","D4","F10"],"town",["I13","D18","B12","B14","B22","C7","C9","C11","C13","C23","D8","D12","D16","D20","E3","E13","E15","F8","F12","F14","F18","G3","G5","G9","G11","H2","H6","H8","H14","I3","I5","I7","I9","J4","J6","J8"],"blank",["G15","C17","C21","D22","E17","E21","G13","I11","J10","J12"],"u=c:120,t:mountain",["B16","E19","H4","B10","H10","H16"],"city",["F16"],"c=r:0;u=c:120,t:mountain",["G7","G17","F20"],"t=r:0;t=r:0",["D6","I17","B18","C19"],"u=c:80,t:water"),yellow:s(["E5","D10"],"c=r:0;c=r:0;l=OO;u=c:80,t:water",["E11","H18"],"c=r:0;c=r:0;l=OO",["I15"],"c=r:30;p=a:3,b:_0;p=a:5,b:_0;l=B",["G19"],"c=r:40;c=r:40;p=a:2,b:_0;p=a:5,b:_1;l=NY;u=c:80,t:water",["E23"],"c=r:30;p=a:2,b:_0;p=a:4,b:_0;l=B")}).$freeze()),e.const_set($[0],"TILES",l(["1","2","3","4","7","8","9","14","15","16","18","19","20","23","24","25","26","27","28","29","39","40","41","42","43","44","45","46","47","53","54","55","56","57","58","59","61","62","63","64","65","66","67","68","69","70"],{1:1,2:1,3:2,4:2,7:4,8:8,9:7,14:3,15:2,16:1,18:1,19:1,20:1,23:3,24:3,25:1,26:1,27:1,28:1,29:1,39:1,40:1,41:2,42:2,43:2,44:1,45:2,46:2,47:1,53:2,54:1,55:1,56:1,57:4,58:2,59:2,61:2,62:1,63:3,64:1,65:1,66:1,67:1,68:1,69:1,70:1}).$freeze()),e.const_set($[0],"LOCATION_NAMES",l(["D2","F2","J2","F4","J14","F22","E5","D10","F6","E7","A11","K13","E11","H12","D14","C15","I15","K15","B16","F16","H18","A19","E19","G19","I19","F24","B20","E23","B24","D4","F10","G7","G17","F20","H4","B10","H10","H16"],{D2:"Lansing",F2:"Chicago",J2:"Gulf",F4:"Toledo",J14:"Washington",F22:"Providence",E5:"Detroit & Windsor",D10:"Hamilton & Toronto",F6:"Cleveland",E7:"London",A11:"Canadian West",K13:"Deep South",E11:"Dunkirk & Buffalo",H12:"Altoona",D14:"Rochester",C15:"Kingston",I15:"Baltimore",K15:"Richmond",B16:"Ottowa",F16:"Scranton",H18:"Philadelphia & Trenton",A19:"Montreal",E19:"Albany",G19:"New York & Newark",I19:"Atlantic City",F24:"Mansfield",B20:"Burlington",E23:"Boston",B24:"Maritime Provinces",D4:"Flint",F10:"Erie",G7:"Akron & Canton",G17:"Reading & Allentown",F20:"New Haven & Hartford",H4:"Columbus",B10:"Barrie",H10:"Pittsburgh",H16:"Lancaster"}).$freeze()),e.const_set($[0],"MARKET",[["60y","67","71","76","82","90","100p","112","126","142","160","180","200","225","250","275","300","325","350"],["53y","60y","66","70","76","82","90p","100","112","126","142","160","180","200","220","240","260","280","300"],["46y","55y","60y","65","70","76","82p","90","100","111","125","140","155","170","185","200"],["39o","48y","54y","60y","66","71","76p","82","90","100","110","120","130"],["32o","41o","48y","55y","62","67","71p","76","82","90","100"],["25b","34o","42o","50y","58y","65","67p","71","75","80"],["18b","27b","36o","45o","54y","63","67","69","70"],["10b","12b","30b","40o","50y","60y","67","68"],[""+n,"10b","20b","30b","40o","50y","60y"],[""+n,""+n,"10b","20b","30b","40o","50y"],[""+n,""+n,""+n,"10b","20b","30b","40o"]].$freeze()),e.const_set($[0],"STARTING_CASH",s(3,800,4,600,5,480,6,400).$freeze()),e.const_set($[0],"PHASES",[a(i($,"Phase"),"TWO"),a(i($,"Phase"),"THREE"),a(i($,"Phase"),"FOUR"),a(i($,"Phase"),"FIVE"),a(i($,"Phase"),"SIX"),a(i($,"Phase"),"D")].$freeze()),e.const_set($[0],"TRAINS",[l(["name","distance","price","rusts_on","num"],{name:"2",distance:2,price:80,rusts_on:"4",num:6}),l(["name","distance","price","rusts_on","num"],{name:"3",distance:3,price:180,rusts_on:"6",num:5}),l(["name","distance","price","rusts_on","num"],{name:"4",distance:4,price:300,rusts_on:"D",num:4}),l(["name","distance","price","num"],{name:"5",distance:5,price:450,num:3}),l(["name","distance","price","num"],{name:"6",distance:6,price:630,num:2}),l(["name","distance","price","num","available_on","discount"],{name:"D",distance:999,price:1100,num:6,available_on:"6",discount:l(["4","5","6","D"],{4:300,5:300,6:300,D:300})})].$freeze()),e.const_set($[0],"COMPANIES",[l(["name","value","revenue","sym","desc","abilities"],{name:"Schuylkill Valley",value:20,revenue:5,sym:"SV",desc:"",abilities:[l(["type","hexes"],{type:"blocks_hexes",hexes:["G15"]})]}),l(["name","value","revenue","sym","desc","abilities"],{name:"Champlain & St.Lawrence",value:40,revenue:10,sym:"C&SL",desc:"A corporation owning the C&StL may lay a tile on the C&StL's hex even if this hex\n          is not connected to the corporations's railhead. This free tile placement is in addition\n          to the corporation's normal tile placement.",abilities:[l(["type","hexes"],{type:"blocks_hexes",hexes:["B20"]})]}),l(["name","value","revenue","sym","desc","abilities"],{name:"Delaware & Hudson",value:70,revenue:15,sym:"D&H",desc:"A corporation owning the Delaware & Hudson may establish a railhead on the D&H hex\n          by laying a station tile and a token. The station does not have to be connected to the\n          remainder of the corporation's route. The tile laid is the owning corporation's one tile\n          placement for the turn.",abilities:[l(["type","hexes"],{type:"blocks_hexes",hexes:["F16"]})]}),l(["name","value","revenue","sym","desc","abilities"],{name:"Mohawk & Hudson",value:110,revenue:20,sym:"M&H",desc:"A player owning the M&H may exhange it for a 10% share of the NYC if he does not\n          already hold 60% of the NYC and there is NYC stock available in the Bank or the Pool. The\n          exchange may be made during the player's turn of a stock round or between the turns of\n          other players or corporations in either stock or operating rounds. This action closes the M&H.",abilities:[l(["type","hexes"],{type:"blocks_hexes",hexes:["D18"]})]}),l(["name","value","revenue","sym","desc","abilities"],{name:"Camden & Amboy",value:160,revenue:25,sym:"C&A",desc:"The initial purchaser of the C&A immediately receives a 10% share of PRR stock\n          without further payment. This action does not close the C&A. The PRR corporation will not\n          be running at this point, but the stock may be retained or sold subject to the ordinary rules\n          of the game.",abilities:[l(["type","hexes"],{type:"blocks_hexes",hexes:["H18"]})]}),l(["name","value","revenue","sym","desc","abilities"],{name:"Baltimore & Ohio",value:220,revenue:30,sym:"B&O",desc:"The owner of the B&O private company immediately receives the President's certificate\n          of the B&O without further payment. The B&O private company may not be sold to any corporation,\n          and does not exchange hands if the owning player loses the Presidency of the B&O. When the B&O\n          purchases its first train the private company is closed down.",abilities:[l(["type","hexes"],{type:"blocks_hexes",hexes:["I13","I15"]})]})].$freeze()),e.const_set($[0],"CORPORATIONS",[l(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"PRR",logo:"1830/PRR",name:"Pennsylvania Railroad",tokens:[0,40,100,100],float_percent:60,coordinates:"H12",color:"#32763f"}),l(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"NYC",logo:"1830/NYC",name:"New York Central Railroad",tokens:[0,40,100,100],float_percent:60,coordinates:"E19",color:"#110a0c"}),l(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"CPR",logo:"1830/CPR",name:"Canadian Pacific Railroad",tokens:[0,40,100,100],float_percent:60,coordinates:"A19",color:"#d1232a"}),l(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"B&O",logo:"1830/BO",name:"Baltimore & Ohio Railroad",tokens:[0,40,100],float_percent:60,coordinates:"I15",color:"#025aaa"}),l(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"C&O",logo:"1830/CO",name:"Chesapeake & Ohio Railroad",tokens:[0,40,100],float_percent:60,coordinates:"F6",color:"#8dd7f6"}),l(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"ERIE",logo:"1830/ERIE",name:"Erie Railroad",tokens:[0,40,100],float_percent:60,coordinates:"E11",color:"#ffe600"}),l(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"NYNH",logo:"1830/NYNH",name:"New York, New Haven & Hartford Railroad",tokens:[0,40],float_percent:60,coordinates:"G19",color:"#f58121"}),l(["sym","logo","name","tokens","float_percent","coordinates","color"],{sym:"B&M",logo:"1830/BM",name:"Boston & Maine Railroad",tokens:[0,40],float_percent:60,coordinates:"E23",color:"rgb(110,192,55)"})].$freeze())}(u[0],i(u,"Base"),u)}(u[0],u)}(r[0],r)},Opal.modules["engine/game/g_1817"]=function(e){var t=e.top,r=[],n=(e.nil,e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.klass,$=e.hash,o=e.hash2;return e.add_stubs(["$freeze"]),t.$require("engine/game/g_1817.rb/../base"),function(t,r){var s=[a(t,"Engine")].concat(r);!function(t,r){var s=[a(t,"Game")].concat(r);!function(t,$super,r){var n=[i(t,$super,"G1817")].concat(r);e.const_set(n[0],"BANK_CASH",99999),e.const_set(n[0],"CURRENCY_FORMAT_STR","$%d"),e.const_set(n[0],"CERT_LIMIT",$(3,21,4,16,5,13,6,11,7,9).$freeze()),e.const_set(n[0],"HEXES",o(["red","white","gray","yellow","blue"],{red:$(["A20"],"o=r:yellow_20|green_30|brown_50|gray_60;p=a:4,b:_0;p=a:5,b:_0",["A28"],"o=r:yellow_20|green_30|brown_50|gray_60;p=a:5,b:_0",["D1"],"o=r:yellow_20|green_30|brown_50|gray_60;p=a:3,b:_0;p=a:4,b:_0",["H1"],"o=r:yellow_20|green_30|brown_50|gray_60;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0",["J7","J15"],"o=r:yellow_20|green_30|brown_50|gray_60;p=a:1,b:_0;p=a:2,b:_0"),white:$(["B5","B17","C14","C22","F3","F13","F19","I16"],"city",["D7"],"c=r:0;u=c:20,t:water",["D19","I12"],"c=r:0;u=c:15,t:mountain",["G6","H3","H9"],"c=r:0;u=c:10,t:water",["B25","C20","C24","E16","E18","F15","G12","G14","H11","H13","H15","I8","I10"],"u=c:15,t:mountain",["D13","E12","F11","G4","G10","H7"],"u=c:10,t:water",["B9","B27","D25","D27","G20","H17"],"u=c:20,t:water",["B3","B7","B11","B15","B19","B21","B23","C4","C6","C10","C16","C18","D3","D5","D11","D15","D17","D21","D23","E2","E4","E6","E8","E10","E14","E20","F5","F7","F9","F17","F21","G2","G8","G16","H5","I2","I4","I6","I14"],"blank"),gray:$(["B13"],"t=r:yellow_20|green_30|brown_40;p=a:0,b:_0;p=a:3,b:_0;p=a:4,b:_0",["D9"],"c=r:yellow_30|green_40|brown_50|gray_60,s:2;p=a:4,b:_0;p=a:5,b:_0"),yellow:$(["C8"],"c=r:30;p=a:3,b:_0;p=a:5,b:_0;l=B;u=c:20,t:water",["C26"],"c=r:30;p=a:2,b:_0;p=a:4,b:_0;l=B",["E22"],"c=r:40;c=r:40;p=a:2,b:_0;p=a:5,b:_1;l=NY;u=c:20,t:water",["G18"],"c=r:30;p=a:3,b:_0;p=a:5,b:_0;l=B"),blue:$(["C12"],"blank")}).$freeze()),e.const_set(n[0],"TILES",o(["5","6","7","8","9","14","15","54","57","62","63","80","81","82","83","448","544","545","546","592","593","597","611","619","X00","X30"],{5:6,6:7,7:5,8:20,9:20,14:7,15:7,54:1,57:7,62:1,63:8,80:7,81:7,82:10,83:10,448:4,544:5,545:5,546:5,592:4,593:4,597:4,611:2,619:8,X00:o(["count","color","code"],{count:1,color:"yellow",code:"c=r:30,s:1;p=a:0,b:_0;p=a:2,b:_0;p=a:4,b:_0;l=B"}),X30:o(["count","color","code"],{count:1,color:"gray",code:"c=r:100,s:4;p=a:1,b:_0;p=a:2,b:_0;p=a:3,b:_0;p=a:4,b:_0;l=NY"})}).$freeze()),e.const_set(n[0],"LOCATION_NAMES",o(["A20","A28","B5","B13","B17","C8","C14","C22","C26","D1","D7","D9","D19","F3","F13","F19","G6","G18","H1","H3","H9","I12","I16","J7","J15"],{A20:"Montr\xe9al",A28:"Maritime Prov.",B5:"Lansing",B13:"Toronto",B17:"Rochester",C8:"Detroit",C14:"Buffalo",C22:"Albany",C26:"Boston",D1:"Chicago",D7:"Toledo",D9:"Cleveland",D19:"Scranton",F3:"Indianapolis",F13:"Pittsburgh",F19:"Philadelphia",G6:"Cincinnati",G18:"Baltimore",H1:"St. Louis",H3:"Louisville",H9:"Charleston",I12:"Blacksburg",I16:"Richmond",J7:"Atlanta",J15:"Raleigh-Durham"}).$freeze()),e.const_set(n[0],"MARKET",[].$freeze()),e.const_set(n[0],"STARTING_CASH",$(3,420,4,315,5,252,6,210,7,180).$freeze()),e.const_set(n[0],"PHASES",[].$freeze()),e.const_set(n[0],"TRAINS",[o(["name","distance","price","num"],{name:"2",distance:2,price:100,num:16}),o(["name","distance","price","num"],{name:"2+",distance:2,price:100,num:4}),o(["name","distance","price","num"],{name:"3",distance:3,price:250,num:12}),o(["name","distance","price","num"],{name:"4",distance:4,price:400,num:8}),o(["name","distance","price","num"],{name:"5",distance:5,price:600,num:5}),o(["name","distance","price","num"],{name:"6",distance:6,price:750,num:4}),o(["name","distance","price","num"],{name:"7",distance:7,price:900,num:3}),o(["name","distance","price","num"],{name:"8",distance:8,price:1100,num:16})].$freeze()),e.const_set(n[0],"COMPANIES",[].$freeze()),e.const_set(n[0],"CORPORATIONS",[o(["sym","logo","name","tokens","float_percent","color"],{sym:"A&S",logo:"",name:"Alton & Southern Railway",tokens:[0,0,0,0],float_percent:20,color:"rgb(193,60,125)"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"A&A",logo:"",name:"Arcade and Attica",tokens:[0,0,0,0],float_percent:20,color:"#e09001"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"Belt",logo:"",name:"Belt Railway of Chicago",tokens:[0,0,0,0],float_percent:20,color:"#f58121"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"Bess",logo:"",name:"Bessemer and Lake Erie Railroad",tokens:[0,0,0,0],float_percent:20,color:"#110a0c"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"B&A",logo:"",name:"Boston and Albany Railroad",tokens:[0,0,0,0],float_percent:20,color:"#d1232a"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"DL&W",logo:"",name:"Delaware, Lackawanna and Western Railroad",tokens:[0,0,0,0],float_percent:20,color:"#680b26"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"J",logo:"",name:"Elgin, Joliet and Eastern Railway",tokens:[0,0,0,0],float_percent:20,color:"#32763f"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"GT",logo:"",name:"Grand Trunk Western Railroad",tokens:[0,0,0,0],float_percent:20,color:"rgb(95,35,132)"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"H",logo:"",name:"Housatonic Railroad",tokens:[0,0,0,0],float_percent:20,color:"#8dd7f6"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"ME",logo:"",name:"Morristown and Erie Railway",tokens:[0,0,0,0],float_percent:20,color:"#ffe600"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"NYOW",logo:"",name:"New York, Ontaria and Western Railway",tokens:[0,0,0,0],float_percent:20,color:"#235758"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"NYSW",logo:"",name:"New York, Susquehanna and Western Railway",tokens:[0,0,0,0],float_percent:20,color:"#9a9a9d"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"PSNR",logo:"",name:"Pittsburg, Shawmut and Northern Railroad",tokens:[0,0,0,0],float_percent:20,color:"rgb(110,192,55)"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"PLE",logo:"",name:"Pittsburg and Lake Erie Railroad",tokens:[0,0,0,0],float_percent:20,color:"#bdbd00"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"PW",logo:"",name:"Providence and Worcester Railroad",tokens:[0,0,0,0],float_percent:20,color:"#b58168"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"R",logo:"",name:"Rutland Railraod",tokens:[0,0,0,0],float_percent:20,color:"#025aaa"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"SR",logo:"",name:"Strasburg Railroad",tokens:[0,0,0,0],float_percent:20,color:"#fbf4de"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"UR",logo:"",name:"Union Railroad",tokens:[0,0,0,0],float_percent:20,color:"#004d95"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"WT",logo:"",name:"Warren & Trumbull Railroad",tokens:[0,0,0,0],float_percent:20,color:"#baa4cb"}),o(["sym","logo","name","tokens","float_percent","color"],{sym:"WC",logo:"",name:"West Chester Railroad",tokens:[0,0,0,0],float_percent:20,color:"#baa4cb"})].$freeze())}(s[0],n(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["engine/share"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var n=e.top,a=[],i=e.nil,$=(e.const_get_qualified,e.const_get_relative),o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash2,u=e.truthy,c=e.send;return e.add_stubs(["$include","$attr_reader","$id","$/","$==","$corporation","$par_price","$share_price","$price","$min_price","$*","$price_per_share","$num_shares","$name","$class"]),n.$require("engine/share.rb/../ownable"),function(n,a){var p=[o(n,"Engine")].concat(a);!function(n,$super,a){var o,p,d,_,f,h,y=s(n,null,"Share"),m=[y].concat(a);y.$$prototype.corporation=y.$$prototype.index=y.$$prototype.percent=y.$$prototype.owner=i,y.$include($(m,"Ownable")),y.$attr_reader("corporation","percent","president"),e.def(y,"$initialize",o=function(t,r){var n,a,$,o,s,c=this;if(null==r)r=l([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(n=r.$$smap.owner)&&(n=i),null==(a=r.$$smap.president)&&(a=!1),null==($=r.$$smap.percent)&&($=10),null==(o=r.$$smap.index)&&(o=0),c.corporation=t,c.president=a,c.percent=$,c.owner=u(s=n)?s:t,c.index=o},o.$$arity=-2),e.def(y,"$id",p=function(){var e=this;return e.corporation.$id()+"_"+e.index},p.$$arity=0),e.def(y,"$num_shares",d=function(){return t(this.percent,10)},d.$$arity=0),e.def(y,"$price_per_share",_=function(){var e,t,r=this,n=i;return n=r.owner["$=="](r.$corporation())?r.$corporation().$par_price():r.$corporation().$share_price(),u(e=(t=n)===i||null==t?i:c(t,"price",[]))?e:r.$corporation().$min_price()},_.$$arity=0),e.def(y,"$price",f=function(){var e=this;return r(e.$price_per_share(),e.$num_shares())},f.$$arity=0),e.def(y,"$to_s",h=function(){var e=this;return e.$class().$name()+" - "+e.$id()},h.$$arity=0)}(p[0],0,p)}(a[0],a)},Opal.modules["engine/round"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module);return function(e,t){var n=[r(e,"Engine")].concat(t);!function(e,t){[r(e,"Round")].concat(t)}(n[0],n)}(t[0],t)},Opal.modules["engine/ownable"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.truthy,$=e.send;return e.add_stubs(["$attr_accessor","$==","$owner","$is_a?","$player"]),function(t,o){var s=[a(t,"Engine")].concat(o);!function(t,o){var s,l,u,c=a(t,"Ownable"),p=[c].concat(o);c.$attr_accessor("owner"),e.def(c,"$owned_by?",s=function(e){var t,n,a,o=this;return!!i(e)&&(i(t=i(n=o.$owner()["$=="](e))?n:(a=o.$owner(),a===r||null==a?r:$(a,"owner",[]))["$=="](e))?t:o.$owner()["$=="]((n=e)===r||null==n?r:$(n,"owner",[])))},s.$$arity=1),e.def(c,"$player",l=function(){var e,t=this;return i(t.$owner()["$is_a?"](n(p,"Player")))?t.$owner():(e=t.$owner())===r||null==e?r:$(e,"player",[])},l.$$arity=0),e.def(c,"$owned_by_corporation?",u=function(){return this.$owner()["$is_a?"](n(p,"Corporation"))},u.$$arity=0)}(s[0],s)}(t[0],t)},Opal.modules.engine=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.send,s=e.truthy;return e.add_stubs(["$==","$require_tree","$compact","$map","$constants","$const_get","$!","$is_a?","$to_h","$title"]),i(r,"RUBY_ENGINE")["$=="]("opal")&&t.$require_tree("engine/game"),function(t,r){var l,u,c=$(t,"Engine"),p=[c].concat(r);e.const_set(p[0],"GAMES",o(i(p,"Game").$constants(),"map",[],(l=function(e){l.$$s;var t,r=n;return null==e&&(e=n),r=i(p,"Game").$const_get(e),s(s(t=r["$is_a?"](i(p,"Class"))["$!"]())?t:r["$=="](a(i(p,"Game"),"Base")))?n:r},l.$$s=c,l.$$arity=1,l)).$compact()),e.const_set(p[0],"GAMES_BY_TITLE",o(i(p,"GAMES"),"map",[],(u=function(e){u.$$s;return null==e&&(e=n),[e.$title(),e]},u.$$s=c,u.$$arity=1,u)).$to_h())}(r[0],r)},Opal.load("engine"),Opal.modules["mail/turn"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.klass),o=e.send,s=e.hash2
;return e.add_stubs(["$needs","$new","$map","$[]","$h","$render_link","$reverse","$last","$log"]),t.$require("mail/turn.rb/../../view/log.rb"),t.$require("mail/turn.rb/../../view/players.rb"),function(t,$super,r){var l,u,c=$(t,$super,"Turn"),p=[c].concat(r);return c.$$prototype.game_data=c.$$prototype.game=c.$$prototype.game_url=n,c.$needs("game_data"),c.$needs("game_url"),e.def(c,"$render",l=function(){var e,t=this;return t.game=a(a(i(p,"Engine"),"Game"),"G1889").$new(o(t.game_data["$[]"]("players"),"map",[],((e=function(t){e.$$s;return null==t&&(t=n),t["$[]"]("name")}).$$s=t,e.$$arity=1,e)),s(["actions"],{actions:t.game_data["$[]"]("actions")})),t.$h("div",[t.$render_link(),t.$h(a(i(p,"View"),"Log"),s(["log"],{log:t.game.$log().$last(20).$reverse()})),t.$h(a(i(p,"View"),"Players"),s(["game"],{game:t.game}))])},l.$$arity=0),e.def(c,"$render_link",u=function(){var e=this,t=n;return t=s(["attrs"],{attrs:s(["href"],{href:e.game_url})}),e.$h("a",t,"Go To Game "+e.game_data["$[]"]("id"))},u.$$arity=0),n&&"render_link"}(r[0],a(i(r,"Snabberb"),"Component"),r)},Opal.modules.index=function(e){e.top;var t=[],r=e.nil,n=e.const_get_qualified,a=e.const_get_relative,i=(e.breaker,e.slice,e.klass),$=e.hash2;return e.add_stubs(["$h"]),function(t,$super,n){var a,o=i(t,$super,"Index");[o].concat(n);return o.$$prototype.application=o.$$prototype.javascript_include_tags=o.$$prototype.attach_func=r,e.def(o,"$render",a=function(){var e=this,t=r,n=r;return t="* { font-family: 'Inconsolata', monospace; }\n\n      .card_header {\n  font-size: 15px;\n  font-weight: bold;\n  margin: 1rem 0;\n}\n\n      .back {\n  font-size: 15px;\n  font-weight: bold;\n  margin: 1rem 0;\n}\n\n      .button {\n  font-size: 14px;\n  border: solid 1px black;\n  border-radius: 5px;\n  padding: 0.2rem 1rem;\n  cursor: pointer;\n  outline-style: none;\n}\n\n      .button:hover {\n  background-color: black;\n  color: white;\n}\n\n      .half {\n  width: 100%;\n  display: inline-block;\n}\n\n      .margined {\n  margin: 1rem 1rem 1rem 0;\n}\n\n      .margined_half {\n  margin: 0.5rem 0.5rem 0.5rem 0;\n}\n\n      @media only screen and (min-width: 900px) {\n  .half { width: 49%; }\n}\n",n=$(["name","content"],{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0"}),e.$h("html",[e.$h("head",[e.$h("meta",$(["props"],{props:$(["charset"],{charset:"utf-8"})})),e.$h("meta",$(["props"],{props:n})),e.$h("title","18xx.games"),e.$h("link",$(["attrs"],{attrs:$(["rel","href"],{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"})})),e.$h("link",$(["attrs"],{attrs:$(["rel","href"],{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap"})})),e.$h("link",$(["attrs"],{attrs:$(["rel","type","href"],{rel:"icon",type:"image/svg+xml",href:"/images/icon.svg"})})),e.$h("link",$(["attrs"],{attrs:$(["rel","type","sizes","href"],{rel:"icon",type:"image/png",sizes:"32x32",href:"/images/favicon-32x32.png"})})),e.$h("link",$(["attrs"],{attrs:$(["rel","type","sizes","href"],{rel:"icon",type:"image/png",sizes:"16x16",href:"/images/favicon-16x16.png"})})),e.$h("link",$(["attrs"],{attrs:$(["rel","href"],{rel:"apple-touch-icon",href:"/apple-touch-icon.png"})})),e.$h("link",$(["attrs"],{attrs:$(["rel","href","color"],{rel:"mask-icon",href:"/images/mask.svg",color:"#f0e68c"})})),e.$h("link",$(["attrs"],{attrs:$(["rel","href"],{rel:"manifest",href:"/site.webmanifest"})})),e.$h("meta",$(["attrs"],{attrs:$(["rel","content"],{rel:"msapplication-TileColor",content:"#da532c"})})),e.$h("meta",$(["attrs"],{attrs:$(["rel","content"],{rel:"theme-color",content:"#ffffff"})})),e.$h("style",$(["props"],{props:$(["innerHTML"],{innerHTML:t})}))]),e.$h("body",[e.application,e.$h("div",$(["props"],{props:$(["innerHTML"],{innerHTML:e.javascript_include_tags})})),e.$h("script",$(["props"],{props:$(["innerHTML"],{innerHTML:e.attach_func})}))])])},a.$$arity=0),r&&"render"}(t[0],n(a(t,"Snabberb"),"Layout"),t)},Opal.modules.game_manager=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.hash2,u=(e.hash,e.send),c=e.truthy;return e.add_stubs(["$require","$needs","$now","$to_i","$strftime","$[]","$[]=","$-","$store","$safe_get","$update","$safe_post","$+","$==","$delete","$url","$update_game","$include?","$hs_url","$map","$dig","$protected","$none?","$reject!","$map!","$reverse","$sort_by"]),n.$require("lib/storage"),function(n,a){var p,d,_,f,h,y,m,g,b,v,w,k,x,E,O,A,T,S=s(n,"GameManager"),I=[S].concat(a);e.defs(S,"$included",p=function(e){return e.$needs("game",l(["default","store"],{"default":i,store:!0})),e.$needs("game_data",l(["default","store"],{"default":i,store:!0})),e.$needs("games",l(["default","store"],{"default":[],store:!0})),e.$needs("app_route",l(["default","store"],{"default":i,store:!0})),e.$needs("connection",l(["default","store"],{"default":i,store:!0})),e.$needs("flash_opts",l(["default","store"],{"default":l([],{}),store:!0}))},p.$$arity=1),e.def(S,"$create_hotseat",d=function(r){var n,a=this,s=i,c=i,p=i,d=i;if(null==r)r=l([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return n=e.kwrestargs(r,{}),s=o(I,"Time").$now(),d=[p=(c=l(["status","actions"],{status:"active",actions:[]}).$merge(e.to_hash(n)).$merge(l(["id","mode","user","created_at"],{id:"hs_"+s.$to_i(),mode:"hotseat",user:l(["id","name"],{id:0,name:"You"}),created_at:s.$strftime("%Y-%m-%d")})))["$[]"]("id"),c],u($(o(I,"Lib"),"Storage"),"[]=",e.to_a(d)),d[t(d.length,1)],a.$store("game",i,l(["skip"],{skip:!0})),a.$store("game_data",c,l(["skip"],{skip:!0})),a.$store("app_route","/hotseat/"+p)},d.$$arity=-1),e.def(S,"$enter_tutorial",_=function(){var e,t=this;return null==t.connection&&(t.connection=i),u(t.connection,"safe_get",["/assets/tutorial.json",""],((e=function(t){var r=e.$$s||this;return null==t&&(t=i),r.$store("game_data",t,l(["skip"],{skip:!0})),r.$update()}).$$s=t,e.$$arity=1,e))},_.$$arity=0),e.def(S,"$get_games",f=function(e){var t,r=this;return null==r.connection&&(r.connection=i),u(r.connection,"safe_get",["/game"+e],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$store("games",e["$[]"]("games"))}).$$s=r,t.$$arity=1,t))},f.$$arity=1),e.def(S,"$create_game",h=function(e){var t,n=this;return null==n.connection&&(n.connection=i),u(n.connection,"safe_post",["/game",e],((t=function(e){var n=t.$$s||this;return null==n.games&&(n.games=i),null==e&&(e=i),n.$store("games",r([e],n.games)),n.$store("app_route","/",l(["skip"],{skip:!0}))}).$$s=n,t.$$arity=1,t))},h.$$arity=1),e.def(S,"$delete_game",y=function(e){var t,r=this;return null==r.connection&&(r.connection=i),e["$[]"]("mode")["$=="]("hotseat")?($(o(I,"Lib"),"Storage").$delete(e["$[]"]("id")),r.$update()):u(r.connection,"safe_post",[r.$url(e,"/delete"),e],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$update_game(e)}).$$s=r,t.$$arity=1,t))},y.$$arity=1),e.def(S,"$join_game",m=function(e){var t,r=this;return null==r.connection&&(r.connection=i),u(r.connection,"safe_post",[r.$url(e,"/join")],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$update_game(e)}).$$s=r,t.$$arity=1,t))},m.$$arity=1),e.def(S,"$leave_game",g=function(e){var t,r=this;return null==r.connection&&(r.connection=i),u(r.connection,"safe_post",[r.$url(e,"/leave")],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$update_game(e)}).$$s=r,t.$$arity=1,t))},g.$$arity=1),e.def(S,"$start_game",b=function(e){var t,r=this;return null==r.connection&&(r.connection=i),u(r.connection,"safe_post",[r.$url(e,"/start")],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$update_game(e)}).$$s=r,t.$$arity=1,t))},b.$$arity=1),e.def(S,"$enter_game",v=function(e){var t,r=this,n=i,a=i;return null==r.app_route&&(r.app_route=i),null==r.connection&&(r.connection=i),r.$store("game",i,l(["skip"],{skip:!0})),e["$[]"]("mode")["$=="]("hotseat")?(n=e["$[]"]("id"),a=$(o(I,"Lib"),"Storage")["$[]"](n),c(a)?(r.$store("game_data",a,l(["skip"],{skip:!0})),c(r.app_route["$include?"](r.$hs_url(e)))||r.$store("app_route",r.$hs_url(e)),i):r.$store("flash_opts","Hotseat game "+n+" not found")):u(r.connection,"safe_get",[r.$url(e)],((t=function(r){var n=t.$$s||this;return null==r&&(r=i),n.$store("game_data",r,l(["skip"],{skip:!0})),n.$store("app_route",n.$url(e))}).$$s=r,t.$$arity=1,t))},v.$$arity=1),e.def(S,"$kick",w=function(e,t){var r,n=this;return null==n.connection&&(n.connection=i),u(n.connection,"safe_post",[n.$url(e,"/kick"),t],((r=function(e){var t=r.$$s||this;return null==e&&(e=i),t.$update_game(e)}).$$s=n,r.$$arity=1,r))},w.$$arity=2),e.def(S,"$user_in_game?",k=function(e,t){var r,n,a=this;return u(t["$[]"]("players"),"map",[],(r=function(e){r.$$s;return null==e&&(e=i),e["$[]"]("id")},r.$$s=a,r.$$arity=1,r))["$include?"]((n=e)===i||null==n?i:u(n,"dig",["id"]))},k.$$arity=2),e.def(S,"$user_owns_game?",x=function(e,t){var r,n;return c(r=t["$[]"]("mode")["$=="]("hotseat"))?r:t["$[]"]("user")["$[]"]("id")["$=="]((n=e)===i||null==n?i:u(n,"dig",["id"]))},x.$$arity=2),e.def(S,"$user_is_acting?",E=function(e,t){var r;return t["$[]"]("status")["$=="]("active")?t["$[]"]("acting")["$include?"]((r=e)===i||null==r?i:u(r,"dig",["id"])):t["$[]"]("status")["$=="]("active")},E.$$arity=2),S.$protected(),e.def(S,"$url",O=function(e,t){return null==t&&(t=""),"/game/"+e["$[]"]("id")+t},O.$$arity=-2),e.def(S,"$hs_url",A=function(e){return"/hotseat/"+e["$[]"]("id")},A.$$arity=1),e.def(S,"$update_game",T=function(e){var t,n,a,$,o=this;return null==o.games&&(o.games=i),c(u(o.games,"none?",[],((t=function(r){t.$$s;return null==r&&(r=i),r["$[]"]("id")["$=="](e["$[]"]("id"))}).$$s=o,t.$$arity=1,t)))&&(o.games=r(o.games,[e])),c(e["$[]"]("deleted"))&&u(o.games,"reject!",[],((n=function(t){n.$$s;return null==t&&(t=i),t["$[]"]("id")["$=="](e["$[]"]("id"))}).$$s=o,n.$$arity=1,n)),u(o.games,"map!",[],((a=function(t){a.$$s;return null==t&&(t=i),t["$[]"]("id")["$=="](e["$[]"]("id"))?e:t}).$$s=o,a.$$arity=1,a)),o.$store("games",u(o.games,"sort_by",[],($=function(e){$.$$s;return null==e&&(e=i),e["$[]"]("id")},$.$$s=o,$.$$arity=1,$)).$reverse())},T.$$arity=1)}(a[0],a)},Opal.modules["view/buy_trains"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var a=e.top,i=[],$=e.nil,o=e.const_get_qualified,s=e.const_get_relative,l=(e.breaker,e.slice,e.module),u=e.klass,c=e.send,p=e.hash2,d=e.truthy,_=e.lambda;return e.add_stubs(["$require","$include","$round","$current_entity","$depot","$group_by","$available","$to_proc","$delete","$sort_by","$==","$owner","$must_buy_train?","$crowded_corps","$<<","$h","$!","$none?","$can_buy_train?","$corp_has_room?","$concat","$from_depot","$is_a?","$last","$actions","$other_trains","$discountable_trains_for","$any?","$each","$lambda","$process_action","$new","$name","$format_currency","$<","$+","$cash","$min_depot_price","$render_bankruptcy","$shares_by_corporation","$empty?","$remaining_trains","$map","$price","$flat_map","$size","$to_s","$to_i","$[]","$>","$upcoming","$first"]),a.$require("view/actionable"),a.$require("view/corporation"),a.$require("view/discard_trains"),a.$require("view/sell_shares"),a.$require("view/undo_and_pass"),function(a,i){var f=[l(a,"View")].concat(i);!function(a,$super,i){var l,f,h,y,m,g=u(a,$super,"BuyTrains"),b=[g].concat(i);g.$$prototype.game=g.$$prototype.depot=g.$$prototype.corporation=$,g.$include(s(b,"Actionable")),e.def(g,"$render",l=function(){var n,a,i,l,u,_=this,f=$,h=$,y=$,m=$,g=$,v=$,w=$,k=$,x=$;return f=_.game.$round(),_.corporation=f.$current_entity(),_.depot=f.$depot(),y=(h=c(_.depot.$available(_.corporation),"group_by",[],"owner".$to_proc())).$delete(_.depot),m=c(h,"sort_by",[],((n=function(e,t){var r=n.$$s||this;return null==r.corporation&&(r.corporation=$),null==e&&(e=$),null==t&&(t=$),e.$owner()["$=="](r.corporation.$owner())?0:1}).$$s=_,n.$$arity=2,n)),g=[],v=f["$must_buy_train?"](),w=f.$crowded_corps(),g["$<<"](_.$h("div",[_.$h(s(b,"UndoAndPass"),p(["pass"],{pass:d(a=v["$!"]())?w["$none?"]():a}))])),d(d(a=d(i=f["$can_buy_train?"]())?f["$corp_has_room?"]():i)?a:f["$must_buy_train?"]())&&(g["$<<"](_.$h("div.margined","Available Trains")),g.$concat(_.$from_depot(y)),d(_.game.$actions().$last()["$is_a?"](s(b,"SellShares")))||g.$concat(_.$other_trains(m))),k=_.depot.$discountable_trains_for(_.corporation),d(k["$any?"]())&&(g["$<<"](_.$h("div.margined","Exchange Trains")),c(k,"each",[],((l=function(e,t,r){var n,a=l.$$s||this,i=$;return null==a.game&&(a.game=$),null==e&&(e=$),null==t&&(t=$),null==r&&(r=$),i=c(a,"lambda",[],((n=function(){var a=n.$$s||this;return null==a.corporation&&(a.corporation=$),a.$process_action(o(o(s(b,"Engine"),"Action"),"BuyTrain").$new(a.corporation,t,r,e))}).$$s=a,n.$$arity=0,n)),g["$<<"](a.$h("div",[e.$name()+" -> "+t.$name()+" "+a.game.$format_currency(r),a.$h("button.margined",p(["on"],{on:p(["click"],{click:i})}),"Exchange")]))}).$$s=_,l.$$arity=3,l))),d(v)&&(x=_.corporation.$owner(),d(t(r(_.corporation.$cash(),x.$cash()),_.depot.$min_depot_price()))&&(g["$<<"](_.$render_bankruptcy()),c(x.$shares_by_corporation(),"each",[],((u=function(e,t){var r=u.$$s||this;return null==e&&(e=$),null==t&&(t=$),d(t["$empty?"]())?$:g["$<<"](r.$h(s(b,"Corporation"),p(["corporation"],{corporation:e})))}).$$s=_,u.$$arity=2,u)),g["$<<"](_.$h(s(b,"SellShares"),p(["player"],{player:_.corporation.$owner()}))))),d(w["$any?"]())&&g["$<<"](_.$h(s(b,"DiscardTrains"),p(["corporations"],{corporations:w}))),g["$<<"](_.$h("div",[_.$h("div","Remaining Trains")].concat(e.to_a(_.$remaining_trains())))),_.$h("div",p([],{}),g)},l.$$arity=0),e.def(g,"$from_depot",f=function(e){var t,r=this;return c(e,"map",[],((t=function(e){var r,n=t.$$s||this,a=$;return null==n.game&&(n.game=$),null==e&&(e=$),a=_(((r=function(){var t=r.$$s||this;return null==t.corporation&&(t.corporation=$),t.$process_action(o(o(s(b,"Engine"),"Action"),"BuyTrain").$new(t.corporation,e,e.$price()))}).$$s=n,r.$$arity=0,r)),n.$h("div",["Train "+e.$name()+" - "+n.game.$format_currency(e.$price()),n.$h("button",p(["style","on"],{style:p(["margin"],{margin:"1rem"}),on:p(["click"],{click:a})}),"Buy")])}).$$s=r,t.$$arity=1,t))},f.$$arity=1),e.def(g,"$other_trains",h=function(e){var t,a=this;return c(e,"flat_map",[],((t=function(e,a){var i,l=t.$$s||this;return null==e&&(e=$),null==a&&(a=$),c(c(a,"group_by",[],"name".$to_proc()),"map",[],((i=function(t,a){var l,u=i.$$s||this,_=$,f=$,h=$;return null==u.corporation&&(u.corporation=$),null==t&&(t=$),null==a&&(a=$),_=u.$h("input",p(["style","attrs"],{style:p(["margin-left"],{"margin-left":"1rem"}),attrs:p(["type","min","max","value","size"],{type:"number",min:1,max:u.corporation.$cash(),value:1,size:u.corporation.$cash().$to_s().$size()})})),f=c(u,"lambda",[],((l=function(){var e=l.$$s||this,t=$;return null==e.corporation&&(e.corporation=$),t=_.elm.value.$to_i(),e.$process_action(o(o(s(b,"Engine"),"Action"),"BuyTrain").$new(e.corporation,a["$[]"](0),t))}).$$s=u,l.$$arity=0,l)),h=a.$size(),u.$h("div",[r("Train "+t+" - from "+e.$name(),d(n(h,1))?" (has "+h+")":""),_,u.$h("button.margined",p(["on"],{on:p(["click"],{click:f})}),"Buy")])}).$$s=l,i.$$arity=2,i))}).$$s=a,t.$$arity=2,t))},h.$$arity=1),e.def(g,"$remaining_trains",y=function(){var e,t=this;return c(c(t.depot.$upcoming(),"group_by",[],"name".$to_proc()),"map",[],((e=function(t,r){var n=e.$$s||this,a=$;return null==n.game&&(n.game=$),null==t&&(t=$),null==r&&(r=$),a=r.$first(),n.$h("div","Train: "+t+" - "+n.game.$format_currency(a.$price())+" x "+r.$size())}).$$s=t,e.$$arity=2,e))},y.$$arity=0),e.def(g,"$render_bankruptcy",m=function(){var e,t=this,r=$,n=$;return r=c(t,"lambda",[],((e=function(){var t=e.$$s||this;return null==t.corporation&&(t.corporation=$),t.$process_action(o(o(s(b,"Engine"),"Action"),"Bankrupt").$new(t.corporation))}).$$s=t,e.$$arity=0,e)),n=p(["style","on"],{style:p(["display"],{display:"block"}),on:p(["click"],{click:r})}),t.$h("button",n,"Declare Bankruptcy")},m.$$arity=0)}(f[0],o(s(f,"Snabberb"),"Component"),f)}(i[0],i)},Opal.modules["view/about"]=function(e){e.top;var t=[],r=e.nil,n=e.const_get_qualified,a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$h"]),function(t,s){var l=[i(t,"View")].concat(s);!function(t,$super,n){var a,i=$(t,$super,"About");[i].concat(n);e.def(i,"$render",a=function(){var e=this,t=r,n=r;return t="<p>18xx.games is created and maintained by Toby Mao. It is an open source project, and you can find the\ncode on <a href='https://github.com/tobymao/18xx/issues'>Github</a>.</p>\n\n        <p><a href='https://boardgamegeek.com/boardgame/23540/1889-history-shikoku-railways'>1889</a> is used with kind permission from\nJosh Starr at Grand Trunk Games.</p>\n\n        <p>This website will always be open-source and free to play. If you'd like support this project, you can become a patron on\n<a href='https://www.patreon.com/18xxgames'>Patreon</a>.</p>\n",n=o(["style","props"],{style:o(["padding","margin"],{padding:"1em",margin:"1rem 0"}),props:o(["innerHTML"],{innerHTML:t})}),e.$h("div",n)},a.$$arity=0)}(l[0],n(a(l,"Snabberb"),"Component"),l)}(t[0],t)},Opal.modules["view/token"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2;return e.add_stubs(["$needs","$h","$logo","$-@","$*"]),function(r,l){var u=[$(r,"View")].concat(l);!function(r,$super,a){var i,$=o(r,$super,"Token");[$].concat(a);$.$$prototype.corporation=$.$$prototype.radius=n,$.$needs("corporation"),$.$needs("radius"),e.def($,"$render",i=function(){var e=this;return e.$h("image",s(["attrs"],{attrs:s(["href","x","y","height","width"],{href:e.corporation.$logo(),x:e.radius["$-@"](),y:e.radius["$-@"](),height:t(2,e.radius),width:t(2,e.radius)})}))},i.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/tile_confirmation"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.lambda;return e.add_stubs(["$require","$include","$needs","$x","$y","$lay_tile","$store","$h","$new","$entity","$tile","$hex","$rotation","$process_action"]),t.$require("view/actionable"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var $,u,c=o(t,$super,"TileConfirmation"),p=[c].concat(r);c.$$prototype.tile_selector=n,c.$include(i(p,"Actionable")),c.$needs("selected_company",s(["store","default"],{store:!0,"default":n})),c.$needs("tile_selector",s(["store"],{store:!0})),e.def(c,"$render",$=function(){var e,t,r=this,a=n,i=n,$=n;return a=s(["position","left","top"],{position:"absolute",left:r.tile_selector.$x(),top:r.tile_selector.$y()}),i=s(["props","style","on"],{props:s(["innerHTML"],{innerHTML:"\u2611"}),style:s(["position","cursor","left","top","font-size"],{position:"absolute",cursor:"pointer",left:"22px",top:"-8px","font-size":"35px"}),on:s(["click"],{click:l((e=function(){return(e.$$s||this).$lay_tile()},e.$$s=r,e.$$arity=0,e))})}),$=s(["props","style","on"],{props:s(["innerHTML"],{innerHTML:"\u232b"}),style:s(["position","cursor","left","font-size"],{position:"absolute",cursor:"pointer",left:"52px","font-size":"20px"}),on:s(["click"],{click:l((t=function(){return(t.$$s||this).$store("tile_selector",n)},t.$$s=r,t.$$arity=0,t))})}),r.$h("div",s(["style"],{style:a}),[r.$h("div",i),r.$h("div",$)])},$.$$arity=0),e.def(c,"$lay_tile",u=function(){var e=this,t=n;return t=a(a(i(p,"Engine"),"Action"),"LayTile").$new(e.tile_selector.$entity(),e.tile_selector.$tile(),e.tile_selector.$hex(),e.tile_selector.$tile().$rotation()),e.$store("tile_selector",n,s(["skip"],{skip:!0})),e.$store("selected_company",n,s(["skip"],{skip:!0})),e.$process_action(t)},u.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/stock_market"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var $=e.top,o=[],s=e.nil,l=e.const_get_qualified,u=e.const_get_relative,c=(e.breaker,e.slice,e.module),p=e.klass,d=e.hash2,_=e.send,f=e.truthy;return e.add_stubs(["$require","$needs","$freeze","$-","$*","$/","$+","$merge","$flat_map","$market","$stock_market","$map","$[]","$color","$corporations","$size","$>","$with_index","$logo","$h","$price","$<<","$format_currency","$cash","$bank","$concat"]),$.$require("view/token"),function($,o){var h=[c($,"View")].concat(o);!function($,$super,o){var l,c=p($,$super,"StockMarket"),h=[c].concat(o);c.$$prototype.game=c.$$prototype.show_bank=s,c.$needs("game"),c.$needs("show_bank",d(["default"],{"default":!1})),e.const_set(h[0],"COLOR_MAP",d(["red","brown","orange","yellow"],{red:"#ffaaaa",brown:"#8b4513",orange:"#ffbb55",yellow:"#ffff99"}).$freeze()),e.const_set(h[0],"PAD",5),e.const_set(h[0],"BORDER",1),e.const_set(h[0],"WIDTH_TOTAL",50),e.const_set(h[0],"HEIGHT_TOTAL",50),e.const_set(h[0],"TOKEN_PAD",3),e.const_set(h[0],"TOKEN_SIZE",25),e.const_set(h[0],"BOX_WIDTH",t(u(h,"WIDTH_TOTAL"),r(2,u(h,"BORDER")))),e.const_set(h[0],"LEFT_MARGIN",u(h,"TOKEN_PAD")),e.const_set(h[0],"RIGHT_MARGIN",t(u(h,"BOX_WIDTH"),u(h,"TOKEN_PAD"))),e.const_set(h[0],"LEFT_TOKEN_POS",u(h,"LEFT_MARGIN")),e.const_set(h[0],"RIGHT_TOKEN_POS",t(u(h,"RIGHT_MARGIN"),u(h,"TOKEN_SIZE"))),e.const_set(h[0],"MID_TOKEN_POS",n(a(u(h,"LEFT_TOKEN_POS"),u(h,"RIGHT_TOKEN_POS")),2)),e.def(c,"$render",l=function(){var e,$=this,o=s,l=s,c=s,p=s,y=s,m=s;return o=d(["position","display","padding","width","height","margin","vertical-align"],{position:"relative",display:"inline-block",padding:u(h,"PAD")+"px",width:t(u(h,"WIDTH_TOTAL"),r(2,u(h,"PAD")))+"px",height:t(u(h,"HEIGHT_TOTAL"),r(2,u(h,"PAD")))+"px",margin:"0","vertical-align":"top"}),l=o.$merge(d(["width","height","border"],{width:t(t(u(h,"WIDTH_TOTAL"),r(2,u(h,"PAD"))),r(2,u(h,"BORDER")))+"px",height:t(t(u(h,"HEIGHT_TOTAL"),r(2,u(h,"PAD"))),r(2,u(h,"BORDER")))+"px",border:"solid "+u(h,"BORDER")+"px rgba(0,0,0,0.2)"})),c=_($.game.$stock_market().$market(),"flat_map",[],((e=function($){var c,p=e.$$s||this,y=s;return null==$&&($=s),y=_($,"map",[],((c=function(e){var $,p=c.$$s||this,y=s,m=s,g=s,b=s,v=s;return null==e&&(e=s),f(e)?(y=l.$merge(d(["background-color"],{"background-color":u(h,"COLOR_MAP")["$[]"](e.$color())})),m=e.$corporations(),g=m.$size(),b=f(i(g,1))?n(t(u(h,"RIGHT_TOKEN_POS"),u(h,"LEFT_TOKEN_POS")),t(g,1)):0,v=_(m.$map(),"with_index",[],(($=function(e,n){var o=$.$$s||this,l=s;return null==e&&(e=s),null==n&&(n=s),l=d(["attrs","style"],{attrs:d(["data","width"],{data:e.$logo(),width:u(h,"TOKEN_SIZE")+"px"}),style:d(["position","left","z-index"],{position:"absolute",left:f(i(g,1))?a(u(h,"LEFT_TOKEN_POS"),r(t(t(g,n),1),b))+"px":u(h,"MID_TOKEN_POS")+"px","z-index":t(g,n)})}),o.$h("object",l)}).$$s=p,$.$$arity=2,$)),p.$h("div",d(["style"],{style:y}),[p.$h("div",d(["style"],{style:d(["font-size"],{"font-size":"80%"})}),e.$price()),p.$h("div",v)])):p.$h("div",d(["style"],{style:o}),"")}).$$s=p,c.$$arity=1,c)),p.$h("div",d(["style"],{style:d(["width"],{width:"max-content"})}),y)}).$$s=$,e.$$arity=1,e)),p=d(["style"],{style:d(["margin-bottom"],{"margin-bottom":"1rem"})}),y=[],f($.show_bank)&&y["$<<"]($.$h("div",p,"Bank Cash: "+$.game.$format_currency($.game.$bank().$cash()))),y.$concat(c),m=d(["style"],{style:d(["width","overflow"],{width:"100%",overflow:"auto"})}),$.$h("div",m,y)},l.$$arity=0)}(h[0],l(u(h,"Snabberb"),"Component"),h)}(o[0],o)},Opal.modules["view/game"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send,u=e.truthy;return e.add_stubs(["$require","$needs","$[]","$size","$to_i","$!=","$id","$actions","$new","$map","$take","$store","$route_anchor","$===","$render_game","$h","$tiles","$init_tiles","$subscribe","$game_path","$==","$current_action_id","$<<","$process_action","$get","$clone","$lambda","$unsubscribe","$tabs","$private","$tab_button","$all?","$companies","$to_proc","$concat","$first","$split","$last","$name","$class","$operating?","$turn","$round_num","$description","$round","$render_round","$render_action"]),t.$require("lib/connection"),t.$require("lib/params"),t.$require("view/auction_round"),t.$require("view/companies"),t.$require("view/corporations"),t.$require("view/entity_order"),t.$require("view/exchange"),t.$require("view/history_controls"),t.$require("view/game_log"),t.$require("view/map"),t.$require("view/operating_round"),t.$require("view/players"),t.$require("view/stock_round"),t.$require("view/stock_market"),t.$require("view/tile_manifest"),t.$require("view/tools"),t.$require("view/train_and_phase_roster"),t.$require("view/spreadsheet"),function(t,r){var c=[$(t,"View")].concat(r);!function(t,$super,r){var $,c,p,d,_,f,h,y,m=o(t,$super,"Game"),g=[m].concat(r);m.$$prototype.game_data=m.$$prototype.game=m.$$prototype.num_actions=m.$$prototype.user=m.$$prototype.connection=m.$$prototype.app_route=m.$$prototype.round=n,m.$needs("game_data",s(["store"],{store:!0})),m.$needs("game",s(["default","store"],{"default":n,store:!0})),m.$needs("connection"),m.$needs("show_grid",s(["default","store"],{"default":!1,store:!0})),m.$needs("selected_company",s(["default","store"],{"default":n,store:!0})),m.$needs("app_route",s(["store"],{store:!0})),m.$needs("user"),e.def(m,"$render",$=function(){var e,t,r,$,o,c,p,d=this,_=n,f=n,h=n,y=n,m=n,b=n,v=n;return _=d.game_data["$[]"]("id"),f=d.game_data["$[]"]("actions"),d.num_actions=f.$size(),e=a(i(g,"Lib"),"Params")["$[]"]("action"),h=e===n||null==e?n:l(e,"to_i",[]),u(u(t=u(r=_["$!="](($=d.game)===n||null==$?n:l($,"id",[])))?r:d.game.$actions().$size()["$!="](d.num_actions))?t:u(r=h)?h["$!="](d.game.$actions().$size()):r)&&(d.game=a(i(g,"Engine"),"GAMES_BY_TITLE")["$[]"](d.game_data["$[]"]("title")).$new(l(d.game_data["$[]"]("players"),"map",[],((o=function(e){o.$$s;return null==e&&(e=n),e["$[]"]("name")}).$$s=d,o.$$arity=1,o)),s(["id","pin","actions"],{id:_,pin:d.game_data["$[]"]("settings")["$[]"]("pin_version"),actions:u(h)?f.$take(h):f})),d.$store("game",d.game,s(["skip"],{skip:!0}))),m=d.$route_anchor(),y=n["$==="](m)?d.$render_game():"map"["$==="](m)?d.$h(i(g,"Map"),s(["game"],{game:d.game})):"market"["$==="](m)?d.$h(i(g,"StockMarket"),s(["game","show_bank"],{game:d.game,show_bank:!0})):"tiles"["$==="](m)?d.$h(i(g,"TileManifest"),s(["tiles","all_tiles"],{tiles:d.game.$tiles(),all_tiles:d.game.$init_tiles()})):"companies"["$==="](m)?d.$h(i(g,"Companies"),s(["game","user"],{game:d.game,user:d.user})):"corporations"["$==="](m)?d.$h(i(g,"Corporations"),s(["game","user"],{game:d.game,user:d.user})):"trains"["$==="](m)?d.$h(i(g,"TrainAndPhaseRoster"),s(["game"],{game:d.game})):"players"["$==="](m)?d.$h(i(g,"Players"),s(["game"],{game:d.game})):"spreadsheet"["$==="](m)?d.$h(i(g,"Spreadsheet"),s(["game"],{game:d.game})):"tools"["$==="](m)?d.$h(i(g,"Tools"),s(["game","game_data","user"],{game:d.game,game_data:d.game_data,user:d.user})):n,l(d.connection,"subscribe",[d.$game_path()],((c=function(e){var t,r=c.$$s||this;return null==r.game&&(r.game=n),null==r.game_data&&(r.game_data=n),null==r.connection&&(r.connection=n),null==e&&(e=n),e["$[]"]("id")["$=="](r.game.$current_action_id())?(r.game_data["$[]"]("actions")["$<<"](e),r.$store("game_data",r.game_data,s(["skip"],{skip:!0})),r.$store("game",r.game.$process_action(e))):l(r.connection,"get",[r.$game_path()],((t=function(e){var r=t.$$s||this;return null==r.game&&(r.game=n),null==e&&(e=n),r.$store("game_data",e,s(["skip"],{skip:!0})),r.$store("game",r.game.$clone(e["$[]"]("actions")))}).$$s=r,t.$$arity=1,t))}).$$s=d,c.$$arity=1,c)),b=l(d,"lambda",[],((p=function(){var e=p.$$s||this;return null==e.connection&&(e.connection=n),e.connection.$unsubscribe(e.$game_path()),e.$store("show_grid",!1,s(["skip"],{skip:!0})),e.$store("selected_company",n,s(["skip"],{skip:!0}))}).$$s=d,p.$$arity=0,p)),v=s(["key","hook"],{key:"game_page",hook:s(["destroy"],{destroy:b})}),d.$h("div",v,[d.$tabs(),y])},$.$$arity=0),e.def(m,"$game_path",c=function(){return"/game/"+this.game_data["$[]"]("id")},c.$$arity=0),m.$private(),e.def(m,"$tabs",p=function(){var e=this,t=n,r=n;return t=s(["style"],{style:s(["overflow","position","padding","margin","top","background-color","font-size","z-index"],{overflow:"auto",position:"sticky",padding:"1.5rem",margin:"-16px -1.5rem 1.5rem -1.5rem",top:"0","background-color":"gainsboro","font-size":"large","z-index":"9999"})}),r=[e.$tab_button("Game"),e.$tab_button("Players","#players"),e.$tab_button("Corporations","#corporations"),e.$tab_button("Map","#map"),e.$tab_button("Market","#market"),e.$tab_button("Trains/Phases","#trains"),e.$tab_button("Tiles","#tiles")],u(l(e.game.$companies(),"all?",[],"closed?".$to_proc()))||r["$<<"](e.$tab_button("Companies","#companies")),r.$concat([e.$tab_button("Spreadsheet","#spreadsheet"),e.$tab_button("Tools","#tools")]),e.$h("div",t,[e.$h("div",s(["style"],{style:s(["width"],{width:"max-content"})}),r)])},p.$$arity=0),e.def(m,"$tab_button",d=function(e,t){var r,a,i=this,$=n,o=n;return null==t&&(t=""),$=l(i,"lambda",[],((r=function(){var e=r.$$s||this;return null==e.app_route&&(e.app_route=n),e.$store("app_route",""+e.app_route.$split("#").$first()+t)}).$$s=i,r.$$arity=0,r)),o=s(["attrs","style","on"],{attrs:s(["href","onclick"],{href:t,onclick:"return false"}),style:s(["margin","color","text-decoration"],{margin:"0 1rem 1rem 0",color:"black","text-decoration":(u(a=i.$route_anchor())?a:"")["$=="](t)?"":"none"}),on:s(["click"],{click:$})}),i.$h("a",o,e)},d.$$arity=-2),e.def(m,"$route_anchor",_=function(){return this.app_route.$split("#")["$[]"](1)},_.$$arity=0),e.def(m,"$render_round",f=function(){var e=this,t=n,r=n;return t=e.round.$class().$name().$split(":").$last(),r=(r=u(e.round["$operating?"]())?e.game.$turn()+"."+e.round.$round_num():e.game.$turn())+" - "+e.round.$description(),e.$h("div",s(["style"],{style:s(["font-weight"],{"font-weight":"bold"})}),t+" Round "+r)},f.$$arity=0),e.def(m,"$render_action",h=function(){var e=this,t=n;return t=e.round,a(a(i(g,"Engine"),"Round"),"Auction")["$==="](t)?e.$h(i(g,"AuctionRound"),s(["game"],{game:e.game})):a(a(i(g,"Engine"),"Round"),"Stock")["$==="](t)?e.$h(i(g,"StockRound"),s(["game"],{game:e.game})):a(a(i(g,"Engine"),"Round"),"Operating")["$==="](t)?e.$h(i(g,"OperatingRound"),s(["game"],{game:e.game})):n},h.$$arity=0),e.def(m,"$render_game",y=function(){var e=this;return e.round=e.game.$round(),e.$h("div.game",[e.$render_round(),e.$h(i(g,"GameLog"),s(["user"],{user:e.user})),e.$h(i(g,"HistoryControls"),s(["num_actions"],{num_actions:e.num_actions})),e.$h(i(g,"EntityOrder"),s(["round"],{round:e.round})),e.$h(i(g,"Exchange")),e.$render_action()])},y.$$arity=0)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(r[0],r)},Opal.modules["view/stock_round"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy,u=e.send;return e.add_stubs(["$require","$include","$needs","$round","$current_entity","$!=","$store","$h","$!","$must_sell?","$render_corporations","$<<","$map","$corporations","$share_pool","$==","$render_input","$ipoed","$render_ipoed","$render_pre_ipo","$compact","$first","$shares","$[]","$shares_by_corporation","$lambda","$process_action","$new","$can_buy?","$select","$companies","$to_s","$fetch","$abilities","$name","$can_gain?","$owner","$each","$par_prices","$stock_market","$format_currency","$price"]),t.$require("view/actionable"),t.$require("view/corporation"),t.$require("view/players"),t.$require("view/sell_shares"),t.$require("view/stock_market"),t.$require("view/undo_and_pass"),function(t,r){var c=[$(t,"View")].concat(r);!function(t,$super,r){var $,c,p,d,_,f=o(t,$super,"StockRound"),h=[f].concat(r);f.$$prototype.game=f.$$prototype.round=f.$$prototype.last_player=f.$$prototype.current_entity=f.$$prototype.selected_corporation=n,f.$include(i(h,"Actionable")),f.$needs("selected_corporation",s(["default","store"],{"default":n,store:!0})),f.$needs("last_player",s(["default","store"],{"default":n,store:!0})),e.def(f,"$render",$=function(){var t=this,r=n;return t.round=t.game.$round(),t.current_entity=t.round.$current_entity(),
l(t.last_player["$!="](t.current_entity))&&(t.$store("selected_corporation",n,s(["skip"],{skip:!0})),t.$store("last_player",t.current_entity,s(["skip"],{skip:!0}))),(r=[t.$h(i(h,"UndoAndPass"),s(["pass"],{pass:t.round["$must_sell?"]()["$!"]()}))].concat(e.to_a(t.$render_corporations())))["$<<"](t.$h(a(i(h,"View"),"Players"),s(["game"],{game:t.game}))),r["$<<"](t.$h(a(i(h,"View"),"StockMarket"),s(["game"],{game:t.game}))),t.$h("div",r)},$.$$arity=0),e.def(f,"$render_corporations",c=function(){var e,t=this,r=n;return r=s(["style"],{style:s(["display","vertical-align"],{display:"inline-block","vertical-align":"top"})}),u(t.round.$share_pool().$corporations(),"map",[],((e=function(t){var a=e.$$s||this,$=n;return null==a.selected_corporation&&(a.selected_corporation=n),null==t&&(t=n),$=[a.$h(i(h,"Corporation"),s(["corporation"],{corporation:t}))],a.selected_corporation["$=="](t)&&$["$<<"](a.$render_input()),a.$h("div",r,$)}).$$s=t,e.$$arity=1,e))},c.$$arity=0),e.def(f,"$render_input",p=function(){var e=this,t=n;return t=l(e.selected_corporation.$ipoed())?e.$render_ipoed():e.$render_pre_ipo(),e.$h("div",s(["style"],{style:s(["margin-top","width"],{"margin-top":"0.5rem",width:"320px"})}),[t].$compact())},p.$$arity=0),e.def(f,"$render_ipoed",d=function(){var e,t,r,$,o,c=this,p=n,d=n,_=n,f=n,y=n,m=n;return p=c.selected_corporation.$shares().$first(),e=c.round.$share_pool().$shares_by_corporation()["$[]"](c.selected_corporation),d=e===n||null==e?n:u(e,"first",[]),_=u(c,"lambda",[],((t=function(){var e=t.$$s||this;return null==e.current_entity&&(e.current_entity=n),e.$process_action(a(a(i(h,"Engine"),"Action"),"BuyShare").$new(e.current_entity,p))}).$$s=c,t.$$arity=0,t)),f=u(c,"lambda",[],((r=function(){var e=r.$$s||this;return null==e.current_entity&&(e.current_entity=n),e.$process_action(a(a(i(h,"Engine"),"Action"),"BuyShare").$new(e.current_entity,d))}).$$s=c,r.$$arity=0,r)),y=[],l(c.round["$must_sell?"]())||(l(c.round["$can_buy?"](p))&&y["$<<"](c.$h("button.margined_half",s(["on"],{on:s(["click"],{click:_})}),"Buy IPO Share")),l(c.round["$can_buy?"](d))&&y["$<<"](c.$h("button.margined_half",s(["on"],{on:s(["click"],{click:f})}),"Buy Market Share")),m=u(c.game.$companies(),"select",[],(($=function(e){var t,r,a,i,o=$.$$s||this;return null==o.selected_corporation&&(o.selected_corporation=n),null==o.round&&(o.round=n),null==e&&(e=n),(t=e.$abilities("exchange"),r=t===n||null==t?n:u(t,"fetch",["corporation"]),r===n||null==r?n:u(r,"to_s",[]))["$=="](o.selected_corporation.$name())?o.round["$can_gain?"](p,e.$owner()):(a=e.$abilities("exchange"),i=a===n||null==a?n:u(a,"fetch",["corporation"]),i===n||null==i?n:u(i,"to_s",[]))["$=="](o.selected_corporation.$name())}).$$s=c,$.$$arity=1,$)),u(m,"each",[],((o=function(e){var t,r=o.$$s||this,$=n;return null==r.current_entity&&(r.current_entity=n),null==e&&(e=n),$=u(r,"lambda",[],((t=function(){return(t.$$s||this).$process_action(a(a(i(h,"Engine"),"Action"),"BuyShare").$new(e,p))}).$$s=r,t.$$arity=0,t)),y["$<<"](e.$owner()["$=="](r.current_entity)?r.$h("button",s(["on"],{on:s(["click"],{click:$})}),"Exchange "+e.$name()+" for Share"):r.$h("button",s(["on"],{on:s(["click"],{click:$})}),e.$owner().$name()+" exchanges "+e.$name()+" for Share"))}).$$s=c,o.$$arity=1,o))),y["$<<"](c.$h(i(h,"SellShares"),s(["player"],{player:c.current_entity}))),c.$h("div",y)},d.$$arity=0),e.def(f,"$render_pre_ipo",_=function(){var t,r=this,$=n,o=n;return l(r.round["$must_sell?"]())?n:($=s(["cursor","border","display","padding","margin"],{cursor:"pointer",border:"solid 1px gainsboro",display:"inline-block",padding:"0.5rem",margin:"0.5rem 0.5rem 0.5rem 0"}),o=u(r.round.$stock_market().$par_prices(),"map",[],((t=function(e){var r,o=t.$$s||this,l=n;return null==o.game&&(o.game=n),null==e&&(e=n),l=u(o,"lambda",[],((r=function(){var t=r.$$s||this;return null==t.current_entity&&(t.current_entity=n),null==t.selected_corporation&&(t.selected_corporation=n),t.$process_action(a(a(i(h,"Engine"),"Action"),"Par").$new(t.current_entity,t.selected_corporation,e))}).$$s=o,r.$$arity=0,r)),o.$h("div",s(["style","on"],{style:$,on:s(["click"],{click:l})}),o.game.$format_currency(e.$price()))}).$$s=r,t.$$arity=1,t)),r.$h("div",[r.$h("div","Par Price:")].concat(e.to_a(o))))},_.$$arity=0)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(r[0],r)},Opal.modules["view/triangular_grid"]=function(e){e.top;var t=[],r=e.nil,n=e.const_get_qualified,a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.klass,o=e.send,s=e.hash2;return e.add_stubs(["$map","$h"]),function(t,l){var u=[i(t,"View")].concat(l);!function(t,$super,n){var a,i=$(t,$super,"TriangularGrid");[i].concat(n);e.def(i,"$render",a=function(){var e,t=this,n=r,a=r;return n=o([30,90,150],"map",[],((e=function(t){var n=e.$$s||this;return null==t&&(t=r),n.$h("g",s(["attrs"],{attrs:s(["transform"],{transform:"rotate("+t+")"})}),[n.$h("path",s(["attrs"],{attrs:s(["d"],{d:"M 0 100 L 0 -100"})})),n.$h("path",s(["attrs"],{attrs:s(["d","transform"],{d:"M 0 75 L 0 -75",transform:"translate(-43.5 0)"})})),n.$h("path",s(["attrs"],{attrs:s(["d","transform"],{d:"M 0 75 L 0 -75",transform:"translate(43.5 0)"})}))])}).$$s=t,e.$$arity=1,e)),a=s(["fill","opacity","stroke","stroke-width"],{fill:"none",opacity:.5,stroke:"black","stroke-width":2}),t.$h("g.triangular_grid",s(["attrs"],{attrs:a}),n)},a.$$arity=0)}(u[0],n(a(u,"Snabberb"),"Component"),u)}(t[0],t)},Opal.modules["view/buy_companies"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send;return e.add_stubs(["$require","$include","$needs","$current_entity","$h","$compact","$render_companies","$sort_by","$purchasable_companies","$==","$owner","$value","$map","$<<","$render_input","$max_price","$min_price","$size","$to_s","$cash","$lambda","$to_i","$process_action","$new","$store"]),t.$require("view/actionable"),t.$require("view/company"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var $,u,c,p=o(t,$super,"BuyCompanies"),d=[p].concat(r);p.$$prototype.game=p.$$prototype.selected_company=p.$$prototype.corporation=n,p.$include(i(d,"Actionable")),p.$needs("selected_company",s(["default","store"],{"default":n,store:!0})),e.def(p,"$render",$=function(){var t=this;return t.corporation=t.game.$current_entity(),t.$h("div","Buy Private Companies",[].concat(e.to_a(t.$render_companies())).$compact())},$.$$arity=0),e.def(p,"$render_companies",u=function(){var e,t,r=this,a=n,$=n;return a=s(["style"],{style:s(["display","vertical-align"],{display:"inline-block","vertical-align":"top"})}),$=l(r.game.$purchasable_companies(),"sort_by",[],((e=function(t){var r=e.$$s||this;return null==r.corporation&&(r.corporation=n),null==t&&(t=n),[t.$owner()["$=="](r.corporation.$owner())?0:1,t.$value()]}).$$s=r,e.$$arity=1,e)),l($,"map",[],((t=function(e){var r=t.$$s||this,$=n;return null==r.selected_company&&(r.selected_company=n),null==e&&(e=n),$=[r.$h(i(d,"Company"),s(["company"],{company:e}))],r.selected_company["$=="](e)&&$["$<<"](r.$render_input()),r.$h("div",a,$)}).$$s=r,t.$$arity=1,t))},u.$$arity=0),e.def(p,"$render_input",c=function(){var e,t=this,r=n,$=n,o=n;return r=t.$h("input",s(["style","props"],{style:s(["margin-right"],{"margin-right":"1rem"}),props:s(["value","type","min","max","size"],{value:t.selected_company.$max_price(),type:"number",min:t.selected_company.$min_price(),max:t.selected_company.$max_price(),size:t.corporation.$cash().$to_s().$size()})})),$=l(t,"lambda",[],((e=function(){var t=e.$$s||this,$=n;return null==t.corporation&&(t.corporation=n),null==t.selected_company&&(t.selected_company=n),$=r.elm.value.$to_i(),t.$process_action(a(a(i(d,"Engine"),"Action"),"BuyCompany").$new(t.corporation,t.selected_company,$)),t.$store("selected_company",n,s(["skip"],{skip:!0}))}).$$s=t,e.$$arity=0,e)),o=s(["style"],{style:s(["text-align","margin"],{"text-align":"center",margin:"1rem"})}),t.$h("div",o,[r,t.$h("button",s(["on"],{on:s(["click"],{click:$})}),"Buy")])},c.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/discard_trains"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.send,l=e.hash2,u=e.lambda;return e.add_stubs(["$require","$include","$needs","$map","$trains","$process_action","$new","$h","$name"]),t.$require("view/actionable"),function(t,r){var c=[$(t,"View")].concat(r);!function(t,$super,r){var $,c=o(t,$super,"DiscardTrains"),p=[c].concat(r);c.$$prototype.corporations=n,c.$include(i(p,"Actionable")),c.$needs("corporations"),e.def(c,"$render",$=function(){var t,r=this,$=n;return $=s(r.corporations,"map",[],((t=function(r){var $,o=t.$$s||this,c=n;return null==r&&(r=n),c=s(r.$trains(),"map",[],(($=function(e){var t,o=$.$$s||this,s=n;return null==e&&(e=n),s=l(["style","on"],{style:l(["display","cursor","border","margin-left","padding"],{display:"inline-block",cursor:"pointer",border:"solid 1px gainsboro","margin-left":"1rem",padding:"0.5rem"}),on:l(["click"],{click:u((t=function(){return(t.$$s||this).$process_action(a(a(i(p,"Engine"),"Action"),"DiscardTrain").$new(r,e))},t.$$s=o,t.$$arity=0,t))})}),o.$h("div",s,e.$name())}).$$s=o,$.$$arity=1,$)),o.$h("div",[r.$name()].concat(e.to_a(c)))}).$$s=r,t.$$arity=1,t)),r.$h("div",["Discard Trains"].concat(e.to_a($)))},$.$$arity=0)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(r[0],r)},Opal.modules["view/dividend"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.lambda;return e.add_stubs(["$require","$include","$h","$dividend","$process_action","$new","$current_entity"]),t.$require("view/actionable"),t.$require("view/undo_and_pass"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var $,u,c=o(t,$super,"Dividend"),p=[c].concat(r);c.$$prototype.game=n,c.$include(i(p,"Actionable")),e.def(c,"$render",$=function(){var e,t,r=this;return r.$h("div",[r.$h(i(p,"UndoAndPass"),s(["pass"],{pass:!1})),r.$h("button.margined",s(["on"],{on:s(["click"],{click:l((e=function(){return(e.$$s||this).$dividend("payout")},e.$$s=r,e.$$arity=0,e))})}),"Payout"),r.$h("button.margined",s(["on"],{on:s(["click"],{click:l((t=function(){return(t.$$s||this).$dividend("withhold")},t.$$s=r,t.$$arity=0,t))})}),"Withhold")])},$.$$arity=0),e.def(c,"$dividend",u=function(e){var t=this;return t.$process_action(a(a(i(p,"Engine"),"Action"),"Dividend").$new(t.game.$current_entity(),e))},u.$$arity=1)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/player"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}e.top;var a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.truthy,p=e.send;return e.add_stubs(["$needs","$can_act?","$round","$[]=","$-","$render_title","$render_body","$any?","$companies","$<<","$render_companies","$h","$name","$render_info","$shares","$render_shares","$num_certs","$cert_limit","$>","$format_currency","$cash","$value","$==","$priority_deal_player","$map","$reverse","$sort_by","$reject","$shares_by_corporation","$empty?","$sum","$to_proc","$president?","$render_corporation_shares","$logo","$+","$render_company","$revenue"]),function(a,d){var _=[s(a,"View")].concat(d);!function(a,$super,$){var o,s,d,_,f,h,y,m,g=l(a,$super,"Player");[g].concat($);g.$$prototype.game=g.$$prototype.player=i,g.$needs("player"),g.$needs("game"),e.def(g,"$render",o=function(){var r=this,n=i,a=i,$=i;return n=u(["display","position","border","border-radius","overflow","padding","margin","width","vertical-align"],{display:"inline-block",position:"relative",border:"solid 1px gainsboro","border-radius":"10px",overflow:"hidden",padding:"0.5rem",margin:"0.5rem 0.5rem 0 0",width:"320px","vertical-align":"top"}),c(r.game.$round()["$can_act?"](r.player))&&(a=["border","solid 1px black"],p(n,"[]=",e.to_a(a)),a[t(a.length,1)],a=["background-color","#dfd"],p(n,"[]=",e.to_a(a)),a[t(a.length,1)]),$=[r.$render_title(),r.$render_body()],c(r.player.$companies()["$any?"]())&&$["$<<"](r.$render_companies()),r.$h("div",u(["style"],{style:n}),$)},o.$$arity=0),e.def(g,"$render_title",s=function(){var e=this,t=i;return t=u(["background-color","text-align","color","padding","font-weight","margin"],{"background-color":c(e.game.$round()["$can_act?"](e.player))?"#9b9":"lightgray","text-align":"center",color:"black",padding:"0.5rem 0px","font-weight":"bold",margin:"-0.5rem -0.5rem 0 -0.5rem"}),e.$h("div",u(["style"],{style:t}),e.player.$name())},s.$$arity=0),e.def(g,"$render_body",d=function(){var e=this,t=i,r=i;return t=u(["style"],{style:u(["margin-top","margin-bottom","display","justify-content"],{"margin-top":"1rem","margin-bottom":"0.5rem",display:"flex","justify-content":"center"})}),r=[e.$render_info()],c(e.player.$shares()["$any?"]())&&r["$<<"](e.$render_shares()),e.$h("div",t,r)},d.$$arity=0),e.def(g,"$render_info",_=function(){var e=this,t=i,n=i,a=i,$=i,o=i,s=i;return t=e.player.$num_certs(),n=e.game.$cert_limit(),a=u(["style"],{style:u(["display","margin-left","margin-right"],{display:"inline-block","margin-left":"1.5rem","margin-right":"1.5rem"})}),$=u(["style"],{style:u(["padding"],{padding:"0 0.5rem"})}),o=u(["style"],{style:u(["padding","color"],{padding:"0 0.5rem",color:c(r(t,n))?"red":"black"})}),s=[e.$h("tr",[e.$h("td",$,"Cash"),e.$h("td",$,e.game.$format_currency(e.player.$cash()))]),e.$h("tr",[e.$h("td",$,"Value"),e.$h("td",$,e.game.$format_currency(e.player.$value()))]),e.$h("tr",[e.$h("td",$,"Certs"),e.$h("td",o,t+"/"+n)])],e.player["$=="](e.game.$priority_deal_player())&&s["$<<"](e.$h("tr",[e.$h("td",u(["attrs","style"],{attrs:u(["colspan"],{colspan:"2"}),style:u(["text-align"],{"text-align":"center"})}),"Priority Deal")])),e.$h("div",a,[e.$h("table",s)])},_.$$arity=0),e.def(g,"$render_shares",f=function(){var e,t,r,n=this,a=i,$=i,o=i;return a=u(["style"],{style:u(["text-align"],{"text-align":"right"})}),$=u(["style"],{style:u(["display","margin-left","margin-right"],{display:"inline-block","margin-left":"1.5rem","margin-right":"1.5rem"})}),o=p(p(p(n.player.$shares_by_corporation(),"reject",[],(e=function(t,r){e.$$s;return null==t&&(t=i),null==r&&(r=i),r["$empty?"]()},e.$$s=n,e.$$arity=2,e)),"sort_by",[],(t=function(e,r){var n=t.$$s||this;return null==n.player&&(n.player=i),null==e&&(e=i),null==r&&(r=i),[p(r,"sum",[],"percent".$to_proc()),c(e["$president?"](n.player))?1:0,e.$name()]},t.$$s=n,t.$$arity=2,t)).$reverse(),"map",[],((r=function(e,t){var n=r.$$s||this;return null==e&&(e=i),null==t&&(t=i),n.$render_corporation_shares(e,t)}).$$s=n,r.$$arity=2,r)),n.$h("div",$,[n.$h("table",a,o)])},f.$$arity=0),e.def(g,"$render_corporation_shares",h=function(e,t){var r=this,a=i,$=i,o=i,s=i;return a=u(["attrs","style"],{attrs:u(["src"],{src:e.$logo()}),style:u(["position","width","top","left"],{position:"absolute",width:"20px",top:"0",left:"0"})}),$=u(["style"],{style:u(["position","width"],{position:"relative",width:"20px"})}),o=u(["style"],{style:u(["padding","text-align"],{padding:"0.1rem 0.2rem","text-align":"left"})}),s=c(e["$president?"](r.player))?"*":"",r.$h("tr",[r.$h("td",$,[r.$h("img",a)]),r.$h("td",o,n(e.$name(),s)),r.$h("td",o,p(t,"sum",[],"percent".$to_proc())+"%")])},h.$$arity=2),e.def(g,"$render_companies",y=function(){var t,r=this,n=i,a=i,$=i,o=i;return n=u(["style"],{style:u(["margin-top","margin-bottom","text-align"],{"margin-top":"1rem","margin-bottom":"0.5rem","text-align":"center"})}),a=u(["style"],{style:u(["display","text-align","margin-left","margin-right"],{display:"inline-block","text-align":"right","margin-left":"auto","margin-right":"auto"})}),$=u(["style"],{style:u(["text-align","padding"],{"text-align":"center",padding:"0 0.3rem"})}),o=p(r.player.$companies(),"map",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$render_company(e)}).$$s=r,t.$$arity=1,t)),r.$h("div",n,[r.$h("table",a,[r.$h("tr",[r.$h("th",$,"Company"),r.$h("th",$,"Value"),r.$h("th",$,"Income")])].concat(e.to_a(o)))])},y.$$arity=0),e.def(g,"$render_company",m=function(e){var t=this,r=i,n=i;return r=u(["style"],{style:u(["text-align","overflow","white-space","text-overflow"],{"text-align":"center",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"})}),n=u(["style"],{style:u(["padding"],{padding:"0 0.5rem"})}),t.$h("tr",[t.$h("td",r,e.$name()),t.$h("td",n,t.game.$format_currency(e.$value())),t.$h("td",n,t.game.$format_currency(e.$revenue()))])},m.$$arity=1)}(_[0],$(o(_,"Snabberb"),"Component"),_)}(a[0],a)},Opal.modules["view/link"]=function(e){e.top;var t=[],r=e.nil,n=e.const_get_qualified,a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$needs","$h"]),function(t,s){var l=[i(t,"View")].concat(s);!function(t,$super,n){var a,i=$(t,$super,"Link");[i].concat(n);i.$$prototype.href=i.$$prototype.style=i.$$prototype.click=i.$$prototype["class"]=i.$$prototype.children=r,i.$needs("href"),i.$needs("click"),i.$needs("children",o(["default"],{"default":[]})),i.$needs("style",o(["default"],{"default":o([],{})})),i.$needs("class",o(["default"],{"default":r})),e.def(i,"$render",a=function(){var e=this,t=r;return t=o(["attrs","style","on"],{attrs:o(["href","onclick"],{href:e.href,onclick:"return false"}),style:e.style,on:o(["click"],{click:e.click})}),e.$h("a"+e["class"],t,e.children)},a.$$arity=0)}(l[0],n(a(l,"Snabberb"),"Component"),l)}(t[0],t)},Opal.modules["view/exchange"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy,u=e.send;return e.add_stubs(["$require","$include","$needs","$abilities","$h","$corporation_by_id","$to_s","$[]","$find","$shares","$!","$president","$can_gain?","$round","$owner","$lambda","$process_action","$new","$store","$name"]),t.$require("view/actionable"),function(t,r){var c=[$(t,"View")].concat(r);!function(t,$super,r){var $,c=o(t,$super,"Exchange"),p=[c].concat(r);c.$$prototype.selected_company=c.$$prototype.game=n,c.$include(i(p,"Actionable")),c.$needs("selected_company",s(["default","store"],{"default":n,store:!0})),e.def(c,"$render",$=function(){var e,t,r,$,o=this,c=n,d=n,_=n,f=n;return l(c=(e=o.selected_company)===n||null==e?n:u(e,"abilities",["exchange"]))?(d=o.game.$corporation_by_id((t=c["$[]"]("corporation"))===n||null==t?n:u(t,"to_s",[])),_=u(d.$shares(),"find",[],((r=function(e){r.$$s;return null==e&&(e=n),e.$president()["$!"]()}).$$s=o,r.$$arity=1,r)),l(_)&&l(o.game.$round()["$can_gain?"](_,o.selected_company.$owner()))?(f=u(o,"lambda",[],(($=function(){var e=$.$$s||this;return null==e.selected_company&&(e.selected_company=n),e.$process_action(a(a(i(p,"Engine"),"Action"),"BuyShare").$new(e.selected_company,_)),e.$store("selected_company",n,s(["skip"],{skip:!0}))}).$$s=o,$.$$arity=0,$)),o.$h("button",s(["on"],{on:s(["click"],{click:f})}),"Exchange for a share of "+d.$name())):o.$h("div")):o.$h("div")},$.$$arity=0)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(r[0],r)},Opal.modules["view/hex"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var i=e.top,$=[],o=e.nil,s=e.const_get_qualified,l=e.const_get_relative,u=(e.breaker,e.slice,e.module),c=e.klass,p=e.hash2,d=e.send,_=e.truthy,f=e.lambda;return e.add_stubs(["$require_tree","$require","$freeze","$/","$*","$sqrt","$needs","$h","$==","$hex","$tile","$<<","$[]","$layable_hexes","$coordinates","$transform","$fetch","$color","$opacity","$on_hex_click","$[]=","$-","$layout","$+","$x","$y","$translation","$add_hex","$store","$rotate!","$===","$can_lay_track?","$new","$root","$current_entity","$tile=","$is_a?","$step","$include?"]),i.$require_tree("view/engine"),i.$require("lib/hex"),i.$require("lib/tile_selector"),i.$require("view/tile"),i.$require("view/triangular_grid"),function(i,$){var h=[u(i,"View")].concat($);!function(i,$super,$){var u,h,y,m,g,b=c(i,$super,"Hex"),v=[b].concat($);b.$$prototype.hex=b.$$prototype.tile_selector=b.$$prototype.selected=b.$$prototype.tile=b.$$prototype.show_grid=b.$$prototype.round=b.$$prototype.role=b.$$prototype.selected_route=b.$$prototype.opacity=o,e.const_set(v[0],"SIZE",100),e.const_set(v[0],"LAYOUT",p(["flat","pointy"],{flat:[t(r(l(v,"SIZE"),3),2),t(r(l(v,"SIZE"),l(v,"Math").$sqrt(3)),2)],pointy:[t(r(l(v,"SIZE"),l(v,"Math").$sqrt(3)),2),t(r(l(v,"SIZE"),3),2)]}).$freeze()),e.const_set(v[0],"COLOR",p(["white","yellow","green","brown","gray","red"],{white:"#fff",yellow:"#fde900",green:"#71bf44",brown:"#cb7745",gray:"#bcbdc0",red:"#ec232a"}).$freeze()),b.$needs("hex"),b.$needs("round",p(["default"],{"default":o})),b.$needs("selected_route",p(["default","store"],{"default":o,store:!0})),b.$needs("tile_selector",p(["default","store"],{"default":o,store:!0})),b.$needs("show_grid",p(["default","store"],{"default":!1,store:!0})),b.$needs("role",p(["default"],{"default":"map"})),b.$needs("opacity",p(["default"],{"default":o})),e.def(b,"$render",u=function(){var t,r,a,i=this,$=o,u=o,c=o,h=o,y=o;return $=[i.$h("polygon",p(["attrs"],{attrs:p(["points"],{points:s(s(l(v,"Lib"),"Hex"),"POINTS")})}))],i.selected=i.hex["$=="]((t=i.tile_selector)===o||null==t?o:d(t,"hex",[])),i.tile=_(_(r=i.selected)?i.tile_selector.$tile():r)?i.tile_selector.$tile():i.hex.$tile(),_(i.tile)&&$["$<<"](i.$h(l(v,"Tile"),p(["tile"],{tile:i.tile}))),_(i.show_grid)&&$["$<<"](i.$h(s(l(v,"View"),"TriangularGrid"))),_(i.round)&&(u=i.round.$layable_hexes()["$[]"](i.hex)),c=_(r=u)?r:i.role["$=="]("tile_selector"),h=p(["attrs"],{attrs:p(["id","transform","fill","stroke","opacity","cursor"],{id:"hex-"+i.hex.$coordinates(),transform:i.$transform(),fill:l(v,"COLOR").$fetch((r=i.tile,r===o||null==r?o:d(r,"color",[])),"white"),stroke:"black",opacity:i.$opacity(u),cursor:_(c)?"pointer":o})}),_(c)&&(y=["on",p(["click"],{click:f((a=function(e){var t=a.$$s||this;return null==e&&(e=o),t.$on_hex_click(e)},a.$$s=i,a.$$arity=1,a))})],d(h,"[]=",e.to_a(y)),y[n(y.length,1)]),_(i.selected)&&(y=["stroke-width",5],d(h["$[]"]("attrs"),"[]=",e.to_a(y)),y[n(y.length,1)]),i.$h("g",h,$)},u.$$arity=0),e.def(b,"$translation",h=function(){var t,n,i=this,$=o,s=o;return n=l(v,"LAYOUT")["$[]"](i.hex.$layout()),$=null==(t=e.to_ary(n))[0]?o:t[0],s=null==t[1]?o:t[1],"translate("+a(r($,i.hex.$x()),l(v,"SIZE"))+", "+a(r(s,i.hex.$y()),l(v,"SIZE"))+")"},h.$$arity=0),e.def(b,"$transform",y=function(){var e=this;return e.$translation()+(e.hex.$layout()["$=="]("pointy")?" rotate(30)":"")},y.$$arity=0),e.def(b,"$on_hex_click",m=function(t){var r,a=this,i=o,$=o;return _(a.selected_route)?(a.selected_route.$add_hex(a.hex),a.$store("selected_route",a.selected_route),o):_(_(r=a.selected)?a.tile_selector.$tile():r)?a.tile_selector["$rotate!"]():(i=a.role,"map"["$==="](i)?_((r=a.round)===o||null==r?o:d(r,"can_lay_track?",[]))?a.$store("tile_selector",s(l(v,"Lib"),"TileSelector").$new(a.hex,a.tile,t,a.$root(),a.round.$current_entity())):o:"tile_selector"["$==="](i)?($=[a.tile],d(a.tile_selector,"tile=",e.to_a($)),$[n($.length,1)]):o)},m.$$arity=1),e.def(b,"$opacity",g=function(e){var t,r=this,n=o,a=o;return _(r.opacity)?r.opacity:(n=_(t=r.round["$is_a?"](s(s(l(v,"Engine"),"Round"),"Operating")))?r.round.$step()["$=="]("track"):t,a=r.round["$is_a?"](s(s(l(v,"Engine"),"Round"),"Special")),_(_(t=n)?t:a)?_(_(t=e)?t:["tile_selector","tile_page"]["$include?"](r.role))?1:.3:1)},g.$$arity=1)}(h[0],s(l(h,"Snabberb"),"Component"),h)}($[0],$)},Opal.modules["view/actionable"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.hash2,l=e.truthy,u=e.send;return e.add_stubs(["$require","$needs","$[]","$store","$process_action","$<<","$to_h","$==","$finished","$result","$[]=","$-","$safe_post","$clone","$actions","$message","$each","$backtrace","$puts"]),r.$require("lib/params"),r.$require("lib/storage"),function(r,n){var c=[o(r,"View")].concat(n);!function(r,n){var c,p,d=o(r,"Actionable"),_=[d].concat(n);e.defs(d,"$included",c=function(e){return e.$needs("game_data",s(["default","store"],{"default":s([],{}),store:!0})),e.$needs("game",s(["store"],{store:!0})),e.$needs("flash_opts",s(["default","store"],{"default":s([],{}),store:!0})),e.$needs("connection",s(["store","default"],{store:!0,"default":a}))},c.$$arity=1),e.def(d,"$process_action",p=function(r){var n,o=this,c=a,p=a,d=a;null==o.game&&(o.game=a),null==o.game_data&&(o.game_data=a),null==o.connection&&(o.connection=a);try{return l(i($(_,"Lib"),"Params")["$[]"]("action"))?o.$store("flash_opts","You cannot make changes in history mode. Press >| to go current"):(c=o.game.$process_action(r),o.game_data["$[]"]("actions")["$<<"](r.$to_h()),o.$store("game_data",o.game_data,s(["skip"],{skip:!0})),o.game_data["$[]"]("mode")["$=="]("hotseat")?(l(o.game.$finished())?(p=["result",o.game.$result()],u(o.game_data,"[]=",e.to_a(p)),p[t(p.length,1)],p=["status","finished"],u(o.game_data,"[]=",e.to_a(p)),p[t(p.length,1)]):(p=["result",s([],{})],u(o.game_data,"[]=",e.to_a(p)),p[t(p.length,1)],p=["status","active"],u(o.game_data,"[]=",e.to_a(p)),p[t(p.length,1)]),p=[o.game_data["$[]"]("id"),o.game_data],u(i($(_,"Lib"),"Storage"),"[]=",e.to_a(p)),p[t(p.length,1)]):o.connection.$safe_post("/game/"+o.game_data["$[]"]("id")+"/action",r.$to_h()),o.$store("game",c))}catch(f){if(!e.rescue(f,[$(_,"StandardError")]))throw f;d=f;try{return o.$store("game",o.game.$clone(o.game.$actions()),s(["skip"],{skip:!0})),o.$store("flash_opts",d.$message()),u(d.$backtrace(),"each",[],((n=function(e){var t=n.$$s||this;return null==e&&(e=a),t.$puts(e)}).$$s=o,n.$$arity=1,n))}finally{e.pop_exception()}}},p.$$arity=1)}(c[0],c)}(n[0],n)},Opal.modules["view/companies"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send;return e.add_stubs(["$require","$needs","$map","$sort_by","$group_by","$select","$companies","$to_proc","$==","$name","$dig","$render_companies","$h"]),t.$require("view/company"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var a,$,u=o(t,$super,"Companies"),c=[u].concat(r);u.$$prototype.game=n,u.$needs("game"),u.$needs("user",s(["default"],{"default":n})),e.def(u,"$render",a=function(){var e,t,r=this,a=n;return a=l(l(l(l(r.game.$companies(),"select",[],"owner".$to_proc()),"group_by",[],"owner".$to_proc()),"sort_by",[],((e=function(t,r){var a,i=e.$$s||this;return null==i.user&&(i.user=n),null==t&&(t=n),null==r&&(r=n),t.$name()["$=="]((a=i.user)===n||null==a?n:l(a,"dig",["name"]))?"":t.$name()}).$$s=r,e.$$arity=2,e)),"map",[],((t=function(e,r){var a=t.$$s||this;return null==e&&(e=n),null==r&&(r=n),a.$render_companies(e,r)}).$$s=r,t.$$arity=2,t)),r.$h("div",a)},a.$$arity=0),e.def(u,"$render_companies",$=function(t,r){var a,$=this;return $.$h("div",[$.$h("div",s(["style"],{style:s(["border-bottom"],{"border-bottom":"1px solid gainsboro"})}),t.$name())].concat(e.to_a(l(r,"map",[],((a=function(e){var t=a.$$s||this;return null==e&&(e=n),t.$h(i(c,"Company"),s(["company"],{company:e}))}).$$s=$,a.$$arity=1,a)))))},$.$$arity=2)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/tiles_page"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.send,c=e.truthy,p=e.hash2;return e.add_stubs(["$require_tree","$require","$needs","$freeze","$reduce","$keys","$to_proc","$[]","$match","$==","$h","$map","$render_tile_block","$include?","$map_hexes_and_tile_manifest_for","$split","$render_individual_tile","$new","$class","$tile_by_id","$name","$tile","$hex_by_id","$location_name","$to_h","$hexes","$each","$find","$all?","$blockers","$cities","$nil?","$[]=","$-","$<<","$join","$>","$size","$slice","$name=","$sort","$group_by","$tiles","$first","$title","$to_s"]),n.$require_tree("view/engine"),n.$require("view/tile_manifest"),n.$require("view/tiles"),function(n,a){var d=[s(n,"View")].concat(a);!function(n,$super,a){var s,d,_,f=l(n,$super,"TilesPage"),h=[f].concat(a);f.$$prototype.route=i,f.$needs("route"),e.const_set(h[0],"ROUTE_FORMAT",/\/tiles\/(.*)/.$freeze()),e.const_set(h[0],"TILE_IDS",u([$($(o(h,"Engine"),"Tile"),"WHITE").$keys(),$($(o(h,"Engine"),"Tile"),"YELLOW").$keys(),$($(o(h,"Engine"),"Tile"),"GREEN").$keys(),$($(o(h,"Engine"),"Tile"),"BROWN").$keys(),$($(o(h,"Engine"),"Tile"),"GRAY").$keys(),$($(o(h,"Engine"),"Tile"),"RED").$keys()],"reduce",[],"+".$to_proc())),e.def(f,"$render",s=function(){var t,r,n,a=this,s=i,l=i,d=i,_=i;if(l='Bad tile dest: "'+(s=a.route.$match(o(h,"ROUTE_FORMAT"))["$[]"](1))+'"; should be "all", <game_title>, <tile_name>, <game_title>/<hex_coord>, or <game_title>/<tile_name>',s["$=="]("all"))return a.$h("div#tiles",[a.$h("div#all_tiles",[a.$h("h1","Generic Map Hexes and Common Track Tiles")].concat(e.to_a(u(o(h,"TILE_IDS"),"map",[],(t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$render_tile_block(e)},t.$$s=a,t.$$arity=1,t)))))]);if(c($(o(h,"Engine"),"GAMES_BY_TITLE").$keys()["$include?"](s)))return d=$(o(h,"Engine"),"GAMES_BY_TITLE")["$[]"](s),a.$h("div#tiles",[a.$map_hexes_and_tile_manifest_for(d)]);if(c(o(h,"TILE_IDS")["$include?"](s)))return a.$render_tile_block(s,p(["scale"],{scale:3}));if(!c(s["$include?"]("/")))return a.$h("p",l);n=s.$split("/"),_=null==(r=e.to_ary(n))[0]?i:r[0],s=null==r[1]?i:r[1];try{return a.$render_individual_tile(_,s)}catch(f){if(!e.rescue(f,[o(h,"StandardError")]))throw f;try{return a.$h("p",l)}finally{e.pop_exception()}}},s.$$arity=0),e.def(f,"$render_individual_tile",d=function(t,r){var n,a,s=this,l=i,u=i,d=i,_=i;return l=$(o(h,"Engine"),"GAMES_BY_TITLE")["$[]"](t).$new(["p1","p2","p3"]),a=c($(l.$class(),"TILES")["$include?"](r))?[u=l.$tile_by_id(r+"-0"),u.$name()]:[u=l.$hex_by_id(r).$tile(),r],d=null==(n=e.to_ary(a))[0]?i:n[0],_=null==n[1]?i:n[1],s.$render_tile_block(_,p(["tile","location_name","scale"],{tile:d,location_name:d.$location_name(),scale:3}))},d.$$arity=2),e.def(f,"$map_hexes_and_tile_manifest_for",_=function(n){var a,$,o,s,l,d=this,_=i,f=i,h=i,y=i,m=i,g=i;return _=n.$new(["p1","p2","p3"]),f=u(_.$hexes(),"map",[],(a=function(e){a.$$s;return null==e&&(e=i),[e.$name(),e.$tile()]},a.$$s=d,a.$$arity=1,a)).$to_h(),h=p([],{}),u(f,"each",[],(($=function(r,n){var a,o=$.$$s||this,s=i,l=i;return null==r&&(r=i),null==n&&(n=i),s=u(h.$keys(),"find",[],((a=function(e){a.$$s;return null==e&&(e=i),[e.$name()["$=="](n.$name()),e.$location_name()["$=="](n.$location_name()),e.$blockers()["$=="](n.$blockers()),u(e.$cities(),"map",[],"reservations".$to_proc())["$=="](u(n.$cities(),"map",[],"reservations".$to_proc()))]["$all?"]()}).$$s=o,a.$$arity=1,a)),c(s["$nil?"]())?(l=[n,[r]],u(h,"[]=",e.to_a(l)),l[t(l.length,1)]):h["$[]"](s)["$<<"](r)}).$$s=d,$.$$arity=2,$)),y=u(h,"map",[],((o=function(n,a){o.$$s;var $=i,s=i;return null==n&&(n=i),null==a&&(a=i),$=a.$join(","),c(r($.$size(),13))&&($=$.$slice(0,10)+"..."),s=[$],u(n,"name=",e.to_a(s)),s[t(s.length,1)],n}).$$s=d,o.$$arity=2,o)),m=u(y.$sort(),"map",[],((s=function(e){var t=s.$$s||this;return null==e&&(e=i),t.$render_tile_block(e.$name(),p(["tile","location_name"],{tile:e,location_name:e.$location_name()}))}).$$s=d,s.$$arity=1,s)),g=u(u(_.$tiles().$sort(),"group_by",[],"name".$to_proc()),"map",[],((l=function(e,t){var r=l.$$s||this;return null==e&&(e=i),null==t&&(t=i),r.$render_tile_block(e,p(["tile","num"],{tile:t.$first(),num:t.$size()}))}).$$s=d,l.$$arity=2,l)),d.$h("div#hexes_and_tiles_"+n.$title(),[d.$h("h1",n.$title().$to_s()),d.$h("div#map_hexes_"+n.$title(),[d.$h("h2",n.$title()+" Map Hexes")].concat(e.to_a(m))),d.$h("div#game_tiles_"+n.$title(),[d.$h("h2",n.$title()+" Tile Manifest")].concat(e.to_a(g)))])},_.$$arity=1)}(d[0],o(d,"Tiles"),d)}(a[0],a)},Opal.modules["view/players"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send;return e.add_stubs(["$require","$needs","$h","$map","$players"]),t.$require("view/player"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var a,$=o(t,$super,"Players"),u=[$].concat(r);$.$$prototype.game=n,$.$needs("game"),e.def($,"$render",a=function(){var e,t=this,r=n;return r=s(["style"],{style:s(["margin"],{margin:"1rem 0 1.5rem 0"
})}),t.$h("div",r,l(t.game.$players(),"map",[],((e=function(t){var r=e.$$s||this;return null==r.game&&(r.game=n),null==t&&(t=n),r.$h(i(u,"Player"),s(["player","game"],{player:t,game:r.game}))}).$$s=t,e.$$arity=1,e)))},a.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/tile_selector"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var i=e.top,$=[],o=e.nil,s=e.const_get_qualified,l=e.const_get_relative,u=(e.breaker,e.slice,e.module),c=e.klass,p=e.hash2,d=e.send;return e.add_stubs(["$require","$needs","$map","$new","$h","$/","$*","$size","$with_index","$+","$cos","$sin","$-","$x","$y"]),i.$require("view/hex"),function(i,$){var _=[u(i,"View")].concat($);!function(i,$super,$){var u,_=c(i,$super,"TileSelector"),f=[_].concat($);_.$$prototype.tiles=_.$$prototype.tile_selector=o,_.$needs("tile_selector",p(["store"],{store:!0})),_.$needs("tiles"),e.def(_,"$render",u=function(){var e,i,$=this,u=o,c=o,_=o;return u=d($.tiles,"map",[],((e=function(t){var r=e.$$s||this,n=o;return null==t&&(t=o),n=s(l(f,"Engine"),"Hex").$new("A1",p(["layout","tile"],{layout:"flat",tile:t})),r.$h(l(f,"Hex"),p(["hex","role"],{hex:n,role:"tile_selector"}))}).$$s=$,e.$$arity=1,e)),c=t(r(t(360,u.$size()),s(l(f,"Math"),"PI")),180),u=d(u.$map(),"with_index",[],((i=function(e,t){var a=i.$$s||this,$=o;return null==e&&(e=o),null==t&&(t=o),$=p(["position","left","bottom","width","height","filter","pointer-events"],{position:"absolute",left:n(r(s(l(f,"Hex"),"SIZE"),l(f,"Math").$cos(r(t,c))),70),bottom:n(r(s(l(f,"Hex"),"SIZE"),l(f,"Math").$sin(r(t,c))),80),width:60,height:60,filter:"drop-shadow(5px 5px 2px #888)","pointer-events":"auto"}),a.$h("svg",p(["style"],{style:$}),[a.$h("g",p(["attrs"],{attrs:p(["transform"],{transform:"scale(0.3)"})}),[e])])}).$$s=$,i.$$arity=2,i)),_=p(["position","left","top","width","height","pointer-events"],{position:"absolute",left:a($.tile_selector.$x(),50),top:a($.tile_selector.$y(),50),width:"200px",height:"200px","pointer-events":"none"}),$.$h("div",p(["style"],{style:_}),u)},u.$$arity=0)}(_[0],s(l(_,"Snabberb"),"Component"),_)}($[0],$)},Opal.modules["view/train_and_phase_roster"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.truthy,p=e.send;return e.add_stubs(["$require","$needs","$depot","$h","$render_body","$cert_limit","$upcoming_trains","$empty?","$discarded","$<<","$discarded_trains","$phases","$current","$phase","$map","$last","$Array","$[]","$include?","$convert_hex_to_rgba","$[]=","$-","$+","$==","$capitalize","$merge","$each","$group_by","$trains","$to_proc","$rusts_on","$first","$append","$upcoming","$discount","$join","$format_currency","$price","$size","$available_on","$name"]),n.$require("lib/color"),function(n,a){var d=[s(n,"View")].concat(a);!function(n,$super,a){var s,d,_,f,h,y,m=l(n,$super,"TrainAndPhaseRoster"),g=[m].concat(a);m.$$prototype.game=m.$$prototype.depot=i,m.$needs("game"),e.def(m,"$render",s=function(){var e=this;return e.depot=e.game.$depot(),e.$h("div",u(["style"],{style:u(["overflow","margin"],{overflow:"auto",margin:"0 -1rem"})}),[e.$render_body()])},s.$$arity=0),e.def(m,"$render_body",d=function(){var e=this,t=i,r=i;return t=[e.$h("div",[e.$cert_limit(),e.$upcoming_trains()])],c(e.depot.$discarded()["$empty?"]())||(r=u(["style"],{style:u(["margin-top"],{"margin-top":"1rem"})}),t["$<<"](e.$h("div",r,[e.$discarded_trains()]))),t["$<<"](e.$phases()),e.$h("div",u([],{}),t)},d.$$arity=0),e.def(m,"$cert_limit",_=function(){var e=this,t=i;return t=u(["style"],{style:u(["margin-bottom"],{"margin-bottom":"1rem"})}),e.$h("div",t,"Certificate limit: "+e.game.$cert_limit())},_.$$arity=0),e.def(m,"$phases",f=function(){var n,a=this,s=i,l=i,d=i,_=i;return s=u(["style"],{style:u(["padding"],{padding:"0 1rem"})}),l=a.game.$phase().$current(),d=p(a.game.$phase().$phases(),"map",[],((n=function(a){var d,_=n.$$s||this,f=i,h=i,y=i,m=i;return null==a&&(a=i),f=_.$Array(a["$[]"]("tiles")).$last(),h=u(["style"],{style:u(["padding"],{padding:"0 1rem"})}),c($($(o(g,"Part"),"MultiRevenue"),"COLOR")["$include?"](f))&&(y=["background-color",$(o(g,"Lib"),"Color").$convert_hex_to_rgba($($(o(g,"Part"),"MultiRevenue"),"COLOR")["$[]"](f),.4)],p(h["$[]"]("style"),"[]=",e.to_a(y)),y[t(y.length,1)]),m=c(a["$[]"]("buy_companies"))?"Can Buy":c((d=a["$[]"]("events"))===i||null==d?i:p(d,"include?",["close_companies"]))?"Close":"",_.$h("tr",[_.$h("td",s,r(a["$[]"]("name"),l["$=="](a)?" (Current) ":"")),_.$h("td",s,a["$[]"]("operating_rounds")),_.$h("td",s,a["$[]"]("train_limit")),_.$h("td",h,f.$capitalize()),_.$h("td",s,m)])}).$$s=a,n.$$arity=1,n)),_=u(["style"],{style:u(["margin-top"],{"margin-top":"1rem"})}),a.$h("div",_,[a.$h("div","Game Phases"),a.$h("table",[a.$h("tr",[a.$h("th",s,"Phase"),a.$h("th",s.$merge(u(["attrs"],{attrs:u(["title"],{title:"Number of Operating Rounds"})})),"# OR"),a.$h("th",s,"Train Limit"),a.$h("th",s,"Tiles"),a.$h("th",s,"Companies")])].concat(e.to_a(d)))])},f.$$arity=0),e.def(m,"$upcoming_trains",h=function(){var n,a,$=this,o=i,s=i,l=i;return o=u(["style"],{style:u(["padding"],{padding:"0 1rem"})}),s=u([],{}),p(p($.depot.$trains(),"group_by",[],"name".$to_proc()),"each",[],((n=function(r,a){var $=n.$$s||this,o=i;return null==r&&(r=i),null==a&&(a=i),o=[a.$first().$rusts_on(),$.$Array(s["$[]"](a.$first().$rusts_on())).$append(r)],p(s,"[]=",e.to_a(o)),o[t(o.length,1)]}).$$s=$,n.$$arity=2,n)),l=p(p($.depot.$upcoming(),"group_by",[],"name".$to_proc()),"map",[],((a=function(e,t){var n,$,l,u,d,_,f=a.$$s||this,h=i,y=i;return null==f.game&&(f.game=i),null==e&&(e=i),null==t&&(t=i),y=(l=(n=(h=t.$first()).$discount())===i||null==n?i:p(n,"group_by",[],(($=function(e,t){$.$$s;return null==e&&(e=i),null==t&&(t=i),t}).$$s=f,$.$$arity=2,$)))===i||null==l?i:p(l,"map",[],((u=function(e,t){var n=u.$$s||this;return null==n.game&&(n.game=i),null==e&&(e=i),null==t&&(t=i),r(r(p(t,"map",[],"first".$to_proc()).$join(",")," => "),n.game.$format_currency(e))}).$$s=f,u.$$arity=2,u)),f.$h("tr",[f.$h("td",o,e),f.$h("td",o,f.game.$format_currency(h.$price())),f.$h("td",o,t.$size()),f.$h("td",o,c((_=s["$[]"](e),d=_===i||null==_?i:p(_,"join",[","])))?d:"None"),f.$h("td",o,(d=y,d===i||null==d?i:p(d,"join",[" "]))),f.$h("td",o,h.$available_on())])}).$$s=$,a.$$arity=2,a)),$.$h("div",[$.$h("div","Upcoming Trains"),$.$h("table",[$.$h("tr",[$.$h("th",o,"Type"),$.$h("th",o,"Price"),$.$h("th",o,"Remaining"),$.$h("th",o,"Rusts"),$.$h("th",o,"Upgrade Discount"),$.$h("th",o.$merge(u(["attrs"],{attrs:u(["title"],{title:"Available after purchase of first train of type"})})),"Available")])].concat(e.to_a(l)))])},h.$$arity=0),e.def(m,"$discarded_trains",y=function(){var t,r=this,n=i,a=i;return n=u(["style"],{style:u(["padding"],{padding:"0 1rem"})}),a=p(r.depot.$discarded(),"map",[],((t=function(e){var r=t.$$s||this;return null==r.game&&(r.game=i),null==e&&(e=i),r.$h("tr",[r.$h("td",n,e.$name()),r.$h("td",n,r.game.$format_currency(e.$price()))])}).$$s=r,t.$$arity=1,t)),r.$h("div",[r.$h("div","In bank pool:"),r.$h("table",[r.$h("tr",[r.$h("th",n,"Type"),r.$h("th",n,"Price")])].concat(e.to_a(a)))])},y.$$arity=0)}(d[0],$(o(d,"Snabberb"),"Component"),d)}(a[0],a)},Opal.modules["view/spreadsheet"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.send,p=e.truthy;return e.add_stubs(["$require","$needs","$h","$render_table","$render_title","$render_corporations","$size","$players","$render_player_cash","$render_player_privates","$render_player_worth","$render_player_certs","$sort","$uniq","$flat_map","$keys","$revenue_history","$map","$or_history","$empty?","$corporations","$[]","$negative?","$abs","$render_history_titles","$name","$render_corporation","$color","$!","$floated?","$[]=","$-","$counts_for_limit","$share_price","$convert_hex_to_rgba","$did_sell?","$round","$+","$to_s","$num_shares_of","$president?","$share_pool","$par_price","$format_currency","$price","$cash","$join","$trains","$to_proc","$sum","$tokens","$used?","$render_companies","$render_history","$companies","$value","$num_certs"]),n.$require("view/stock_market"),n.$require("lib/color"),function(n,a){var d=[s(n,"View")].concat(a);!function(n,$super,a){var s,d,_,f,h,y,m,g,b,v,w,k,x,E=l(n,$super,"Spreadsheet"),O=[E].concat(a);E.$$prototype.game=i,E.$needs("game"),e.def(E,"$render",s=function(){var e=this;return e.$h("div",u(["style"],{style:u(["overflow","margin"],{overflow:"auto",margin:"0 -1rem"})}),[e.$render_table()])},s.$$arity=0),e.def(E,"$render_table",d=function(){var t=this;return t.$h("table",u(["style"],{style:u(["margin","text-align"],{margin:"1rem 0 1.5rem 0","text-align":"center"})}),[].concat(e.to_a(t.$render_title())).concat(e.to_a(t.$render_corporations())).concat([t.$h("tr",[t.$h("td",u(["style"],{style:u(["width"],{width:"20px"})}),""),t.$h("th",u(["attrs"],{attrs:u(["colspan"],{colspan:t.game.$players().$size()})}),"Player Finances")]),t.$render_player_cash(),t.$render_player_privates(),t.$render_player_worth(),t.$render_player_certs()]))},d.$$arity=0),e.def(E,"$or_history",_=function(e){var t,r=this;return c(e,"flat_map",[],(t=function(e){t.$$s;return null==e&&(e=i),e.$revenue_history().$keys()},t.$$s=r,t.$$arity=1,t)).$uniq().$sort()},_.$$arity=1),e.def(E,"$render_history_titles",f=function(e){var t,r=this;return c(r.$or_history(e),"map",[],((t=function(e,r){var n=t.$$s||this;return null==e&&(e=i),null==r&&(r=i),n.$h("th",e+"."+r)}).$$s=r,t.$$arity=2,t))},f.$$arity=1),e.def(E,"$render_history",h=function(e){var t,r=this,n=i;return n=e.$revenue_history(),p(n["$empty?"]())?[]:c(r.$or_history(r.game.$corporations()),"map",[],((t=function(e){var r=t.$$s||this,a=i;return null==e&&(e=i),p(n["$[]"](e))?(a=u(["style"],{style:u(["color","padding"],{color:p(n["$[]"](e)["$negative?"]())?"#aaa":"black",padding:"0 0.15rem"})}),r.$h("td",a,n["$[]"](e).$abs())):r.$h("td","")}).$$s=r,t.$$arity=1,t))},h.$$arity=1),e.def(E,"$render_title",y=function(){var t,r=this,n=i,a=i;return n=r.$render_history_titles(r.game.$corporations()),a=u(["style"],{style:u(["padding"],{padding:"0 0.3rem"})}),[r.$h("tr",[r.$h("th",u(["style"],{style:u(["width"],{width:"20px"})}),""),r.$h("th",u(["attrs"],{attrs:u(["colspan"],{colspan:r.game.$players().$size()})}),"Players"),r.$h("th",u(["attrs"],{attrs:u(["colspan"],{colspan:2})}),"Bank"),r.$h("th",u(["attrs"],{attrs:u(["colspan"],{colspan:2})}),"Prices"),r.$h("th",u(["attrs"],{attrs:u(["colspan"],{colspan:4})}),"Corporation"),r.$h("th",u(["style"],{style:u(["width"],{width:"20px"})}),""),r.$h("th",u(["attrs"],{attrs:u(["colspan"],{colspan:n.$size()})}),"OR History")]),r.$h("tr",[r.$h("th",u(["style"],{style:u(["width"],{width:"20px"})}),"")].concat(e.to_a(c(r.game.$players(),"map",[],(t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$h("th",a,e.$name())},t.$$s=r,t.$$arity=1,t)))).concat([r.$h("th",a,"IPO"),r.$h("th",a,"Market"),r.$h("th",a,"IPO"),r.$h("th",a,"Market"),r.$h("th",a,"Cash"),r.$h("th",a,"Trains"),r.$h("th",a,"Tokens"),r.$h("th",a,"Privates"),r.$h("th",u(["style"],{style:u(["width"],{width:"20px"})}),"")]).concat(e.to_a(n)))]},y.$$arity=0),e.def(E,"$render_corporations",m=function(){var e,t=this;return c(t.game.$corporations(),"map",[],((e=function(t){var r=e.$$s||this;return null==t&&(t=i),r.$render_corporation(t)}).$$s=t,e.$$arity=1,e))},m.$$arity=0),e.def(E,"$render_corporation",g=function(n){var a,s,l,d=this,_=i,f=i,h=i,y=i,m=i;return _=u(["style"],{style:u(["background","color"],{background:n.$color(),color:"#ffffff"})}),f=u(["style"],{style:u([],{})}),h=u(["style"],{style:u([],{})}),p(n["$floated?"]()["$!"]())?(y=["background-color","rgba(220,220,220,0.4)"],c(f["$[]"]("style"),"[]=",e.to_a(y)),y[t(y.length,1)]):p(p(a=n.$counts_for_limit()["$!"]())?m=$(o(O,"StockMarket"),"COLOR_MAP")["$[]"](n.$share_price().$color()):a)&&(y=["background-color",$(o(O,"Lib"),"Color").$convert_hex_to_rgba(m,.4)],c(h["$[]"]("style"),"[]=",e.to_a(y)),y[t(y.length,1)]),d.$h("tr",f,[d.$h("th",_,n.$name())].concat(e.to_a(c(d.game.$players(),"map",[],(s=function(a){var $=s.$$s||this,o=i;return null==$.game&&($.game=i),null==a&&(a=i),o=u(["style"],{style:u([],{})}),p($.game.$round()["$did_sell?"](n,a))&&(y=["background-color","rgba(225,0,0,0.4)"],c(o["$[]"]("style"),"[]=",e.to_a(y)),y[t(y.length,1)]),$.$h("td",o,r(a.$num_shares_of(n).$to_s(),p(n["$president?"](a))?"*":""))},s.$$s=d,s.$$arity=1,s)))).concat([d.$h("td",n.$num_shares_of(n)),d.$h("td",d.game.$share_pool().$num_shares_of(n)),d.$h("td",p(n.$par_price())?d.game.$format_currency(n.$par_price().$price()):""),d.$h("td",h,p(n.$share_price())?d.game.$format_currency(n.$share_price().$price()):""),d.$h("td",d.game.$format_currency(n.$cash())),d.$h("td",c(n.$trains(),"map",[],"name".$to_proc()).$join(",")),d.$h("td",c(n.$tokens(),"map",[],(l=function(e){l.$$s;return null==e&&(e=i),p(e["$used?"]())?0:1},l.$$s=d,l.$$arity=1,l)).$sum()+"/"+n.$tokens().$size()),d.$render_companies(n),d.$h("th",_,n.$name())]).concat(e.to_a(d.$render_history(n))))},g.$$arity=1),e.def(E,"$render_companies",b=function(e){return this.$h("td",c(e.$companies(),"map",[],"short_name".$to_proc()).$join(","))},b.$$arity=1),e.def(E,"$render_player_privates",v=function(){var t,r=this;return r.$h("tr",[r.$h("th","Privates")].concat(e.to_a(c(r.game.$players(),"map",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$render_companies(e)}).$$s=r,t.$$arity=1,t)))))},v.$$arity=0),e.def(E,"$render_player_cash",w=function(){var t,r=this;return r.$h("tr",[r.$h("th","Cash")].concat(e.to_a(c(r.game.$players(),"map",[],((t=function(e){var r=t.$$s||this;return null==r.game&&(r.game=i),null==e&&(e=i),r.$h("td",r.game.$format_currency(e.$cash()))}).$$s=r,t.$$arity=1,t)))))},w.$$arity=0),e.def(E,"$render_player_worth",k=function(){var t,r=this;return r.$h("tr",[r.$h("th","Worth")].concat(e.to_a(c(r.game.$players(),"map",[],((t=function(e){var r=t.$$s||this;return null==r.game&&(r.game=i),null==e&&(e=i),r.$h("td",r.game.$format_currency(e.$value()))}).$$s=r,t.$$arity=1,t)))))},k.$$arity=0),e.def(E,"$render_player_certs",x=function(){var t,r=this;return r.$h("tr",[r.$h("th","Certs")].concat(e.to_a(c(r.game.$players(),"map",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=i),r.$h("td",e.$num_certs())}).$$s=r,t.$$arity=1,t)))))},x.$$arity=0)}(d[0],$(o(d,"Snabberb"),"Component"),d)}(a[0],a)},Opal.modules["view/game_row"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var a=e.top,i=[],$=e.nil,o=e.const_get_qualified,s=e.const_get_relative,l=(e.breaker,e.slice,e.module),u=e.klass,c=e.truthy,p=e.send,d=e.hash2;return e.add_stubs(["$require","$include","$needs","$h","$render_header","$render_row","$to_i","$page","$positive?","$<<","$render_more","$-","$>","$size","$+","$lambda","$get_games","$store","$first","$split","$take","$map","$private"]),a.$require("game_manager"),a.$require("view/game_card"),function(a,i){var _=[l(a,"View")].concat(i);!function(a,$super,i){var o,l,_,f,h,y=u(a,$super,"GameRow"),m=[y].concat(i);y.$$prototype.header=y.$$prototype.type=y.$$prototype.game_row_games=$,y.$include(s(m,"GameManager")),y.$needs("header"),y.$needs("game_row_games"),y.$needs("user"),y.$needs("type"),e.def(y,"$render",o=function(){var t=this;return t.$h("div",[t.$render_header(t.header)].concat(e.to_a(t.$render_row())))},o.$$arity=0),e.def(y,"$render_header",l=function(e){var a=this,i=$,o=$;return i=[e],o=a.$page().$to_i(),c(o["$positive?"]())&&i["$<<"](a.$render_more("Prev","?"+a.type+"="+t(o,1))),c(r(a.game_row_games.$size(),10))&&i["$<<"](a.$render_more("Next","?"+a.type+"="+n(o,1))),a.$h("div.card_header",i)},l.$$arity=1),e.def(y,"$render_more",_=function(e,t){var r,n=this,a=$,i=$;return a=p(n,"lambda",[],((r=function(){var e=r.$$s||this;return null==e.app_route&&(e.app_route=$),e.$get_games(t),e.$store("app_route",""+e.app_route.$split("?").$first()+t)}).$$s=n,r.$$arity=0,r)),i=d(["attrs","style","on"],{attrs:d(["href","onclick"],{href:t,onclick:"return false"}),style:d(["margin-left"],{"margin-left":"1rem"}),on:d(["click"],{click:a})}),n.$h("a",i,e)},_.$$arity=2),e.def(y,"$render_row",f=function(){var e,t=this;return p(t.game_row_games,"map",[],(e=function(t){var r=e.$$s||this;return null==r.user&&(r.user=$),null==t&&(t=$),r.$h(s(m,"GameCard"),d(["gdata","user"],{gdata:t,user:r.user}))},e.$$s=t,e.$$arity=1,e)).$take(10)},f.$$arity=0),y.$private(),e.def(y,"$page",h=function(){var e,t=this;return c("undefined"==typeof URLSearchParams)?0:c(e=new URLSearchParams(window.location.search).get(t.type))?e:0},h.$$arity=0)}(_[0],o(s(_,"Snabberb"),"Component"),_)}(i[0],i)},Opal.modules["view/history_controls"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var a=e.top,i=[],$=e.nil,o=e.const_get_qualified,s=e.const_get_relative,l=(e.breaker,e.slice,e.module),u=e.klass,c=e.hash2,p=e.truthy,d=e.send;return e.add_stubs(["$require","$needs","$zero?","$h","$to_i","$[]","$<<","$link","$-","$<","$+","$add","$lambda","$puts","$store"]),a.$require("lib/params"),a.$require("view/link"),function(a,i){var _=[l(a,"View")].concat(i);!function(a,$super,i){var l,_,f=u(a,$super,"HistoryControls"),h=[f].concat(i);f.$$prototype.num_actions=f.$$prototype.app_route=$,f.$needs("app_route",c(["default","store"],{"default":$,store:!0})),f.$needs("num_actions",c(["default"],{"default":0})),e.def(f,"$render",l=function(){var e,a,i=this,l=$,u=$;return p(i.num_actions["$zero?"]())?i.$h("div"):(l=[i.$h("b.margined","History")],e=o(s(h,"Lib"),"Params")["$[]"]("action"),u=e===$||null==e?$:d(e,"to_i",[]),p((a=u)===$||null==a?$:d(a,"zero?",[]))||(l["$<<"](i.$link("|<",0)),l["$<<"](i.$link("<",p(u)?t(u,1):t(i.num_actions,1)))),p(u)&&(l["$<<"](i.$link(">",p(r(n(u,1),i.num_actions))?n(u,1):$)),l["$<<"](i.$link(">|"))),i.$h("div",l))},l.$$arity=0),e.def(f,"$link",_=function(e,t){var r,n=this,a=$,i=$;return null==t&&(t=$),a=o(s(h,"Lib"),"Params").$add(n.app_route,"action",t),i=d(n,"lambda",[],((r=function(){var e=r.$$s||this;return e.$puts("** route "+a),e.$store("app_route",a)}).$$s=n,r.$$arity=0,r)),n.$h(s(h,"Link"),c(["href","click","children","style"],{href:a,click:i,children:e,style:c(["color","margin-right","text-decoration"],{color:"black","margin-right":"2rem","text-decoration":"none"})}))},_.$$arity=-2)}(_[0],o(s(_,"Snabberb"),"Component"),_)}(i[0],i)},Opal.modules["view/game_log"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash2,u=e.truthy,c=e.send;return e.add_stubs(["$require","$include","$needs","$h","$log","$player_by_id","$[]","$lambda","$Native","$==","$[]=","$-","$process_action","$new","$<<"]),r.$require("view/actionable"),r.$require("view/log"),function(r,n){var p=[o(r,"View")].concat(n);!function(r,$super,n){var o,p=s(r,$super,"GameLog"),d=[p].concat(n);p.$$prototype.game=p.$$prototype.user=p.$$prototype.player=a,p.$include($(d,"Actionable")),p.$needs("user"),e.def(p,"$render",o=function(){var r,n=this,o=a,s=a,p=a;return o=[n.$h($(d,"Log"),l(["log"],{log:n.game.$log()}))],u(n.user)&&(n.player=n.game.$player_by_id(n.user["$[]"]("name"))),s=c(n,"lambda",[],((r=function(n){var o,s=r.$$s||this,l=a,p=a,_=a;return null==s.player&&(s.player=a),null==n&&(n=a),l=(n=s.$Native(n))["$[]"]("keyCode"),u(u(o=l)?l["$=="](13):o)?(p=n["$[]"]("target")["$[]"]("value"),_=["value",""],c(n["$[]"]("target"),"[]=",e.to_a(_)),_[t(_.length,1)],s.$process_action(i(i($(d,"Engine"),"Action"),"Message").$new(s.player,p))):a}).$$s=n,r.$$arity=1,r)),u(n.player)&&o["$<<"](n.$h("input",l(["style","on"],{style:l(["width"],{width:"100%"}),on:l(["keyup"],{keyup:s})}))),p=l(["style"],{style:l(["display","width","margin"],{display:"inline-block",width:"100%",margin:"1rem 0 1rem 0"})}),n.$h("div",p,o)},o.$$arity=0)}(p[0],i($(p,"Snabberb"),"Component"),p)}(n[0],n)},Opal.modules["view/navigation"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy,u=e.send;return e.add_stubs(["$require","$needs","$item","$<<","$[]","$h","$render_other_links","$map"]),t.$require("view/create_game"),function(t,r){var c=[$(t,"View")].concat(r);!function(t,$super,r){var a,i,$,c=o(t,$super,"Navigation");[c].concat(r);c.$$prototype.user=n,c.$needs("app_route",s(["default","store"],{"default":n,store:!0})),c.$needs("user",s(["default","store"],{"default":n,store:!0})),e.def(c,"$render",a=function(){var e=this,t=n,r=n,a=n;return t=s(["style"],{style:s(["padding","box-shadow"],{padding:"1rem","box-shadow":"0 2px 0 0 gainsboro"})}),r=[e.$item("About","/about")],l(e.user)?r["$<<"](e.$item("Profile ("+e.user["$[]"]("name")+")","/profile")):(r["$<<"](e.$item("Signup","/signup")),r["$<<"](e.$item("Login","/login"))),a=s(["attrs","style"],{attrs:s(["src"],{src:"/images/logo.svg"}),style:s(["position","top","width"],{position:"absolute",top:"16px",width:"80px"})}),e.$h("div",t,[e.$h("a",s(["attrs"],{attrs:s(["href"],{href:"/"})}),[e.$h("img",a)]),e.$render_other_links(r)])},a.$$arity=0),e.def(c,"$item",i=function(e,t){var r=this,a=n;return a=s(["attrs","style"],{attrs:s(["href"],{href:t}),style:s(["margin"],{margin:"0 1rem"})}),r.$h("a",a,e)},i.$$arity=2),e.def(c,"$render_other_links",$=function(e){var t,r=this,a=n,i=n;return a=u(e,"map",[],((t=function(e){t.$$s;return null==e&&(e=n),e}).$$s=r,t.$$arity=1,t)),i=s(["style"],{style:s(["text-align"],{"text-align":"right"})}),r.$h("div",i,a)},$.$$arity=1)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(r[0],r)},Opal.modules["view/map_page"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.truthy,l=e.hash2;return e.add_stubs(["$require_tree","$require","$needs","$freeze","$[]","$match","$h","$new","$puts","$name","$class","$message"]),t.$require_tree("view/engine"),t.$require("view/map"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var $,u=o(t,$super,"MapPage"),c=[u].concat(r);u.$$prototype.route=n,u.$needs("route"),e.const_set(c[0],"ROUTE_FORMAT",/\/map\/(.*)/.$freeze()),e.def(u,"$render",$=function(){var t=this,r=n,$=n,o=n,u=n;if(r=t.route.$match(i(c,"ROUTE_FORMAT"))["$[]"](1),$=a(i(c,"Engine"),"GAMES_BY_TITLE")["$[]"](r),!s($))return t.$h("p","Bad game title: "+r);try{return o=["p1","p2","p3","p4","p5"],t.$h(i(c,"Map"),l(["game"],{game:$.$new(o)}))}catch(p){if(!e.rescue(p,[i(c,"StandardError")]))throw p;u=p;try{return t.$puts(u),t.$h("div",[t.$h("p","Error rendering map for "+r+":"),t.$h("p",u.$class().$name()+": "+u.$message())])}finally{e.pop_exception()}}},$.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/tile_manifest"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.send,s=e.truthy,l=e.hash2;return e.add_stubs(["$require","$needs","$group_by","$to_proc","$map","$sort","$size","$[]","$positive?","$render_tile_block","$first","$h"]),t.$require("view/tiles"),function(t,r){var u=[i(t,"View")].concat(r);!function(t,$super,r){var a,i=$(t,$super,"TileManifest");[i].concat(r);i.$$prototype.tiles=i.$$prototype.all_tiles=n,i.$needs("tiles"),i.$needs("all_tiles"),e.def(i,"$render",a=function(){var e,t=this,r=n,a=n;return r=o(t.tiles,"group_by",[],"name".$to_proc()),a=o(o(t.all_tiles.$sort(),"group_by",[],"name".$to_proc()),"map",[],((e=function(t,a){var i,$,u=e.$$s||this,c=n,p=n;return null==t&&(t=n),null==a&&(a=n),c=s(i=($=r["$[]"](t))===n||null==$?n:o($,"size",[]))?i:0,p=s(c["$positive?"]())?1:.5,u.$render_tile_block(t,l(["tile","num","opacity"],{tile:a.$first(),num:c,opacity:p}))}).$$s=t,e.$$arity=2,e)),t.$h("div#tile_manifest",a)},a.$$arity=0)}(u[0],a(u,"Tiles"),u)}(r[0],r)},Opal.modules["view/chat"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.send,p=e.truthy;return e.add_stubs(["$require","$needs","$subscribe","$add_line","$lambda","$store","$unsubscribe","$h","$Native","$[]","$==","$strftime","$now","$[]=","$-","$post","$<<","$+"]),n.$require("view/log"),function(n,a){var d=[s(n,"View")].concat(a);!function(n,$super,a){var $,s,d=l(n,$super,"Chat"),_=[d].concat(a);d.$$prototype.connection=d.$$prototype.log=d.$$prototype.user=i,d.$needs("user"),d.$needs("connection"),d.$needs("log",u(["default","store"],{"default":i,store:!0})),e.def(d,"$render",$=function(){var r,n,a,$,s=this,l=i,d=i,f=i,h=i;return c(s.connection,"subscribe",["/chat",p(s.log)?-1:0],((r=function(e){var t=r.$$s||this;return null==e&&(e=i),t.$add_line(e)}).$$s=s,r.$$arity=1,r)),l=c(s,"lambda",[],((n=function(){var e=n.$$s||this;return null==e.connection&&(e.connection=i),e.$store("log",i,u(["skip"],{skip:!0})),e.connection.$unsubscribe("/chat")}).$$s=s,n.$$arity=0,n)),s.log=p(a=s.log)?a:[],d=[s.$h(o(_,"Log"),u(["log"],{log:s.log}))],f=c(s,"lambda",[],(($=function(r){var n,a=$.$$s||this,s=i,l=i,d=i;return null==a.user&&(a.user=i),null==a.connection&&(a.connection=i),null==r&&(r=i),s=(r=a.$Native(r))["$[]"]("keyCode"),p(p(n=s)?s["$=="](13):n)?(l=r["$[]"]("target")["$[]"]("value"),a.$add_line(u(["user","created_at","message"],{user:a.user,created_at:o(_,"Time").$now().$strftime("%m/%d %H:%M:%S"),message:l})),d=["value",""],c(r["$[]"]("target"),"[]=",e.to_a(d)),d[t(d.length,1)],a.connection.$post("/chat",u(["message"],{message:l}))):i}).$$s=s,$.$$arity=1,$)),p(s.user)&&d["$<<"](s.$h("input",u(["style","on"],{style:u(["width"],{width:"100%"}),on:u(["keyup"],{keyup:f})}))),h=u(["key","hook","style"],{key:"global_chat",hook:u(["destroy"],{destroy:l}),style:u(["display","vertical-align"],{display:"inline-block","vertical-align":"top"})}),s.$h("div.half",h,d)},$.$$arity=0),e.def(d,"$add_line",s=function(e){var t=this,n=i,a=i,$=i;return n=e["$[]"]("user")["$[]"]("name"),a=e["$[]"]("created_at"),$=e["$[]"]("message"),t.$store("log",r(t.log,[a+" "+n+": "+$]))},s.$$arity=1)}(d[0],$(o(d,"Snabberb"),"Component"),d)}(a[0],a)},Opal.modules["view/create_game"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var i=e.top,$=[],o=e.nil,s=e.const_get_qualified,l=e.const_get_relative,u=(e.breaker,e.slice,e.module),c=e.klass,p=e.hash2,d=e.send,_=e.lambda,f=e.truthy;e.hash;return e.add_stubs(["$require","$include","$needs","$mode_selector","$render_buttons","$render_inputs","$==","$times","$+","$<<","$render_input","$h","$render_form","$map","$title","$mode_input","$store","$render_button","$submit","$<=","$>=","$-","$values","$select","$params","$start_with?","$[]","$empty?","$parse","$message","$create_hotseat","$create_game"]),i.$require("game_manager"),i.$require("view/form"),function(i,$){var h=[u(i,"View")].concat($);!function(i,$super,$){var u,h,y,m,g,b,v=c(i,$super,"CreateGame"),w=[v].concat($);v.$$prototype.mode=v.$$prototype.num_players=o,v.$include(l(w,"GameManager")),v.$needs("mode",p(["default","store"],{"default":"multi",store:!0})),v.$needs("num_players",p(["default","store"],{"default":3,store:!0})),v.$needs("flash_opts",p(["default","store"],{"default":p([],{}),store:!0})),e.def(v,"$render_content",u=function(){var r,n=this,a=o;return a=[n.$mode_selector()].concat(e.to_a(n.$render_buttons())).concat([n.$render_inputs()]),n.mode["$=="]("hotseat")&&(d(n.num_players,"times",[],((r=function(e){var n=r.$$s||this,i=o;return null==e&&(e=o),i=t(e,1),a["$<<"](n.$render_input("Player "+i,p(["id","attrs"],{id:"player_"+i,attrs:p(["value"],{value:"Player "+i})})))}).$$s=n,r.$$arity=1,r)),a["$<<"](n.$render_input("",p(["id","el","attrs","container_style"],{id:"game_data",el:"textarea",attrs:p(["placeholder","rows","cols"],{placeholder:"Paste JSON Game Data. Will override settings",rows:50,cols:50}),container_style:p(["display"],{display:"block"})})))),n.$h("div",[n.$render_form("Create New Game - You need an account to play multiplayer",a)])},u.$$arity=0),e.def(v,"$render_inputs",h=function(){var e,t=this,r=o;return r=d(s(l(w,"Engine"),"GAMES"),"map",[],((e=function(t){var r=e.$$s||this;return null==t&&(t=o),t.$title()["$=="]("1889")?r.$h("option",t.$title()):o}).$$s=t,e.$$arity=1,e)),t.$h("div",[t.$render_input("Game Title",p(["id","el","children"],{id:"title",el:"select",children:r})),t.$render_input("Description",p(["id"],{id:"description"})),t.$render_input("Max Players",p(["id","type","attrs"],{id:"max_players",type:"number",attrs:p(["value"],{value:6})}))])},h.$$arity=0),e.def(v,"$mode_selector",y=function(){var t=this;return t.$h("div",p(["style"],{style:p(["margin"],{margin:"1rem 0"})}),[].concat(e.to_a(t.$mode_input("multi","Multiplayer"))).concat(e.to_a(t.$mode_input("hotseat","Hotseat"))))},y.$$arity=0),e.def(v,"$mode_input",m=function(e,t){var r,n=this,a=o;return a=p(["attrs","on"],{attrs:p(["type","name","checked"],{type:"radio",name:"mode_options",checked:n.mode["$=="](e)}),on:p(["click"],{click:_((r=function(){return(r.$$s||this).$store("mode",e)},r.$$s=n,r.$$arity=0,r))})}),[n.$h("input",a),n.$h("span",p(["style"],{style:p(["margin"],{margin:"0 1rem 0 0.5rem"})}),t)]},m.$$arity=2),e.def(v,"$render_buttons",g=function(){var e,i,$,s=this,l=o;return(l=[])["$<<"](d(s,"render_button",["Create"],((e=function(){return(e.$$s||this).$submit()}).$$s=s,e.$$arity=0,e))),s.mode["$=="]("hotseat")&&(l["$<<"](d(s,"render_button",["+ Player"],((i=function(){var e=i.$$s||this;return null==e.num_players&&(e.num_players=o),f(r(t(e.num_players,1),6))?e.$store("num_players",t(e.num_players,1)):o}).$$s=s,i.$$arity=0,i))),l["$<<"](d(s,"render_button",["- Player"],(($=function(){var e=$.$$s||this;return null==e.num_players&&(e.num_players=o),f(n(a(e.num_players,1),2))?e.$store("num_players",a(e.num_players,1)):o}).$$s=s,$.$$arity=0,$)))),l},g.$$arity=0),e.def(v,"$submit",b=function(){var t,r,n=this,a=o,i=o,$=o;if(n.mode["$=="]("hotseat")){if(a=d(d(n.$params(),"select",[],(t=function(e,r){t.$$s;return null==e&&(e=o),null==r&&(r=o),e["$start_with?"]("player_")},t.$$s=n,t.$$arity=2,t)).$values(),"map",[],((r=function(e){r.$$s;return null==e&&(e=o),p(["name"],{name:e})}).$$s=n,r.$$arity=1,r)),i=n.$params()["$[]"]("game_data"),f(i["$empty?"]()))i=p([],{});else try{i=l(w,"JSON").$parse(i)}catch(u){if(!e.rescue(u,[s(l(w,"JSON"),"ParserError")]))throw u;$=u;try{return n.$store("flash_opts",$.$message())}finally{e.pop_exception()}}return n.$create_hotseat(p(["players","title","description","max_players"],{players:a,title:n.$params()["$[]"]("title"),description:n.$params()["$[]"]("description"),max_players:n.$params()["$[]"]("max_players")}).$merge(e.to_hash(i)))}return n.$create_game(n.$params())},b.$$arity=0)}(h[0],l(h,"Form"),h)}($[0],$)},Opal.modules["view/map"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var a=e.top,i=[],$=e.nil,o=e.const_get_qualified,s=e.const_get_relative,l=(e.breaker,e.slice,e.module),u=e.klass,c=e.hash2,p=e.send,d=e.truthy;return e.add_stubs(["$require","$needs","$dup","$hexes","$map","$sort","$uniq","$to_proc","$layout","$current_entity=","$special","$-","$any?","$tile_laying_ability","$operating?","$round","$<<","$delete","$hex","$map!","$h","$render_map","$!=","$tile","$upgradeable_tiles","$==","$*","$size","$+"]),a.$require("view/axis"),a.$require("view/hex"),a.$require("view/tile_confirmation"),a.$require("view/tile_selector"),function(a,i){
var _=[l(a,"View")].concat(i);!function(a,$super,i){var o,l,_=u(a,$super,"Map"),f=[_].concat(i);_.$$prototype.game=_.$$prototype.hexes=_.$$prototype.selected_company=_.$$prototype.tile_selector=_.$$prototype.layout=_.$$prototype.cols=_.$$prototype.rows=$,_.$needs("game"),_.$needs("tile_selector",c(["default","store"],{"default":$,store:!0})),_.$needs("selected_company",c(["default","store"],{"default":$,store:!0})),e.const_set(f[0],"GAP",50),e.def(_,"$render",o=function(){var r,n,a=this,i=$,o=$,l=$,u=$,_=$;return a.hexes=a.game.$hexes().$dup(),a.cols=p(p(a.hexes,"map",[],"x".$to_proc()).$uniq().$sort(),"map",[],"next".$to_proc()),a.rows=p(p(a.hexes,"map",[],"y".$to_proc()).$uniq().$sort(),"map",[],"next".$to_proc()),a.layout=a.game.$layout(),i=[a.selected_company],p(a.game.$special(),"current_entity=",e.to_a(i)),i[t(i.length,1)],o=d(a.game.$special().$tile_laying_ability()["$any?"]())?a.game.$special():d(a.game.$round()["$operating?"]())?a.game.$round():$,d(a.tile_selector)&&a.hexes["$<<"](a.hexes.$delete(a.tile_selector.$hex())),p(a.hexes,"map!",[],((r=function(e){var t=r.$$s||this;return null==e&&(e=$),t.$h(s(f,"Hex"),c(["hex","round"],{hex:e,round:o}))}).$$s=a,r.$$arity=1,r)),l=[a.$render_map()],d(d(n=a.tile_selector)?a.tile_selector.$hex().$tile()["$!="](a.tile_selector.$tile()):n)?l["$<<"](a.$h(s(f,"TileConfirmation"))):d(a.tile_selector)&&(u=o.$upgradeable_tiles(a.tile_selector.$hex()),l["$<<"](a.$h(s(f,"TileSelector"),c(["tiles"],{tiles:u})))),_=c(["style"],{style:c(["overflow","margin"],{overflow:"auto",margin:"1rem -1rem"})}),a.$h("div",_,l)},o.$$arity=0),e.def(_,"$render_map",l=function(){var t,a,i=this,o=$,l=$,u=$,p=$,d=$;return a=i.layout["$=="]("flat")?[85,50]:[50,85],o=null==(t=e.to_ary(a))[0]?$:t[0],l=null==t[1]?$:t[1],u=r(i.cols.$size(),o),p=r(i.rows.$size(),l),d=c(["attrs","style"],{attrs:c(["id"],{id:"map"}),style:c(["width","height"],{width:u,height:p})}),i.$h("svg",d,[i.$h("g",c(["attrs"],{attrs:c(["transform"],{transform:"scale(0.5)"})}),[i.$h("g",c(["attrs"],{attrs:c(["id","transform"],{id:"map-hexes",transform:"translate("+n(25,s(f,"GAP"))+" "+n(12.5,s(f,"GAP"))+")"})}),i.hexes),i.$h(s(f,"Axis"),c(["cols","rows","layout","gap"],{cols:i.cols,rows:i.rows,layout:i.layout,gap:s(f,"GAP")}))])])},l.$$arity=0)}(_[0],o(s(_,"Snabberb"),"Component"),_)}(i[0],i)},Opal.modules["view/form"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send,u=e.truthy;e.hash;return e.add_stubs(["$needs","$render_content","$raise","$to_h","$map","$Native","$[]","$==","$lambda","$submit","$h","$[]=","$-"]),function(r,c){var p=[$(r,"View")].concat(c);!function(r,$super,a){var $,c,p,d,_,f,h,y=o(r,$super,"Form"),m=[y].concat(a);y.$$prototype.inputs=n,y.$needs("app_route",s(["default","store"],{"default":n,store:!0})),e.def(y,"$render",$=function(){var e=this;return e.inputs=s([],{}),e.$render_content()},$.$$arity=0),e.def(y,"$render_content",c=function(){return this.$raise(i(m,"NotImplementedError"))},c.$$arity=0),e.def(y,"$submit",p=function(){return this.$raise(i(m,"NotImplementedError"))},p.$$arity=0),e.def(y,"$params",d=function(){var e,t=this;return l(t.inputs,"map",[],(e=function(t,r){var a=e.$$s||this,i=n;return null==t&&(t=n),null==r&&(r=n),r=a.$Native(r),[t,(i=r["$[]"]("elm"))["$[]"]("type")["$=="]("checkbox")?i["$[]"]("checked"):i["$[]"]("value")]},e.$$s=t,e.$$arity=2,e)).$to_h()},d.$$arity=0),e.def(y,"$render_form",_=function(e,t){var r,a=this,i=n,$=n;return i=l(a,"lambda",[],((r=function(e){var t,a=r.$$s||this,i=n;return null==e&&(e=n),i=e.keyCode,u(u(t=i)?i["$=="](13):t)?a.$submit():n}).$$s=a,r.$$arity=1,r)),$=s(["on"],{on:s(["keyup"],{keyup:i})}),a.$h("form",$,[a.$h("legend",e),a.$h("div",t),a.$h("input",s(["attrs","style"],{attrs:s(["type"],{type:"text"}),style:s(["display"],{display:"none"})}))])},_.$$arity=2),e.def(y,"$render_input",f=function(r,a){var i,$,o,u,c,p,d,_=this,f=n,h=n,y=n;if(null==a)a=s([],{});else if(!a.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(a.$$smap,"id"))throw e.ArgumentError.$new("missing keyword: id");return i=a.$$smap.id,null==($=a.$$smap.el)&&($="input"),null==(o=a.$$smap.type)&&(o="text"),null==(u=a.$$smap.attrs)&&(u=s([],{})),null==(c=a.$$smap.container_style)&&(c=s([],{})),null==(p=a.$$smap.input_style)&&(p=s([],{})),null==(d=a.$$smap.children)&&(d=[]),f=s(["style","attrs"],{style:s(["margin"],{margin:"1rem"}).$merge(e.to_hash(p)),attrs:s(["placeholder","type"],{placeholder:r,type:o}).$merge(e.to_hash(u))}),y=[i,h=_.$h($,f,d)],l(_.inputs,"[]=",e.to_a(y)),y[t(y.length,1)],_.$h("div",s(["style"],{style:s(["display"],{display:"inline-block"}).$merge(e.to_hash(c))}),[r,h])},f.$$arity=2),e.def(y,"$render_button",h=function(e){var t=h.$$p,r=t||n,a=this,i=n;return t&&(h.$$p=null),t&&(h.$$p=null),i=s(["style","attrs","on"],{style:s(["margin"],{margin:"0.5rem 0.5rem 0 0"}),attrs:s(["type"],{type:"button"}),on:s(["click"],{click:r})}),a.$h("button",i,e)},h.$$arity=1)}(p[0],a(i(p,"Snabberb"),"Component"),p)}(r[0],r)},Opal.modules["view/redo_button"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.lambda;return e.add_stubs(["$require","$include","$process_action","$new","$current_entity","$h"]),t.$require("view/actionable"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var $,u=o(t,$super,"RedoButton"),c=[u].concat(r);u.$include(i(c,"Actionable")),e.def(u,"$render",$=function(){var e,t=this,r=n;return r=s(["on","style"],{on:s(["click"],{click:l((e=function(){var t=e.$$s||this;return null==t.game&&(t.game=n),t.$process_action(a(a(i(c,"Engine"),"Action"),"Redo").$new(t.game.$current_entity()))},e.$$s=t,e.$$arity=0,e))}),style:s(["margin-right"],{"margin-right":"1em"})}),t.$h("button",r,"Redo")},$.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/undo_button"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.lambda;return e.add_stubs(["$require","$include","$process_action","$new","$current_entity","$h"]),t.$require("view/actionable"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var $,u=o(t,$super,"UndoButton"),c=[u].concat(r);u.$include(i(c,"Actionable")),e.def(u,"$render",$=function(){var e,t=this,r=n;return r=s(["on","style"],{on:s(["click"],{click:l((e=function(){var t=e.$$s||this;return null==t.game&&(t.game=n),t.$process_action(a(a(i(c,"Engine"),"Action"),"Undo").$new(t.game.$current_entity()))},e.$$s=t,e.$$arity=0,e))}),style:s(["margin-right"],{"margin-right":"1em"})}),t.$h("button",r,"Undo")},$.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/company"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send,u=e.truthy;return e.add_stubs(["$needs","$==","$join","$map","$reverse","$sort_by","$to_proc","$name","$entity","$format_currency","$price","$h","$lambda","$selected?","$store","$[]=","$[]","$-","$desc","$value","$revenue","$any?","$<<","$render_bidders","$owner"]),function(r,c){var p=[$(r,"View")].concat(c);!function(r,$super,a){var i,$,c,p=o(r,$super,"Company");[p].concat(a);p.$$prototype.company=p.$$prototype.selected_company=p.$$prototype.bids=p.$$prototype.game=n,p.$needs("company"),p.$needs("bids",s(["default"],{"default":n})),p.$needs("selected_company",s(["default","store"],{"default":n,store:!0})),p.$needs("game",s(["store"],{store:!0})),e.def(p,"$selected?",i=function(){var e=this;return e.company["$=="](e.selected_company)},i.$$arity=0),e.def(p,"$render_bidders",$=function(){var e,t=this,r=n,a=n;return r=s(["font-weight"],{"font-weight":"normal"}),a=l(l(t.bids,"sort_by",[],"price".$to_proc()).$reverse(),"map",[],(e=function(t){var r=e.$$s||this;return null==r.game&&(r.game=n),null==t&&(t=n),t.$entity().$name()+" ("+r.game.$format_currency(t.$price())+")"},e.$$s=t,e.$$arity=1,e)).$join(", "),t.$h("div",s(["style"],{style:r}),a)},$.$$arity=0),e.def(p,"$render",c=function(){var r,a,i=this,$=n,o=n,c=n,p=n,d=n,_=n,f=n,h=n,y=n;return $=l(i,"lambda",[],((r=function(){var e=r.$$s||this,t=n;return null==e.company&&(e.company=n),t=u(e["$selected?"]())?n:e.company,e.$store("selected_company",t)}).$$s=i,r.$$arity=0,r)),o=s(["background","border","border-radius","margin-bottom","font-size"],{background:"yellow",border:"1px solid","border-radius":"5px","margin-bottom":"0.5rem","font-size":"90%"}),c=s(["margin","font-size","text-align","font-weight"],{margin:"0.5rem 0 0.5rem 0","font-size":"80%","text-align":"left","font-weight":"normal"}),p=s(["display","width","text-align"],{display:"inline-block",width:"50%","text-align":"left"}),d=s(["display","width","text-align"],{display:"inline-block",width:"50%","text-align":"right"}),_=s(["margin-top"],{"margin-top":"1rem"}),f=s(["style","on"],{style:s(["display","cursor","border","border-radius","overflow","padding","margin","width","text-align","font-weight","vertical-align"],{display:"inline-block",cursor:"pointer",border:"solid 1px gainsboro","border-radius":"10px",overflow:"hidden",padding:"0.5rem",margin:"0.5rem 0.5rem 0 0",width:"300px","text-align":"center","font-weight":"bold","vertical-align":"top"}),on:s(["click"],{click:$})}),u(i["$selected?"]())&&(h=["background-color","lightblue"],l(f["$[]"]("style"),"[]=",e.to_a(h)),h[t(h.length,1)]),y=[i.$h("div",s(["style"],{style:o}),"PRIVATE COMPANY"),i.$h("div",i.company.$name()),i.$h("div",s(["style"],{style:c}),i.company.$desc()),i.$h("div",[i.$h("div",s(["style"],{style:p}),"Value: "+i.game.$format_currency(i.company.$value())),i.$h("div",s(["style"],{style:d}),"Revenue: "+i.game.$format_currency(i.company.$revenue()))])],u((a=i.bids)===n||null==a?n:l(a,"any?",[]))&&(y["$<<"](i.$h("div",s(["style"],{style:_}),"Bidders:")),y["$<<"](i.$render_bidders())),u(i.company.$owner())&&y["$<<"](i.$h("div",s(["style"],{style:_}),"Owner: "+i.company.$owner().$name())),i.$h("div",f,y)},c.$$arity=0)}(p[0],a(i(p,"Snabberb"),"Component"),p)}(r[0],r)},Opal.modules["view/tile"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash2,u=(e.hash,e.truthy);return e.add_stubs(["$require","$needs","$h","$first","$blockers","$nil?","$closed?","$owned_by_corporation?","$new","$any?","$exits","$<<","$render_tile_part","$cities","$towns","$label","$+","$offboards","$upgrades","$location_name","$should_render_blocker?","$flatten!"]),r.$require("view/part/blocker"),r.$require("view/part/cities"),r.$require("view/part/label"),r.$require("view/part/location_name"),r.$require("view/part/revenue"),r.$require("view/part/towns"),r.$require("view/part/track"),r.$require("view/part/upgrades"),function(r,n){var c=[o(r,"View")].concat(n);!function(r,$super,n){var o,c,p,d=s(r,$super,"Tile"),_=[d].concat(n);d.$$prototype.region_use=d.$$prototype.tile=d.$$prototype.routes=a,d.$needs("tile"),d.$needs("routes",l(["default","store"],{"default":[],store:!0})),e.def(d,"$render_tile_part",o=function(t,r){var n,a=this;if(null==r)r=l([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return n=e.kwrestargs(r,{}),a.$h(t,l(["region_use","tile"],{region_use:a.region_use,tile:a.tile}).$merge(e.to_hash(n)))},o.$$arity=-2),e.def(d,"$should_render_blocker?",c=function(){var e=a;return e=this.tile.$blockers().$first(),!u(e["$nil?"]())&&(!u(e["$closed?"]())&&!u(e["$owned_by_corporation?"]()))},c.$$arity=0),e.def(d,"$render",p=function(){var e=this,r=a,n=a;return e.region_use=$(_,"Hash").$new(0),r=[],u(e.tile.$exits()["$any?"]())&&r["$<<"](e.$render_tile_part(i($(_,"Part"),"Track"),l(["routes"],{routes:e.routes}))),u(e.tile.$cities()["$any?"]())&&r["$<<"](e.$render_tile_part(i($(_,"Part"),"Cities"))),u(e.tile.$towns()["$any?"]())&&r["$<<"](e.$render_tile_part(i($(_,"Part"),"Towns"),l(["routes"],{routes:e.routes}))),u(e.tile.$label())&&r["$<<"](e.$render_tile_part(i($(_,"Part"),"Label"))),u(t(t(e.tile.$cities(),e.tile.$towns()),e.tile.$offboards())["$any?"]())&&r["$<<"](e.$render_tile_part(i($(_,"Part"),"Revenue"))),u(e.tile.$upgrades())&&r["$<<"](e.$render_tile_part(i($(_,"Part"),"Upgrades"))),u(e.tile.$location_name())&&r["$<<"](e.$render_tile_part(i($(_,"Part"),"LocationName"))),u(e["$should_render_blocker?"]())&&r["$<<"](e.$render_tile_part(i($(_,"Part"),"Blocker"))),r["$flatten!"](),n=l(["fill","stroke-width"],{fill:"none","stroke-width":1}),e.$h("g",l(["attrs"],{attrs:n}),r)},p.$$arity=0)}(c[0],i($(c,"Snabberb"),"Component"),c)}(n[0],n)},Opal.modules["view/operating_round"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy;return e.add_stubs(["$require","$needs","$round","$step","$===","$h","$<<","$current_entity","$can_buy_companies?"]),t.$require("view/buy_companies"),t.$require("view/buy_trains"),t.$require("view/corporation"),t.$require("view/dividend"),t.$require("view/map"),t.$require("view/undo_and_pass"),t.$require("view/route_selector"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var a,$=o(t,$super,"OperatingRound"),u=[$].concat(r);$.$$prototype.game=n,$.$needs("game"),e.def($,"$render",a=function(){var e=this,t=n,r=n,a=n,$=n;return t=e.game.$round(),r=[],$=t.$step(),a="company"["$==="]($)||"track"["$==="]($)||"token"["$==="]($)?e.$h(i(u,"UndoAndPass")):"route"["$==="]($)?e.$h(i(u,"RouteSelector")):"dividend"["$==="]($)?e.$h(i(u,"Dividend")):"train"["$==="]($)?e.$h(i(u,"BuyTrains")):n,r["$<<"](a),r["$<<"](e.$h(i(u,"Corporation"),s(["corporation"],{corporation:t.$current_entity()}))),r["$<<"](e.$h(i(u,"Map"),s(["game"],{game:e.game}))),l(t["$can_buy_companies?"]())&&r["$<<"](e.$h(i(u,"BuyCompanies"))),e.$h("div",r)},a.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/auction_round"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash2,u=e.send,c=e.truthy;return e.add_stubs(["$require","$include","$needs","$round","$current_entity","$h","$compact","$render_companies","$map","$companies","$[]","$bids","$==","$<<","$render_input","$min_increment","$min_bid","$+","$cash","$size","$to_s","$lambda","$process_action","$new","$store","$to_i","$may_purchase?","$may_bid?"]),r.$require("view/actionable"),r.$require("view/company"),r.$require("view/players"),r.$require("view/undo_and_pass"),function(r,n){var p=[o(r,"View")].concat(n);!function(r,$super,n){var o,p,d,_=s(r,$super,"AuctionRound"),f=[_].concat(n);_.$$prototype.game=_.$$prototype.round=_.$$prototype.selected_company=_.$$prototype.current_entity=a,_.$include($(f,"Actionable")),_.$needs("selected_company",l(["default","store"],{"default":a,store:!0})),e.def(_,"$render",o=function(){var t=this;return t.round=t.game.$round(),t.current_entity=t.round.$current_entity(),t.$h("div",[t.$h($(f,"UndoAndPass"))].concat(e.to_a(t.$render_companies())).concat([t.$h(i($(f,"View"),"Players"),l(["game"],{game:t.game}))]).$compact())},o.$$arity=0),e.def(_,"$render_companies",p=function(){var e,t=this,r=a;return r=l(["style"],{style:l(["display","vertical-align"],{display:"inline-block","vertical-align":"top"})}),u(t.round.$companies(),"map",[],((e=function(t){var n=e.$$s||this,i=a;return null==n.round&&(n.round=a),null==n.selected_company&&(n.selected_company=a),null==t&&(t=a),i=[n.$h($(f,"Company"),l(["company","bids"],{company:t,bids:n.round.$bids()["$[]"](t)}))],n.selected_company["$=="](t)&&i["$<<"](n.$render_input()),n.$h("div",r,i)}).$$s=t,e.$$arity=1,e))},p.$$arity=0),e.def(_,"$render_input",d=function(){var e,r,n,o=this,s=a,p=a,d=a,_=a,h=a;return s=o.round.$min_increment(),p=o.$h("input",l(["style","props"],{style:l(["margin-right"],{"margin-right":"1rem"}),props:l(["value","step","min","max","type","size"],{value:o.round.$min_bid(o.selected_company),step:s,min:t(o.selected_company.$min_bid(),s),max:o.current_entity.$cash(),type:"number",size:o.current_entity.$cash().$to_s().$size()})})),d=u(o,"lambda",[],((e=function(){var t=e.$$s||this;return null==t.current_entity&&(t.current_entity=a),null==t.selected_company&&(t.selected_company=a),null==t.round&&(t.round=a),t.$process_action(i(i($(f,"Engine"),"Action"),"Bid").$new(t.current_entity,t.selected_company,t.round.$min_bid(t.selected_company))),t.$store("selected_company",a,l(["skip"],{skip:!0}))}).$$s=o,e.$$arity=0,e)),_=u(o,"lambda",[],((r=function(){var e=r.$$s||this,t=a;return null==e.current_entity&&(e.current_entity=a),null==e.selected_company&&(e.selected_company=a),t=p.elm.value.$to_i(),e.$process_action(i(i($(f,"Engine"),"Action"),"Bid").$new(e.current_entity,e.selected_company,t)),e.$store("selected_company",a,l(["skip"],{skip:!0}))}).$$s=o,r.$$arity=0,r)),h=c(o.round["$may_purchase?"](o.selected_company))?[o.$h("button",l(["on"],{on:l(["click"],{click:d})}),"Buy")]:c(c(n=o.selected_company)?o.round["$may_bid?"](o.selected_company):n)?[p,o.$h("button",l(["on"],{on:l(["click"],{click:_})}),"Place Bid")]:a,o.$h("div",l(["style"],{style:l(["text-align","margin"],{"text-align":"center",margin:"1rem"})}),h)},d.$$arity=0)}(p[0],i($(p,"Snabberb"),"Component"),p)}(n[0],n)},Opal.modules["view/game_card"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.truthy,p=e.lambda,d=e.send;return e.add_stubs(["$require","$include","$needs","$h","$render_header","$render_body","$==","$[]","$user_owns_game?","$include?","$owner?","$<<","$render_button","$delete_game","$===","$user_in_game?","$leave_game","$<","$size","$players","$join_game","$enter_game","$acting?","$new?","$>","$start_game","$map","$!=","$kick","$to_s","$join","$sort_by","$-@","$first","$split"]),n.$require("view/game_row"),function(n,a){var _=[s(n,"View")].concat(a);!function(n,$super,a){var $,s,_,f,h,y,m,g,b=l(n,$super,"GameCard"),v=[b].concat(a);b.$$prototype.gdata=b.$$prototype.user=i,b.$include(o(v,"GameManager")),b.$needs("user"),b.$needs("gdata"),e.const_set(v[0],"ENTER_GREEN","#3CB371"),e.const_set(v[0],"JOIN_YELLOW","#F0E58C"),e.const_set(v[0],"YOUR_TURN_ORANGE","#FF8C00"),e.const_set(v[0],"FINISHED_GREY","#D3D3D3"),e.def(b,"$render",$=function(){var e=this,t=i;return t=u(["style"],{style:u(["display","border","border-radius","overflow","padding","width","margin","vertical-align"],{display:"inline-block",border:"solid 1px black","border-radius":"10px",overflow:"hidden",padding:"0.5rem",width:"320px",margin:"0 0.5rem 0.5rem 0","vertical-align":"top"})}),e.$h("div",t,[e.$render_header(),e.$render_body()])},$.$$arity=0),e.def(b,"$new?",s=function(){return this.gdata["$[]"]("status")["$=="]("new")},s.$$arity=0),e.def(b,"$owner?",_=function(){var e=this;return e["$user_owns_game?"](e.user,e.gdata)},_.$$arity=0),e.def(b,"$players",f=function(){return this.gdata["$[]"]("players")},f.$$arity=0),e.def(b,"$acting?",h=function(e){var t=this,r=i;return!!c(e)&&(!!c(r=t.gdata["$[]"]("acting"))&&r["$include?"](e["$[]"]("id")))},h.$$arity=1),e.def(b,"$render_header",y=function(){var n,a,$,s,l,d,_,f,h=this,y=i,m=i,g=i,b=i,w=i;return y=[],c(h["$owner?"]())&&y["$<<"](h.$render_button("Delete",p(((n=function(){var e=n.$$s||this;return null==e.gdata&&(e.gdata=i),e.$delete_game(e.gdata)}).$$s=h,n.$$arity=0,n)))),g=h.gdata["$[]"]("status"),m="new"["$==="](g)?(c(h["$owner?"]())||(c(h["$user_in_game?"](h.user,h.gdata))?y["$<<"](h.$render_button("Leave",p(((a=function(){var e=a.$$s||this;return null==e.gdata&&(e.gdata=i),e.$leave_game(e.gdata)}).$$s=h,a.$$arity=0,a)))):c(t(h.$players().$size(),h.gdata["$[]"]("max_players")))&&y["$<<"](h.$render_button("Join",p((($=function(){var e=$.$$s||this;return null==e.gdata&&(e.gdata=i),e.$join_game(e.gdata)}).$$s=h,$.$$arity=0,$))))),o(v,"JOIN_YELLOW")):"active"["$==="](g)?(y["$<<"](h.$render_button("Enter",p(((s=function(){var e=s.$$s||this;return null==e.gdata&&(e.gdata=i),e.$enter_game(e.gdata)}).$$s=h,s.$$arity=0,s)))),c(h["$acting?"](h.user))?o(v,"YOUR_TURN_ORANGE"):o(v,"ENTER_GREEN")):"finished"["$==="](g)?(y["$<<"](h.$render_button("Review",p(((l=function(){var e=l.$$s||this;return null==e.gdata&&(e.gdata=i),e.$enter_game(e.gdata)}).$$s=h,l.$$arity=0,l)))),o(v,"FINISHED_GREY")):i,c(c(d=c(_=h["$owner?"]())?h["$new?"]():_)?r(h.$players().$size(),1):d)&&y["$<<"](h.$render_button("Start",p(((f=function(){var e=f.$$s||this;return null==e.gdata&&(e.gdata=i),e.$start_game(e.gdata)}).$$s=h,f.$$arity=0,f)))),b=u(["style"],{style:u(["position","margin","padding","background-color"],{position:"relative",margin:"-0.5em",padding:"0.5em","background-color":m})}),w=u(["style"],{style:u(["display","width"],{display:"inline-block",width:"160px"})}),h.$h("div",b,[h.$h("div",w,[h.$h("div","Game: "+h.gdata["$[]"]("title")),h.$h("div","Owner: "+h.gdata["$[]"]("user")["$[]"]("name"))])].concat(e.to_a(y)))},y.$$arity=0),e.def(b,"$render_button",m=function(e,t){var r=this,n=i;return n=u(["style","on"],{style:u(["top","float","border-radius","margin","padding"],{top:"1rem",float:"right","border-radius":"5px",margin:"0 0.3rem",padding:"0.2rem 0.5rem"}),on:u(["click"],{click:t})}),r.$h("button.button",n,e)},m.$$arity=2),e.def(b,"$render_body",g=function(){var t,r,n,a,$,o=this,s=i,l=i,_=i,f=i;return s=u(["style"],{style:u(["margin-top","line-height","word-break"],{"margin-top":"0.5rem","line-height":"1.2rem","word-break":"break-all"})}),l=d(o.$players(),"map",[],((t=function(e){var r,n,a,$=t.$$s||this,o=i,s=i;return null==$.user&&($.user=i),null==e&&(e=i),o=$.$h(c($["$acting?"](e))?"u":"span",u(["style"],{style:u(["margin-right"],{"margin-right":"0.5rem"})}),e["$[]"]("name")),c(c(r=c(n=$["$owner?"]())?$["$new?"]():n)?e["$[]"]("id")["$!="]($.user["$[]"]("id")):r)&&(s=u(["on","style"],{on:u(["click"],{click:p((a=function(){var t=a.$$s||this;return null==t.gdata&&(t.gdata=i),t.$kick(t.gdata,e)},a.$$s=$,a.$$arity=0,a))}),style:u(["margin-left"],{"margin-left":"0.5rem"})}),o=$.$h("button.button",s,[o])),o}).$$s=o,t.$$arity=1,t)),_=[o.$h("div",[o.$h("b","Id: "),o.gdata["$[]"]("id").$to_s()]),o.$h("div",[o.$h("b","Description: "),o.gdata["$[]"]("description")]),o.$h("div",[o.$h("b","Players: ")].concat(e.to_a(l)))],c(o["$new?"]())?(_["$<<"](o.$h("div",[o.$h("b","Max Players: "),o.gdata["$[]"]("max_players")])),_["$<<"](o.$h("div",[o.$h("b","Created: "),o.gdata["$[]"]("created_at")]))):o.gdata["$[]"]("status")["$=="]("finished")?(f=d(d(o.gdata["$[]"]("result"),"sort_by",[],(r=function(e,t){r.$$s;return null==e&&(e=i),null==t&&(t=i),t["$-@"]()},r.$$s=o,r.$$arity=2,r)),"map",[],(n=function(e,t){n.$$s;return null==e&&(e=i),null==t&&(t=i),e+" ("+t+")"},n.$$s=o,n.$$arity=2,n)).$join(", "),_["$<<"](o.$h("div",[o.$h("b","Result: "),f]))):_["$<<"](o.$h("div",[o.$h("b","Round: "),(a=o.gdata["$[]"]("round"),$=a===i||null==a?i:d(a,"split",[" "]),($===i||null==$?i:d($,"first",[]))+" "+o.gdata["$[]"]("turn")+" "),o.$h("b","Updated: "),o.gdata["$[]"]("updated_at")])),o.$h("div",s,_)},g.$$arity=0)}(_[0],$(o(_,"Snabberb"),"Component"),_)}(a[0],a)},Opal.modules["view/pass_button"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.lambda;return e.add_stubs(["$require","$include","$process_action","$new","$current_entity","$h","$pass_description","$round"]),t.$require("view/actionable"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var $,u=o(t,$super,"PassButton"),c=[u].concat(r);u.$$prototype.game=n,u.$include(i(c,"Actionable")),e.def(u,"$render",$=function(){var e,t=this,r=n;return r=s(["on"],{on:s(["click"],{click:l((e=function(){var t=e.$$s||this;return null==t.game&&(t.game=n),t.$process_action(a(a(i(c,"Engine"),"Action"),"Pass").$new(t.game.$current_entity()))},e.$$s=t,e.$$arity=0,e))})}),t.$h("button",r,t.game.$round().$pass_description())},$.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/corporation"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send,u=e.truthy;return e.add_stubs(["$needs","$lambda","$selected?","$store","$[]=","$-","$can_act?","$round","$render_title","$render_holdings","$render_shares","$any?","$companies","$<<","$render_companies","$owner","$empty?","$revenue_history","$render_revenue_history","$h","$color","$full_name","$render_header_segment","$name","$render_trains","$format_currency","$cash","$render_tokens","$trains","$join","$map","$to_proc","$with_index","$tokens","$logo","$used?","$[]","$zero?","$coordinates","$price","$positive?","$to_s","$players","$president?","$num_shares_of","$did_sell?","$sort_by","$select","$-@","$share_pool","$share_number_str","$share_price_str","$par_price","$share_price","$render_company","$revenue","$abs","$max","$keys","$=="]),function(r,c){var p=[$(r,"View")].concat(c);!function(r,$super,a){var i,$,c,p,d,_,f,h,y,m,g,b,v,w,k,x=o(r,$super,"Corporation");[x].concat(a);x.$$prototype.game=x.$$prototype.corporation=x.$$prototype.selected_corporation=n,x.$needs("corporation"),x.$needs("selected_corporation",s(["default","store"],{"default":n,store:!0})),x.$needs("game",s(["store"],{store:!0})),e.def(x,"$render",i=function(){var r,a=this,i=n,$=n,o=n,c=n,p=n,d=n;return i=l(a,"lambda",[],((r=function(){var e=r.$$s||this,t=n;return null==e.corporation&&(e.corporation=n),t=u(e["$selected?"]())?n:e.corporation,e.$store("selected_corporation",t)}).$$s=a,r.$$arity=0,r)),$=s(["display","cursor","position","border","border-radius","overflow","padding","margin","width","vertical-align"],{display:"inline-block",cursor:"pointer",position:"relative",border:"solid 1px gainsboro","border-radius":"10px",overflow:"hidden",padding:"0.5rem",margin:"0.5rem 0.5rem 0 0",width:"320px","vertical-align":"top"}),u(a["$selected?"]())&&(o=["background-color","lightblue"],l($,"[]=",e.to_a(o)),o[t(o.length,1)]),u(a.game.$round()["$can_act?"](a.corporation))&&(o=["border","solid 1px black"],l($,"[]=",e.to_a(o)),o[t(o.length,1)],o=["background-color","#dfd"],l($,"[]=",e.to_a(o)),o[t(o.length,1)]),c=[a.$render_title(),a.$render_holdings(),a.$render_shares()],u(a.corporation.$companies()["$any?"]())&&c["$<<"](a.$render_companies()),p=s(["style"],{style:s(["text-align","font-weight","margin-left","margin-right"],{"text-align":"center","font-weight":"bold","margin-left":"auto","margin-right":"auto"})}),u(a.corporation.$owner())&&(d=u(a.corporation.$revenue_history()["$empty?"]())?[]:[a.$render_revenue_history()],c["$<<"](a.$h("table",p,[a.$h("tr",d)]))),a.$h("div",s(["style","on"],{style:$,on:s(["click"],{click:i})}),c)},i.$$arity=0),e.def(x,"$render_title",$=function(){var e=this,t=n;return t=s(["background","text-align","color","padding","font-weight","margin"],{background:e.corporation.$color(),"text-align":"center",color:"#ffffff",padding:"0.5rem 0px","font-weight":"bold",margin:"-0.5rem -0.5rem 0 -0.5rem"}),e.$h("div",s(["style"],{style:t}),e.corporation.$full_name())},$.$$arity=0),e.def(x,"$render_holdings",c=function(){var r=this,a=n,i=n;return a=s(["text-align","white-space","background-color","display","justify-content","margin"],{"text-align":"center","white-space":"nowrap","background-color":"lightgray",display:"flex","justify-content":"center",margin:"0 -0.5rem"}),u(r.game.$round()["$can_act?"](r.corporation))&&(i=["background-color","#9b9"],l(a,"[]=",e.to_a(i)),i[t(i.length,1)]),r.$h("div",s(["style"],{style:a}),[r.$render_header_segment(r.corporation.$name(),"Sym"),r.$render_trains(),r.$render_header_segment(r.game.$format_currency(r.corporation.$cash()),"Cash"),r.$render_tokens()])},c.$$arity=0),e.def(x,"$render_trains",p=function(){var e=this,t=n;return t=u(e.corporation.$trains()["$empty?"]())?"None":l(e.corporation.$trains(),"map",[],"name".$to_proc()).$join(","),e.$render_header_segment(t,"Trains")},p.$$arity=0),e.def(x,"$render_header_segment",d=function(e,t){var r=this,a=n,i=n;return a=s(["style"],{style:s(["display","margin","text-align"],{display:"inline-block",margin:"0.5em","text-align":"center"})}),i=s(["style"],{style:s(["font-size","font-weight","max-width","white-space","text-overflow","overflow"],{"font-size":"16px","font-weight":"bold","max-width":"120px","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden"})}),r.$h("div",a,[r.$h("div",i,e),r.$h("div",t)])},d.$$arity=2),e.def(x,"$render_treasury",_=function(){var e=this;return e.$h("div","Treasury: "+e.game.$format_currency(e.corporation.$cash()))},_.$$arity=0),e.def(x,"$render_tokens",f=function(){var r,a=this,i=n,$=n,o=n;return i=s(["margin","text-align"],{margin:"0.5rem","text-align":"center"}),$=s(["width","float"],{width:"2rem",float:"left"}),o=l(a.corporation.$tokens().$map(),"with_index",[],((r=function(a,i){var o=r.$$s||this,c=n,p=n,d=n;return null==o.corporation&&(o.corporation=n),null==a&&(a=n),null==i&&(i=n),c=s(["attrs","style"],{attrs:s(["src"],{src:o.corporation.$logo()}),style:s(["width"],{width:"25px"})}),u(a["$used?"]())&&(p=["filter","contrast(15%) grayscale(100%)"],l(c["$[]"]("style"),"[]=",e.to_a(p)),p[t(p.length,1)]),d=u(i["$zero?"]())?o.corporation.$coordinates():a.$price(),o.$h("div",s(["style"],{style:$}),[o.$h("img",c),o.$h("div",d)])}).$$s=a,r.$$arity=2,r)),a.$h("div",s(["style"],{style:i}),o)},f.$$arity=0),e.def(x,"$share_price_str",h=function(e){var t=this;return u(e)?t.game.$format_currency(e.$price()):""},h.$$arity=1),e.def(x,"$share_number_str",y=function(e){return u(e["$positive?"]())?e.$to_s():""},y.$$arity=1),e.def(x,"$render_shares",m=function(){var t,r,a,i,$=this,o=n,c=n,p=n,d=n,_=n,f=n,h=n,y=n,m=n;return o=s(["style"],{style:s(["padding","line-height"],{padding:"0 0.5rem","line-height":"1.25rem"})}),c=l($.game.$players(),"map",[],((t=function(e){var r=t.$$s||this;return null==r.corporation&&(r.corporation=n),null==r.game&&(r.game=n),null==e&&(e=n),[e,r.corporation["$president?"](e),e.$num_shares_of(r.corporation),r.game.$round()["$did_sell?"](r.corporation,e)]}).$$s=$,t.$$arity=1,t)),p=l(l(l(c,"select",[],((r=function(e,t,a,i){var $;r.$$s;return null==e&&(e=n),null==e&&(e=n),null==a&&(a=n),null==i&&(i=n),u($=a["$positive?"]())?$:i}).$$s=$,r.$$arity=4,r)),"sort_by",[],((a=function(e,t,r){a.$$s;return null==e&&(e=n),null==t&&(t=n),null==r&&(r=n),null==e&&(e=n),[u(t)?0:1,r["$-@"]()]}).$$s=$,a.$$arity=4,a)),"map",[],((i=function(e,t,r,a){var $=i.$$s||this,l=n,c=n;return null==e&&(e=n),null==t&&(t=n),null==r&&(r=n),null==a&&(a=n),l=s(["style"],{style:s(["padding"],{padding:"0 0.3rem"})}),c=s(["style"],{style:s(["padding","line-height","font-style"],{padding:"0 0.5rem","line-height":"1.25rem","font-style":"italic"})}),$.$h("tr",[$.$h("td",l,e.$name()),$.$h("td",o,r+(u(t)?"*":"")),$.$h("td",c,u(a)?"Sold":"")])}).$$s=$,i.$$arity=4,i)),d=s(["style"],{style:s(["border-bottom"],{"border-bottom":u(p["$any?"]())?"1px solid #888":"0"})}),_=$.corporation.$num_shares_of($.corporation),f=$.game.$share_pool().$num_shares_of($.corporation),h=[$.$h("tr",[$.$h("td",o,"IPO"),$.$h("td",o,$.$share_number_str(_)),$.$h("td",o,$.$share_price_str($.corporation.$par_price()))])],u(p["$any?"]())&&h["$<<"]($.$h("tr",[$.$h("td",o,"Market"),$.$h("td",o,$.$share_number_str(f)),$.$h("td",o,$.$share_price_str($.corporation.$share_price()))])),y=[].concat(e.to_a(h)).concat([$.$h("tr",d,[$.$h("td",s(["colspan"],{colspan:"100%"}),"")])]).concat(e.to_a(p)),m=s(["style"],{style:s(["border-collapse","text-align","margin-left","margin-right","margin-top"],{"border-collapse":"collapse","text-align":"center","margin-left":"auto","margin-right":"auto","margin-top":"0.5rem"})}),$.$h("table",m,[$.$h("tr",[$.$h("th",o,"Shareholder"),$.$h("th",o,"Shares"),$.$h("th",o,"Price")])].concat(e.to_a(y)))},m.$$arity=0),e.def(x,"$render_companies",g=function(){var t,r=this,a=n,i=n;return a=s(["style"],{style:s(["margin-top","text-align","margin-left","margin-right"],{"margin-top":"1rem","text-align":"center","margin-left":"auto","margin-right":"auto"})}),i=l(r.corporation.$companies(),"map",[],((t=function(e){var r=t.$$s||this;return null==e&&(e=n),r.$render_company(e)}).$$s=r,t.$$arity=1,t)),r.$h("table",a,[r.$h("tr",[r.$h("th","Company"),r.$h("th","Income")])].concat(e.to_a(i)))
},g.$$arity=0),e.def(x,"$render_company",b=function(e){var t=this,r=n;return r=s(["style"],{style:s(["padding","line-height"],{padding:"0 0.3rem","line-height":"1.25rem"})}),t.$h("tr",[t.$h("td",r,e.$name()),t.$h("td",r,t.game.$format_currency(e.$revenue()))])},b.$$arity=1),e.def(x,"$render_president",v=function(){var e=this,t=n;return t=s(["style"],{style:s(["font-weight"],{"font-weight":"bold"})}),e.$h("td",t,"President: "+e.corporation.$owner().$name())},v.$$arity=0),e.def(x,"$render_revenue_history",w=function(){var e=this,t=n,r=n;return t=s(["style"],{style:s(["padding-top","text-align","font-weight"],{"padding-top":"1rem","text-align":"center","font-weight":"bold"})}),r=e.corporation.$revenue_history()["$[]"](e.corporation.$revenue_history().$keys().$max()).$abs(),e.$h("td",t,"Last Run: "+e.game.$format_currency(r))},w.$$arity=0),e.def(x,"$selected?",k=function(){var e=this;return e.corporation["$=="](e.selected_corporation)},k.$$arity=0)}(p[0],a(i(p,"Snabberb"),"Component"),p)}(r[0],r)},Opal.modules["view/part/upgrades"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.send,l=e.hash2;return e.add_stubs(["$require","$needs","$map","$upgrades","$h","$cost","$terrains"]),t.$require("view/part/base"),t.$require("view/part/upgrade"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,r){var u=[$(t,"Part")].concat(r);!function(t,$super,r){var $,u=o(t,$super,"Upgrades"),c=[u].concat(r);u.$$prototype.tile=n,u.$needs("tile"),u.$needs("region_use"),e.def(u,"$render",$=function(){var e,t=this;return s(t.tile.$upgrades(),"map",[],((e=function(t){var r=e.$$s||this;return null==r.region_use&&(r.region_use=n),null==t&&(t=n),r.$h(a(i(c,"Part"),"Upgrade"),l(["region_use","cost","terrains"],{region_use:r.region_use,cost:t.$cost(),terrains:t.$terrains()}))}).$$s=t,e.$$arity=1,e))},$.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(u[0],u)}(r[0],r)},Opal.modules["view/part/blocker"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2;return e.add_stubs(["$require","$first","$blockers","$h","$translate","$sym"]),t.$require("view/part/base"),function(t,r){var s=[i(t,"View")].concat(r);!function(t,r){var s=[i(t,"Part")].concat(r);!function(t,$super,r){var i,s,l,u=$(t,$super,"Blocker"),c=[u].concat(r);u.$$prototype.tile=u.$$prototype.blocker=n,e.def(u,"$preferred_render_locations",i=function(){return[o(["region_weights","x","y"],{region_weights:a(c,"LEFT_CORNER"),x:-65,y:5}),o(["region_weights","x","y"],{region_weights:[19,20],x:-35,y:60})]},i.$$arity=0),e.def(u,"$load_from_tile",s=function(){var e=this;return e.blocker=e.tile.$blockers().$first()},s.$$arity=0),e.def(u,"$render_part",l=function(){var e=this;return e.$h("g",o(["attrs"],{attrs:o(["transform","class"],{transform:e.$translate(),"class":"blocker"})}),[e.$h("text",o(["attrs"],{attrs:o(["fill","dominant-baseline","text-anchor","x","y"],{fill:"black","dominant-baseline":"baseline","text-anchor":"middle",x:0,y:-5})}),e.blocker.$sym()),e.$h("path",o(["attrs"],{attrs:o(["fill","d"],{fill:"white",d:"M -11 6 A 44 44 0 0 0 11 6"})})),e.$h("circle",o(["attrs"],{attrs:o(["fill","r","cx","cy"],{fill:"white",r:6,cx:11,cy:6})})),e.$h("circle",o(["attrs"],{attrs:o(["fill","r","cx","cy"],{fill:"white",r:6,cx:-11,cy:6})}))])},l.$$arity=0)}(s[0],a(s,"Base"),s)}(s[0],s)}(r[0],r)},Opal.modules["view/part/revenue"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.klass,l=e.truthy,u=e.hash2,c=e.hash,p=e.range,d=e.send;return e.add_stubs(["$require","$multi_revenue?","$===","$+","$sum","$map","$cities","$to_proc","$size","$towns","$offboards","$uniq","$empty?","$==","$first","$puts","$values","$!","$include?","$is_a?","$h","$translate"]),r.$require("view/part/base"),r.$require("view/part/multi_revenue"),function(r,n){var _=[o(r,"View")].concat(n);!function(r,n){var _=[o(r,"Part")].concat(n);!function(r,$super,n){var o,_,f,h,y,m=s(r,$super,"Revenue"),g=[m].concat(n);m.$$prototype.slots=m.$$prototype.tile=m.$$prototype.revenue=a,e.def(m,"$preferred_render_locations",o=function(){var e=this,r=a;return l(e["$multi_revenue?"]())?[u(["region_weights","x","y"],{region_weights:$(g,"CENTER"),x:0,y:0}),u(["region_weights","x","y"],{region_weights:$(g,"TOP_MIDDLE_ROW"),x:0,y:-24}),u(["region_weights","x","y"],{region_weights:$(g,"BOTTOM_MIDDLE_ROW"),x:0,y:24}),u(["region_weights","x","y"],{region_weights:$(g,"TOP_ROW"),x:0,y:-48}),u(["region_weights","x","y"],{region_weights:$(g,"BOTTOM_ROW"),x:0,y:48})]:(r=e.slots,1["$==="](r)?[u(["region_weights_in","region_weights_out","x","y"],{region_weights_in:c($(g,"LEFT_MID"),1,$(g,"LEFT_CENTER"),.4),region_weights_out:c($(g,"LEFT_CORNER"),.1,$(g,"LEFT_MID"),.2,$(g,"LEFT_CENTER"),1),x:-45,y:0}),u(["region_weights_in","region_weights_out","x","y"],{region_weights_in:c($(g,"RIGHT_MID"),1,$(g,"RIGHT_CENTER"),.4),region_weights_out:c($(g,"RIGHT_CORNER"),.1,$(g,"RIGHT_MID"),.2,$(g,"RIGHT_CENTER"),1),x:45,y:0}),u(["region_weights","x","y"],{region_weights:[13,14],x:-45,y:25}),u(["region_weights","x","y"],{region_weights:[6,7],x:-45,y:-25}),u(["region_weights_in","region_weights_out","x","y"],{region_weights_in:c([13,14,15,21],.4,[19,20],1),region_weights_out:[13,14,15,19,20,21],x:-28,y:45}),u(["region_weights_in","region_weights_out","x","y"],{region_weights_in:c([15,16,17,21],.4,[22,23],1),region_weights_out:[15,16,17,21,22,34],x:28,y:45})]:p(2,4,!1)["$==="](r)?[u(["region_weights_in","region_weights_out","x","y"],{region_weights_in:t($(g,"LEFT_CORNER"),$(g,"LEFT_MID")),region_weights_out:$(g,"LEFT_CORNER"),x:-70,y:0}),u(["region_weights_in","region_weights_out","x","y"],{region_weights_in:t($(g,"RIGHT_CORNER"),$(g,"RIGHT_MID")),region_weights_out:$(g,"RIGHT_CORNER"),x:70,y:0}),u(["region_weights","x","y"],{region_weights:[13,14],x:-45,y:25})]:[u(["region_weights","x","y"],{region_weights:[7,8,9,14,15,16],x:0,y:0})])},o.$$arity=0),e.def(m,"$load_from_tile",_=function(){var e=this,r=a,n=a;return e.slots=t(d(e.tile.$cities(),"map",[],"slots".$to_proc()).$sum(),e.tile.$towns().$size()),r=t(t(e.tile.$cities(),e.tile.$towns()),e.tile.$offboards()),n=d(r,"map",[],"revenue".$to_proc()).$uniq(),l(n["$empty?"]())?a:n.$size()["$=="](1)?(n=n.$first(),e.revenue=n.$values().$uniq().$size()["$=="](1)?n.$values().$uniq().$first():n):(e.$puts("WARNING: encountered multiple different revenues on one tile"),e.revenue=a,a)},_.$$arity=0),e.def(m,"$should_render?",f=function(){var e=this;return[a,0]["$include?"](e.revenue)["$!"]()},f.$$arity=0),e.def(m,"$multi_revenue?",h=function(){return this.revenue["$is_a?"]($(g,"Numeric"))["$!"]()},h.$$arity=0),e.def(m,"$render_part",y=function(){var e=this,t=a,r=a;return t=u(["fill","transform","text-anchor"],{fill:"black",transform:"translate(0 6)","text-anchor":"middle"}),l(e["$multi_revenue?"]())?e.$h(i($(g,"Part"),"MultiRevenue"),u(["revenues","translate"],{revenues:e.revenue,translate:e.$translate()})):(r=u(["class","stroke-width","transform"],{"class":"revenue","stroke-width":1,transform:e.$translate()}),e.$h("g",u(["attrs"],{attrs:r}),[e.$h("circle",u(["attrs"],{attrs:u(["r","fill"],{r:14,fill:"white"})})),e.$h("text",u(["attrs"],{attrs:t}),e.revenue)]))},y.$$arity=0)}(_[0],$(_,"Base"),_)}(_[0],_)}(n[0],n)},Opal.modules["view/part/towns"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.send,l=e.truthy,u=e.hash2;return e.add_stubs(["$require","$freeze","$needs","$map","$towns","$lawson?","$empty?","$paths","$h","$color_for","$flat_map","$select","$equal?","$town","$to_proc","$paths_for","$find_index","$any?","$==","$[]","$class"]),t.$require("view/part/town_dot"),t.$require("view/part/town_rect"),function(t,r){var c=[$(t,"View")].concat(r);!function(t,r){var c=[$(t,"Part")].concat(r);!function(t,$super,r){var $,c,p=o(t,$super,"Towns"),d=[p].concat(r);p.$$prototype.tile=p.$$prototype.routes=p.$$prototype.routes_paths=n,e.const_set(d[0],"ROUTE_COLORS",["red","blue","green","purple"].$freeze()),p.$needs("tile"),p.$needs("region_use"),p.$needs("routes"),e.def(p,"$render",$=function(){var e,t=this;return s(t.tile.$towns(),"map",[],((e=function(t){var r,$,o=e.$$s||this,c=n;return null==o.tile&&(o.tile=n),null==o.region_use&&(o.region_use=n),null==t&&(t=n),l(l(r=o.tile["$lawson?"]())?r:o.tile.$paths()["$empty?"]())?o.$h(a(i(d,"Part"),"TownDot"),u(["tile","region_use","color"],{tile:o.tile,region_use:o.region_use,color:o.$color_for(t)})):(c=s(s(o.tile.$paths(),"select",[],(($=function(e){$.$$s;return null==e&&(e=n),e.$town()["$equal?"](t)}).$$s=o,$.$$arity=1,$)),"flat_map",[],"exits".$to_proc()),o.$h(a(i(d,"Part"),"TownRect"),u(["region_use","color","edges"],{region_use:o.region_use,color:o.$color_for(t),edges:c})))}).$$s=t,e.$$arity=1,e))},$.$$arity=0),e.def(p,"$color_for",c=function(e){var t,r,i=this,$=n;return i.routes_paths=s(i.routes,"map",[],((t=function(e){var r=t.$$s||this;return null==r.tile&&(r.tile=n),null==e&&(e=n),e.$paths_for(r.tile.$paths())}).$$s=i,t.$$arity=1,t)),$=s(i.routes_paths,"find_index",[],((r=function(t){var a,i=r.$$s||this;return null==t&&(t=n),s(t,"any?",[],((a=function(t){a.$$s;return null==t&&(t=n),t.$town()["$=="](e)}).$$s=i,a.$$arity=1,a))}).$$s=i,r.$$arity=1,r)),l($)?a(i.$class(),"ROUTE_COLORS")["$[]"]($):"black"},c.$$arity=1)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(c[0],c)}(r[0],r)},Opal.modules["view/part/track"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.send,l=e.truthy,u=e.hash2;return e.add_stubs(["$require","$freeze","$needs","$map","$paths_for","$paths","$!","$empty?","$offboards","$select","$to_proc","$lawson?","$==","$size","$edges","$any?","$towns","$render_track_for_curvilinear_town","$cities","$render_track_for_curvilinear_city","$h","$color_for","$private","$flat_map","$group_by","$find_index","$[]","$class"]),t.$require("view/part/track_curvilinear_path"),t.$require("view/part/track_curvilinear_half_path"),t.$require("view/part/track_lawson_path"),t.$require("view/part/track_offboard"),function(t,r){var c=[$(t,"View")].concat(r);!function(t,r){var c=[$(t,"Part")].concat(r);!function(t,$super,r){var $,c,p,d,_=o(t,$super,"Track"),f=[_].concat(r);_.$$prototype.routes=_.$$prototype.tile=_.$$prototype.routes_paths=n,e.const_set(f[0],"ROUTE_COLORS",["#AA0A3C","#0A9B4B","#005AC8","#8214A0"].$freeze()),_.$needs("tile"),_.$needs("region_use"),_.$needs("routes"),e.def(_,"$render",$=function(){var e,t,r,$,o=this,c=n,p=n;if(o.routes_paths=s(o.routes,"map",[],((e=function(t){var r=e.$$s||this;return null==r.tile&&(r.tile=n),null==t&&(t=n),t.$paths_for(r.tile.$paths())}).$$s=o,e.$$arity=1,e)),l(o.tile.$offboards()["$empty?"]()["$!"]()))c=a(i(f,"Part"),"TrackOffboard"),p=s(o.tile.$paths(),"select",[],"offboard".$to_proc());else if(l(o.tile["$lawson?"]()))c=a(i(f,"Part"),"TrackLawsonPath"),p=s(o.tile.$paths(),"select",[],((t=function(e){t.$$s;return null==e&&(e=n),e.$edges().$size()["$=="](1)}).$$s=o,t.$$arity=1,t));else{if(l(o.tile.$towns()["$any?"]()))return o.$render_track_for_curvilinear_town();if(l(o.tile.$cities()["$any?"]()))return o.$render_track_for_curvilinear_city();c=a(i(f,"Part"),"TrackCurvilinearPath"),p=s(o.tile.$paths(),"select",[],((r=function(e){r.$$s;return null==e&&(e=n),e.$edges().$size()["$=="](2)}).$$s=o,r.$$arity=1,r))}return s(p,"map",[],(($=function(e){var t=$.$$s||this;return null==t.region_use&&(t.region_use=n),null==e&&(e=n),t.$h(c,u(["region_use","path","color"],{region_use:t.region_use,path:e,color:t.$color_for(e)}))}).$$s=o,$.$$arity=1,$))},$.$$arity=0),_.$private(),e.def(_,"$render_track_for_curvilinear_city",c=function(){var e,t=this;return s(s(s(t.tile.$paths(),"select",[],"city".$to_proc()),"group_by",[],"city".$to_proc()),"flat_map",[],((e=function(t,r){var $,o=e.$$s||this,l=n;return null==t&&(t=n),null==r&&(r=n),l=s(r,"flat_map",[],"exits".$to_proc()),s(r,"map",[],(($=function(e){var t=$.$$s||this;return null==t.region_use&&(t.region_use=n),null==e&&(e=n),t.$h(a(i(f,"Part"),"TrackCurvilinearHalfPath"),u(["region_use","exits","path","color"],{region_use:t.region_use,exits:l,path:e,color:t.$color_for(e)}))}).$$s=o,$.$$arity=1,$))}).$$s=t,e.$$arity=2,e))},c.$$arity=0),e.def(_,"$render_track_for_curvilinear_town",p=function(){var e,t=this;return s(s(s(t.tile.$paths(),"select",[],"town".$to_proc()),"group_by",[],"town".$to_proc()),"flat_map",[],((e=function(t,r){var $,o=e.$$s||this,l=n;return null==t&&(t=n),null==r&&(r=n),l=s(r,"flat_map",[],"exits".$to_proc()),s(r,"map",[],(($=function(e){var t=$.$$s||this;return null==t.region_use&&(t.region_use=n),null==e&&(e=n),t.$h(a(i(f,"Part"),"TrackCurvilinearHalfPath"),u(["region_use","exits","path","color"],{region_use:t.region_use,exits:l,path:e,color:t.$color_for(e)}))}).$$s=o,$.$$arity=1,$))}).$$s=t,e.$$arity=2,e))},p.$$arity=0),e.def(_,"$color_for",d=function(e){var t,r=this,i=n;return i=s(r.routes_paths,"find_index",[],((t=function(r){var a,i=t.$$s||this;return null==r&&(r=n),s(r,"any?",[],((a=function(t){a.$$s;return null==t&&(t=n),e["$=="](t)}).$$s=i,a.$$arity=1,a))}).$$s=r,t.$$arity=1,t)),l(i)?a(r.$class(),"ROUTE_COLORS")["$[]"](i):"#000000"},d.$$arity=1)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(c[0],c)}(r[0],r)},Opal.modules["view/part/track_curvilinear_path"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var i=e.top,$=[],o=e.nil,s=(e.const_get_qualified,e.const_get_relative),l=(e.breaker,e.slice,e.module),u=e.klass,c=e.hash,p=e.hash2,d=e.truthy,_=e.send;return e.add_stubs(["$require","$freeze","$needs","$<","$-","$>","$%","$*","$exits","$compute_curvilinear_type","$compute_track_rotation_degrees","$map","$[]","$rotate_region","$h"]),i.$require("view/part/base"),function(i,$){var f=[l(i,"View")].concat($);!function(i,$){var f=[l(i,"Part")].concat($);!function(i,$super,$){var l,f,h,y,m,g=u(i,$super,"TrackCurvilinearPath"),b=[g].concat($);g.$$prototype.path=g.$$prototype.curvilinear_type=g.$$prototype.rotation=g.$$prototype.color=o,e.const_set(b[0],"STOP",0),e.const_set(b[0],"SHARP",1),e.const_set(b[0],"GENTLE",2),e.const_set(b[0],"STRAIGHT",3),e.const_set(b[0],"REGIONS",c(s(b,"STOP"),[15,21],s(b,"SHARP"),[13,14,15,21],s(b,"GENTLE"),[6,7,14,15,21],s(b,"STRAIGHT"),[2,8,15,21]).$freeze()),e.const_set(b[0],"SVG_PATH_STRINGS",c(s(b,"STOP"),"M 0 87 L 0 30",s(b,"SHARP"),"M 0 87 L 0 75 A 43.30125 43.30125 0 0 0 -64.951875 37.5 L -75 43.5",s(b,"GENTLE"),"M 0 87 L 0 75 A 129.90375 129.90375 0 0 0 -64.951875 -37.5 L -75 -43.5",s(b,"STRAIGHT"),"M 0 87 L 0 -87").$freeze()),g.$needs("path"),g.$needs("color",p(["default"],{"default":"black"})),e.def(g,"$compute_curvilinear_type",l=function(e,a){var i,$=o;return d(a)?(d(t(a,e))&&(e=(i=[a,e])[0],a=i[1]),$=r(a,e),d(n($,3))&&($=r(e,a)["$%"](6)),$):0},l.$$arity=2),e.def(g,"$compute_track_rotation_degrees",f=function(e,i){var $;return d(i)?(d(t(i,e))&&(e=($=[i,e])[0],i=$[1]),d(n(r(i,e),3))?a(60,i):a(60,e)):a(60,e)},f.$$arity=2),e.def(g,"$load_from_tile",h=function(){var t,r,n=this,a=o,i=o;return r=n.path.$exits(),a=null==(t=e.to_ary(r))[0]?o:t[0],i=null==t[1]?o:t[1],n.curvilinear_type=n.$compute_curvilinear_type(a,i),n.rotation=n.$compute_track_rotation_degrees(a,i)},h.$$arity=0),e.def(g,"$preferred_render_locations",y=function(){var e,t=this,r=o;return r=_(s(b,"REGIONS")["$[]"](t.curvilinear_type),"map",[],((e=function(t){var r=e.$$s||this;return null==r.rotation&&(r.rotation=o),null==t&&(t=o),r.$rotate_region(t,p(["degrees"],{degrees:r.rotation}))}).$$s=t,e.$$arity=1,e)),[p(["region_weights","x","y"],{region_weights:r,x:0,y:0})]},y.$$arity=0),e.def(g,"$render_part",m=function(){var e=this,t=o;return t=p(["attrs"],{attrs:p(["class","transform","d","stroke","stroke-width"],{"class":"curvilinear_path",transform:"rotate("+e.rotation+")",d:s(b,"SVG_PATH_STRINGS")["$[]"](e.curvilinear_type),stroke:e.color,"stroke-width":8})}),e.$h("path",t)},m.$$arity=0)}(f[0],s(f,"Base"),f)}(f[0],f)}($[0],$)},Opal.modules["view/part/upgrade"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var n=e.top,a=[],i=e.nil,$=(e.const_get_qualified,e.const_get_relative),o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash2,u=e.send;return e.add_stubs(["$require","$needs","$h","$with_index","$map","$[]","$mountain","$+","$*","$water","$translate"]),n.$require("view/part/base"),function(n,a){var c=[o(n,"View")].concat(a);!function(n,a){var c=[o(n,"Part")].concat(a);!function(n,$super,a){var o,c,p,d,_=s(n,$super,"Upgrade"),f=[_].concat(a);_.$$prototype.cost=_.$$prototype.terrains=i,_.$needs("cost"),_.$needs("terrains",l(["default"],{"default":[]})),e.def(_,"$preferred_render_locations",o=function(){return[l(["region_weights","x","y"],{region_weights:$(f,"CENTER"),x:0,y:0}),l(["region_weights","x","y"],{region_weights:[3,4],x:30,y:-60})]},o.$$arity=0),e.def(_,"$render_part",c=function(){var e,n=this,a=i,$=i,o=i,s=i,c=i;return a=l(["text-anchor","fill","transform"],{"text-anchor":"middle",fill:"black",transform:"scale(1.5)"}),$=n.$h("text",l(["attrs"],{attrs:a}),n.cost),o=-10,s=t([$],u(n.terrains.$map(),"with_index",[],((e=function(n,a){var $=e.$$s||this;return null==n&&(n=i),null==a&&(a=i),l(["mountain","water"],{mountain:$.$mountain(l(["delta_x","delta_y"],{delta_x:o,delta_y:t(5,r(20,a))})),water:$.$water(l(["delta_x","delta_y"],{delta_x:o,delta_y:t(5,r(20,a))}))})["$[]"](n)}).$$s=n,e.$$arity=2,e))),c=l(["class","stroke-width","transform"],{"class":"upgrade","stroke-width":1,transform:n.$translate()}),n.$h("g",l(["attrs"],{attrs:c}),s)},c.$$arity=0),e.def(_,"$mountain",p=function(t){var r,n,a=this;if(null==t)t=l([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(r=t.$$smap.delta_x)&&(r=0),null==(n=t.$$smap.delta_y)&&(n=0),a.$h("polygon",l(["attrs"],{attrs:l(["transform","points"],{transform:"translate("+r+" "+n+")",points:"0,20 10,0 20,20"})}))},p.$$arity=-1),e.def(_,"$water",d=function(r){var n,a,i=this;if(null==r)r=l([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(n=r.$$smap.delta_x)&&(n=0),null==(a=r.$$smap.delta_y)&&(a=0),i.$h("g",l(["attrs"],{attrs:l(["transform"],{transform:"translate("+t(10,n)+" "+t(12,a)+") scale(0.7)"})}),[i.$h("path",l(["attrs"],{attrs:l(["d","fill","stroke","stroke-width","stroke-linecap","stroke-linejoin"],{d:"M -15 -7 Q -7.5 -15, 0 -7 S 7.5 1, 15 -7M -15 -2  Q -7.5 -10, 0 -2  S 7.5 6, 15 -2",fill:"none",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})})),i.$h("path",l(["attrs"],{attrs:l(["d","fill","stroke","stroke-width","stroke-linecap","stroke-linejoin"],{d:"M -15 -7 Q -7.5 -15, 0 -7 S 7.5 1, 15 -7M -15 -2  Q -7.5 -10, 0 -2  S 7.5 6, 15 -2",fill:"none",stroke:"#147ebe","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})}))])},d.$$arity=-1)}(c[0],$(c,"Base"),c)}(c[0],c)}(a[0],a)},Opal.modules["view/part/location_name"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e<=t:e["$<="](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var $=e.top,o=[],s=e.nil,l=(e.const_get_qualified,e.const_get_relative),u=(e.breaker,e.slice,e.module),c=e.klass,p=e.truthy,d=e.hash2,_=e.hash,f=e.send,h=e.range;return e.add_stubs(["$require","$any?","$offboards","$-@","$+","$delta_y","$name_segments","$class","$location_name","$translate","$with_index","$map","$*","$h","$-","$size","$<=","$split","$===","$>","$[]","$join","$each_slice"]),$.$require("view/part/base"),function($,o){var y=[u($,"View")].concat(o);!function($,o){var y=[u($,"Part")].concat(o);!function($,$super,o){var u,y,m,g,b,v=c($,$super,"LocationName"),w=[v].concat(o);v.$$prototype.tile=v.$$prototype.name_segments=v.$$prototype.delta_y=s,e.const_set(w[0],"LINE_HEIGHT",15),e.def(v,"$preferred_render_locations",u=function(){var e=this;return p(e.tile.$offboards()["$any?"]())?[d(["region_weights","x","y"],{region_weights:l(w,"CENTER"),x:0,y:0}),d(["region_weights","x","y"],{region_weights:l(w,"TOP_MIDDLE_ROW"),x:0,y:t(24,e.$delta_y())["$-@"]()}),d(["region_weights","x","y"],{region_weights:l(w,"BOTTOM_MIDDLE_ROW"),x:0,y:24})]:[d(["region_weights","x","y"],{region_weights:l(w,"CENTER"),x:0,y:0}),d(["region_weights_in","region_weights_out","x","y"],{region_weights_in:_(l(w,"TRACK_TO_EDGE_3"),1,l(w,"UPPER_CENTER"),1,[6,10],.25,l(w,"TOP_ROW"),.1),region_weights_out:_(l(w,"UPPER_CENTER"),1,[6,10],.25),x:0,y:t(40,e.$delta_y())["$-@"]()}),d(["region_weights_in","region_weights_out","x","y"],{region_weights_in:_(l(w,"TRACK_TO_EDGE_0"),1,l(w,"LOWER_CENTER"),1,[13,17],.25,l(w,"BOTTOM_ROW"),.1),region_weights_out:_(l(w,"LOWER_CENTER"),1,[13,14,16,17],.25),x:0,y:40})]},u.$$arity=0),e.def(v,"$load_from_tile",y=function(){var e=this;return e.name_segments=e.$class().$name_segments(e.tile.$location_name())},y.$$arity=0),e.def(v,"$render_part",m=function(){var e,t=this,n=s,a=s;return n=d(["class","fill","transform","text-anchor","stroke-width","alignment-baseline","dominant-baseline"],{"class":"location_name",fill:"black",transform:"scale(1.1) "+t.$translate(),"text-anchor":"middle","stroke-width":.5,"alignment-baseline":"middle","dominant-baseline":"middle"}),a=f(t.name_segments.$map(),"with_index",[],((e=function(t,n){var a=e.$$s||this,i=s,$=s;return null==t&&(t=s),null==n&&(n=s),i=0,$=r(n,l(w,"LINE_HEIGHT")),a.$h("text",d(["attrs"],{attrs:d(["transform"],{transform:"translate("+i+" "+$+")"})}),t)}).$$s=t,e.$$arity=2,e)),t.$h("g.location_name",d(["attrs"],{attrs:n}),a)},m.$$arity=0),e.def(v,"$delta_y",g=function(){var e,t=this;return t.delta_y=p(e=t.delta_y)?e:r(n(t.name_segments.$size(),1),l(w,"LINE_HEIGHT"))},g.$$arity=0),e.defs(v,"$name_segments",b=function(t,r){var n,$,o=this,l=s,u=s;if(null==r)r=d([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(n=r.$$smap.max_size)&&(n=13),p(a(t.$size(),n))?[t]:(l=t.$split(" "),u=l.$size(),3["$==="](u)?p(i(l["$[]"](0).$size(),l["$[]"](2).$size()))?[l["$[]"](0),l["$[]"](h(1,2,!1)).$join(" ")]:[l["$[]"](h(0,1,!1)).$join(" "),l["$[]"](2)]:4["$==="](u)?f(l.$each_slice(2),"map",[],(($=function(e){return $.$$s,null==e&&(e=s),e.$join(" ")}).$$s=o,$.$$arity=1,$)):l)},b.$$arity=-2)}(y[0],l(y,"Base"),y)}(y[0],y)}(o[0],o)},Opal.modules["view/part/cities"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.send,l=e.hash2;return e.add_stubs(["$require","$map","$cities","$flat_map","$select","$paths","$equal?","$city","$to_proc","$h"]),t.$require("view/part/city"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,r){var u=[$(t,"Part")].concat(r);!function(t,$super,r){var $,u=o(t,$super,"Cities"),c=[u].concat(r);u.$$prototype.tile=n,e.def(u,"$render",$=function(){var e,t=this;return s(t.tile.$cities(),"map",[],((e=function(t){var r,$=e.$$s||this,o=n;return null==$.tile&&($.tile=n),null==$.region_use&&($.region_use=n),null==t&&(t=n),o=s(s($.tile.$paths(),"select",[],((r=function(e){r.$$s;return null==e&&(e=n),e.$city()["$equal?"](t)}).$$s=$,r.$$arity=1,r)),"flat_map",[],"exits".$to_proc()),$.$h(a(i(c,"Part"),"City"),l(["region_use","tile","city","edges"],{region_use:$.region_use,tile:$.tile,city:t,edges:o}))}).$$s=t,e.$$arity=1,e))},$.$$arity=0)}(u[0],i(u,"Base"),u)}(u[0],u)}(r[0],r)},Opal.modules["view/part/city"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}var o=e.top,s=[],l=e.nil,u=e.const_get_qualified,c=e.const_get_relative,p=(e.breaker,e.slice,e.module),d=e.klass,_=e.hash,f=e.hash2,h=e.truthy,y=e.range,m=e.send;return e.add_stubs(["$require","$*","$needs","$freeze","$-@","$>","$size","$cities","$!","$[]","$sin","$/","$cos","$abs","$-","$+","$<","$slots","$===","$map","$zip","$tokens","$h","$translate","$reservations","$between?","$<<","$render_box"]),o.$require("lib/hex"),o.$require("view/part/base"),o.$require("view/part/city_slot"),function(o,s){var g=[p(o,"View")].concat(s);!function(o,s){var g=[p(o,"Part")].concat(s);!function(o,$super,s){var p,g,b,v=d(o,$super,"City"),w=[v].concat(s);v.$$prototype.edges=v.$$prototype.tile=v.$$prototype.city=l,e.const_set(w[0],"SLOT_RADIUS",25),e.const_set(w[0],"SLOT_DIAMETER",t(2,c(w,"SLOT_RADIUS"))),v.$needs("tile"),v.$needs("edges"),v.$needs("city"),e.const_set(w[0],"CITY_SLOT_POSITION",_(1,[0,0],2,[c(w,"SLOT_RADIUS")["$-@"](),0],3,[0,-29],4,[c(w,"SLOT_RADIUS")["$-@"](),c(w,"SLOT_RADIUS")["$-@"]()],5,[0,-43],6,[0,-50]).$freeze()),e.const_set(w[0],"EDGE_TRACK_LOCATIONS",[c(w,"TRACK_TO_EDGE_0"),c(w,"TRACK_TO_EDGE_1"),c(w,"TRACK_TO_EDGE_2"),c(w,"TRACK_TO_EDGE_3"),c(w,"TRACK_TO_EDGE_4"),c(w,"TRACK_TO_EDGE_5")].$freeze()),e.const_set(w[0],"SHARP_TRACK_LOCATIONS",[[13,14,15,19,20,21],[5,6,7,12,13,14],[0,1,2,6,7,8],[2,3,4,8,9,10],[9,10,11,16,17,18],[15,16,17,21,22,23]].$freeze()),e.const_set(w[0],"BOX_ATTRS",_(2,["rect",f(["fill","width","height","x","y"],{fill:"white",width:c(w,"SLOT_DIAMETER"),height:c(w,"SLOT_DIAMETER"),x:c(w,"SLOT_RADIUS")["$-@"](),y:c(w,"SLOT_RADIUS")["$-@"]()})],3,["polygon",f(["fill","points","transform"],{fill:"white",points:u(u(c(w,"Lib"),"Hex"),"POINTS"),transform:"scale(0.458)"})],4,["rect",f(["fill","width","height","x","y","rx"],{fill:"white",width:t(c(w,"SLOT_DIAMETER"),2),height:t(c(w,"SLOT_DIAMETER"),2),x:c(w,"SLOT_DIAMETER")["$-@"](),y:c(w,"SLOT_DIAMETER")["$-@"](),rx:c(w,"SLOT_RADIUS")})],5,["circle",f(["fill","r"],{fill:"white",r:t(1.36,c(w,"SLOT_DIAMETER"))})],6,["circle",f(["fill","r"],{fill:"white",r:t(1.5,c(w,"SLOT_DIAMETER"))})]).$freeze()),e.def(v,"$preferred_render_locations",p=function(){var o,s,p=this,d=l,m=l,g=l,b=l,v=l,k=l,x=l;return s=p.edges,o=e.to_ary(s),d=null==o[0]?l:o[0],m=null==o[1]?l:o[1],h(h(o=r(p.tile.$cities().$size(),1))?h(s=d)?s:m:o)?h(h(o=d["$!"]())?o:m["$!"]())?(g=h(o=d)?o:m,[f(["region_weights","x","y"],{region_weights:c(w,"EDGE_TRACK_LOCATIONS")["$[]"](g),x:t(c(w,"Math").$sin(t(n(t(g,60),180),u(c(w,"Math"),"PI")))["$-@"](),50),y:t(c(w,"Math").$cos(t(n(t(g,60),180),u(c(w,"Math"),"PI"))),50)})]):(h(r(a(m,d).$abs(),3))&&(d=i(d,6)),g=h($(m,d))?m:d,[f(["region_weights","x","y"],{region_weights:c(w,"EDGE_TRACK_LOCATIONS")["$[]"](g),x:t(c(w,"Math").$sin(t(n(t(g,60),180),u(c(w,"Math"),"PI")))["$-@"](),50),y:t(c(w,"Math").$cos(t(n(t(g,60),180),u(c(w,"Math"),"PI"))),50)})]):(v=p.city.$slots(),b=1["$==="](v)?c(w,"CENTER"):y(2,4,!1)["$==="](v)?_(c(w,"CENTER"),1,i(i(i(c(w,"LEFT_CENTER"),c(w,"LEFT_MID")),c(w,"RIGHT_CENTER")),c(w,"RIGHT_MID")),.5):c(w,"CENTER"),s=c(w,"CITY_SLOT_POSITION")["$[]"](p.city.$slots()),k=null==(o=e.to_ary(s))[0]?l:o[0],x=null==o[1]?l:o[1],[f(["region_weights","x","y"],{region_weights:b,x:k,y:x})])},p.$$arity=0),e.def(v,"$render_part",g=function(){var r,$=this,o=l,s=l;return o=m(e.Range.$new(0,a($.city.$slots(),1),!1).$zip($.city.$tokens()),"map",[],((r=function(e,a){var i=r.$$s||this,$=l;return null==i.city&&(i.city=l),null==e&&(e=l),null==a&&(a=l),$=t(n(360,i.city.$slots()),e),i.$h("g",f(["attrs"],{attrs:f(["stroke-width","transform"],{"stroke-width":1,transform:"rotate("+$+")"})}),[i.$h("g",f(["attrs"],{attrs:f(["transform"],{transform:i.$translate()+" rotate("+$+")"})}),[i.$h(c(w,"CitySlot"),f(["city","token","slot_index","radius","reservation"],{city:i.city,token:a,slot_index:e,radius:c(w,"SLOT_RADIUS"),reservation:i.city.$reservations()["$[]"](e)}))])])}).$$s=$,r.$$arity=2,r)),s=[],h(o.$size()["$between?"](2,6))&&s["$<<"]($.$render_box(o.$size())),s=i(s,o),$.$h("g.city",s)},g.$$arity=0),e.def(v,"$render_box",b=function(t){var r,n,a=this,i=l,$=l;return n=c(w,"BOX_ATTRS")["$[]"](t),i=null==(r=e.to_ary(n))[0]?l:r[0],$=null==r[1]?l:r[1],a.$h(i+".city_box",f(["attrs"],{attrs:$}))},b.$$arity=1)}(g[0],c(g,"Base"),g)}(g[0],g)}(s[0],s)},Opal.modules["view/part/town_dot"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.hash,u=e.truthy;return e.add_stubs(["$require","$needs","$freeze","$>","$size","$towns","$translate","$h"]),r.$require("view/part/base"),function(r,n){var c=[$(r,"View")].concat(n);!function(r,n){var c=[$(r,"Part")].concat(n);!function(r,$super,n){var $,c,p=o(r,$super,"TownDot"),d=[p].concat(n);p.$$prototype.tile=p.$$prototype.color=a,p.$needs("color",s(["default"],{"default":"black"})),p.$needs("tile"),e.const_set(d[0],"CENTER_TOWN",[s(["region_weights","x","y"],{region_weights:i(d,"CENTER"),x:0,y:0})].$freeze()),e.const_set(d[0],"OFFSET_TOWNS",[s(["region_weights","x","y"],{region_weights:[13,14],x:-40,y:20}),s(["region_weights","x","y"],{region_weights:[9,10],x:40,y:-20}),s(["region_weights","x","y"],{region_weights:l([6,7],.5),x:-40,y:-20}),s(["region_weights","x","y"],{region_weights:l([16,17],.5),x:40,y:20})].$freeze()),e.def(p,"$preferred_render_locations",$=function(){return u(t(this.tile.$towns().$size(),1))?i(d,"OFFSET_TOWNS"):i(d,"CENTER_TOWN")},$.$$arity=0),e.def(p,"$render_part",c=function(){var e=this,t=a;return t=s(["class","transform","fill","cx","cy","r"],{"class":"town_dot",transform:e.$translate(),fill:e.color,cx:"0",cy:"0",r:"10"}),e.$h("circle",s(["attrs"],{attrs:t}))},c.$$arity=0)}(c[0],i(c,"Base"),c)}(c[0],c)}(n[0],n)},Opal.modules["view/part/label"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.hash;return e.add_stubs(["$require","$+","$to_s","$label","$translate","$h"]),r.$require("view/part/base"),function(r,n){var u=[$(r,"View")].concat(n);!function(r,n){var u=[$(r,"Part")].concat(n);!function(r,$super,n){var $,u,c,p=o(r,$super,"Label"),d=[p].concat(n);p.$$prototype.tile=p.$$prototype.label=a,e.def(p,"$preferred_render_locations",$=function(){return[s(["region_weights","x","y"],{region_weights:l(t(i(d,"LEFT_MID"),i(d,"LEFT_CORNER")),1,i(d,"LEFT_CENTER"),.5),x:-22,y:0}),s(["region_weights","x","y"],{region_weights:l(t(i(d,"RIGHT_MID"),i(d,"RIGHT_CORNER")),1,i(d,"RIGHT_CENTER"),.5),x:22,y:0}),s(["region_weights","x","y"],{region_weights:l(i(d,"LEFT_CORNER"),1,t(i(d,"LEFT_CENTER"),i(d,"LEFT_MID")),.5),x:-28.5,y:0}),s(["region_weights","x","y"],{region_weights:l(i(d,"RIGHT_CORNER"),1,t(i(d,"RIGHT_CENTER"),i(d,"RIGHT_MID")),.5),x:28.5,y:0})]},$.$$arity=0),e.def(p,"$load_from_tile",u=function(){var e=this;return e.label=e.tile.$label().$to_s()},u.$$arity=0),e.def(p,"$render_part",c=function(){var e=this,t=a;return t=s(["class","fill","transform","text-anchor","alignment-baseline","dominant-baseline"],{"class":"label",fill:"black",transform:"scale(2.5) "+e.$translate(),"text-anchor":"middle","alignment-baseline":"middle","dominant-baseline":"middle"}),e.$h("text",s(["attrs"],{attrs:t}),e.label)},c.$$arity=0)}(u[0],i(u,"Base"),u)}(u[0],u)}(n[0],n)},Opal.modules["view/part/multi_revenue"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}e.top;var a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.send;return e.add_stubs(["$freeze","$needs","$map","$==","$*","$size","$sum","$[]","$with_index","$flat_map","$-","$+","$h"]),function(a,p){var d=[s(a,"View")].concat(p);!function(a,p){var d=[s(a,"Part")].concat(p);!function(a,$super,$){var s,p=l(a,$super,"MultiRevenue"),d=[p].concat($);p.$$prototype.revenues=p.$$prototype.translate=i,e.const_set(d[0],"COLOR",u(["white","yellow","green","brown","gray","red"],{white:"#fff",yellow:"#fde900",green:"#71bf44",
brown:"#cb7745",gray:"#bcbdc0",red:"#ec232a"}).$freeze()),p.$needs("revenues"),p.$needs("translate",u(["default"],{"default":"translate(0 0)"})),e.def(p,"$render",s=function(){var a,$,s,l=this,p=i,_=i,f=i,h=i;return p=c(l.revenues,"map",[],((a=function(r){a.$$s;var n,$,o=i,s=i,l=i;return null==r&&(r=i),$=r,n=e.to_ary($),o=null==n[0]?i:n[0],s=null==n[1]?i:n[1],l=""+(o["$=="]("diesel")?"D":i)+s,u(["text","width","color"],{text:l,width:t(l.$size(),13),color:o["$=="]("diesel")?"gray":o})}).$$s=l,a.$$arity=1,a)),_=c(p,"sum",[],(($=function(e){$.$$s;return null==e&&(e=i),e["$[]"]("width")}).$$s=l,$.$$arity=1,$)),f=c(p.$flat_map(),"with_index",[],((s=function(e,a){var $=s.$$s||this,l=i,c=i,p=i,f=i,h=i;return null==e&&(e=i),null==a&&(a=i),l=o(d,"COLOR")["$[]"](e["$[]"]("color")),c=e["$[]"]("width"),p=r(t(26,a),t(_,.5)),f=u(["fill","transform","height","width","x","y"],{fill:l,transform:"translate("+p+" 0)",height:24,width:c,x:0,y:-12}),h=u(["transform","fill","text-anchor","dominant-baseline","font-size"],{transform:"translate("+n(p,t(c,.5))+" -1)",fill:"black","text-anchor":"middle","dominant-baseline":"central","font-size":20}),[$.$h("rect",u(["attrs"],{attrs:f})),$.$h("text",u(["attrs"],{attrs:h}),e["$[]"]("text"))]}).$$s=l,s.$$arity=2,s)),h=u(["class","transform"],{"class":"multi_revenue",transform:l.translate}),l.$h("g",u(["attrs"],{attrs:h}),f)},s.$$arity=0)}(d[0],$(o(d,"Snabberb"),"Component"),d)}(d[0],d)}(a[0],a)},Opal.modules["view/part/track_curvilinear_half_path"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var n=e.top,a=[],i=e.nil,$=(e.const_get_qualified,e.const_get_relative),o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash,u=e.send,c=e.hash2,p=e.truthy;return e.add_stubs(["$require","$needs","$freeze","$map","$[]","$rotate_region","$one?","$exits","$puts","$first","$reject","$==","$compute_curvilinear_type","$compute_track_rotation_degrees","$compute_direction","$<","$!","$%","$+","$h"]),n.$require("view/part/track_curvilinear_path"),n.$require("view/part/base"),function(n,a){var d=[o(n,"View")].concat(a);!function(n,a){var d=[o(n,"Part")].concat(a);!function(n,$super,a){var o,d,_,f,h=s(n,$super,"TrackCurvilinearHalfPath"),y=[h].concat(a);h.$$prototype.curvilinear_type=h.$$prototype.direction=h.$$prototype.path=h.$$prototype.exits=h.$$prototype.this_exit=h.$$prototype.other_exit=h.$$prototype.rotation=h.$$prototype.color=i,h.$needs("exits"),e.const_set(y[0],"REGIONS",l([$(y,"STOP"),"none"],[15,21],[$(y,"SHARP"),"left"],[15,21],[$(y,"SHARP"),"right"],[13,14],[$(y,"GENTLE"),"left"],[14,15,21],[$(y,"GENTLE"),"right"],[6,7,14],[$(y,"STRAIGHT"),"left"],[2,8],[$(y,"STRAIGHT"),"right"],[15,21]).$freeze()),e.const_set(y[0],"SVG_PATH_STRINGS",l([$(y,"STOP"),"none"],"M 0 87 L 0 30",[$(y,"SHARP"),"left"],"M 0 87 L 0 75 A 43.30125 43.30125 0 0 0 -21.575 37.5405",[$(y,"SHARP"),"right"],"M -75 43.5 L -64.951875 37.5 A 43.30125 43.30125 0 0 1 -21.575 37.5405",[$(y,"GENTLE"),"left"],"M 0 87 L 0 75 A 129.90375 129.90375 0 0 0 -17.375 10.0775",[$(y,"GENTLE"),"right"],"M -75 -43.5 L -64.951875 -37.5 A 129.90375 129.90375 0 0 1 -17.375 10.0775",[$(y,"STRAIGHT"),"left"],"M 0 87 L 0 0",[$(y,"STRAIGHT"),"right"],"M 0 -87 L 0 0").$freeze()),e.def(h,"$preferred_render_locations",o=function(){var e,t=this,r=i;return r=u($(y,"REGIONS")["$[]"]([t.curvilinear_type,t.direction]),"map",[],((e=function(t){var r=e.$$s||this;return null==r.rotation&&(r.rotation=i),null==t&&(t=i),r.$rotate_region(t,c(["degrees"],{degrees:r.rotation}))}).$$s=t,e.$$arity=1,e)),[c(["region_weights","x","y"],{region_weights:r,x:0,y:0})]},o.$$arity=0),e.def(h,"$load_from_tile",d=function(){var e,t=this,r=i;return p(t.path.$exits()["$one?"]())||t.$puts("WARNING: expected @path to have exactly one exit"),t.this_exit=t.path.$exits().$first(),r=u(t.exits,"reject",[],((e=function(t){var r=e.$$s||this;return null==r.this_exit&&(r.this_exit=i),null==t&&(t=i),t["$=="](r.this_exit)}).$$s=t,e.$$arity=1,e)),t.other_exit=r.$first(),t.curvilinear_type=t.$compute_curvilinear_type(t.this_exit,t.other_exit),t.rotation=t.$compute_track_rotation_degrees(t.this_exit,t.other_exit),t.direction=t.$compute_direction(t.this_exit,t.other_exit,t.curvilinear_type)},d.$$arity=0),e.def(h,"$compute_direction",_=function(e,n,a){var o;return a["$=="]($(y,"STRAIGHT"))?p(t(e,n))?"left":"right":p(p(o=n["$!"]())?o:e["$!"]())?"none":r(e,a)["$%"](6)["$=="](n)?"left":r(n,a)["$%"](6)["$=="](e)?"right":i},_.$$arity=3),e.def(h,"$render_part",f=function(){var e=this,t=i;return t=c(["attrs"],{attrs:c(["class","transform","d","stroke","stroke-width"],{"class":"curvilinear_path",transform:"rotate("+e.rotation+")",d:$(y,"SVG_PATH_STRINGS")["$[]"]([e.curvilinear_type,e.direction]),stroke:e.color,"stroke-width":8})}),e.$h("path",t)},f.$$arity=0)}(d[0],$(d,"TrackCurvilinearPath"),d)}(d[0],d)}(a[0],a)},Opal.modules["view/part/track_offboard"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy,u=e.hash;return e.add_stubs(["$require","$needs","$num","$first","$edges","$[]","$edge_num","$*","$h"]),r.$require("view/part/base"),function(r,n){var c=[$(r,"View")].concat(n);!function(r,n){var c=[$(r,"Part")].concat(n);!function(r,$super,n){var i,$,c,p=o(r,$super,"TrackOffboard");[p].concat(n);p.$$prototype.edge_num=p.$$prototype.path=p.$$prototype.color=a,p.$needs("path"),p.$needs("color",s(["default"],{"default":"black"})),e.def(p,"$edge_num",i=function(){var e,t=this;return t.edge_num=l(e=t.edge_num)?e:t.path.$edges().$first().$num()},i.$$arity=0),e.def(p,"$preferred_render_locations",$=function(){var e=this,t=a;return t=u(0,[21],1,[13],2,[6],3,[2],4,[10],5,[17])["$[]"](e.$edge_num()),[s(["region_weights","x","y"],{region_weights:t,x:0,y:0})]},$.$$arity=0),e.def(p,"$render_part",c=function(){var e=this,r=a,n=a;return r=t(60,e.$edge_num()),n=s(["attrs"],{attrs:s(["class","transform","d","fill","stroke","stroke-linecap","stroke-linejoin","stroke-width"],{"class":"track",transform:"rotate("+r+")",d:"M6 75 L 6 85 L -6 85 L -6 75 L 0 48 Z",fill:e.color,stroke:"none","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-width":6})}),e.$h("path",n)},c.$$arity=0)}(c[0],i(c,"Base"),c)}(c[0],c)}(n[0],n)},Opal.modules["view/part/base"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}e.top;var i=[],$=e.nil,o=e.const_get_qualified,s=e.const_get_relative,l=(e.breaker,e.slice,e.module),u=e.klass,c=e.hash2,p=e.hash,d=e.truthy,_=e.send;return e.add_stubs(["$needs","$freeze","$[]","$render_location","$is_a?","$each","$+","$[]=","$-","$with_index","$min_by","$preferred_render_locations","$combined_cost","$load_from_tile","$should_render?","$increment_cost","$render_part","$raise","$sum","$*","$to_i","$/"]),function(i,f){var h=[l(i,"View")].concat(f);!function(i,f){var h=[l(i,"Part")].concat(f);!function(i,$super,o){var l,f,h,y,m,g,b,v,w,k,x,E=u(i,$super,"Base"),O=[E].concat(o);E.$$prototype.render_location=$,E.$needs("region_use"),E.$needs("tile",c(["default"],{"default":$})),e.const_set(O[0],"UPPER_LEFT",[0,1,2].$freeze()),e.const_set(O[0],"UPPER_RIGHT",[2,3,4].$freeze()),e.const_set(O[0],"UPPER_CENTER_LEFT",[6,7,8].$freeze()),e.const_set(O[0],"UPPER_CENTER_RIGHT",[8,9,10].$freeze()),e.const_set(O[0],"UPPER_CENTER",[7,8,9].$freeze()),e.const_set(O[0],"LOWER_CENTER",[14,15,16].$freeze()),e.const_set(O[0],"CENTER",[7,8,9,14,15,16].$freeze()),e.const_set(O[0],"LEFT_CENTER",[7,14].$freeze()),e.const_set(O[0],"RIGHT_CENTER",[9,16].$freeze()),e.const_set(O[0],"LEFT_MID",[6,13].$freeze()),e.const_set(O[0],"RIGHT_MID",[10,17].$freeze()),e.const_set(O[0],"LEFT_CORNER",[5,12].$freeze()),e.const_set(O[0],"RIGHT_CORNER",[11,18].$freeze()),e.const_set(O[0],"TRACK_TO_EDGE_0",[15,21].$freeze()),e.const_set(O[0],"TRACK_TO_EDGE_1",[13,14].$freeze()),e.const_set(O[0],"TRACK_TO_EDGE_2",[6,7].$freeze()),e.const_set(O[0],"TRACK_TO_EDGE_3",[2,8].$freeze()),e.const_set(O[0],"TRACK_TO_EDGE_4",[9,10].$freeze()),e.const_set(O[0],"TRACK_TO_EDGE_5",[16,17].$freeze()),e.const_set(O[0],"TOP_ROW",[0,1,2,3,4].$freeze()),e.const_set(O[0],"TOP_MIDDLE_ROW",[6,7,8,9,10].$freeze()),e.const_set(O[0],"BOTTOM_MIDDLE_ROW",[13,14,15,16,17].$freeze()),e.const_set(O[0],"BOTTOM_ROW",[19,20,21,22,23].$freeze()),e.const_set(O[0],"REGIONS_ROTATED_ONCE",p(0,3,1,4,2,10,3,11,4,18,5,1,6,2,7,8,8,9,9,16,10,17,11,23,12,0,13,6,14,7,15,14,16,15,17,21,18,22,19,5,20,12,21,13,22,19,23,20).$freeze()),e.def(E,"$preferred_render_locations",l=function(){return[c(["region_weights","region_weights_in","region_weights_out","x","y"],{region_weights:c([],{}),region_weights_in:c([],{}),region_weights_out:c([],{}),x:0,y:0})]},l.$$arity=0),e.def(E,"$translate",f=function(){var e=this;return"translate("+e.$render_location()["$[]"]("x")+" "+e.$render_location()["$[]"]("y")+")"},f.$$arity=0),e.def(E,"$rotation",h=function(){var e;return"rotate("+(d(e=this.$render_location()["$[]"]("angle"))?e:0)+")"},h.$$arity=0),e.def(E,"$increment_cost",y=function(){var n,a,i=this,o=$;return o=d(n=i.$render_location()["$[]"]("region_weights_out"))?n:i.$render_location()["$[]"]("region_weights"),d(o["$is_a?"](s(O,"Array")))&&(o=p(o,1)),_(o,"each",[],((a=function(n,i){var o,s=a.$$s||this;return null==n&&(n=$),null==i&&(i=$),_(n,"each",[],((o=function(n){var a=o.$$s||this,s=$;return null==a.region_use&&(a.region_use=$),null==n&&(n=$),s=[n,t(a.region_use["$[]"](n),i)],_(a.region_use,"[]=",e.to_a(s)),s[r(s.length,1)]}).$$s=s,o.$$arity=1,o))}).$$s=i,a.$$arity=2,a))},y.$$arity=0),e.def(E,"$render_location",m=function(){var e,t,r=this;return r.render_location=d(e=r.render_location)?e:_(r.$preferred_render_locations().$min_by(),"with_index",[],((t=function(e,r){var n,a=t.$$s||this;return null==e&&(e=$),null==r&&(r=$),[a.$combined_cost(d(n=e["$[]"]("region_weights_in"))?n:e["$[]"]("region_weights")),r]}).$$s=r,t.$$arity=2,t))},m.$$arity=0),e.def(E,"$load_from_tile",g=function(){return $},g.$$arity=0),e.def(E,"$should_render?",b=function(){return!0},b.$$arity=0),e.def(E,"$render",v=function(){var e=this;return e.$load_from_tile(),d(e["$should_render?"]())?(e.$increment_cost(),e.$render_part()):""},v.$$arity=0),e.def(E,"$render_part",w=function(){return this.$raise(s(O,"NotImplementedError"))},w.$$arity=0),e.def(E,"$combined_cost",k=function(e){var t,r=this;return d(e["$is_a?"](s(O,"Array")))&&(e=p(e,1)),_(e,"sum",[],((t=function(e,r){var a,i=t.$$s||this;return null==e&&(e=$),null==r&&(r=$),n(r,_(e,"sum",[],((a=function(e){var t=a.$$s||this;return null==t.region_use&&(t.region_use=$),null==e&&(e=$),t.region_use["$[]"](e)}).$$s=i,a.$$arity=1,a)))}).$$s=r,t.$$arity=2,t))},k.$$arity=1),e.def(E,"$rotate_region",x=function(t,r){var n,i,o,l,u=this;if(null==r)r=c([],{});else if(!r.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(n=r.$$smap.rotations)&&(n=$),null==(i=r.$$smap.degrees)&&(i=$),n=d(o=n)?o:a(i,60).$to_i(),_(e.Range.$new(1,n,!1),"each",[],((l=function(e){l.$$s;return null==e&&(e=$),t=s(O,"REGIONS_ROTATED_ONCE")["$[]"](t)}).$$s=u,l.$$arity=1,l)),t},x.$$arity=-2)}(h[0],o(s(h,"Snabberb"),"Component"),h)}(h[0],h)}(i[0],i)},Opal.modules["view/part/city_slot"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy,u=e.lambda;return e.add_stubs(["$require","$include","$needs","$<<","$h","$reservation","$corporation","$on_click","$can_place_token?","$round","$new","$current_entity","$process_action"]),t.$require("view/actionable"),t.$require("view/token"),function(t,r){var c=[$(t,"View")].concat(r);!function(t,r){var c=[$(t,"Part")].concat(r);!function(t,$super,r){var $,c,p,d=o(t,$super,"CitySlot"),_=[d].concat(r);d.$$prototype.radius=d.$$prototype.reservation=d.$$prototype.token=d.$$prototype.game=d.$$prototype.city=d.$$prototype.slot_index=n,d.$include(i(_,"Actionable")),d.$needs("token"),d.$needs("slot_index",s(["default"],{"default":0})),d.$needs("city"),d.$needs("radius"),d.$needs("tile_selector",s(["default","store"],{"default":n,store:!0})),d.$needs("reservation",s(["default"],{"default":n})),d.$needs("game",s(["default","store"],{"default":n,store:!0})),e.def(d,"$render",$=function(){var e,t=this,r=n;return(r=[])["$<<"](t.$h("circle",s(["attrs"],{attrs:s(["r","fill"],{r:t.radius,fill:"white"})}))),l(t.reservation)&&r["$<<"](t.$reservation()),l(t.token)&&r["$<<"](t.$h(i(_,"Token"),s(["corporation","radius"],{corporation:t.token.$corporation(),radius:t.radius}))),t.$h("g",s(["on","attrs"],{on:s(["click"],{click:u((e=function(){return(e.$$s||this).$on_click()},e.$$s=t,e.$$arity=0,e))}),attrs:s(["class"],{"class":"city_slot"})}),r)},$.$$arity=0),e.def(d,"$reservation",c=function(){var e=this;return e.$h("text",s(["attrs"],{attrs:s(["text-anchor","fill","transform"],{"text-anchor":"middle",fill:"black",transform:"translate(0 9) scale(1.75)"})}),e.reservation)},c.$$arity=0),e.def(d,"$on_click",p=function(){var e=this,t=n;return l(e.token)?n:l(e.game.$round()["$can_place_token?"]())?(t=a(a(i(_,"Engine"),"Action"),"PlaceToken").$new(e.game.$current_entity(),e.city,e.slot_index),e.$process_action(t)):n},p.$$arity=0)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(c[0],c)}(r[0],r)},Opal.modules["view/part/town_rect"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function i(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function $(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}var o=e.top,s=[],l=e.nil,u=e.const_get_qualified,c=e.const_get_relative,p=(e.breaker,e.slice,e.module),d=e.klass,_=e.hash2,f=e.truthy,h=e.send;return e.add_stubs(["$require","$needs","$freeze","$<","$>","$abs","$-","$+","$normalized_edges","$===","$track_type","$*","$/","$-@","$sin","$cos","$[]","$%","$map","$zip","$track_location","$rotation_angles","$position","$translate","$rotation","$h"]),o.$require("view/part/base"),function(o,s){var y=[p(o,"View")].concat(s);!function(o,s){var y=[p(o,"Part")].concat(s);!function(o,$super,s){var p,y,m,g,b,v,w,k,x=d(o,$super,"TownRect"),E=[x].concat(s);x.$$prototype.normalized_edges=x.$$prototype.edges=x.$$prototype.track_type=x.$$prototype.position_angle=x.$$prototype.track_location=x.$$prototype.rotation_angles=x.$$prototype.position=x.$$prototype.color=l,x.$needs("edges"),x.$needs("color",_(["default"],{"default":"black"})),e.const_set(E[0],"HEIGHT",8),e.const_set(E[0],"WIDTH",32),e.const_set(E[0],"EDGE_TRACK_LOCATIONS",[c(E,"TRACK_TO_EDGE_0"),c(E,"TRACK_TO_EDGE_1"),c(E,"TRACK_TO_EDGE_2"),c(E,"TRACK_TO_EDGE_3"),c(E,"TRACK_TO_EDGE_4"),c(E,"TRACK_TO_EDGE_5")].$freeze()),e.const_set(E[0],"SHARP_TRACK_LOCATIONS",[[13,14,15,19,20,21],[5,6,7,12,13,14],[0,1,2,6,7,8],[2,3,4,8,9,10],[9,10,11,16,17,18],[15,16,17,21,22,23]].$freeze()),e.def(x,"$normalized_edges",p=function(){var i,$,o,s=this,u=l,c=l;return s.normalized_edges=f(i=s.normalized_edges)?i:(o=s.edges,$=e.to_ary(o),u=null==$[0]?l:$[0],c=null==$[1]?l:$[1],f(t(c,u))&&(u=($=[c,u])[0],c=$[1]),f(r(n(c,u).$abs(),3))&&(u=a(u,6)),f(t(c,u))&&(u=($=[c,u])[0],c=$[1]),[u,c])},p.$$arity=0),e.def(x,"$track_type",y=function(){var t,r,a,i=this,$=l,o=l,s=l;return i.track_type=f(t=i.track_type)?t:(a=i.$normalized_edges(),r=e.to_ary(a),$=null==r[0]?l:r[0],o=null==r[1]?l:r[1],s=n(o,$),3["$==="](s)?"straight":2["$==="](s)?"gentle":"sharp")},y.$$arity=0),e.def(x,"$position_angle",m=function(){var t,r,n,o=this,s=l,p=l,d=l,_=l;return o.position_angle=f(t=o.position_angle)?t:(n=o.$normalized_edges(),r=e.to_ary(n),s=null==r[0]?l:r[0],d=o.$track_type(),_=i($(p="sharp"["$==="](d)?i(a(s,.5),60):"gentle"["$==="](d)?a(i(s,60),5):i(s,60),180),u(c(E,"Math"),"PI")),[p,c(E,"Math").$sin(_)["$-@"](),c(E,"Math").$cos(_)])},m.$$arity=0),e.def(x,"$track_location",g=function(){var t,r,n,a=this,i=l,$=l,o=l;return a.track_location=f(t=a.track_location)?t:(n=a.$normalized_edges(),r=e.to_ary(n),i=null==r[0]?l:r[0],$=null==r[1]?l:r[1],o=a.$track_type(),"sharp"["$==="](o)?[c(E,"SHARP_TRACK_LOCATIONS")["$[]"](i["$%"](6))]:[c(E,"CENTER"),c(E,"EDGE_TRACK_LOCATIONS")["$[]"](i["$%"](6)),c(E,"EDGE_TRACK_LOCATIONS")["$[]"]($["$%"](6))])},g.$$arity=0),e.def(x,"$rotation_angles",b=function(){var t,r,$,o=this,s=l,u=l;return o.rotation_angles=f(t=o.rotation_angles)?t:($=o.$normalized_edges(),r=e.to_ary($),s=null==r[0]?l:r[0],u=o.$track_type(),"sharp"["$==="](u)?[i(a(s,2),60)]:"gentle"["$==="](u)?[n(i(s,60),30),n(i(s,60),10),n(i(s,60),50)]:i([i(s,60)],3))},b.$$arity=0),e.def(x,"$position",v=function(){var t,r,o,s,p,d,_=this,y=l,m=l,g=l,b=l,v=l,w=l,k=l,x=l;return _.position=f(t=_.position)?t:(o=_.$normalized_edges(),r=e.to_ary(o),y=null==r[0]?l:r[0],m=null==r[1]?l:r[1],b=_.$track_type(),g="sharp"["$==="](b)?[i(a(y,.5),60)]:"gentle"["$==="](b)?[i(a(y,1),60),a(i(y,60),2),n(i(m,60),2)]:i([i(y,60)],3),v=h(g,"map",[],((s=function(e){s.$$s;return null==e&&(e=l),i($(e,180),u(c(E,"Math"),"PI"))}).$$s=_,s.$$arity=1,s)),b=_.$track_type(),w="sharp"["$==="](b)?[43.5]:"gentle"["$==="](b)?[20,53.375,53.375]:[0,40,-40],k=h(w.$zip(v),"map",[],((p=function(e,t){p.$$s;return null==e&&(e=l),null==t&&(t=l),i(c(E,"Math").$sin(t)["$-@"](),e)}).$$s=_,p.$$arity=2,p)),x=h(w.$zip(v),"map",[],((d=function(e,t){d.$$s;return null==e&&(e=l),null==t&&(t=l),i(c(E,"Math").$cos(t),e)}).$$s=_,d.$$arity=2,d)),_.$track_location().$zip(k,x,_.$rotation_angles()))},v.$$arity=0),e.def(x,"$preferred_render_locations",w=function(){var e,t=this;return h(t.$position(),"map",[],((e=function(t,r,n,a){e.$$s;return null==t&&(t=l),null==r&&(r=l),null==n&&(n=l),null==a&&(a=l),_(["region_weights","x","y","angle"],{region_weights:t,x:r,y:n,angle:a})}).$$s=t,e.$$arity=4,e))},w.$$arity=0),e.def(x,"$render",k=function(){var e=this,t=l;return t=_(["class","transform","x","y","height","width","fill","stroke"],{"class":"town_rect",transform:e.$translate()+" "+e.$rotation(),x:$(c(E,"WIDTH")["$-@"](),2),y:$(c(E,"HEIGHT")["$-@"](),2),height:c(E,"HEIGHT"),width:c(E,"WIDTH"),fill:e.color,stroke:"none"}),e.$h("rect",_(["attrs"],{attrs:t}))},k.$$arity=0)}(y[0],c(y,"Base"),y)}(y[0],y)}(s[0],s)},Opal.modules["view/part/track_lawson_path"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var r=e.top,n=[],a=e.nil,i=(e.const_get_qualified,e.const_get_relative),$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.hash;return e.add_stubs(["$require","$needs","$num","$first","$edges","$[]","$*","$h"]),r.$require("view/part/base"),function(r,n){var u=[$(r,"View")].concat(n);!function(r,n){var u=[$(r,"Part")].concat(n);!function(r,$super,n){var $,u,c,p=o(r,$super,"TrackLawsonPath"),d=[p].concat(n);p.$$prototype.path=p.$$prototype.edge_num=p.$$prototype.color=a,p.$needs("path"),p.$needs("color",s(["default"],{"default":"black"})),e.def(p,"$load_from_tile",$=function(){var e=this;return e.edge_num=e.path.$edges().$first().$num()},$.$$arity=0),e.def(p,"$preferred_render_locations",u=function(){var e=this,t=a;return t=l(0,i(d,"TRACK_TO_EDGE_0"),1,i(d,"TRACK_TO_EDGE_1"),2,i(d,"TRACK_TO_EDGE_2"),3,i(d,"TRACK_TO_EDGE_3"),4,i(d,"TRACK_TO_EDGE_4"),5,i(d,"TRACK_TO_EDGE_5"))["$[]"](e.edge_num),[s(["region_weights","x","y"],{region_weights:t,x:0,y:0})]},u.$$arity=0),e.def(p,"$render_part",c=function(){var e=this,r=a,n=a;return r=t(60,e.edge_num),n=s(["attrs"],{attrs:s(["class","transform","d","stroke","stroke-width"],{"class":"lawson_path",transform:"rotate("+r+")",d:"M 0 87 L 0 0",stroke:e.color,"stroke-width":8})}),[e.$h("path",n)]},c.$$arity=0)}(u[0],i(u,"Base"),u)}(u[0],u)}(n[0],n)},Opal.modules["view/tiles"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy;return e.add_stubs(["$*","$h","$new","$for"]),function(r,u){var c=[$(r,"View")].concat(u);!function(r,$super,$){var u,c=o(r,$super,"Tiles"),p=[c].concat($);e.def(c,"$render_tile_block",u=function(r,$){var o,u,c,d,_,f,h=this,y=n,m=n;if(null==$)$=s([],{});else if(!$.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(o=$.$$smap.num)&&(o=n),null==(u=$.$$smap.tile)&&(u=n),null==(c=$.$$smap.location_name)&&(c=n),null==(d=$.$$smap.scale)&&(d=1),null==(_=$.$$smap.opacity)&&(_=1),y=s(["style"],{style:s(["display","width","height","padding","margin","outline-style","outline-width"],{display:"inline-block",width:t(80,d)+"px",height:t(97,d)+"px",padding:"0.1em",margin:"10px 1px 10px 0","outline-style":"solid","outline-width":"thin"})}),m=l(o)?r+" x "+o:r,h.$h("div",y,[h.$h("div",s(["style"],{style:s(["text-align","font-size"],{"text-align":"center","font-size":"12px"})}),m),h.$h("svg",s(["style"],{style:s(["width","height"],{width:"100%",height:"100%"})}),[h.$h("g",s(["attrs"],{attrs:s(["transform"],{transform:"scale("+t(d,.4)+")"})}),[h.$h(i(p,"Hex"),s(["hex","role","opacity"],{hex:a(i(p,"Engine"),"Hex").$new("A1",s(["layout","location_name","tile"],{layout:"flat",location_name:c,tile:l(f=u)?f:a(i(p,"Engine"),"Tile").$for(r)})),role:"tile_page",opacity:_}))])])])},u.$$arity=-2)}(c[0],a(i(c,"Snabberb"),"Component"),c)}(r[0],r)},Opal.modules["view/home"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash2,u=e.send,c=e.truthy,p=e.lambda;return e.add_stubs(["$require","$include","$needs","$h","$partition","$user_in_game?","$group_by","$[]","$sort_by!","$user_is_acting?","$-@","$==","$reverse","$sort_by","$map","$select","$all_keys","$start_with?","$render_row","$any?","$subscribe","$update_game","$lambda","$unsubscribe","$<<","$line","$join","$!=","$button","$enter_game","$>","$size","$start_game","$delete_game","$leave_game","$join_game"]),r.$require("game_manager"),r.$require("lib/storage"),r.$require("view/chat"),r.$require("view/game_row"),r.$require("view/welcome"),function(r,n){var d=[o(r,"View")].concat(n);!function(r,$super,n){var o,d,_,f,h,y=s(r,$super,"Home"),m=[y].concat(n);y.$$prototype.user=y.$$prototype.connection=y.$$prototype.games=a,y.$include($(m,"GameManager")),y.$needs("user"),e.def(y,"$render",o=function(){var t,r,n,o,s,p,d,_,f,h,y=this,g=a,b=a,v=a,w=a,k=a,x=a,E=a;return g=[y.$h($(m,"Welcome"),l(["user"],{user:y.user})),y.$h($(m,"Chat"),l(["user","connection"],{user:y.user,connection:y.connection}))],r=u(y.games,"partition",[],((n=function(e){var t=n.$$s||this;return null==t.user&&(t.user=a),null==e&&(e=a),t["$user_in_game?"](t.user,e)}).$$s=y,n.$$arity=1,n)),b=null==(t=e.to_ary(r))[0]?a:t[0],v=null==t[1]?a:t[1],w=u(v,"group_by",[],((o=function(e){o.$$s;return null==e&&(e=a),e["$[]"]("status")}).$$s=y,o.$$arity=1,o)),u(b,"sort_by!",[],((s=function(e){var t=s.$$s||this;return null==t.user&&(t.user=a),null==e&&(e=a),[c(t["$user_is_acting?"](t.user,e))?e["$[]"]("id")["$-@"]():0,e["$[]"]("status")["$=="]("active")?e["$[]"]("id")["$-@"]():0,e["$[]"]("status")["$=="]("new")?e["$[]"]("id")["$-@"]():0,e["$[]"]("id")["$-@"]()]}).$$s=y,s.$$arity=1,s)),k=u(u(u(i($(m,"Lib"),"Storage").$all_keys(),"select",[],(p=function(e){p.$$s;return null==e&&(e=a),e["$start_with?"]("hs_")},p.$$s=y,p.$$arity=1,p)),"map",[],(d=function(e){d.$$s;return null==e&&(e=a),i($(m,"Lib"),"Storage")["$[]"](e)},d.$$s=y,d.$$arity=1,d)),"sort_by",[],(_=function(e){_.$$s;return null==e&&(e=a),e["$[]"]("id")},_.$$s=y,_.$$arity=1,_)).$reverse(),c(y.user)&&y.$render_row(g,"Your Games",b,"personal"),c(k["$any?"]())&&y.$render_row(g,"Hotseat Games",k,"hotseat"),c(y.user)&&y.$render_row(g,"New Games",w["$[]"]("new"),"new"),y.$render_row(g,"Active Games",w["$[]"]("active"),"active"),y.$render_row(g,"Finished Games",w["$[]"]("finished"),"finished"),u(y.connection,"subscribe",["/games"],((f=function(e){var t=f.$$s||this;return null==e&&(e=a),t.$update_game(e)}).$$s=y,f.$$arity=1,f)),x=u(y,"lambda",[],((h=function(){var e=h.$$s||this;return null==e.connection&&(e.connection=a),e.connection.$unsubscribe("/games")}).$$s=y,h.$$arity=0,h)),E=l(["key","hook"],{key:"home_page",hook:l(["destroy"],{destroy:x})}),y.$h("div",E,g)},o.$$arity=0),e.def(y,"$render_row",d=function(e,t,r,n){var i,o=this;return c((i=r)===a||null==i?a:u(i,"any?",[]))?e["$<<"](o.$h($(m,"GameRow"),l(["header","game_row_games","type","user"],{header:t,game_row_games:r,type:n,user:o.user}))):a},d.$$arity=4),e.def(y,"$render_game_box",_=function(e){var r,n,i,$,o,s,d,_=this,f=a,h=a,y=a;return f=l(["style"],{style:l(["text-align","border-top"],{"text-align":"center","border-top":"1px solid gainsboro"})}),h=[_.$line("Game",e["$[]"]("title")),_.$line("Owner",e["$[]"]("user")["$[]"]("name")),_.$line("Description","Id: "+e["$[]"]("id")+" "+e["$[]"]("description")),_.$line("Players",u(e["$[]"]("players"),"map",[],(r=function(e){r.$$s;return null==e&&(e=a),e["$[]"]("name")},r.$$s=_,r.$$arity=1,r)).$join(", ")),_.$line("Created",e["$[]"]("created_at"))],y=_.$h("div",f,h),c(e["$[]"]("status")["$!="]("new"))?(h["$<<"](_.$button("Enter",p(((n=function(){return(n.$$s||this).$enter_game(e)}).$$s=_,n.$$arity=0,n)))),y):c(_.user)?(e["$[]"]("user")["$[]"]("id")["$=="](_.user["$[]"]("id"))?(c(t(e["$[]"]("players").$size(),1))&&h["$<<"](_.$button("Start",p(((i=function(){return(i.$$s||this).$start_game(e)}).$$s=_,i.$$arity=0,i)))),h["$<<"](_.$button("Delete",p((($=function(){return($.$$s||this).$delete_game(e)}).$$s=_,$.$$arity=0,$))))):c(u(e["$[]"]("players"),"any?",[],((o=function(e){var t=o.$$s||this;return null==t.user&&(t.user=a),null==e&&(e=a),e["$[]"]("id")["$=="](t.user["$[]"]("id"))}).$$s=_,o.$$arity=1,o)))?h["$<<"](_.$button("Leave",p(((s=function(){return(s.$$s||this).$leave_game(e)}).$$s=_,s.$$arity=0,s)))):c(t(e["$[]"]("max_players"),e["$[]"]("players").$size()))&&h["$<<"](_.$button("Join",p(((d=function(){return(d.$$s||this).$join_game(e)}).$$s=_,d.$$arity=0,d)))),y):y},_.$$arity=1),e.def(y,"$line",f=function(e,t){var r=this,n=a;return n=l(["style"],{style:l(["margin","display"],{margin:"0.5em",display:"inline-block"})}),r.$h("div",n,[r.$h("div",e+":"),r.$h("div",t)])},f.$$arity=2),e.def(y,"$button",h=function(e,t){var r=this,n=a;return n=l(["attrs","on","style"],{attrs:l(["type"],{type:"button"}),on:l(["click"],{click:t}),style:l(["margin"],{margin:"1rem"})}),r.$h("button",n,e)},h.$$arity=2)}(d[0],i($(d,"Snabberb"),"Component"),d)}(n[0],n)},Opal.modules["view/sell_shares"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send;return e.add_stubs(["$require","$include","$needs","$map","$sellable_bundles","$round","$lambda","$process_action","$new","$shares","$percent","$num_shares","$format_currency","$price","$h","$compact"]),t.$require("view/actionable"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var $,u=o(t,$super,"SellShares"),c=[u].concat(r);u.$$prototype.game=u.$$prototype.player=u.$$prototype.selected_corporation=n,u.$include(i(c,"Actionable")),u.$needs("player"),u.$needs("selected_corporation",s(["default","store"],{"default":n,store:!0})),e.def(u,"$render",$=function(){var e,t=this,r=n;return r=l(t.game.$round().$sellable_bundles(t.player,t.selected_corporation),"map",[],((e=function(t){var r,$=e.$$s||this,o=n,u=n;return null==$.game&&($.game=n),null==t&&(t=n),o=l($,"lambda",[],((r=function(){var e=r.$$s||this;return null==e.player&&(e.player=n),e.$process_action(a(a(i(c,"Engine"),"Action"),"SellShares").$new(e.player,t.$shares(),t.$percent()))}).$$s=$,r.$$arity=0,r)),u="Sell "+t.$num_shares()+" ("+$.game.$format_currency(t.$price())+")",$.$h("button.margined_half",s(["on"],{on:s(["click"],{click:o})}),u)}).$$s=t,e.$$arity=1,e)),t.$h("div",s(["style"],{style:s(["margin-top"],{"margin-top":"1rem"})}),r.$compact())},$.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/log"]=function(e){e.top;var t=[],r=e.nil,n=e.const_get_qualified,a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.klass,o=e.send,s=e.hash2,l=e.truthy;return e.add_stubs(["$needs","$lambda","$map","$reverse","$is_a?","$h","$name","$entity","$message"]),function(t,u){var c=[i(t,"View")].concat(u);!function(t,$super,i){var u,c=$(t,$super,"Log"),p=[c].concat(i);c.$$prototype.log=r,c.$needs("log"),e.def(c,"$render",u=function(){var e,t,i=this,$=r,u=r,c=r;return $=o(i,"lambda",[],((e=function(t){e.$$s;null==t&&(t=r);var n=t;n.preventDefault(),n.currentTarget.scrollTop-=n.deltaY}).$$s=i,e.$$arity=1,e)),u=s(["on","style"],{on:s(["wheel"],{wheel:$}),style:s(["transform","overflow","height","padding","background-color","word-break"],{transform:"scaleY(-1)",overflow:"auto",height:"200px",padding:"0.5rem","background-color":"lightgray","word-break":"break-word"})}),c=o(i.log.$reverse(),"map",[],((t=function(e){var i=t.$$s||this;return null==e&&(e=r),l(e["$is_a?"](a(p,"String")))?i.$h("div",s(["style"],{style:s(["transform"],{transform:"scaleY(-1)"})}),e):l(e["$is_a?"](n(n(a(p,"Engine"),"Action"),"Message")))?i.$h("div",s(["style"],{style:s(["font-weight","transform"],{"font-weight":"bold",transform:"scaleY(-1)"})}),e.$entity().$name()+": "+e.$message()):r}).$$s=i,t.$$arity=1,t)),i.$h("div",u,c)},u.$$arity=0)}(c[0],n(a(c,"Snabberb"),"Component"),c)}(t[0],t)},Opal.modules["view/route_selector"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var n=e.top,a=[],i=e.nil,$=e.const_get_qualified,o=e.const_get_relative,s=(e.breaker,e.slice,e.module),l=e.klass,u=e.hash2,c=e.send,p=e.truthy;return e.add_stubs(["$require","$include","$needs","$select","$any?","$hexes","$round","$map","$trains","$current_entity","$lambda","$find","$==","$train","$new","$phase","$store","$+","$active_routes","$format_currency","$revenue","$to_s","$[]","$index","$[]=","$-","$<<","$h","$size","$stops","$join","$to_proc","$name","$actions","$process_action","$reset!","$sum"]),n.$require("view/actionable"),n.$require("view/undo_and_pass"),function(n,a){var d=[s(n,"View")].concat(a);!function(n,$super,a){var s,d,_,f=l(n,$super,"RouteSelector"),h=[f].concat(a);f.$$prototype.routes=f.$$prototype.game=i,f.$include(o(h,"Actionable")),f.$needs("routes",u(["store","default"],{store:!0,"default":[]})),f.$needs("selected_route",u(["store","default"],{store:!0,"default":i})),e.def(f,"$active_routes",s=function(){var e,t=this;return c(t.routes,"select",[],((e=function(t){e.$$s;return null==t&&(t=i),t.$hexes()["$any?"]()}).$$s=t,e.$$arity=1,e))},s.$$arity=0),e.def(f,"$render",d=function(){var n,a=this,s=i,l=i;return s=a.game.$round(),l=c(s.$current_entity().$trains(),"map",[],((n=function(a){var s,l,d,_,f,y=n.$$s||this,m=i,g=i,b=i,v=i,w=i,k=i,x=i,E=i,O=i;return null==y.selected_route&&(y.selected_route=i),null==y.game&&(y.game=i),null==y.routes&&(y.routes=i),null==a&&(a=i),m=c(y,"lambda",[],((s=function(){var e,r=s.$$s||this,n=i;return null==r.routes&&(r.routes=i),null==r.game&&(r.game=i),n=c(r.routes,"find",[],((e=function(t){e.$$s;return null==t&&(t=i),t.$train()["$=="](a)}).$$s=r,e.$$arity=1,e)),p(n)||(n=$(o(h,"Engine"),"Route").$new(r.game.$phase(),a),r.$store("routes",t(r.routes,[n]))),r.$store("selected_route",n)}).$$s=y,s.$$arity=0,s)),g=(l=y.selected_route,l===i||null==l?i:c(l,"train",[]))["$=="](a),b=u(["border","display","cursor","margin","padding"],{border:"solid "+(p(g)?"4px":"1px")+" rgba(0,0,0,0.2)",display:"inline-block",cursor:p(g)?"default":"pointer",margin:"0.5rem 0.5rem 0.5rem 0",padding:"0.5rem"}),v=c(y.$active_routes(),"find",[],((d=function(e){d.$$s;return null==e&&(e=i),e.$train()["$=="](a)}).$$s=y,d.$$arity=1,d)),w=[],p(v)&&(f=function(){try{return[y.game.$format_currency(v.$revenue()),i]}catch(t){if(!e.rescue(t,[$(o(h,"Engine"),"GameError")]))throw t;k=t;try{return["N/A",k.$to_s()]}finally{e.pop_exception()}}}(),x=null==(_=e.to_ary(f))[0]?i:_[0],E=null==_[1]?i:_[1],O=["background-color",$($(o(h,"Part"),"Track"),"ROUTE_COLORS")["$[]"](y.routes.$index(v))],c(b,"[]=",e.to_a(O)),O[r(O.length,1)],O=["color","white"],c(b,"[]=",e.to_a(O)),O[r(O.length,1)],w["$<<"](y.$h("td",v.$stops().$size())),w["$<<"](y.$h("td",x)),
w["$<<"](y.$h("td",p(E)?c(v.$hexes(),"map",[],"name".$to_proc()).$join(", ")+" ("+E+")":c(v.$hexes(),"map",[],"name".$to_proc()).$join(", ")))),y.$h("tr",[y.$h("td",u(["style","on"],{style:b,on:u(["click"],{click:m})}),"Train: "+a.$name())].concat(e.to_a(w)))}).$$s=a,n.$$arity=1,n)),a.$h("div",[a.$h(o(h,"UndoAndPass"),u(["pass"],{pass:!1})),a.$h("table",u(["style"],{style:u(["text-align"],{"text-align":"left"})}),[a.$h("tr",[a.$h("th","Train"),a.$h("th","Stops"),a.$h("th","Revenue"),a.$h("th","Route")])].concat(e.to_a(l))),a.$actions()])},d.$$arity=0),e.def(f,"$actions",_=function(){var r,n,a,s=this,l=i,p=i,d=i,_=i;return l=c(s,"lambda",[],((r=function(){var e=r.$$s||this;return null==e.game&&(e.game=i),e.$process_action($($(o(h,"Engine"),"Action"),"RunRoutes").$new(e.game.$current_entity(),e.$active_routes())),e.$store("routes",[],u(["skip"],{skip:!0})),e.$store("selected_route",i,u(["skip"],{skip:!0}))}).$$s=s,r.$$arity=0,r)),p=c(s,"lambda",[],((n=function(){var e,t=n.$$s||this;return null==t.selected_route&&(t.selected_route=i),(e=t.selected_route)===i||null==e||c(e,"reset!",[]),t.$store("selected_route",t.selected_route)}).$$s=s,n.$$arity=0,n)),d=c(s,"lambda",[],((a=function(){var e=a.$$s||this;return null==e.selected_route&&(e.selected_route=i),e.selected_route=i,e.$store("selected_route",e.selected_route),e.$store("routes",[])}).$$s=s,a.$$arity=0,a)),_=function(){try{return s.game.$format_currency(c(s.$active_routes(),"sum",[],"revenue".$to_proc()))}catch(t){if(!e.rescue(t,[$(o(h,"Engine"),"GameError")]))throw t;try{return"(Invalid Route)"}finally{e.pop_exception()}}}(),s.$h("div",[s.$h("button",u(["on"],{on:u(["click"],{click:l})}),t("Submit ",_)),s.$h("button",u(["style","on"],{style:u(["margin-left"],{"margin-left":"1rem"}),on:u(["click"],{click:p})}),"Reset Train"),s.$h("button",u(["style","on"],{style:u(["margin-left"],{"margin-left":"1rem"}),on:u(["click"],{click:d})}),"Reset All")])},_.$$arity=0)}(d[0],$(o(d,"Snabberb"),"Component"),d)}(a[0],a)},Opal.modules["view/welcome"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy,u=e.lambda;return e.add_stubs(["$needs","$h","$render_header","$render_notification","$render_introduction","$render_buttons","$+","$[]","$store"]),function(r,c){var p=[$(r,"View")].concat(c);!function(r,$super,a){var i,$,c,p,d,_=o(r,$super,"Welcome");[_].concat(a);_.$$prototype.user=n,_.$needs("user"),_.$needs("app_route",s(["default","store"],{"default":n,store:!0})),e.def(_,"$render",i=function(){var e=this,t=n;return t=s(["style"],{style:s(["display","margin-right"],{display:"inline-block","margin-right":"1rem"})}),e.$h("div.half",t,[e.$render_header(),e.$render_notification(),e.$render_introduction(),e.$render_buttons()])},i.$$arity=0),e.def(_,"$render_header",$=function(){var e=this;return e.$h("div.card_header",["Welcome"+(l(e.user)?t(" ",e.user["$[]"]("name")):"")+"!"])},$.$$arity=0),e.def(_,"$render_notification",c=function(){var e=this,t=n,r=n;return t="I've made some changes to email notifications. You can now disable them in your <a href='/profile'>Profile</a>.\nAnd email messages will only be sent to users if you ping them with @playername.\n\n        You can now end games early. The owner of the game has an option in the tools tab to end the game if it is finished.\n\n        Please file issues <a href='https://github.com/tobymao/18xx/issues'>here</a>. And if you have any questions, check out the\n<a href='https://docs.google.com/document/d/1nCYnzNMQLrFLZtWdbjfuSx5aIcaOyi27lMYkJxcGayw/edit'>FAQ!</a>\n",r=s(["style","props"],{style:s(["background-color","padding","margin"],{"background-color":"#FFEC46",padding:"1em",margin:"1rem 0"}),props:s(["innerHTML"],{innerHTML:t})}),e.$h("div",r)},c.$$arity=0),e.def(_,"$render_introduction",p=function(){var e=this,t=n;return t=s(["props","style"],{props:s(["innerHTML"],{innerHTML:"<p>18xx.games is a website where you can play async or real-time 18xx games! Right now only 1889 is implemented\nbut I'm planning on doing many more in the future.</p>\n\n        <p>You can play locally with hot seat mode without an account. If you want to play multiplayer, you'll need to create an account.</p>\n\n        <p>If you look at other people's games, you can make moves to play around but it won't affect them and changes won't be saved.\nYou can clone games in the tools tab and then play around locally.</p>\n\n        <p>In multiplayer games, you'll also be able to make moves for other players, this is so people can say 'pass me this SR' and you don't\nneed to wait. Please use this feature politely! I'm also planning on adding a toggle to disable or enable this in the future. </p>\n"}),style:s(["margin"],{margin:"1rem 0"})}),e.$h("div",t)},p.$$arity=0),e.def(_,"$render_buttons",d=function(){var e,t,r=this,a=n,i=n,$=n;return a=s(["style"],{style:s(["margin"],{margin:"1rem 0"})}),i=s(["on"],{on:s(["click"],{click:u((e=function(){return(e.$$s||this).$store("app_route","/new_game")},e.$$s=r,e.$$arity=0,e))})}),$=s(["on","style"],{on:s(["click"],{click:u((t=function(){return(t.$$s||this).$store("app_route","/tutorial?action=1")},t.$$s=r,t.$$arity=0,t))}),style:s(["margin-left"],{"margin-left":"1rem"})}),r.$h("div",a,[r.$h("button.button",i,"CREATE A NEW GAME"),r.$h("button.button",$,"TUTORIAL")])},d.$$arity=0)}(p[0],a(i(p,"Snabberb"),"Component"),p)}(r[0],r)},Opal.modules["view/axis"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e/t:e["$/"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var i=e.top,$=[],o=e.nil,s=e.const_get_qualified,l=e.const_get_relative,u=(e.breaker,e.slice,e.module),c=e.klass,p=e.hash2,d=e.send,_=e.range;return e.add_stubs(["$require","$needs","$h","$col_labels","$row_labels","$private","$[]","$hex_size","$map","$+","$/","$*","$-","$to_i","$to_a","$size"]),i.$require("view/hex"),function(i,$){var f=[u(i,"View")].concat($);!function(i,$super,$){var u,f,h,y,m=c(i,$super,"Axis"),g=[m].concat($);m.$$prototype.font_size=m.$$prototype.layout=m.$$prototype.cols=m.$$prototype.gap=m.$$prototype.rows=m.$$prototype.text_length=o,m.$needs("cols"),m.$needs("rows"),m.$needs("layout"),m.$needs("font_size",p(["default"],{"default":25})),m.$needs("text_length",p(["default"],{"default":25})),m.$needs("gap"),e.def(m,"$render",u=function(){var t=this,r=o;return r=p(["id","stroke-width","stroke","fill","text-anchor","dominant-baseline","font-size"],{id:"map-axis","stroke-width":1,stroke:"black",fill:"black","text-anchor":"middle","dominant-baseline":"baseline","font-size":t.font_size+"px"}),t.$h("g",p(["attrs"],{attrs:r}),[].concat(e.to_a(t.$col_labels())).concat(e.to_a(t.$row_labels())))},u.$$arity=0),m.$private(),e.def(m,"$hex_size",f=function(){var e=this;return s(s(l(g,"View"),"Hex"),"LAYOUT")["$[]"](e.layout)},f.$$arity=0),e.def(m,"$col_labels",h=function(){var i,$,s,l=this,u=o,c=o,f=o,h=o,y=o;return $=l.$hex_size(),i=e.to_ary($),u=null==i[0]?o:i[0],c=null==i[1]?o:i[1],f=d(l.cols,"map",[],((s=function(e){var i=s.$$s||this,$=o,l=o;return null==i.font_size&&(i.font_size=o),null==e&&(e=o),$=t(r(u,2),n(u,a(e.$to_i(),1))),l=_("A","Z",!1).$to_a()["$[]"](a(e,1)),i.$h("text",p(["attrs"],{attrs:p(["x","y"],{x:$,y:i.font_size})}),l)}).$$s=l,s.$$arity=1,s)),h=t(50,l.gap),y=t(n(c,t(l.rows.$size().$to_i(),1)),n(2,l.gap)),[l.$h("g",p(["attrs"],{attrs:p(["transform"],{transform:"translate("+h+" 0)"})}),f),l.$h("g",p(["attrs"],{attrs:p(["dominant-baseline","transform"],{"dominant-baseline":"hanging",transform:"translate("+h+" "+y+")"})}),f)]},h.$$arity=0),e.def(m,"$row_labels",y=function(){var r,i,$,s=this,l=o,u=o,c=o,_=o,f=o;return i=s.$hex_size(),l=null==(r=e.to_ary(i))[0]?o:r[0],u=null==r[1]?o:r[1],c=d(s.rows,"map",[],(($=function(e){var t=$.$$s||this,r=o;return null==t.font_size&&(t.font_size=o),null==e&&(e=o),r=n(u,e.$to_i()),t.$h("text",p(["attrs"],{attrs:p(["x","y"],{x:t.font_size,y:r})}),e)}).$$s=s,$.$$arity=1,$)),_=a(t(n(l,t(s.cols.$size().$to_i(),1)),n(2,s.gap)),100),f=t(29,s.gap),[s.$h("g",p(["attrs"],{attrs:p(["dominant-baseline","textLength","transform","text-anchor"],{"dominant-baseline":"middle",textLength:s.text_length,transform:"translate(0 "+f+")","text-anchor":"end"})}),c),s.$h("g",p(["attrs"],{attrs:p(["dominant-baseline","textLength","transform","text-anchor"],{"dominant-baseline":"middle",textLength:s.text_length,transform:"translate("+_+" "+f+")","text-anchor":"start"})}),c)]},y.$$arity=0)}(f[0],s(l(f,"Snabberb"),"Component"),f)}($[0],$)},Opal.modules["view/entity_order"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}e.top;var r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.klass),o=e.send,s=e.hash2,l=e.lambda,u=e.truthy;return e.add_stubs(["$needs","$with_index","$map","$entities","$==","$current_entity","$lambda","$[]","$Native","$-","$scrollLeft=","$call","$[]=","$can_act?","$positive?","$corporation?","$logo","$<<","$h","$!","$player?","$owner","$name"]),function(r,$super,a){var i,c=$(r,$super,"EntityOrder");[c].concat(a);return c.$$prototype.round=n,c.$needs("round"),e.def(c,"$render",i=function(){var r,a=this,i=n,$=n,c=n;return i=o(a.round.$entities().$map(),"with_index",[],((r=function(a,i){var $,c,p,d=r.$$s||this,_=n,f=n,h=n,y=n,m=n,g=n,b=n,v=n;return null==d.round&&(d.round=n),null==a&&(a=n),null==i&&(i=n),_=s(["key","style"],{key:"entity_"+i,style:s(["display","height","vertical-align","margin-right","white-space"],{display:"inline-block",height:"1.5rem","vertical-align":"top","margin-right":"1rem","white-space":"nowrap"})}),d.round.$current_entity()["$=="](a)&&(f=o(d,"lambda",[],(($=function(r){var a=$.$$s||this,i=n,s=n;return null==r&&(r=n),s=[t((i=a.$Native(r)["$[]"]("elm"))["$[]"]("offsetLeft"),10)],o(i["$[]"]("parentElement")["$[]"]("parentElement"),"scrollLeft=",e.to_a(s)),s[t(s.length,1)]}).$$s=d,$.$$arity=1,$)),h=["hook",s(["insert","update"],{insert:f,update:l((c=function(e,t){c.$$s;return null==e&&(e=n),null==t&&(t=n),f.$call(t)},c.$$s=d,c.$$arity=2,c))})],o(_,"[]=",e.to_a(h)),h[t(h.length,1)]),y=_["$[]"]("style"),u(d.round["$can_act?"](a))&&(h=["text-decoration","underline"],o(y,"[]=",e.to_a(h)),h[t(h.length,1)],h=["font-weight","bold"],o(y,"[]=",e.to_a(h)),h[t(h.length,1)]),u(i["$positive?"]())&&(h=["border-left","black solid thin"],o(y,"[]=",e.to_a(h)),h[t(h.length,1)],h=["padding-left","1rem"],o(y,"[]=",e.to_a(h)),h[t(h.length,1)]),m=[],u(a["$corporation?"]())&&(g=s(["attrs","style"],{attrs:s(["src"],{src:a.$logo()}),style:s(["max-height","padding"],{"max-height":"1.2rem",padding:"0 .4rem 0 0"})}),b=s(["style"],{style:s(["height","display","vertical-align"],{height:"100%",display:"inline-block","vertical-align":"top"})}),m["$<<"](d.$h("span",b,[d.$h("img",g)]))),u(u(p=a["$player?"]()["$!"]())?a.$owner():p)&&(v=" ("+a.$owner().$name()+")"),m["$<<"](d.$h("span",""+a.$name()+v)),d.$h("div",_,m)}).$$s=a,r.$$arity=2,r)),$=s(["key","style"],{key:"entity_order",style:s(["margin","font-size","overflow"],{margin:"1rem 0 1rem 0","font-size":"1.1rem",overflow:"auto"})}),c=s(["style","key"],{style:s(["width","margin-bottom"],{width:"max-content","margin-bottom":"0.5rem"}),key:"entity_order_container"}),a.$h("div",$,[a.$h("div",c,i)])},i.$$arity=0),n&&"render"}(r[0],a(i(r,"Snabberb"),"Component"),r)},Opal.modules["view/user"]=function(e){var t=e.top,r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative),i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2,s=e.send;return e.add_stubs(["$require","$include","$needs","$===","$render_input","$render_notifications","$h","$render_button","$submit","$dig","$logout","$render_form","$create_user","$params","$login","$edit_user"]),t.$require("user_manager"),t.$require("view/form"),function(t,r){var l=[i(t,"View")].concat(r);!function(t,$super,r){var i,l,u,c=$(t,$super,"User"),p=[c].concat(r);c.$$prototype.type=c.$$prototype.user=n,c.$include(a(p,"UserManager")),c.$needs("type"),e.def(c,"$render_content",i=function(){var t,r,a,i,$,l,u,c=this,p=n,d=n,_=n;return p=c.type,r="signup"["$==="](p)?["Signup",[c.$render_input("User Name",o(["id"],{id:"name"})),c.$render_input("Email",o(["id","type","attrs"],{id:"email",type:"email",attrs:o(["autocomplete"],{autocomplete:"email"})})),c.$render_input("Password",o(["id","type","attrs"],{id:"password",type:"password",attrs:o(["autocomplete"],{autocomplete:"new-password"})})),c.$render_notifications(),c.$h("div",[s(c,"render_button",["Create Account"],(a=function(){return(a.$$s||this).$submit()},a.$$s=c,a.$$arity=0,a))])]]:"login"["$==="](p)?["Login",[c.$render_input("Email",o(["id","type","attrs"],{id:"email",type:"email",attrs:o(["autocomplete"],{autocomplete:"email"})})),c.$render_input("Password",o(["id","type","attrs"],{id:"password",type:"password",attrs:o(["autocomplete"],{autocomplete:"current-password"})})),c.$h("div",[s(c,"render_button",["Login"],(i=function(){return(i.$$s||this).$submit()},i.$$s=c,i.$$arity=0,i))])]]:"profile"["$==="](p)?["Profile Settings",[c.$h("div",[c.$render_notifications(($=c.user,$===n||null==$?n:s($,"dig",["settings","notifications"]))),s(c,"render_button",["Save Changes"],(l=function(){return(l.$$s||this).$submit()},l.$$s=c,l.$$arity=0,l))]),s(c,"render_button",["Logout"],(u=function(){return(u.$$s||this).$logout()},u.$$s=c,u.$$arity=0,u))]]:n,d=null==(t=e.to_ary(r))[0]?n:t[0],_=null==t[1]?n:t[1],c.$render_form(d,_)},i.$$arity=0),e.def(c,"$render_notifications",l=function(e){return null==e&&(e=!0),this.$render_input("Allow Turn and Message Notifications",o(["id","type","attrs"],{id:"notifications",type:"checkbox",attrs:o(["checked"],{checked:e})}))},l.$$arity=-1),e.def(c,"$submit",u=function(){var e=this,t=n;return t=e.type,"signup"["$==="](t)?e.$create_user(e.$params()):"login"["$==="](t)?e.$login(e.$params()):"profile"["$==="](t)?e.$edit_user(e.$params()):n},u.$$arity=0)}(l[0],a(l,"Form"),l)}(r[0],r)},Opal.modules["view/flash"]=function(e){e.top;var t=[],r=e.nil,n=e.const_get_qualified,a=e.const_get_relative,i=(e.breaker,e.slice,e.module),$=e.klass,o=e.hash2,s=e.truthy,l=e.send,u=e.lambda;return e.add_stubs(["$needs","$is_a?","$any?","$h","$[]","$store"]),function(t,c){var p=[i(t,"View")].concat(c);!function(t,$super,n){var i,c=$(t,$super,"Flash"),p=[c].concat(n);c.$$prototype.flash_opts=r,c.$needs("flash_opts",o(["default","store"],{"default":o([],{}),store:!0})),e.def(c,"$render",i=function(){var e,t,n,i=this,$=r;return s(i.flash_opts["$is_a?"](a(p,"String")))&&(i.flash_opts=o(["message"],{message:i.flash_opts})),s((e=i.flash_opts)===r||null==e?r:l(e,"any?",[]))?($=o(["style","on"],{style:o(["padding","position","cursor","top","left","width","z-index","text-align","background-color"],{padding:"1em",position:"fixed",cursor:"pointer",top:"0",left:"0",width:"100%","z-index":"10000","text-align":"center","background-color":s(t=i.flash_opts["$[]"]("color"))?t:"salmon"}),on:o(["click"],{click:u((n=function(){return(n.$$s||this).$store("flash_opts",o([],{}))},n.$$s=i,n.$$arity=0,n))})}),i.$h("div",$,i.flash_opts["$[]"]("message"))):i.$h("div")},i.$$arity=0)}(p[0],n(a(p,"Snabberb"),"Component"),p)}(t[0],t)},Opal.modules["view/tools"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send,u=e.truthy,c=e.lambda;e.hash;return e.add_stubs(["$require","$include","$needs","$merge","$map","$actions","$to_proc","$to_n","$h","$render_admin","$render_clone_game","$user_owns_game?","$finished","$!","$store","$lambda","$process_action","$new","$current_entity","$first","$split","$<<","$any?","$unshift","$create_hotseat","$[]"]),t.$require("game_manager"),function(t,r){var p=[$(t,"View")].concat(r);!function(t,$super,r){var $,p,d,_=o(t,$super,"Tools"),f=[_].concat(r);_.$$prototype.game_data=_.$$prototype.game=_.$$prototype.json=_.$$prototype.user=_.$$prototype.confirm_endgame=n,_.$include(i(f,"GameManager")),_.$include(i(f,"Actionable")),_.$needs("game",s(["store"],{store:!0})),_.$needs("user"),_.$needs("confirm_endgame",s(["store","default"],{store:!0,"default":!1})),e.def(_,"$render",$=function(){var t=this,r=n;return t.game_data=t.game_data.$merge(s(["actions"],{actions:l(t.game.$actions(),"map",[],"to_h".$to_proc())})),t.json=JSON.stringify(t.game_data.$to_n(),null,2),r=s(["style"],{style:s(["white-space"],{"white-space":"pre-wrap"})}),t.$h("div",r,[].concat(e.to_a(t.$render_admin())).concat([t.$render_clone_game(),t.json]))},$.$$arity=0),e.def(_,"$render_admin",p=function(){var t,r,$,o=this,p=n,d=n,_=n;return u(o["$user_owns_game?"](o.user,o.game_data))?(p=[],u(o.game.$finished())||(d=u(o.confirm_endgame["$!"]())?[o.$h("button.button",s(["style","on"],{style:s(["margin"],{margin:"1rem"}),on:s(["click"],{click:c((t=function(){return(t.$$s||this).$store("confirm_endgame",!0)},t.$$s=o,t.$$arity=0,t))})}),"End Game")]:(_=l(o,"lambda",[],((r=function(){var e=r.$$s||this;return null==e.game&&(e.game=n),null==e.app_route&&(e.app_route=n),e.$store("confirm_endgame",!1),e.$process_action(a(a(i(f,"Engine"),"Action"),"EndGame").$new(e.game.$current_entity())),e.$store("app_route",e.app_route.$split("#").$first())}).$$s=o,r.$$arity=0,r)),[o.$h("button.button",s(["style","on"],{style:s(["margin"],{margin:"1rem"}),on:s(["click"],{click:_})}),"Confirm End Game"),o.$h("button.button",s(["style","on"],{style:s(["margin"],{margin:"1rem"}),on:s(["click"],{click:c(($=function(){return($.$$s||this).$store("confirm_endgame",!1)},$.$$s=o,$.$$arity=0,$))})}),"Cancel")]),p["$<<"](o.$h("div.margined",[o.$h("span","End Game:")].concat(e.to_a(d))))),u(p["$any?"]())&&p.$unshift(o.$h("div",s(["style"],{style:s(["font-weight"],{"font-weight":"bold"})}),"Admin tools")),p):[]},p.$$arity=0),e.def(_,"$render_clone_game",d=function(){var t,r,a=this,i=n,$=n,o=n,u=n;return i=l(a,"lambda",[],((t=function(){var r=t.$$s||this;return null==r.game_data&&(r.game_data=n),r.$store("game",n,s(["skip"],{skip:!0})),r.$create_hotseat(e.to_hash(r.game_data).$merge(s(["description"],{description:"Cloned from game "+r.game_data["$[]"]("id")})))}).$$s=a,t.$$arity=0,t)),$=l(a,"lambda",[],((r=function(){var e=r.$$s||this;return navigator.clipboard.writeText(e.json),e.$store("flash_opts",s(["message","color"],{message:"Copied Data",color:"lightgreen"}),s(["skip"],{skip:!1}))}).$$s=a,r.$$arity=0,r)),o=a.$h("button.button",s(["style","on"],{style:s(["margin"],{margin:"1rem"}),on:s(["click"],{click:i})}),"Clone Game"),u=a.$h("button.button.margined",s(["on"],{on:s(["click"],{click:$})}),"Copy Data"),a.$h("div.margined",[a.$h("span","Clone this game to play around in hotseat mode"),o,u])},d.$$arity=0)}(p[0],a(i(p,"Snabberb"),"Component"),p)}(r[0],r)},Opal.modules["view/undo_and_pass"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.truthy;return e.add_stubs(["$require","$include","$needs","$undo_possible","$<<","$h","$redo_possible"]),t.$require("view/pass_button"),t.$require("view/undo_button"),t.$require("view/redo_button"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var a,$=o(t,$super,"UndoAndPass"),u=[$].concat(r);$.$$prototype.game=$.$$prototype.pass=n,$.$include(i(u,"Actionable")),$.$needs("pass",s(["default"],{"default":!0})),e.def($,"$render",a=function(){var e=this,t=n;return t=[],l(e.game.$undo_possible())&&t["$<<"](e.$h(i(u,"UndoButton"))),l(e.game.$redo_possible())&&t["$<<"](e.$h(i(u,"RedoButton"))),l(e.pass)&&t["$<<"](e.$h(i(u,"PassButton"))),e.$h("div",t)},a.$$arity=0)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules["view/all_tokens"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.klass,l=e.send,u=e.hash2;return e.add_stubs(["$require","$corporations","$new","$[]","$map","$render_token_block","$h","$name","$*"]),r.$require("view/token"),function(r,n){var c=[o(r,"View")].concat(n);!function(r,$super,n){var o,c,p=s(r,$super,"AllTokens"),d=[p].concat(n);e.def(p,"$render",o=function(){var e,t=this,r=a,n=a;return r=i($(d,"Engine"),"GAMES_BY_TITLE")["$[]"]("1889").$new([]).$corporations(),n=l(r,"map",[],((e=function(t){var r=e.$$s||this;return null==t&&(t=a),r.$render_token_block(t)}).$$s=t,e.$$arity=1,e)),t.$h("div",u(["attrs"],{attrs:u(["id"],{id:"tiles"})}),n)},o.$$arity=0),e.def(p,"$render_token_block",c=function(e){var r=this,n=a;return n=38,r.$h("div",u(["style"],{style:u(["display","width","height","outline-style","outline-width","margin-top","margin-right"],{display:"inline-block",width:"76px",height:"100px","outline-style":"solid","outline-width":"thin","margin-top":"10px","margin-right":"1px"})}),[r.$h("div",u(["style"],{style:u(["text-align"],{"text-align":"center"})}),e.$name()),r.$h("svg",u(["attrs"],{attrs:u(["width","height"],{width:t(2,n),height:t(2,n)})}),[r.$h("g",u(["attrs"],{attrs:u(["transform"],{transform:"translate("+n+" "+n+")"})}),[r.$h(i($(d,"View"),"Token"),u(["corporation","radius"],{corporation:e,radius:n}))])])])},c.$$arity=1)}(c[0],i($(c,"Snabberb"),"Component"),c)}(n[0],n)},Opal.modules["view/corporations"]=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.module),o=e.klass,s=e.hash2,l=e.send;return e.add_stubs(["$require","$needs","$partition","$corporations","$to_proc","$map","$sort_by","$group_by","$==","$name","$dig","$render_corporations","$<<","$bank","$h"]),t.$require("view/corporation"),function(t,r){var u=[$(t,"View")].concat(r);!function(t,$super,r){var a,$,u=o(t,$super,"Corporations"),c=[u].concat(r);u.$$prototype.game=n,u.$needs("game"),u.$needs("user",s(["default"],{"default":n})),e.def(u,"$render",a=function(){var t,r,a,i,$=this,o=n,s=n,u=n;return r=l($.game.$corporations(),"partition",[],"owner".$to_proc()),o=null==(t=e.to_ary(r))[0]?n:t[0],s=null==t[1]?n:t[1],(u=l(l(l(o,"group_by",[],"owner".$to_proc()),"sort_by",[],((a=function(e,t){var r,i=a.$$s||this;return null==i.user&&(i.user=n),null==e&&(e=n),null==t&&(t=n),e.$name()["$=="]((r=i.user)===n||null==r?n:l(r,"dig",["name"]))?"":e.$name()}).$$s=$,a.$$arity=2,a)),"map",[],((i=function(e,t){var r=i.$$s||this;return null==e&&(e=n),null==t&&(t=n),r.$render_corporations(e,t)}).$$s=$,i.$$arity=2,i)))["$<<"]($.$render_corporations($.game.$bank(),s)),$.$h("div",u)},a.$$arity=0),e.def(u,"$render_corporations",$=function(t,r){var a,$=this;return $.$h("div",[$.$h("div",s(["style"],{style:s(["border-bottom"],{"border-bottom":"1px solid gainsboro"})}),t.$name())].concat(e.to_a(l(l(r,"sort_by",[],"name".$to_proc()),"map",[],((a=function(e){var t=a.$$s||this;return null==e&&(e=n),t.$h(i(c,"Corporation"),s(["corporation"],{corporation:e}))}).$$s=$,a.$$arity=1,a)))))},$.$$arity=2)}(u[0],a(i(u,"Snabberb"),"Component"),u)}(r[0],r)},Opal.modules.app=function(e){var t=e.top,r=[],n=e.nil,a=e.const_get_qualified,i=e.const_get_relative,$=(e.breaker,e.slice,e.klass),o=e.hash2,s=e.truthy;return e.add_stubs(["$require","$include","$h","$render_content","$store","$new","$root","$refresh_user","$js_handlers","$===","$render_game","$match","$include?","$enter_tutorial","$enter_game","$[]","$==","$to_n","$any?","$store_app_route"]),t.$require("index"),t.$require("game_manager"),t.$require("user_manager"),t.$require("lib/connection"),t.$require("lib/storage"),t.$require("view/about"),t.$require("view/create_game"),t.$require("view/home"),t.$require("view/flash"),t.$require("view/game"),t.$require("view/map_page"),t.$require("view/navigation"),t.$require("view/tiles_page"),t.$require("view/user"),function(t,$super,r){var l,u,c,p,d,_,f=$(t,$super,"App"),h=[f].concat(r);return f.$$prototype.connection=f.$$prototype.app_route=f.$$prototype.user=f.$$prototype.game_data=n,f.$include(i(h,"GameManager")),f.$include(i(h,"UserManager")),e.def(f,"$render",l=function(){var e=this,t=n;return t=o(["props","style"],{props:o(["id"],{id:"app"}),style:o(["padding","margin"],{padding:"0.5rem",margin:"auto"})}),e.$h("div",t,[e.$h(a(i(h,"View"),"Navigation")),e.$h(a(i(h,"View"),"Flash")),e.$render_content()])},l.$$arity=0),e.def(f,"$render_content",u=function(){var e=this,t=n,r=n,$=n;return s(e.connection)||e.$store("connection",a(i(h,"Lib"),"Connection").$new(e.$root()),o(["skip"],{skip:!0})),e.$refresh_user(),e.$js_handlers(),r=e.app_route,t=/new_game/["$==="](r)?e.$h(a(i(h,"View"),"CreateGame")):/game|hotseat|tutorial/["$==="](r)?e.$render_game():/signup/["$==="](r)?e.$h(a(i(h,"View"),"User"),o(["user","type"],{user:e.user,type:"signup"})):/login/["$==="](r)?e.$h(a(i(h,"View"),"User"),o(["user","type"],{user:e.user,type:"login"})):/profile/["$==="](r)?e.$h(a(i(h,"View"),"User"),o(["user","type"],{user:e.user,type:"profile"})):/about/["$==="](r)?e.$h(a(i(h,"View"),"About")):/tiles/["$==="](r)?e.$h(a(i(h,"View"),"TilesPage"),o(["route"],{route:e.app_route})):/map/["$==="](r)?e.$h(a(i(h,"View"),"MapPage"),o(["route"],{route:e.app_route})):e.$h(a(i(h,"View"),"Home"),o(["user"],{user:e.user})),$=o(["style"],{style:o(["padding","margin"],{padding:"0 1rem",margin:"1rem 0"})}),e.$h("div",$,[t])},u.$$arity=0),e.def(f,"$render_game",c=function(){var e=this,t=n,r=n;if(t=e.app_route.$match(/(hotseat|game)\/((hs_)?\d+)/),s(e.game_data));else if(r=e.$h("div","Loading game..."),s(e.app_route["$include?"]("tutorial"))?e.$enter_tutorial():e.$enter_game(o(["id","mode"],{id:t["$[]"](2),mode:t["$[]"](1)["$=="]("game")?"muti":"hotseat"})),!s(e.game_data))return r;return e.$h(a(i(h,"View"),"Game"),o(["connection","user"],{connection:e.connection,user:e.user}))},c.$$arity=0),e.def(f,"$js_handlers",p=function(){var e=this;e=this;window.onpopstate||(window.onpopstate=function(t){e.$on_hash_change(t.state)},e.$store_app_route());var t=window.location;t.pathname+t.hash+t.search!=e.app_route&&window.history.pushState(e.game_data.$to_n(),e.app_route,e.app_route)},p.$$arity=0),e.def(f,"$on_hash_change",d=function(e){var t=this,r=n;return r=i(h,"Hash").$new(e),s(r["$any?"]())&&t.$store("game_data",r,o(["skip"],{skip:!0})),t.$store_app_route(o(["skip"],{skip:!1}))},d.$$arity=1),e.def(f,"$store_app_route",_=function(t){var r,a=this,i=n;if(null==t)t=o([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(r=t.$$smap.skip)&&(r=!0),(i=window.location.pathname+window.location.hash+window.location.search)["$=="]("")?n:a.$store("app_route",i,o(["skip"],{skip:r}))},_.$$arity=-1),n&&"store_app_route"}(r[0],a(i(r,"Snabberb"),"Component"),r)},Opal.modules.user_manager=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.hash2,l=e.send,u=e.truthy;return e.add_stubs(["$require","$needs","$safe_post","$login_user","$!","$[]","$post","$invalidate_user","$store","$authenticate!","$update","$private","$[]=","$-","$invalidate!"]),r.$require("lib/storage"),function(r,n){var c,p,d,_,f,h,y,m,g=o(r,"UserManager"),b=[g].concat(n);e.defs(g,"$included",c=function(e){return e.$needs("user",s(["default","store"],{"default":a,store:!0})),e.$needs("app_route",s(["default","store"],{"default":a,store:!0})),e.$needs("flash_opts",s(["default","store"],{"default":s([],{}),store:!0})),e.$needs("connection",s(["default","store"],{"default":a,store:!0})),e.$needs("games",s(["default","store"],{"default":[],store:!0}))},c.$$arity=1),e.def(g,"$create_user",p=function(e){var t,r=this;return null==r.connection&&(r.connection=a),l(r.connection,"safe_post",["/user",e],((t=function(e){var r=t.$$s||this;return null==e&&(e=a),r.$login_user(e)}).$$s=r,t.$$arity=1,t))},p.$$arity=1),e.def(g,"$refresh_user",d=function(){var e,t,r=this;return null==r.user&&(r.user=a),null==r.connection&&(r.connection=a),u(u(e=r.user)?e:i($(b,"Lib"),"Storage")["$[]"]("auth_token")["$!"]())?a:l(r.connection,"post",["/user/refresh"],((t=function(e){var r=t.$$s||this;return null==r.connection&&(r.connection=a),null==e&&(e=a),u(e["$[]"]("error"))?(r.$invalidate_user(),r.$store("flash_opts","Credentials expired please re-login")):(r.connection["$authenticate!"](),r.$store("games",e["$[]"]("games"),s(["skip"],{skip:!0})),r.$store("user",e["$[]"]("user"),s(["skip"],{skip:!0})),r.$update())}).$$s=r,t.$$arity=1,t))},d.$$arity=0),e.def(g,"$edit_user",_=function(e){var t=this;return null==t.connection&&(t.connection=a),t.connection.$safe_post("/user/edit",e)},_.$$arity=1),e.def(g,"$login",f=function(e){var t,r=this;return null==r.connection&&(r.connection=a),l(r.connection,"safe_post",["/user/login",e],((t=function(e){var r=t.$$s||this;return null==e&&(e=a),r.$login_user(e)}).$$s=r,t.$$arity=1,t))},f.$$arity=1),e.def(g,"$logout",h=function(){var e=this;return null==e.connection&&(e.connection=a),e.connection.$safe_post("/user/logout"),e.$invalidate_user(),e.$store("app_route","/")},h.$$arity=0),g.$private(),e.def(g,"$login_user",y=function(r){var n=this,o=a;return null==n.connection&&(n.connection=a),o=["auth_token",r["$[]"]("auth_token")],l(i($(b,"Lib"),"Storage"),"[]=",e.to_a(o)),o[t(o.length,1)],n.connection["$authenticate!"](),n.$store("user",r["$[]"]("user"),s(["skip"],{skip:!0})),n.$store("games",r["$[]"]("games"),s(["skip"],{skip:!0})),n.$store("app_route","/")},y.$$arity=1),e.def(g,"$invalidate_user",m=function(){var r=this,n=a;return null==r.connection&&(r.connection=a),n=["auth_token",a],l(i($(b,"Lib"),"Storage"),"[]=",e.to_a(n)),n[t(n.length,1)],r.connection["$invalidate!"](),r.$store("user",a,s(["skip"],{skip:!0}))},m.$$arity=0)}(n[0],n)},Opal.modules["lib/hex"]=function(e){e.top;var t=[],r=(e.nil,e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module);return function(t,n){var a=[r(t,"Lib")].concat(n);!function(t,n){var a=[r(t,"Hex")].concat(n);e.const_set(a[0],"POINTS","100,0 50,-87 -50,-87 -100,-0 -50,87 50,87")}(a[0],a)}(t[0],t)},Opal.modules["lib/tile_selector"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}e.top;var r=[],n=e.nil,a=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module),i=e.klass;return e.add_stubs(["$attr_reader","$get_coordinates","$+","$update","$rotate!"]),function(r,$){var o=[a(r,"Lib")].concat($);!function(r,$super,a){var $,o,s,l,u=i(r,null,"TileSelector");[u].concat(a);u.$$prototype.root=u.$$prototype.tile=n,u.$attr_reader("entity","hex","tile","x","y"),e.def(u,"$initialize",$=function(t,r,a,i,$){var o,s,l=this;return l.hex=t,l.tile=r,s=l.$get_coordinates(a),o=e.to_ary(s),l.x=null==o[0]?n:o[0],l.y=null==o[1]?n:o[1],l.root=i,l.entity=$},$.$$arity=5),e.def(u,"$get_coordinates",o=function(e){var r=n;return r=e.currentTarget.getBoundingClientRect(),[t(window.pageXOffset,r.left),t(window.pageYOffset,r.top)]},o.$$arity=1),e.def(u,"$tile=",s=function(e){var t=this;return t.tile=e,t.root.$update()},s.$$arity=1),e.def(u,"$rotate!",l=function(){var e=this;return e.tile["$rotate!"](),e.root.$update()},l.$$arity=0)}(o[0],0,o)}(r[0],r)},Opal.modules["lib/params"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module),a=e.truthy;return e.add_stubs(["$Native","$[]","$split"]),function(t,i){var $=[n(t,"Lib")].concat(i);!function(t,i){var $,o,s=n(t,"Params");[s].concat(i);e.defs(s,"$[]",$=function(e){var t=this;return a("undefined"==typeof URLSearchParams)?r:t.$Native(new URLSearchParams(window.location.search).get(e))},$.$$arity=1),e.defs(s,"$add",o=function(e,t,r){return e=e.$split("?")["$[]"](0),a(r)?e+"?"+t+"="+r:e},o.$$arity=3)}($[0],$)}(t[0],t)},Opal.modules["lib/connection"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}var r=e.top,n=[],a=e.nil,i=e.const_get_qualified,$=e.const_get_relative,o=(e.breaker,e.slice,e.module),s=e.klass,l=e.hash2,u=e.send,c=e.truthy;return e.add_stubs(["$require","$start_message_bus","$unsubscribe","$send","$get","$[]","$store","$call","$post","$auth_token","$private","$merge","$to_n","$+"]),r.$require("lib/storage"),function(r,n){var p=[o(r,"Lib")].concat(n);!function(r,$super,n){var o,p,d,_,f,h,y,m,g,b,v,w,k=s(r,null,"Connection"),x=[k].concat(n);e.def(k,"$initialize",o=function(e){var t=this;return t.root=e,t.$start_message_bus()},o.$$arity=1),e.def(k,"$subscribe",p=function(t,r){var n=p.$$p,i=n||a,$=this;n&&(p.$$p=null),n&&(p.$$p=null),null==r&&(r=-1),$.$unsubscribe(t),window.MessageBus.subscribe(t,function(t){t._client_id!=MessageBus.clientId&&i.$call(e.Hash.$new(t))},r)},p.$$arity=-2),e.def(k,"$unsubscribe",d=function(e){return window.MessageBus.unsubscribe(e)},d.$$arity=1),
e.def(k,"$get",_=function(e,t){var r=_.$$p,n=r||a,i=this;return r&&(_.$$p=null),r&&(_.$$p=null),null==t&&(t="/api"),i.$send(e,"GET",a,t,n)},_.$$arity=-2),e.def(k,"$post",f=function(e,t){var r=f.$$p,n=r||a,i=this;return r&&(f.$$p=null),r&&(f.$$p=null),null==t&&(t=l([],{})),i.$send(e,"POST",t,"/api",n)},f.$$arity=-2),e.def(k,"$safe_get",h=function(e,t){var r,n=h.$$p,i=n||a,$=this;return n&&(h.$$p=null),n&&(h.$$p=null),null==t&&(t="/api"),u($,"get",[e,t],((r=function(e){var t=r.$$s||this,n=a;return null==t.root&&(t.root=a),null==e&&(e=a),c(n=e["$[]"]("error"))?t.root.$store("flash_opts",n):c(i)?i.$call(e):a}).$$s=$,r.$$arity=1,r))},h.$$arity=-2),e.def(k,"$safe_post",y=function(e,t){var r,n=y.$$p,i=n||a,$=this;return n&&(y.$$p=null),n&&(y.$$p=null),null==t&&(t=l([],{})),u($,"post",[e,t],((r=function(e){var t=r.$$s||this,n=a;return null==t.root&&(t.root=a),null==e&&(e=a),c(n=e["$[]"]("error"))?t.root.$store("flash_opts",n):c(i)?i.$call(e):a}).$$s=$,r.$$arity=1,r))},y.$$arity=-2),e.def(k,"$authenticate!",m=function(){var e=this;return MessageBus.headers={Authorization:e.$auth_token()}},m.$$arity=0),e.def(k,"$invalidate!",g=function(){return MessageBus.headers={}},g.$$arity=0),k.$private(),e.def(k,"$auth_token",b=function(){return i($(x,"Lib"),"Storage")["$[]"]("auth_token")},b.$$arity=0),e.def(k,"$send",v=function(r,n,i,$,o){var s,c=this;i=(s=i)===a||null==s?a:u(s,"merge",[l(["_client_id"],{_client_id:MessageBus.clientId})]);var p={method:n,headers:{"Content-Type":"application/json",Authorization:c.$auth_token()}};"POST"==n&&(p.body=JSON.stringify(i.$to_n())),"undefined"!=typeof fetch&&fetch(t($,r),p).then(e=>e.text()).then(t=>{"function"==typeof o&&o(e.Hash.$new(JSON.parse(t)))})["catch"](t=>{"function"==typeof o&&o(e.hash("error",JSON.stringify(t)))})},v.$$arity=5),e.def(k,"$start_message_bus",w=function(){window.MessageBus.start(),window.MessageBus.callbackInterval=1e3},w.$$arity=0)}(p[0],0,p)}(n[0],n)},Opal.modules["lib/color"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative,e.breaker,e.slice,e.module);return e.add_stubs(["$match","$hex","$[]"]),function(t,a){var i=[n(t,"Lib")].concat(a);!function(t,a){var i,$=n(t,"Color");[$].concat(a);e.defs($,"$convert_hex_to_rgba",i=function(e,t){var n=r;return"rgba("+(n=e.$match(/#(..)(..)(..)/))["$[]"](1).$hex()+","+n["$[]"](2).$hex()+","+n["$[]"](3).$hex()+","+t+")"},i.$$arity=2)}(i[0],i)}(t[0],t)},Opal.modules["lib/storage"]=function(e){e.top;var t=[],r=e.nil,n=(e.const_get_qualified,e.const_get_relative),a=(e.breaker,e.slice,e.module),i=e.truthy;return e.add_stubs(["$parse","$dump","$[]"]),function(t,$){var o=[a(t,"Lib")].concat($);!function(t,$){var o,s,l,u,c=a(t,"Storage"),p=[c].concat($);e.defs(c,"$[]",o=function(e){var t=r;return t=localStorage.getItem(e),i(t)?n(p,"JSON").$parse(t):r},o.$$arity=1),e.defs(c,"$[]=",s=function(e,t){var r=this;return localStorage.setItem(e,n(p,"JSON").$dump(t)),r["$[]"](e)},s.$$arity=2),e.defs(c,"$delete",l=function(e){return localStorage.removeItem(e)},l.$$arity=1),e.defs(c,"$all_keys",u=function(){return Object.keys(localStorage)},u.$$arity=0)}(o[0],o)}(t[0],t)},Opal.load("app");